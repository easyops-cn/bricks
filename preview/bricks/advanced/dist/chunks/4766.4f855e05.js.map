{"version":3,"file":"chunks/4766.4f855e05.js","mappings":"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","sources":["webpack:///../../node_modules/@ctrl/tinycolor/dist/module/conversion.js","webpack:///../../node_modules/@ctrl/tinycolor/dist/module/css-color-names.js","webpack:///../../node_modules/@ctrl/tinycolor/dist/module/format-input.js","webpack:///../../node_modules/@ctrl/tinycolor/dist/module/util.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/assertClassBrand.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/checkPrivateRedeclaration.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getBasePath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/historyExtended.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/history.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Runtime.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getV2RuntimeFromDll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomProcessors.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerAppI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/devtools.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/proxyFactories.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/themeAndMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getGeneralGlobals.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/StoryboardFunctionRegistry.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/StoryboardFunctions.js","webpack:///../../node_modules/@ungap/event-target/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mediaQuery.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getStorageItem.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/isStrictMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetFunctions.js","webpack:///../../node_modules/compare-versions/lib/esm/utils.js","webpack:///../../node_modules/compare-versions/lib/esm/compare.js","webpack:///../../node_modules/compare-versions/lib/esm/compareVersions.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/hasInstalledApp.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/getProviderBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/markAsComputed.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveData.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/evaluate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getNextStateOfUseBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealValue.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/checkIf.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getTracks.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/listenOnTrackingContext.js","webpack:///../../node_modules/path-to-regexp/dist.es2015/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchPath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/poll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/i18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Dialog.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/setLoginStateCookie.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/handleHttpError.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Notification.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/bindListeners.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/sse.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/bindTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/enums.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mount.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/RendererContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/routeMatchedMap.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/secret_internals.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/realTimeDataInspect.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/DataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveDataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupUseBrickInTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/expandCustomTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/expandFormRenderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/getDefaultProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/registerFormRenderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/ErrorNode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Renderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/setupRootRuntimeContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getPageInfo.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/abortController.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/setWatermark.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerCustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/setUIVersion.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Router.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/setAppVariable.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/fulfilStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/insertPreviewRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/injected.js","webpack:///../../node_modules/@next-core/color-theme/node_modules/@ant-design/colors/dist/index.esm.js","webpack:///../../node_modules/@next-core/color-theme/dist/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/customizeColorTheme.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/auth.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomEditors.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/fetchByProvider.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/createRoot.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getRealValue.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/ModalStack.js"],"sourcesContent":["import { bound01, pad2 } from './util.js';\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n/**\n * Handle bounds / percentage checking to conform to CSS color spec\n * <http://www.w3.org/TR/css3-color/>\n * *Assumes:* r, g, b in [0, 255] or [0, 1]\n * *Returns:* { r, g, b } in [0, 255]\n */\nexport function rgbToRgb(r, g, b) {\n    return {\n        r: bound01(r, 255) * 255,\n        g: bound01(g, 255) * 255,\n        b: bound01(b, 255) * 255,\n    };\n}\n/**\n * Converts an RGB color value to HSL.\n * *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n * *Returns:* { h, s, l } in [0,1]\n */\nexport function rgbToHsl(r, g, b) {\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var h = 0;\n    var s = 0;\n    var l = (max + min) / 2;\n    if (max === min) {\n        s = 0;\n        h = 0; // achromatic\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n            default:\n                break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, l: l };\n}\nfunction hue2rgb(p, q, t) {\n    if (t < 0) {\n        t += 1;\n    }\n    if (t > 1) {\n        t -= 1;\n    }\n    if (t < 1 / 6) {\n        return p + (q - p) * (6 * t);\n    }\n    if (t < 1 / 2) {\n        return q;\n    }\n    if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n}\n/**\n * Converts an HSL color value to RGB.\n *\n * *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n * *Returns:* { r, g, b } in the set [0, 255]\n */\nexport function hslToRgb(h, s, l) {\n    var r;\n    var g;\n    var b;\n    h = bound01(h, 360);\n    s = bound01(s, 100);\n    l = bound01(l, 100);\n    if (s === 0) {\n        // achromatic\n        g = l;\n        b = l;\n        r = l;\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1 / 3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1 / 3);\n    }\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n/**\n * Converts an RGB color value to HSV\n *\n * *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n * *Returns:* { h, s, v } in [0,1]\n */\nexport function rgbToHsv(r, g, b) {\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var h = 0;\n    var v = max;\n    var d = max - min;\n    var s = max === 0 ? 0 : d / max;\n    if (max === min) {\n        h = 0; // achromatic\n    }\n    else {\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n            default:\n                break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, v: v };\n}\n/**\n * Converts an HSV color value to RGB.\n *\n * *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n * *Returns:* { r, g, b } in the set [0, 255]\n */\nexport function hsvToRgb(h, s, v) {\n    h = bound01(h, 360) * 6;\n    s = bound01(s, 100);\n    v = bound01(v, 100);\n    var i = Math.floor(h);\n    var f = h - i;\n    var p = v * (1 - s);\n    var q = v * (1 - f * s);\n    var t = v * (1 - (1 - f) * s);\n    var mod = i % 6;\n    var r = [v, q, p, p, t, v][mod];\n    var g = [t, v, v, q, p, p][mod];\n    var b = [p, p, t, v, v, q][mod];\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n/**\n * Converts an RGB color to hex\n *\n * Assumes r, g, and b are contained in the set [0, 255]\n * Returns a 3 or 6 character hex\n */\nexport function rgbToHex(r, g, b, allow3Char) {\n    var hex = [\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n    ];\n    // Return a 3 character hex if possible\n    if (allow3Char &&\n        hex[0].startsWith(hex[0].charAt(1)) &&\n        hex[1].startsWith(hex[1].charAt(1)) &&\n        hex[2].startsWith(hex[2].charAt(1))) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n    }\n    return hex.join('');\n}\n/**\n * Converts an RGBA color plus alpha transparency to hex\n *\n * Assumes r, g, b are contained in the set [0, 255] and\n * a in [0, 1]. Returns a 4 or 8 character rgba hex\n */\n// eslint-disable-next-line max-params\nexport function rgbaToHex(r, g, b, a, allow4Char) {\n    var hex = [\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n        pad2(convertDecimalToHex(a)),\n    ];\n    // Return a 4 character hex if possible\n    if (allow4Char &&\n        hex[0].startsWith(hex[0].charAt(1)) &&\n        hex[1].startsWith(hex[1].charAt(1)) &&\n        hex[2].startsWith(hex[2].charAt(1)) &&\n        hex[3].startsWith(hex[3].charAt(1))) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n    }\n    return hex.join('');\n}\n/**\n * Converts an RGBA color to an ARGB Hex8 string\n * Rarely used, but required for \"toFilter()\"\n */\nexport function rgbaToArgbHex(r, g, b, a) {\n    var hex = [\n        pad2(convertDecimalToHex(a)),\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n    ];\n    return hex.join('');\n}\n/** Converts a decimal to a hex value */\nexport function convertDecimalToHex(d) {\n    return Math.round(parseFloat(d) * 255).toString(16);\n}\n/** Converts a hex value to a decimal */\nexport function convertHexToDecimal(h) {\n    return parseIntFromHex(h) / 255;\n}\n/** Parse a base-16 hex value into a base-10 integer */\nexport function parseIntFromHex(val) {\n    return parseInt(val, 16);\n}\nexport function numberInputToObject(color) {\n    return {\n        r: color >> 16,\n        g: (color & 0xff00) >> 8,\n        b: color & 0xff,\n    };\n}\n","// https://github.com/bahamas10/css-color-names/blob/master/css-color-names.json\n/**\n * @hidden\n */\nexport var names = {\n    aliceblue: '#f0f8ff',\n    antiquewhite: '#faebd7',\n    aqua: '#00ffff',\n    aquamarine: '#7fffd4',\n    azure: '#f0ffff',\n    beige: '#f5f5dc',\n    bisque: '#ffe4c4',\n    black: '#000000',\n    blanchedalmond: '#ffebcd',\n    blue: '#0000ff',\n    blueviolet: '#8a2be2',\n    brown: '#a52a2a',\n    burlywood: '#deb887',\n    cadetblue: '#5f9ea0',\n    chartreuse: '#7fff00',\n    chocolate: '#d2691e',\n    coral: '#ff7f50',\n    cornflowerblue: '#6495ed',\n    cornsilk: '#fff8dc',\n    crimson: '#dc143c',\n    cyan: '#00ffff',\n    darkblue: '#00008b',\n    darkcyan: '#008b8b',\n    darkgoldenrod: '#b8860b',\n    darkgray: '#a9a9a9',\n    darkgreen: '#006400',\n    darkgrey: '#a9a9a9',\n    darkkhaki: '#bdb76b',\n    darkmagenta: '#8b008b',\n    darkolivegreen: '#556b2f',\n    darkorange: '#ff8c00',\n    darkorchid: '#9932cc',\n    darkred: '#8b0000',\n    darksalmon: '#e9967a',\n    darkseagreen: '#8fbc8f',\n    darkslateblue: '#483d8b',\n    darkslategray: '#2f4f4f',\n    darkslategrey: '#2f4f4f',\n    darkturquoise: '#00ced1',\n    darkviolet: '#9400d3',\n    deeppink: '#ff1493',\n    deepskyblue: '#00bfff',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1e90ff',\n    firebrick: '#b22222',\n    floralwhite: '#fffaf0',\n    forestgreen: '#228b22',\n    fuchsia: '#ff00ff',\n    gainsboro: '#dcdcdc',\n    ghostwhite: '#f8f8ff',\n    goldenrod: '#daa520',\n    gold: '#ffd700',\n    gray: '#808080',\n    green: '#008000',\n    greenyellow: '#adff2f',\n    grey: '#808080',\n    honeydew: '#f0fff0',\n    hotpink: '#ff69b4',\n    indianred: '#cd5c5c',\n    indigo: '#4b0082',\n    ivory: '#fffff0',\n    khaki: '#f0e68c',\n    lavenderblush: '#fff0f5',\n    lavender: '#e6e6fa',\n    lawngreen: '#7cfc00',\n    lemonchiffon: '#fffacd',\n    lightblue: '#add8e6',\n    lightcoral: '#f08080',\n    lightcyan: '#e0ffff',\n    lightgoldenrodyellow: '#fafad2',\n    lightgray: '#d3d3d3',\n    lightgreen: '#90ee90',\n    lightgrey: '#d3d3d3',\n    lightpink: '#ffb6c1',\n    lightsalmon: '#ffa07a',\n    lightseagreen: '#20b2aa',\n    lightskyblue: '#87cefa',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#b0c4de',\n    lightyellow: '#ffffe0',\n    lime: '#00ff00',\n    limegreen: '#32cd32',\n    linen: '#faf0e6',\n    magenta: '#ff00ff',\n    maroon: '#800000',\n    mediumaquamarine: '#66cdaa',\n    mediumblue: '#0000cd',\n    mediumorchid: '#ba55d3',\n    mediumpurple: '#9370db',\n    mediumseagreen: '#3cb371',\n    mediumslateblue: '#7b68ee',\n    mediumspringgreen: '#00fa9a',\n    mediumturquoise: '#48d1cc',\n    mediumvioletred: '#c71585',\n    midnightblue: '#191970',\n    mintcream: '#f5fffa',\n    mistyrose: '#ffe4e1',\n    moccasin: '#ffe4b5',\n    navajowhite: '#ffdead',\n    navy: '#000080',\n    oldlace: '#fdf5e6',\n    olive: '#808000',\n    olivedrab: '#6b8e23',\n    orange: '#ffa500',\n    orangered: '#ff4500',\n    orchid: '#da70d6',\n    palegoldenrod: '#eee8aa',\n    palegreen: '#98fb98',\n    paleturquoise: '#afeeee',\n    palevioletred: '#db7093',\n    papayawhip: '#ffefd5',\n    peachpuff: '#ffdab9',\n    peru: '#cd853f',\n    pink: '#ffc0cb',\n    plum: '#dda0dd',\n    powderblue: '#b0e0e6',\n    purple: '#800080',\n    rebeccapurple: '#663399',\n    red: '#ff0000',\n    rosybrown: '#bc8f8f',\n    royalblue: '#4169e1',\n    saddlebrown: '#8b4513',\n    salmon: '#fa8072',\n    sandybrown: '#f4a460',\n    seagreen: '#2e8b57',\n    seashell: '#fff5ee',\n    sienna: '#a0522d',\n    silver: '#c0c0c0',\n    skyblue: '#87ceeb',\n    slateblue: '#6a5acd',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#fffafa',\n    springgreen: '#00ff7f',\n    steelblue: '#4682b4',\n    tan: '#d2b48c',\n    teal: '#008080',\n    thistle: '#d8bfd8',\n    tomato: '#ff6347',\n    turquoise: '#40e0d0',\n    violet: '#ee82ee',\n    wheat: '#f5deb3',\n    white: '#ffffff',\n    whitesmoke: '#f5f5f5',\n    yellow: '#ffff00',\n    yellowgreen: '#9acd32',\n};\n","/* eslint-disable @typescript-eslint/no-redundant-type-constituents */\nimport { convertHexToDecimal, hslToRgb, hsvToRgb, parseIntFromHex, rgbToRgb, } from './conversion.js';\nimport { names } from './css-color-names.js';\nimport { boundAlpha, convertToPercentage } from './util.js';\n/**\n * Given a string or object, convert that input to RGB\n *\n * Possible string inputs:\n * ```\n * \"red\"\n * \"#f00\" or \"f00\"\n * \"#ff0000\" or \"ff0000\"\n * \"#ff000000\" or \"ff000000\"\n * \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n * \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n * \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n * \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n * \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n * \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n * \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n * ```\n */\nexport function inputToRGB(color) {\n    var rgb = { r: 0, g: 0, b: 0 };\n    var a = 1;\n    var s = null;\n    var v = null;\n    var l = null;\n    var ok = false;\n    var format = false;\n    if (typeof color === 'string') {\n        color = stringInputToObject(color);\n    }\n    if (typeof color === 'object') {\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n            rgb = rgbToRgb(color.r, color.g, color.b);\n            ok = true;\n            format = String(color.r).substr(-1) === '%' ? 'prgb' : 'rgb';\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n            s = convertToPercentage(color.s);\n            v = convertToPercentage(color.v);\n            rgb = hsvToRgb(color.h, s, v);\n            ok = true;\n            format = 'hsv';\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n            s = convertToPercentage(color.s);\n            l = convertToPercentage(color.l);\n            rgb = hslToRgb(color.h, s, l);\n            ok = true;\n            format = 'hsl';\n        }\n        if (Object.prototype.hasOwnProperty.call(color, 'a')) {\n            a = color.a;\n        }\n    }\n    a = boundAlpha(a);\n    return {\n        ok: ok,\n        format: color.format || format,\n        r: Math.min(255, Math.max(rgb.r, 0)),\n        g: Math.min(255, Math.max(rgb.g, 0)),\n        b: Math.min(255, Math.max(rgb.b, 0)),\n        a: a,\n    };\n}\n// <http://www.w3.org/TR/css3-values/#integers>\nvar CSS_INTEGER = '[-\\\\+]?\\\\d+%?';\n// <http://www.w3.org/TR/css3-values/#number-value>\nvar CSS_NUMBER = '[-\\\\+]?\\\\d*\\\\.\\\\d+%?';\n// Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\nvar CSS_UNIT = \"(?:\".concat(CSS_NUMBER, \")|(?:\").concat(CSS_INTEGER, \")\");\n// Actual matching.\n// Parentheses and commas are optional, but not required.\n// Whitespace can take the place of commas or opening paren\nvar PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\".concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")\\\\s*\\\\)?\");\nvar PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\".concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")\\\\s*\\\\)?\");\nvar matchers = {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp('rgb' + PERMISSIVE_MATCH3),\n    rgba: new RegExp('rgba' + PERMISSIVE_MATCH4),\n    hsl: new RegExp('hsl' + PERMISSIVE_MATCH3),\n    hsla: new RegExp('hsla' + PERMISSIVE_MATCH4),\n    hsv: new RegExp('hsv' + PERMISSIVE_MATCH3),\n    hsva: new RegExp('hsva' + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n};\n/**\n * Permissive string parsing.  Take in a number of formats, and output an object\n * based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\n */\nexport function stringInputToObject(color) {\n    color = color.trim().toLowerCase();\n    if (color.length === 0) {\n        return false;\n    }\n    var named = false;\n    if (names[color]) {\n        color = names[color];\n        named = true;\n    }\n    else if (color === 'transparent') {\n        return { r: 0, g: 0, b: 0, a: 0, format: 'name' };\n    }\n    // Try to match string input using regular expressions.\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n    // Just return an object and let the conversion functions handle that.\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\n    var match = matchers.rgb.exec(color);\n    if (match) {\n        return { r: match[1], g: match[2], b: match[3] };\n    }\n    match = matchers.rgba.exec(color);\n    if (match) {\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\n    }\n    match = matchers.hsl.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], l: match[3] };\n    }\n    match = matchers.hsla.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\n    }\n    match = matchers.hsv.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], v: match[3] };\n    }\n    match = matchers.hsva.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\n    }\n    match = matchers.hex8.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            a: convertHexToDecimal(match[4]),\n            format: named ? 'name' : 'hex8',\n        };\n    }\n    match = matchers.hex6.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            format: named ? 'name' : 'hex',\n        };\n    }\n    match = matchers.hex4.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1] + match[1]),\n            g: parseIntFromHex(match[2] + match[2]),\n            b: parseIntFromHex(match[3] + match[3]),\n            a: convertHexToDecimal(match[4] + match[4]),\n            format: named ? 'name' : 'hex8',\n        };\n    }\n    match = matchers.hex3.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1] + match[1]),\n            g: parseIntFromHex(match[2] + match[2]),\n            b: parseIntFromHex(match[3] + match[3]),\n            format: named ? 'name' : 'hex',\n        };\n    }\n    return false;\n}\n/**\n * Check to see if it looks like a CSS unit\n * (see `matchers` above for definition).\n */\nexport function isValidCSSUnit(color) {\n    return Boolean(matchers.CSS_UNIT.exec(String(color)));\n}\n","/**\n * Take input from [0, n] and return it as [0, 1]\n * @hidden\n */\nexport function bound01(n, max) {\n    if (isOnePointZero(n)) {\n        n = '100%';\n    }\n    var isPercent = isPercentage(n);\n    n = max === 360 ? n : Math.min(max, Math.max(0, parseFloat(n)));\n    // Automatically convert percentage into number\n    if (isPercent) {\n        n = parseInt(String(n * max), 10) / 100;\n    }\n    // Handle floating point rounding errors\n    if (Math.abs(n - max) < 0.000001) {\n        return 1;\n    }\n    // Convert into [0, 1] range if it isn't already\n    if (max === 360) {\n        // If n is a hue given in degrees,\n        // wrap around out-of-range values into [0, 360] range\n        // then convert into [0, 1].\n        n = (n < 0 ? (n % max) + max : n % max) / parseFloat(String(max));\n    }\n    else {\n        // If n not a hue given in degrees\n        // Convert into [0, 1] range if it isn't already.\n        n = (n % max) / parseFloat(String(max));\n    }\n    return n;\n}\n/**\n * Force a number between 0 and 1\n * @hidden\n */\nexport function clamp01(val) {\n    return Math.min(1, Math.max(0, val));\n}\n/**\n * Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n * <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\n * @hidden\n */\nexport function isOnePointZero(n) {\n    return typeof n === 'string' && n.indexOf('.') !== -1 && parseFloat(n) === 1;\n}\n/**\n * Check to see if string passed in is a percentage\n * @hidden\n */\nexport function isPercentage(n) {\n    return typeof n === 'string' && n.indexOf('%') !== -1;\n}\n/**\n * Return a valid alpha value [0,1] with all invalid values being set to 1\n * @hidden\n */\nexport function boundAlpha(a) {\n    a = parseFloat(a);\n    if (isNaN(a) || a < 0 || a > 1) {\n        a = 1;\n    }\n    return a;\n}\n/**\n * Replace a decimal with it's percentage value\n * @hidden\n */\nexport function convertToPercentage(n) {\n    if (n <= 1) {\n        return \"\".concat(Number(n) * 100, \"%\");\n    }\n    return n;\n}\n/**\n * Force a hex value to have 2 characters\n * @hidden\n */\nexport function pad2(c) {\n    return c.length === 1 ? '0' + c : String(c);\n}\n","export default function _assertClassBrand(e, t, n) {\n  if (\"function\" == typeof e ? e === t : e.has(t)) return arguments.length < 3 ? t : n;\n  throw new TypeError(\"Private element is not present on this object\");\n}","export default function _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}","import assertClassBrand from \"./assertClassBrand.js\";\nexport default function _classPrivateFieldGet2(s, a) {\n  return s.get(assertClassBrand(s, a));\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateFieldInitSpec(obj, privateMap, value) {\n  checkPrivateRedeclaration(obj, privateMap);\n  privateMap.set(obj, value);\n}","import assertClassBrand from \"./assertClassBrand.js\";\nexport default function _classPrivateFieldSet2(s, a, r) {\n  return s.set(assertClassBrand(s, a), r), r;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateMethodInitSpec(obj, privateSet) {\n  checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","/**\n * Get site's base path, generally will be `/next/` or `/`.\n */\nexport function getBasePath() {\n  const base = document.querySelector(\"base\");\n  const basePath = base ? base.getAttribute(\"href\") : \"/\";\n  return basePath;\n}\n//# sourceMappingURL=getBasePath.js.map","import { orderBy } from \"lodash\";\nimport { getRuntime } from \"./Runtime.js\";\nexport function matchStoryboard(storyboards, pathname) {\n  // Put apps with longer homepage before shorter ones.\n  // E.g., `/legacy/tool` will match first before `/legacy`.\n  // This enables two apps with relationship of parent-child of homepage.\n  const sortedStoryboards = orderBy(storyboards, storyboard => {\n    var _storyboard$app$homep;\n    return ((_storyboard$app$homep = storyboard.app.homepage) === null || _storyboard$app$homep === void 0 ? void 0 : _storyboard$app$homep.length) ?? 0;\n  }, \"desc\");\n  for (const storyboard of sortedStoryboards) {\n    const homepage = storyboard.app.homepage;\n    if (typeof homepage === \"string\" && homepage[0] === \"/\") {\n      if (matchHomepage(homepage, pathname)) {\n        return storyboard;\n      }\n    }\n  }\n}\nexport function matchHomepage(homepage, pathname) {\n  return homepage === \"/\" ? pathname === homepage : `${pathname.replace(/\\/+$/, \"\")}/`.startsWith(`${homepage.replace(/\\/+$/, \"\")}/`);\n}\n\n// istanbul ignore next\n/**\n * We say it's an outside app when at least one of the below conditions are true:\n *   - target app is not found.\n *   - target app is not the current app.\n *   - current app is non-standalone mode and target app is standalone mode.\n *\n * Note: when current app is standalone mode, other apps will not be found.\n */\nexport function isOutsideApp(storyboard) {\n  var _getRuntime$getCurren;\n  if (process.env.NODE_ENV === \"test\") {\n    return false;\n  }\n  return !storyboard ||\n  // Sometimes `storyboard.app.standaloneMode` is incorrect.\n  ((_getRuntime$getCurren = getRuntime().getCurrentApp()) === null || _getRuntime$getCurren === void 0 ? void 0 : _getRuntime$getCurren.id) !== storyboard.app.id && !window.STANDALONE_MICRO_APPS && storyboard.app.standaloneMode;\n}\n//# sourceMappingURL=matchStoryboard.js.map","import { parsePath } from \"history\";\nimport { getBasePath } from \"../getBasePath.js\";\nimport { _internalApiMatchStoryboard } from \"./Runtime.js\";\nimport { isOutsideApp } from \"./matchStoryboard.js\";\nlet blocked = false;\nexport function getUserConfirmation(message, callback) {\n  blocked = !confirm(message);\n  callback(!blocked);\n}\nexport function historyExtended(browserHistory) {\n  const {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function push(location, state, callback) {\n    blocked = false;\n    originalPush(location, state);\n    callback === null || callback === void 0 || callback(blocked);\n  }\n  function replace(location, state, callback) {\n    blocked = false;\n    originalReplace(location, state);\n    callback === null || callback === void 0 || callback(blocked);\n  }\n  function updateQueryFactory(method) {\n    return function updateQuery(query) {\n      let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      let callback = arguments.length > 2 ? arguments[2] : undefined;\n      const {\n        extraQuery,\n        clear,\n        keepHash,\n        ...state\n      } = options;\n      const urlSearchParams = new URLSearchParams(clear ? \"\" : browserHistory.location.search);\n      const params = {};\n      Object.assign(params, query, extraQuery);\n      for (const [key, value] of Object.entries(params)) {\n        if (Array.isArray(value)) {\n          urlSearchParams.delete(key);\n          for (const item of value) {\n            urlSearchParams.append(key, item);\n          }\n        } else if (value === undefined || value === null || value === \"\") {\n          urlSearchParams.delete(key);\n        } else {\n          urlSearchParams.set(key, value);\n        }\n      }\n      (method === \"push\" ? push : replace)(`?${urlSearchParams.toString()}${keepHash ? browserHistory.location.hash : \"\"}`, state, callback);\n    };\n  }\n  function pushAnchor(hash, state, callback) {\n    push({\n      ...browserHistory.location,\n      key: undefined,\n      hash,\n      state: {\n        // The default notify is false\n        notify: false,\n        ...state\n      }\n    }, undefined, callback);\n  }\n  function reload(callback) {\n    replace({\n      ...browserHistory.location,\n      state: {\n        ...browserHistory.location.state,\n        // Always notify\n        notify: true,\n        // Do not use incremental sub routes\n        noIncremental: true\n      }\n    }, undefined, callback);\n  }\n  let blockMessage;\n  function setBlockMessage(message) {\n    blockMessage = message;\n  }\n  function getBlockMessage() {\n    return blockMessage;\n  }\n  function unblock() {\n    blockMessage = undefined;\n  }\n  return {\n    pushQuery: updateQueryFactory(\"push\"),\n    replaceQuery: updateQueryFactory(\"replace\"),\n    pushAnchor: pushAnchor,\n    reload,\n    setBlockMessage,\n    getBlockMessage,\n    unblock,\n    ...historyOverridden({\n      ...browserHistory,\n      push,\n      replace\n    })\n  };\n}\n\n/**\n * Override history for standalone micro apps.\n *\n * when `push` or `replace` to other apps, force page refresh.\n */\nfunction historyOverridden(browserHistory) {\n  const {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function updateFactory(method) {\n    return function update(path, state, callback) {\n      let pathname;\n      const pathIsString = typeof path === \"string\";\n      if (pathIsString) {\n        pathname = parsePath(path).pathname;\n      } else {\n        pathname = path.pathname;\n      }\n\n      // When history.push or history.replace is performing with an absolute pathname,\n      // force load the target page when it is a page of an outside app.\n      if (typeof pathname === \"string\" && pathname.startsWith(\"/\") && isOutsideApp(_internalApiMatchStoryboard(pathname))) {\n        // Going to outside apps.\n        return location[method === \"push\" ? \"assign\" : \"replace\"](pathIsString ? getBasePath() + path.substring(1) : browserHistory.createHref(path));\n      }\n      return (method === \"push\" ? originalPush : originalReplace)(path, state, callback);\n    };\n  }\n  return {\n    push: updateFactory(\"push\"),\n    replace: updateFactory(\"replace\")\n  };\n}\n\n/**\n * 扩展的系统会话对象。\n */\n\n/**\n * 更新指定的 query 参数。\n *\n * @param query - 要更新的 query 参数。\n * @param options - 选项。\n */\n\n/** 更新 query 参数时的选项 */\n\n/**\n * 设置指定的 anchor （URL hash）地址，此方法默认不会触发页面重新渲染。\n * 往浏览器会话历史栈中推入一条新记录。\n *\n * @param hash - Hash 地址。\n * @param state - 会话状态设置。\n */\n//# sourceMappingURL=historyExtended.js.map","import { createBrowserHistory } from \"history\";\nimport { getBasePath } from \"./getBasePath.js\";\nimport { getUserConfirmation, historyExtended } from \"./internal/historyExtended.js\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\nlet history;\nexport function createHistory() {\n  if (!history) {\n    // https://github.com/remix-run/history/issues/810\n    const browserHistory = createBrowserHistory({\n      basename: getBasePath().replace(/\\/$/, \"\"),\n      getUserConfirmation\n    });\n    Object.assign(browserHistory, historyExtended(browserHistory));\n    history = browserHistory;\n  }\n  return history;\n}\nfunction getHistoryV3() {\n  return history;\n}\n\n/**\n * When using v3 bricks in v2 container, return history from v2 container.\n */\nfunction getHistoryV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return v2Kit.getHistory;\n  }\n}\nexport const getHistory = getHistoryV2Factory() || getHistoryV3;\n//# sourceMappingURL=history.js.map","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet2\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport { i18n, initializeI18n } from \"@next-core/i18n\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { deepFreeze, isObject } from \"@next-core/utils/general\";\nimport moment from \"moment\";\nimport \"moment/locale/zh-cn.js\";\nimport { createHistory } from \"../history.js\";\nimport { matchStoryboard } from \"./matchStoryboard.js\";\nimport { Router } from \"./Router.js\";\nimport { NS, locales } from \"./i18n.js\";\nimport { loadNotificationService } from \"../Notification.js\";\nimport { loadDialogService } from \"../Dialog.js\";\nimport { injectedBrickPackages } from \"./injected.js\";\nimport { hasInstalledApp } from \"./hasInstalledApp.js\";\nimport { listenDevtoolsEagerly } from \"./devtools.js\";\nimport { getV2RuntimeFromDll } from \"../getV2RuntimeFromDll.js\";\nimport { customizeColorTheme } from \"./customizeColorTheme.js\";\nlet runtime;\n\n// Allow inject bootstrap data in a runtime other than Brick Next.\nlet bootstrapData;\nlet router;\nlet processedBrickPackages;\nexport let hooks;\nexport function createRuntime(options) {\n  if (runtime) {\n    throw new Error(\"Cannot create multiple runtimes\");\n  }\n  listenDevtoolsEagerly();\n  hooks = options === null || options === void 0 ? void 0 : options.hooks;\n  initializeI18n(NS, locales);\n  moment.locale(i18n.language);\n  i18n.on(\"languageChanged\", () => {\n    moment.locale(i18n.language);\n  });\n  createHistory();\n  runtime = new Runtime();\n  return runtime;\n}\nfunction getRuntimeV3() {\n  return runtime;\n}\n\n// istanbul ignore next\nfunction getRuntimeV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function getRuntimeV2() {\n      return new Proxy(v2Kit.getRuntime(), {\n        get() {\n          const key = arguments.length <= 1 ? undefined : arguments[1];\n          switch (key) {\n            case \"getCurrentApp\":\n            case \"getRecentApps\":\n            case \"hasInstalledApp\":\n            case \"getDesktops\":\n            case \"getLaunchpadSettings\":\n            case \"getLaunchpadSiteMap\":\n            case \"toggleLaunchpadEffect\":\n            case \"applyPageTitle\":\n            case \"getNavConfig\":\n            case \"getFeatureFlags\":\n            case \"getMiscSettings\":\n            case \"getBrandSettings\":\n              return Reflect.get(...arguments);\n          }\n        }\n      });\n    };\n  }\n}\n\n// istanbul ignore next\nexport const getRuntime = getRuntimeV2Factory() || getRuntimeV3;\nvar _initialized = /*#__PURE__*/new WeakMap();\nvar _bootstrapped = /*#__PURE__*/new WeakMap();\nexport class Runtime {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _initialized, false);\n    _classPrivateFieldInitSpec(this, _bootstrapped, false);\n    _defineProperty(this, \"version\", 3);\n  }\n  initialize(data) {\n    var _data$settings;\n    if (_classPrivateFieldGet(_initialized, this)) {\n      throw new Error(\"The runtime cannot be initialized more than once\");\n    }\n    _classPrivateFieldSet(_initialized, this, true);\n    normalizeBootstrapData(data);\n    bootstrapData = data;\n    const {\n      notification,\n      dialog\n    } = _internalApiGetPresetBricks();\n    if (notification !== false) {\n      loadNotificationService(notification ?? \"basic.show-notification\", this.loadBricks);\n    }\n    if (dialog !== false) {\n      loadDialogService(dialog ?? \"basic.show-dialog\", this.loadBricks);\n    }\n    customizeColorTheme((_data$settings = data.settings) === null || _data$settings === void 0 || (_data$settings = _data$settings.misc) === null || _data$settings === void 0 ? void 0 : _data$settings.theme);\n  }\n  async bootstrap(data) {\n    if (data) {\n      this.initialize(data);\n    }\n    if (_classPrivateFieldGet(_bootstrapped, this)) {\n      throw new Error(\"The runtime cannot be bootstrapped more than once\");\n    }\n    _classPrivateFieldSet(_bootstrapped, this, true);\n    router = new Router(bootstrapData.storyboards);\n    await router.bootstrap();\n  }\n  getRecentApps() {\n    var _router;\n    return ((_router = router) === null || _router === void 0 ? void 0 : _router.getRecentApps()) ?? {};\n  }\n  getCurrentApp() {\n    var _router2;\n    return (_router2 = router) === null || _router2 === void 0 ? void 0 : _router2.getRecentApps().currentApp;\n  }\n  hasInstalledApp(appId, matchVersion) {\n    return hasInstalledApp(appId, matchVersion);\n  }\n  getFeatureFlags() {\n    var _bootstrapData, _router3;\n    return {\n      ...((_bootstrapData = bootstrapData) === null || _bootstrapData === void 0 || (_bootstrapData = _bootstrapData.settings) === null || _bootstrapData === void 0 ? void 0 : _bootstrapData.featureFlags),\n      ...((_router3 = router) === null || _router3 === void 0 || (_router3 = _router3.getRecentApps().currentApp) === null || _router3 === void 0 || (_router3 = _router3.config) === null || _router3 === void 0 || (_router3 = _router3.settings) === null || _router3 === void 0 ? void 0 : _router3.featureFlags),\n      \"migrate-to-brick-next-v3\": true\n    };\n  }\n  getMiscSettings() {\n    var _bootstrapData2, _router4;\n    return {\n      ...((_bootstrapData2 = bootstrapData) === null || _bootstrapData2 === void 0 || (_bootstrapData2 = _bootstrapData2.settings) === null || _bootstrapData2 === void 0 ? void 0 : _bootstrapData2.misc),\n      ...((_router4 = router) === null || _router4 === void 0 || (_router4 = _router4.getRecentApps().currentApp) === null || _router4 === void 0 || (_router4 = _router4.config) === null || _router4 === void 0 || (_router4 = _router4.settings) === null || _router4 === void 0 ? void 0 : _router4.misc)\n    };\n  }\n  getBrandSettings() {\n    var _bootstrapData3;\n    return {\n      base_title: \"DevOps 管理专家\",\n      ...((_bootstrapData3 = bootstrapData) === null || _bootstrapData3 === void 0 || (_bootstrapData3 = _bootstrapData3.settings) === null || _bootstrapData3 === void 0 ? void 0 : _bootstrapData3.brand)\n    };\n  }\n  getLaunchpadSettings() {\n    var _bootstrapData4;\n    return {\n      columns: 7,\n      rows: 4,\n      ...((_bootstrapData4 = bootstrapData) === null || _bootstrapData4 === void 0 || (_bootstrapData4 = _bootstrapData4.settings) === null || _bootstrapData4 === void 0 ? void 0 : _bootstrapData4.launchpad)\n    };\n  }\n  getDesktops() {\n    var _bootstrapData5;\n    return ((_bootstrapData5 = bootstrapData) === null || _bootstrapData5 === void 0 ? void 0 : _bootstrapData5.desktops) ?? [];\n  }\n  getLaunchpadSiteMap() {\n    var _bootstrapData6;\n    return ((_bootstrapData6 = bootstrapData) === null || _bootstrapData6 === void 0 ? void 0 : _bootstrapData6.siteSort) ?? [];\n  }\n  toggleLaunchpadEffect(open) {\n    document.body.classList.toggle(\"launchpad-open\", open);\n  }\n  applyPageTitle(pageTitle) {\n    var _router5;\n    const baseTitle = this.getBrandSettings().base_title;\n    document.title = ((_router5 = router) === null || _router5 === void 0 || (_router5 = _router5.getRecentApps().currentApp) === null || _router5 === void 0 ? void 0 : _router5.localeTitle) || (pageTitle ? `${pageTitle} - ${baseTitle}` : baseTitle);\n  }\n  getNavConfig() {\n    var _router6;\n    return (_router6 = router) === null || _router6 === void 0 ? void 0 : _router6.getNavConfig();\n  }\n  loadBricks(bricks) {\n    return loadBricksImperatively(bricks, getBrickPackages());\n  }\n}\nfunction normalizeBootstrapData(data) {\n  if (isObject(data.settings)) {\n    deepFreeze(data.settings);\n  }\n  if (data.brickPackages) {\n    deepFreeze(data.brickPackages);\n  }\n}\nfunction processPublicDepsPackages(brickPackages, pubDeps) {\n  if (!(pubDeps !== null && pubDeps !== void 0 && pubDeps.length)) return brickPackages;\n  const bricksMap = new Map();\n\n  // bootstrapData 数据和 pubDeps 中可能同时存在同一个包名，需要过滤去重， 以 pubDeps 中的包为准\n  [...pubDeps, ...brickPackages].forEach(pkg => {\n    const pkgName = pkg.filePath.split(\"/\")[1];\n    // 始终将 pubDeps 放在前面\n    if (!bricksMap.has(pkgName)) {\n      bricksMap.set(pkgName, pkg);\n    }\n  });\n  return Array.from(bricksMap.values());\n}\nexport function getBrickPackages() {\n  var _bootstrapData7;\n  return (\n    // Not necessary to process brick packages multiple times.\n    processedBrickPackages ?? (processedBrickPackages = processPublicDepsPackages(((_bootstrapData7 = bootstrapData) === null || _bootstrapData7 === void 0 ? void 0 : _bootstrapData7.brickPackages) ?? injectedBrickPackages ?? window.STANDALONE_BRICK_PACKAGES ?? [], window.PUBLIC_DEPS))\n  );\n}\nexport function _internalApiGetPresetBricks() {\n  var _bootstrapData8;\n  return ((_bootstrapData8 = bootstrapData) === null || _bootstrapData8 === void 0 || (_bootstrapData8 = _bootstrapData8.settings) === null || _bootstrapData8 === void 0 ? void 0 : _bootstrapData8.presetBricks) ?? {};\n}\nexport function _internalApiGetRenderId() {\n  var _router7;\n  return (_router7 = router) === null || _router7 === void 0 ? void 0 : _router7.getRenderId();\n}\nexport function _internalApiMatchStoryboard(pathname) {\n  var _bootstrapData9;\n  return matchStoryboard(((_bootstrapData9 = bootstrapData) === null || _bootstrapData9 === void 0 ? void 0 : _bootstrapData9.storyboards) ?? [], pathname);\n}\nexport function _internalApiGetRuntimeContext() {\n  var _router8;\n  return (_router8 = router) === null || _router8 === void 0 ? void 0 : _router8.getRuntimeContext();\n}\nexport function _internalApiGetStoryboardInBootstrapData(appId) {\n  var _bootstrapData10;\n  return (_bootstrapData10 = bootstrapData) === null || _bootstrapData10 === void 0 || (_bootstrapData10 = _bootstrapData10.storyboards) === null || _bootstrapData10 === void 0 ? void 0 : _bootstrapData10.find(storyboard => storyboard.app.id === appId);\n}\nexport function _internalApiGetAppInBootstrapData(appId) {\n  var _internalApiGetStoryb;\n  return (_internalApiGetStoryb = _internalApiGetStoryboardInBootstrapData(appId)) === null || _internalApiGetStoryb === void 0 ? void 0 : _internalApiGetStoryb.app;\n}\nexport let _test_only_setBootstrapData;\n\n// istanbul ignore next\nif (process.env.NODE_ENV === \"test\") {\n  _test_only_setBootstrapData = data => {\n    bootstrapData = data;\n  };\n}\n//# sourceMappingURL=Runtime.js.map","export function getV2RuntimeFromDll() {\n  var _window$BRICK_NEXT_VE;\n  const {\n    dll\n  } = window;\n  if (dll && (_window$BRICK_NEXT_VE = window.BRICK_NEXT_VERSIONS) !== null && _window$BRICK_NEXT_VE !== void 0 && (_window$BRICK_NEXT_VE = _window$BRICK_NEXT_VE[\"brick-container\"]) !== null && _window$BRICK_NEXT_VE !== void 0 && _window$BRICK_NEXT_VE.startsWith(\"2.\")) {\n    return dll(\"tYg3\");\n  }\n}\n//# sourceMappingURL=getV2RuntimeFromDll.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomProcessorRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, new Map());\n  }\n  define(processorFullName, processorFunc) {\n    // `namespace` should be the camelCase of the package name.\n    const [namespace, processorName] = processorFullName.split(\".\");\n    let pkg = _classPrivateFieldGet(_registry, this).get(namespace);\n    if (!pkg) {\n      pkg = new Map();\n      _classPrivateFieldGet(_registry, this).set(namespace, pkg);\n    }\n    if (pkg.has(processorName)) {\n      // eslint-disable-next-line no-console\n      throw new Error(`Custom processor of \"${processorFullName}\" already registered`);\n    }\n    pkg.set(processorName, processorFunc);\n  }\n  get(namespace) {\n    return _classPrivateFieldGet(_registry, this).get(namespace);\n  }\n}\n\n// istanbul ignore next\nfunction getCustomProcessorsV2() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return Object.freeze({\n      define(processorFullName, processorFunc) {\n        return v2Kit.getRuntime().registerCustomProcessor(processorFullName, processorFunc);\n      }\n    });\n  }\n}\n\n// istanbul ignore next\nexport const customProcessors = getCustomProcessorsV2() || new CustomProcessorRegistry();\n//# sourceMappingURL=CustomProcessors.js.map","import { i18n } from \"@next-core/i18n\";\nexport function registerAppI18n(_ref) {\n  let {\n    app,\n    meta\n  } = _ref;\n  if (meta !== null && meta !== void 0 && meta.i18n) {\n    // Prefix to avoid conflict between brick package's i18n namespace.\n    const i18nNamespace = getI18nNamespace(\"app\", app.id);\n    // Support any language in `meta.i18n`.\n    const languages = [];\n    Object.entries(meta.i18n).forEach(_ref2 => {\n      let [lang, resources] = _ref2;\n      i18n.addResourceBundle(lang, i18nNamespace, resources);\n      languages.push(lang);\n    });\n    return () => {\n      for (const lang of languages) {\n        i18n.removeResourceBundle(lang, i18nNamespace);\n      }\n    };\n  }\n}\nexport function getI18nNamespace(type, id) {\n  return `${type}/${id}`;\n}\n//# sourceMappingURL=registerAppI18n.js.map","import { i18n } from \"@next-core/i18n\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\nfunction registerWidgetI18nV3(widgetId, i18nData) {\n  const ns = getI18nNamespace(\"widget\", widgetId);\n  Object.entries(i18nData).forEach(_ref => {\n    let [lang, resources] = _ref;\n    i18n.addResourceBundle(lang, ns, resources);\n  });\n}\nexport function widgetI18nFactory(widgetId) {\n  return i18n.getFixedT(null, getI18nNamespace(\"widget\", widgetId));\n}\n\n// istanbul ignore next\nfunction registerWidgetI18nV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function (widgetId, i18nData) {\n      return v2Kit.getRuntime().registerWidgetI18n(widgetId, i18nData);\n    };\n  }\n}\n\n// istanbul ignore next\nexport const registerWidgetI18n = registerWidgetI18nV2Factory() || registerWidgetI18nV3;\n//# sourceMappingURL=WidgetI18n.js.map","export const MESSAGE_SOURCE_PANEL = \"brick-next-devtools-panel\";\nexport const FRAME_ACTIVE_CHANGE = \"devtools-frame-active-change\";\nexport const PANEL_CHANGE = \"devtools-panel-change\";\nlet frameIsActive = true;\nlet selectedPanel;\nexport function devtoolsHookEmit(type, payload) {\n  const devtools = getDevHook();\n  if (!devtools || type === \"evaluation\" && !(frameIsActive && (!selectedPanel || selectedPanel === \"Evaluations\"))) {\n    // Ignore messages if current devtools panel is not relevant.\n    return;\n  }\n  const emit = () => {\n    var _devtools$emit;\n    (_devtools$emit = devtools.emit) === null || _devtools$emit === void 0 || _devtools$emit.call(devtools, {\n      type,\n      payload\n    });\n  };\n\n  // Try to emit only in idle time.\n  // istanbul ignore next\n  if (typeof window.requestIdleCallback === \"function\") {\n    window.requestIdleCallback(emit);\n  } else {\n    setTimeout(emit, 0);\n  }\n}\nexport function listenDevtoolsEagerly() {\n  window.addEventListener(\"message\", _ref => {\n    let {\n      data\n    } = _ref;\n    if ((data === null || data === void 0 ? void 0 : data.source) !== MESSAGE_SOURCE_PANEL) {\n      return;\n    }\n    const payload = data.payload;\n    switch (payload === null || payload === void 0 ? void 0 : payload.type) {\n      case FRAME_ACTIVE_CHANGE:\n        {\n          frameIsActive = payload.active;\n          break;\n        }\n      case PANEL_CHANGE:\n        {\n          selectedPanel = payload.panel;\n          break;\n        }\n    }\n  });\n}\nexport function getDevHook() {\n  return window.__BRICK_NEXT_DEVTOOLS_HOOK__;\n}\n//# sourceMappingURL=devtools.js.map","import { getDevHook } from \"./devtools.js\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst THROW = () => {\n  throw new Error(\"Can't modify read-only proxy object\");\n};\nconst readOnlyHandler = {\n  set: THROW,\n  defineProperty: THROW,\n  deleteProperty: THROW,\n  setPrototypeOf: THROW\n};\nexport function getReadOnlyProxy(object) {\n  return new Proxy(object, readOnlyHandler);\n}\n\n// First, we want to make accessing property of globals lazy,\n// So we use *Proxy* to make a dynamic accessor for each of these globals.\n// But we also want to keep them working in devtools.\nexport function getDynamicReadOnlyProxy(_ref) {\n  let {\n    get,\n    ownKeys\n  } = _ref;\n  if (getDevHook()) {\n    // In devtools, we extract them at beginning.\n    const target = Object.fromEntries(ownKeys(null).map(key => [key, get(null, key, null)]));\n    return getReadOnlyProxy(target);\n  }\n  return new Proxy(Object.freeze({}), {\n    get\n  });\n}\n//# sourceMappingURL=proxyFactories.js.map","import { JsonStorage } from \"@next-core/utils/general\";\n// Themes.\nlet theme = \"light\";\nconst storage = new JsonStorage(localStorage);\nconst LOCAL_STORAGE_APPS_THEME_KEY = \"apps-theme\";\nexport function setTheme(value) {\n  if (value !== \"dark\" && value !== \"light\" && value !== \"dark-v2\") {\n    throw new Error(`Unsupported theme: ${value}`);\n  }\n  theme = value;\n}\nexport function getTheme() {\n  return theme;\n}\nexport function getCurrentTheme() {\n  return document.documentElement.dataset.theme;\n}\nexport function applyTheme(value) {\n  if (value) {\n    setTheme(value);\n  } else {\n    value = getTheme();\n  }\n  if (value !== getCurrentTheme()) {\n    document.documentElement.dataset.theme = value;\n    window.dispatchEvent(new CustomEvent(\"theme.change\", {\n      detail: value\n    }));\n  }\n}\nexport function batchSetAppsLocalTheme(appsTheme) {\n  storage.setItem(LOCAL_STORAGE_APPS_THEME_KEY, {\n    ...getLocalAppsTheme(),\n    ...appsTheme\n  });\n}\nexport function getLocalAppsTheme() {\n  let result;\n  try {\n    result = storage.getItem(LOCAL_STORAGE_APPS_THEME_KEY);\n  } catch {\n    // eslint-disable-next-line no-console\n    console.error(\"JSON parse error inside `getLocalAppsTheme()`\");\n  }\n  return result ?? {};\n}\n\n// Modes.\nlet mode = \"default\";\nexport function setMode(value) {\n  if (value !== \"dashboard\" && value !== \"default\") {\n    throw new Error(`Unsupported mode: ${value}`);\n  }\n  mode = value;\n}\nexport function getMode() {\n  return mode;\n}\nexport function getCurrentMode() {\n  return document.documentElement.dataset.mode;\n}\nexport function applyMode(value) {\n  if (value) {\n    setMode(value);\n  } else {\n    value = getMode();\n  }\n  if (value !== getCurrentMode()) {\n    document.documentElement.dataset.mode = value;\n    window.dispatchEvent(new CustomEvent(\"mode.change\", {\n      detail: value\n    }));\n  }\n}\nexport function getCssPropertyValue(name) {\n  var _window$getComputedSt;\n  let el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.documentElement;\n  if (!el) return \"\";\n  return ((_window$getComputedSt = window.getComputedStyle(el)) === null || _window$getComputedSt === void 0 ? void 0 : _window$getComputedSt.getPropertyValue(name)) || \"\";\n}\n//# sourceMappingURL=themeAndMode.js.map","import { identity } from \"lodash\";\nimport { i18n, i18nText } from \"@next-core/i18n\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getCssPropertyValue, getTheme } from \"../../themeAndMode.js\";\nimport { getBasePath } from \"../../getBasePath.js\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { hooks } from \"../Runtime.js\";\n// `GeneralGlobals` are globals which are page-state-agnostic,\n// thus they can be used both in storyboard expressions and functions.\nexport function getGeneralGlobals(attemptToVisitGlobals, options) {\n  const globalVariables = {};\n  for (const variableName of attemptToVisitGlobals) {\n    const variable = getIndividualGlobal(variableName, options);\n    if (variable !== undefined) {\n      globalVariables[variableName] = variable;\n    }\n  }\n  return globalVariables;\n}\nfunction getIndividualGlobal(variableName, _ref) {\n  var _hooks$images, _hooks$images2, _hooks$checkPermissio;\n  let {\n    collectCoverage,\n    widgetId,\n    widgetVersion,\n    app,\n    appendI18nNamespace,\n    storyboardFunctions,\n    isStoryboardFunction\n  } = _ref;\n  switch (variableName) {\n    case \"BASE_URL\":\n      return collectCoverage ? \"/next\" : getBasePath().replace(/\\/$/, \"\");\n    case \"FN\":\n      return storyboardFunctions;\n    case \"IMG\":\n      return collectCoverage ? fakeImageFactory() : widgetId ? hooks === null || hooks === void 0 || (_hooks$images = hooks.images) === null || _hooks$images === void 0 ? void 0 : _hooks$images.widgetImagesFactory(widgetId, widgetVersion) : hooks === null || hooks === void 0 || (_hooks$images2 = hooks.images) === null || _hooks$images2 === void 0 ? void 0 : _hooks$images2.imagesFactory(app.id, app.isBuildPush, app.currentVersion);\n    case \"I18N\":\n      return collectCoverage ? identity : widgetId ? widgetI18nFactory(widgetId) : i18n.getFixedT(null, [appendI18nNamespace, getI18nNamespace(\"app\", app.id)].filter(Boolean));\n    case \"I18N_TEXT\":\n      return collectCoverage ? fakeI18nText : i18nText;\n    case \"PERMISSIONS\":\n      return getReadOnlyProxy({\n        check: collectCoverage ? fakeCheckPermissions : hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.checkPermissions\n      });\n    case \"THEME\":\n      return getReadOnlyProxy({\n        getTheme: collectCoverage ? () => \"light\" : getTheme,\n        getCssPropertyValue: collectCoverage ? () => \"\" : getCssPropertyValue\n      });\n    case \"console\":\n      return isStoryboardFunction ? getReadOnlyProxy(console) : undefined;\n    case \"location\":\n      return collectCoverage ? {\n        href: \"http://localhost:3000/functions/test\",\n        origin: \"http://localhost:3000\",\n        host: \"localhost:3000\",\n        hostname: \"localhost\"\n      } : {\n        href: location.href,\n        origin: location.origin,\n        host: location.host,\n        hostname: location.hostname\n      };\n  }\n}\nfunction fakeI18nText(data) {\n  return data === null || data === void 0 ? void 0 : data.en;\n}\nfunction fakeImageFactory() {\n  return {\n    get(name) {\n      return `mock/images/${name}`;\n    }\n  };\n}\nfunction fakeCheckPermissions() {\n  return true;\n}\n//# sourceMappingURL=getGeneralGlobals.js.map","import { cook, precookFunction, __dev_only_clearGlobalExecutionContextStack, __dev_only_getGlobalExecutionContextStack } from \"@next-core/cook\";\nimport { supply } from \"@next-core/supply\";\nimport { collectMemberUsageInFunction } from \"@next-core/utils/storyboard\";\nimport { getGeneralGlobals } from \"./internal/compute/getGeneralGlobals.js\";\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\nexport function StoryboardFunctionRegistryFactory() {\n  let {\n    widgetId,\n    widgetVersion,\n    collectCoverage,\n    debuggerOverrides\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const registeredFunctions = new Map();\n  const overrides = debuggerOverrides === null || debuggerOverrides === void 0 ? void 0 : debuggerOverrides({\n    precookFunction,\n    cook,\n    supply\n  });\n\n  // Use `Proxy` with a frozen target, to make a readonly function registry.\n  const storyboardFunctions = new Proxy(Object.freeze({}), {\n    get(_target, key) {\n      return getStoryboardFunction(key);\n    }\n  });\n  let currentApp;\n  function registerStoryboardFunctions(functions, app) {\n    if (app) {\n      currentApp = app;\n    }\n    registeredFunctions.clear();\n    if (Array.isArray(functions)) {\n      for (const fn of functions) {\n        let deps = fn.deps;\n        if (deps == null) {\n          deps = collectMemberUsageInFunction(fn, \"FN\", !!collectCoverage);\n          deps.delete(fn.name);\n        }\n        const hasPermissionsCheck = fn.perm ?? collectMemberUsageInFunction(fn, \"PERMISSIONS\", !!collectCoverage).has(\"check\");\n        registeredFunctions.set(fn.name, {\n          source: fn.source,\n          typescript: fn.typescript,\n          deps,\n          hasPermissionsCheck\n        });\n      }\n    }\n  }\n  function getStoryboardFunction(name) {\n    const fn = registeredFunctions.get(name);\n    if (!fn) {\n      return undefined;\n    }\n    if (fn.processed) {\n      return fn.cooked;\n    }\n    let collector;\n    if (collectCoverage) {\n      collector = collectCoverage.createCollector(name);\n    }\n    const precooked = precookFunction(fn.source, {\n      typescript: fn.typescript,\n      hooks: collector && {\n        beforeVisit: collector.beforeVisit\n      },\n      cacheKey: fn\n    });\n    const globalVariables = supply(precooked.attemptToVisitGlobals, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n      collectCoverage,\n      widgetId,\n      widgetVersion,\n      app: currentApp,\n      storyboardFunctions,\n      isStoryboardFunction: true\n    }), !!collectCoverage);\n    fn.cooked = cook(precooked.function, fn.source, {\n      rules: {\n        noVar: true\n      },\n      globalVariables: overrides ? {\n        ...globalVariables,\n        ...(overrides !== null && overrides !== void 0 && overrides.LodashWithStaticFields && precooked.attemptToVisitGlobals.has(\"_\") ? {\n          _: {\n            ...globalVariables._,\n            ...overrides.LodashWithStaticFields\n          }\n        } : null),\n        ...(overrides !== null && overrides !== void 0 && overrides.ArrayConstructor && precooked.attemptToVisitGlobals.has(\"Array\") ? {\n          Array: overrides.ArrayConstructor\n        } : null),\n        ...(overrides !== null && overrides !== void 0 && overrides.ObjectWithStaticFields && precooked.attemptToVisitGlobals.has(\"Object\") ? {\n          Object: {\n            ...globalVariables.Object,\n            ...overrides.ObjectWithStaticFields\n          }\n        } : null)\n      } : globalVariables,\n      ArrayConstructor: overrides === null || overrides === void 0 ? void 0 : overrides.ArrayConstructor,\n      hooks: collector && {\n        beforeEvaluate: collector.beforeEvaluate,\n        beforeCall: collector.beforeCall,\n        beforeBranch: collector.beforeBranch\n      },\n      debug: !!debuggerOverrides\n    });\n    fn.processed = true;\n    return fn.cooked;\n  }\n  return {\n    storyboardFunctions,\n    registerStoryboardFunctions,\n    updateStoryboardFunction(name, data) {\n      const newFn = {\n        ...data,\n        name\n      };\n      const deps = collectMemberUsageInFunction(newFn, \"FN\", true);\n      const hasPermissionsCheck = collectMemberUsageInFunction(newFn, \"PERMISSIONS\", true).has(\"check\");\n      registeredFunctions.set(name, {\n        source: data.source,\n        typescript: data.typescript,\n        deps,\n        hasPermissionsCheck\n      });\n    },\n    /**\n     * Check whether listed functions attempt to call `PERMISSIONS.check()`,\n     * includes in nested `FN.*()` calls.\n     */\n    checkPermissionsUsage(functionNames) {\n      const checkedFunctions = new Set();\n      const hasPermissionsCheck = name => {\n        if (!checkedFunctions.has(name)) {\n          checkedFunctions.add(name);\n          const fn = registeredFunctions.get(name);\n          return !!fn && (fn.hasPermissionsCheck || [...fn.deps].some(hasPermissionsCheck));\n        }\n        return false;\n      };\n      return functionNames.some(hasPermissionsCheck);\n    },\n    clearGlobalExecutionContextStack() {\n      __dev_only_clearGlobalExecutionContextStack();\n    },\n    getGlobalExecutionContextStack() {\n      return __dev_only_getGlobalExecutionContextStack();\n    }\n  };\n}\n//# sourceMappingURL=StoryboardFunctionRegistry.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nexport const {\n  storyboardFunctions,\n  registerStoryboardFunctions,\n  checkPermissionsUsage\n} = StoryboardFunctionRegistryFactory();\n//# sourceMappingURL=StoryboardFunctions.js.map","/*! (c) Andrea Giammarchi - ISC */\nvar self = {};\ntry {\n  self.EventTarget = (new EventTarget).constructor;\n} catch(EventTarget) {\n  (function (Object, wm) {\n    var create = Object.create;\n    var defineProperty = Object.defineProperty;\n    var proto = EventTarget.prototype;\n    define(proto, 'addEventListener', function (type, listener, options) {\n      for (var\n        secret = wm.get(this),\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener)\n          return;\n      }\n      listeners.push({target: this, listener: listener, options: options});\n    });\n    define(proto, 'dispatchEvent', function (event) {\n      var secret = wm.get(this);\n      var listeners = secret[event.type];\n      if (listeners) {\n        define(event, 'target', this);\n        define(event, 'currentTarget', this);\n        listeners.slice(0).some(dispatch, event);\n        delete event.currentTarget;\n        delete event.target;\n      }\n      return true;\n    });\n    define(proto, 'removeEventListener', function (type, listener) {\n      for (var\n        secret = wm.get(this),\n        /* istanbul ignore next */\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener) {\n          listeners.splice(i, 1);\n          return;\n        }\n      }\n    });\n    self.EventTarget = EventTarget;\n    function EventTarget() {'use strict';\n      wm.set(this, create(null));\n    }\n    function define(target, name, value) {\n      defineProperty(\n        target,\n        name,\n        {\n          configurable: true,\n          writable: true,\n          value: value\n        }\n      );\n    }\n    function dispatch(info) {\n      var options = info.options;\n      if (options && options.once)\n        info.target.removeEventListener(this.type, info.listener);\n      if (typeof info.listener === 'function')\n        info.listener.call(info.target, this);\n      else\n        info.listener.handleEvent(this);\n      return this._stopImmediatePropagationFlag;\n    }\n  }(Object, new WeakMap));\n}\nexport default self.EventTarget;\n","import EventTarget from \"@ungap/event-target\";\nexport let MediaBreakpoint = /*#__PURE__*/function (MediaBreakpoint) {\n  MediaBreakpoint[\"xLarge\"] = \"xLarge\";\n  MediaBreakpoint[\"large\"] = \"large\";\n  MediaBreakpoint[\"medium\"] = \"medium\";\n  MediaBreakpoint[\"small\"] = \"small\";\n  MediaBreakpoint[\"xSmall\"] = \"xSmall\";\n  return MediaBreakpoint;\n}({});\nexport const mediaBreakpointMinWidthMap = new Map([[MediaBreakpoint.xLarge, \"1920px\"], [MediaBreakpoint.large, \"1600px\"], [MediaBreakpoint.medium, \"1280px\"], [MediaBreakpoint.small, \"1024px\"], [MediaBreakpoint.xSmall, 0]]);\nexport const mediaEventTarget = new EventTarget();\nconst breakpointMatchesMap = {};\nconst MEDIA = {};\nfunction handleMatchesChange(data, breakpoint) {\n  let changed = false;\n  breakpointMatchesMap[breakpoint] = data.matches;\n  for (const [breakpoint] of mediaBreakpointMinWidthMap) {\n    if (breakpointMatchesMap[breakpoint] && MEDIA.breakpoint !== breakpoint) {\n      MEDIA.breakpoint = breakpoint;\n      changed = true;\n      break;\n    }\n  }\n  if (changed) {\n    mediaEventTarget.dispatchEvent(new CustomEvent(\"change\", {\n      detail: MEDIA\n    }));\n  }\n}\nmediaBreakpointMinWidthMap.forEach((minWidth, breakpoint) => {\n  const mediaQueryList = window.matchMedia(`(min-width: ${minWidth})`);\n  handleMatchesChange(mediaQueryList, breakpoint);\n  if (mediaQueryList.addEventListener) {\n    mediaQueryList.addEventListener(\"change\", event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  } else {\n    mediaQueryList.addListener(event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  }\n});\nexport const getMedia = () => MEDIA;\n//# sourceMappingURL=mediaQuery.js.map","export function getStorageItem(storageType) {\n  return function (name) {\n    const storage = storageType === \"local\" ? localStorage : sessionStorage;\n    return JSON.parse(storage.getItem(name) ?? \"null\");\n  };\n}\n//# sourceMappingURL=getStorageItem.js.map","import { getRuntime } from \"./index.js\";\nexport function isStrictMode(runtimeContext) {\n  var _ref, _getRuntime;\n  return !!((_ref = runtimeContext ? runtimeContext.flags : (_getRuntime = getRuntime()) === null || _getRuntime === void 0 ? void 0 : _getRuntime.getFeatureFlags()) !== null && _ref !== void 0 && _ref[\"brick-next-v3-strict-mode\"]);\n}\nexport function warnAboutStrictMode(strict, message) {\n  for (var _len = arguments.length, extraLogs = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    extraLogs[_key - 2] = arguments[_key];\n  }\n  const punctuation = extraLogs.length === 0 ? \"\" : \",\";\n  if (strict) {\n    // eslint-disable-next-line no-console\n    console.error(`${message} is dropped in v3 strict mode${punctuation}`, ...extraLogs);\n  } else {\n    // eslint-disable-next-line no-console\n    console.warn(`${message} is deprecated in v3 and will be dropped in strict mode${punctuation}`, ...extraLogs);\n  }\n}\n//# sourceMappingURL=isStrictMode.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport { uniq } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"./isStrictMode.js\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\n\n// Note: `prefix` is a native prop on Element, but it's only used in XML documents.\nconst allowedNativeProps = new Set([\"prefix\"]);\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomTemplateRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, new Map());\n  }\n  define(tagName, constructor) {\n    var _constructor$proxy, _compatibleConstructo;\n    let registered = _classPrivateFieldGet(_registry, this).has(tagName);\n    if (registered) {\n      // When open launchpad, the storyboard will be updated.\n      // However, we can't *undefine* a custom element.\n      // Just ignore re-registering custom templates.\n      // eslint-disable-next-line no-console\n      console.warn(`Custom template of \"${tagName}\" already registered.`);\n    } else {\n      registered = !!customElements.get(tagName);\n      if (registered) {\n        // eslint-disable-next-line no-console\n        console.warn(`Custom template of \"${tagName}\" already defined by customElements.`);\n      }\n    }\n\n    // Transform legacy `proxy.properties[].asVariable` as states.\n    const strict = isStrictMode();\n    const proxyProperties = ((_constructor$proxy = constructor.proxy) === null || _constructor$proxy === void 0 ? void 0 : _constructor$proxy.properties) ?? {};\n    const validProxyProps = [];\n    const legacyTplVariables = [];\n    for (const [key, value] of Object.entries(proxyProperties)) {\n      if (value.asVariable) {\n        warnAboutStrictMode(strict, \"Template `asVariable`\", tagName, key);\n        // istanbul ignore next\n        if (!strict) {\n          // For existed TPL usage, treat it as a STATE.\n          legacyTplVariables.push(key);\n        }\n      } else if (value.mergeProperty || value.refTransform) {\n        // eslint-disable-next-line no-console\n        console.error(\"Template `mergeProperty` and `refTransform` are dropped in v3:\", tagName, key);\n      } else if (value.ref) {\n        validProxyProps.push([key, value]);\n      }\n      // Else: documentation only, for exposed states.\n    }\n    const compatibleConstructor = {\n      ...constructor,\n      proxy: {\n        ...constructor.proxy,\n        properties: Object.fromEntries(validProxyProps)\n      },\n      state: (constructor.state ? strict ? constructor.state : constructor.state.map(item => ({\n        // Make `expose` defaults to true in non-strict mode.\n        expose: true,\n        ...item\n      })) : []).concat(legacyTplVariables.map(tpl => ({\n        name: tpl,\n        expose: true\n      })))\n    };\n\n    // Now we allow re-register custom template\n    _classPrivateFieldGet(_registry, this).set(tagName, {\n      ...compatibleConstructor,\n      name: tagName\n    });\n    const exposedStates = getExposedStates(compatibleConstructor.state);\n    const proxyMethods = Object.entries(((_compatibleConstructo = compatibleConstructor.proxy) === null || _compatibleConstructo === void 0 ? void 0 : _compatibleConstructo.methods) ?? {});\n    const props = exposedStates.concat(validProxyProps.map(entry => entry[0]));\n    const methods = proxyMethods.map(entry => entry[0]);\n    const nativeProps = props.concat(methods).filter(prop => prop in HTMLElement.prototype && !allowedNativeProps.has(prop));\n    if (nativeProps.length > 0) {\n      warnAboutStrictMode(strict, \"Using native HTMLElement properties as template properties or methods\", tagName, ...nativeProps);\n      // istanbul ignore next\n      if (strict) {\n        throw new Error(`In custom template \"${tagName}\", ${nativeProps.map(p => `\"${p}\"`).join(\", \")} are native HTMLElement properties, and should be avoid to be used as brick properties or methods.`);\n      }\n    }\n    if (registered) {\n      return;\n    }\n    class TplElement extends HTMLElement {\n      get $$typeof() {\n        return \"custom-template\";\n      }\n      static get _dev_only_definedProperties() {\n        return props;\n      }\n      static get _dev_only_definedMethods() {\n        return methods;\n      }\n      $$getElementByRef(ref) {\n        var _this$$$tplStateStore;\n        return (_this$$$tplStateStore = this.$$tplStateStore) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.hostBrick) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.tplHostMetadata) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.internalBricksByRef.get(ref)) === null || _this$$$tplStateStore === void 0 ? void 0 : _this$$$tplStateStore.element;\n      }\n      connectedCallback() {\n        let shadowRoot = this.shadowRoot;\n        if (!shadowRoot) {\n          shadowRoot = this.attachShadow({\n            mode: \"open\"\n          });\n        }\n        const fragment = document.createDocumentFragment();\n        const style = document.createElement(\"style\");\n        style.textContent = \":host{display:block}:host([hidden]){display:none}\";\n        const slot = document.createElement(\"slot\");\n        fragment.appendChild(style);\n        fragment.appendChild(slot);\n        shadowRoot.appendChild(fragment);\n      }\n      disconnectedCallback() {\n        if (this.shadowRoot) {\n          this.shadowRoot.textContent = \"\";\n        }\n      }\n    }\n    for (const propName of exposedStates) {\n      if (validProxyProps.some(entry => entry[0] === propName)) {\n        // eslint-disable-next-line no-console\n        console.error(`Cannot define an exposed state that is also a proxy property: \"${propName}\" in ${tagName}`);\n        continue;\n      }\n      Object.defineProperty(TplElement.prototype, propName, {\n        get() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          return this.$$tplStateStore.getValue(propName);\n        },\n        set(value) {\n          var _this$$$tplStateStore2;\n          // 在 mount 过程中，先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n          // 避免初始化的一次 state update 操作及其 onChange 事件。\n          (_this$$$tplStateStore2 = this.$$tplStateStore) === null || _this$$$tplStateStore2 === void 0 || _this$$$tplStateStore2.updateValue(propName, value, \"replace\");\n        },\n        enumerable: true\n      });\n    }\n    for (const [from, to] of validProxyProps) {\n      Object.defineProperty(TplElement.prototype, from, {\n        get() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          const element = this.$$getElementByRef(to.ref);\n          return element[to.refProperty ?? from];\n        },\n        set(value) {\n          var _this$$$getElementByR;\n          // 同上 exposedState.set\n          const element = (_this$$$getElementByR = this.$$getElementByRef) === null || _this$$$getElementByR === void 0 ? void 0 : _this$$$getElementByR.call(this, to.ref);\n          if (element) {\n            element[to.refProperty ?? from] = value;\n          }\n        },\n        enumerable: true\n      });\n    }\n    for (const [from, to] of proxyMethods) {\n      Object.defineProperty(TplElement.prototype, from, {\n        value() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          const element = this.$$getElementByRef(to.ref);\n          return element[to.refMethod ?? from](...arguments);\n        },\n        enumerable: true\n      });\n    }\n    customElements.define(tagName, TplElement);\n  }\n  get(tagName) {\n    return _classPrivateFieldGet(_registry, this).get(tagName);\n  }\n}\nfunction getExposedStates(state) {\n  // Allow duplicated state names which maybe mutually exclusive.\n  return uniq((state === null || state === void 0 ? void 0 : state.filter(item => item.expose).map(item => item.name)) ?? []);\n}\n\n// istanbul ignore next\nfunction getCustomTemplatesV2() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return Object.freeze({\n      define(tagName, constructor) {\n        return v2Kit.getRuntime().registerCustomTemplate(tagName, constructor);\n      }\n    });\n  }\n}\n\n// istanbul ignore next\nexport const customTemplates = getCustomTemplatesV2() || new CustomTemplateRegistry();\n//# sourceMappingURL=CustomTemplates.js.map","import { customTemplates } from \"../../CustomTemplates.js\";\nexport function getTplStateStore(_ref, using, extraInfo) {\n  let {\n    tplStateStoreId,\n    tplStateStoreMap\n  } = _ref;\n  if (!tplStateStoreId) {\n    throw new Error(`Using \"${using}\" outside of a custom template${extraInfo ?? \"\"}`);\n  }\n  const store = tplStateStoreMap.get(tplStateStoreId);\n  if (!store) {\n    throw new Error(`Template state store is not found when using \"${using}\"${extraInfo ?? \"\"}.\\nThis is a bug of Brick Next, please report it.`);\n  }\n  return store;\n}\nexport function getTplHostElement(runtimeContext, using, extraInfo) {\n  const store = getTplStateStore(runtimeContext, using, extraInfo);\n  const hostElement = store.hostBrick.element;\n  if (!hostElement) {\n    throw new Error(`Template host element is gone when using \"${using}\"${extraInfo ?? \"\"}.\\nThis is a bug of Brick Next, please report it.`);\n  }\n  return hostElement;\n}\nexport function getTagNameOfCustomTemplate(brick, appId) {\n  // When a template is registered by an app, it's namespace maybe missed.\n  if (!brick.includes(\".\") && brick.startsWith(\"tpl-\") && appId) {\n    const tagName = `${appId}.${brick}`;\n    if (customTemplates.get(tagName)) {\n      return tagName;\n    }\n  }\n  if (customTemplates.get(brick)) {\n    return brick;\n  }\n  return false;\n}\n//# sourceMappingURL=utils.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\nconst widgetFunctionRegistry = new Map();\nexport const widgetFunctions = new Proxy(Object.freeze({}), {\n  get(target, key) {\n    return widgetFunctionRegistry.get(key);\n  }\n});\nfunction registerWidgetFunctionsV3(widgetId, functions, widgetVersion) {\n  if (widgetFunctionRegistry.has(widgetId)) {\n    // eslint-disable-next-line no-console\n    throw new Error(`Widget functions of \"${widgetId}\" already registered`);\n  }\n  const {\n    storyboardFunctions,\n    registerStoryboardFunctions\n  } = StoryboardFunctionRegistryFactory({\n    widgetId,\n    widgetVersion\n  });\n  widgetFunctionRegistry.set(widgetId, storyboardFunctions);\n  registerStoryboardFunctions(functions);\n}\n\n// istanbul ignore next\nfunction registerWidgetFunctionsV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function (widgetId, functions, widgetVersion) {\n      return v2Kit.getRuntime().registerWidgetFunctions(widgetId, functions, widgetVersion);\n    };\n  }\n}\n\n// istanbul ignore next\nexport const registerWidgetFunctions = registerWidgetFunctionsV2Factory() || registerWidgetFunctionsV3;\n//# sourceMappingURL=WidgetFunctions.js.map","export const semver = /^[v^~<>=]*?(\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+))?(?:-([\\da-z\\-]+(?:\\.[\\da-z\\-]+)*))?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\nexport const validateAndParse = (version) => {\n    if (typeof version !== 'string') {\n        throw new TypeError('Invalid argument expected string');\n    }\n    const match = version.match(semver);\n    if (!match) {\n        throw new Error(`Invalid argument not valid semver ('${version}' received)`);\n    }\n    match.shift();\n    return match;\n};\nconst isWildcard = (s) => s === '*' || s === 'x' || s === 'X';\nconst tryParse = (v) => {\n    const n = parseInt(v, 10);\n    return isNaN(n) ? v : n;\n};\nconst forceType = (a, b) => typeof a !== typeof b ? [String(a), String(b)] : [a, b];\nconst compareStrings = (a, b) => {\n    if (isWildcard(a) || isWildcard(b))\n        return 0;\n    const [ap, bp] = forceType(tryParse(a), tryParse(b));\n    if (ap > bp)\n        return 1;\n    if (ap < bp)\n        return -1;\n    return 0;\n};\nexport const compareSegments = (a, b) => {\n    for (let i = 0; i < Math.max(a.length, b.length); i++) {\n        const r = compareStrings(a[i] || '0', b[i] || '0');\n        if (r !== 0)\n            return r;\n    }\n    return 0;\n};\n//# sourceMappingURL=utils.js.map","import { compareVersions } from './compareVersions.js';\n/**\n * Compare [semver](https://semver.org/) version strings using the specified operator.\n *\n * @param v1 First version to compare\n * @param v2 Second version to compare\n * @param operator Allowed arithmetic operator to use\n * @returns `true` if the comparison between the firstVersion and the secondVersion satisfies the operator, `false` otherwise.\n *\n * @example\n * ```\n * compare('10.1.8', '10.0.4', '>'); // return true\n * compare('10.0.1', '10.0.1', '='); // return true\n * compare('10.1.1', '10.2.2', '<'); // return true\n * compare('10.1.1', '10.2.2', '<='); // return true\n * compare('10.1.1', '10.2.2', '>='); // return false\n * ```\n */\nexport const compare = (v1, v2, operator) => {\n    // validate input operator\n    assertValidOperator(operator);\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    const res = compareVersions(v1, v2);\n    return operatorResMap[operator].includes(res);\n};\nconst operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1],\n    '!=': [-1, 1],\n};\nconst allowedOperators = Object.keys(operatorResMap);\nconst assertValidOperator = (op) => {\n    if (typeof op !== 'string') {\n        throw new TypeError(`Invalid operator type, expected string but got ${typeof op}`);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n        throw new Error(`Invalid operator, expected one of ${allowedOperators.join('|')}`);\n    }\n};\n//# sourceMappingURL=compare.js.map","import { compareSegments, validateAndParse } from './utils.js';\n/**\n * Compare [semver](https://semver.org/) version strings to find greater, equal or lesser.\n * This library supports the full semver specification, including comparing versions with different number of digits like `1.0.0`, `1.0`, `1`, and pre-release versions like `1.0.0-alpha`.\n * @param v1 - First version to compare\n * @param v2 - Second version to compare\n * @returns Numeric value compatible with the [Array.sort(fn) interface](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Parameters).\n */\nexport const compareVersions = (v1, v2) => {\n    // validate input and split into segments\n    const n1 = validateAndParse(v1);\n    const n2 = validateAndParse(v2);\n    // pop off the patch\n    const p1 = n1.pop();\n    const p2 = n2.pop();\n    // validate numbers\n    const r = compareSegments(n1, n2);\n    if (r !== 0)\n        return r;\n    // validate pre-release\n    if (p1 && p2) {\n        return compareSegments(p1.split('.'), p2.split('.'));\n    }\n    else if (p1 || p2) {\n        return p1 ? -1 : 1;\n    }\n    return 0;\n};\n//# sourceMappingURL=compareVersions.js.map","import { compare } from \"compare-versions\";\nimport { _internalApiGetAppInBootstrapData, hooks } from \"./Runtime.js\";\nexport function hasInstalledApp(appId, matchVersion) {\n  // First, check whether the app is in bootstrap already.\n  let app = _internalApiGetAppInBootstrapData(appId);\n  if (!app && hooks !== null && hooks !== void 0 && hooks.checkInstalledApps) {\n    app = hooks.checkInstalledApps.getCheckedApp(appId);\n  }\n  if (!app || app.installStatus === \"running\") {\n    return false;\n  }\n  // Todo: `currentVersion` maybe `\"\"`\n  if (!matchVersion || !app.currentVersion) {\n    return true;\n  }\n  // Valid `matchVersion`:\n  //   >=1.2.3\n  //   >1.2.3\n  //   =1.2.3\n  //   <=1.2.3\n  //   <1.2.3\n  const matches = matchVersion.match(/^([><]=?|=)(.*)$/);\n  try {\n    if (!matches) {\n      throw new TypeError(`Invalid match version: ${matchVersion}`);\n    }\n    return compare(app.currentVersion, matches[2], matches[1]);\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error);\n  }\n  return false;\n}\n//# sourceMappingURL=hasInstalledApp.js.map","export function getFormStateStore(_ref, using, extraInfo) {\n  let {\n    formStateStoreId,\n    formStateStoreMap\n  } = _ref;\n  if (!formStateStoreId) {\n    throw new Error(`Using \"${using}\" outside of form renderer${extraInfo ?? \"\"}`);\n  }\n  const store = formStateStoreMap.get(formStateStoreId);\n  if (!store) {\n    throw new Error(`Form state store is not found when using \"${using}\"${extraInfo ?? \"\"}.\\nThis is a bug of Brick Next, please report it.`);\n  }\n  return store;\n}\n//# sourceMappingURL=utils.js.map","import { loadBricksImperatively } from \"@next-core/loader\";\nimport { getBrickPackages, hooks } from \"../Runtime.js\";\nconst pool = new Map();\nexport async function getProviderBrick(provider) {\n  var _hooks$flowApi;\n  const isFlowApi = hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 ? void 0 : _hooks$flowApi.isFlowApiProvider(provider);\n  if (isFlowApi) {\n    provider = hooks.flowApi.FLOW_API_PROVIDER;\n  }\n  let brick = pool.get(provider);\n  if (brick) {\n    return brick;\n  }\n  if (provider.includes(\"-\") && !customElements.get(provider)) {\n    if (isFlowApi) {\n      hooks.flowApi.registerFlowApiProvider();\n    } else {\n      await loadBricksImperatively([provider], getBrickPackages());\n      if (!customElements.get(provider)) {\n        throw new Error(`Provider not defined: \"${provider}\".`);\n      }\n    }\n  }\n  brick = document.createElement(provider);\n  pool.set(provider, brick);\n  return brick;\n}\n//# sourceMappingURL=getProviderBrick.js.map","import { isObject } from \"@next-core/utils/general\";\nlet computed = new WeakSet();\n\n// The computed (or transformed) result should never be *computed* again.\n// So does the fetched data from a remote api.\nexport function markAsComputed(value) {\n  if (isObject(value)) {\n    if (!hasBeenComputed(value)) {\n      computed.add(value);\n      if (Array.isArray(value)) {\n        value.forEach(markAsComputed);\n      } else {\n        // Only mark pure objects.\n        const proto = Object.getPrototypeOf(value);\n        if (!proto || proto.constructor === Object) {\n          Object.values(value).forEach(markAsComputed);\n        }\n      }\n    }\n  }\n}\nexport function hasBeenComputed(object) {\n  return computed.has(object);\n}\nexport function resetAllComputedMarks() {\n  computed = new WeakSet();\n}\n//# sourceMappingURL=markAsComputed.js.map","import { asyncComputeRealValue } from \"../compute/computeRealValue.js\";\nimport { getProviderBrick } from \"./getProviderBrick.js\";\nimport { _internalApiGetRenderId, hooks } from \"../Runtime.js\";\nimport { markAsComputed } from \"../compute/markAsComputed.js\";\nimport { get } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nconst cache = new Map();\nexport async function resolveData(resolveConf, runtimeContext, options) {\n  const {\n    useProvider,\n    method = \"resolve\",\n    args = [],\n    onReject\n  } = resolveConf;\n  const {\n    provider: legacyProvider,\n    field: legacyField\n  } = resolveConf;\n  if (legacyProvider && !useProvider) {\n    throw new Error(`You're using \"provider: ${legacyProvider}\" which is dropped in v3, please use \"useProvider\" instead`);\n  }\n  const hasLegacyField = legacyField !== null && legacyField !== undefined;\n  if (hasLegacyField) {\n    const strict = isStrictMode();\n    warnAboutStrictMode(strict, \"`resolve.field`\");\n    // istanbul ignore next\n    if (strict) {\n      throw new Error(\"Using deprecated `resolve.field`\");\n    }\n  }\n  const [providerBrick, actualArgs] = await Promise.all([getProviderBrick(useProvider), asyncComputeRealValue(args, runtimeContext)]);\n\n  // `clearResolveCache` maybe cleared during the above promise being\n  // fulfilled, so we manually mark it as stale for this case.\n  const renderId = options === null || options === void 0 ? void 0 : options.renderId;\n  const stale = !!renderId && renderId !== _internalApiGetRenderId();\n  const promise = resolveByProvider(providerBrick, useProvider, method, actualArgs, options, args, stale);\n  let {\n    transform\n  } = resolveConf;\n  let data;\n  try {\n    const value = await promise;\n    data = hasLegacyField ? get(value, legacyField) : value;\n    // The fetched data and its inner objects should never be *injected* again.\n    markAsComputed(data);\n  } catch (error) {\n    if (isHandleRejectByTransform(onReject)) {\n      transform = onReject.transform;\n      data = error;\n    } else {\n      throw error;\n    }\n  }\n  if (!transform) {\n    return data;\n  }\n\n  // Keep backward compatibility of string transform.\n  if (typeof transform === \"string\") {\n    return {\n      [transform]: data\n    };\n  }\n  return asyncComputeRealValue(transform, {\n    ...runtimeContext,\n    data\n  });\n}\nexport function clearResolveCache() {\n  cache.clear();\n}\nexport async function resolveByProvider(brick, useProvider, method, args, options, originalArgs, stale) {\n  let cacheKey;\n  try {\n    // `args` may contain circular references, which makes\n    // JSON stringify failed, thus we fallback to original args.\n    cacheKey = JSON.stringify({\n      useProvider,\n      method,\n      args\n    });\n  } catch (e) {\n    if (!originalArgs) {\n      throw e;\n    }\n    cacheKey = JSON.stringify({\n      useProvider,\n      method,\n      originalArgs\n    });\n  }\n  let promise;\n  if ((options === null || options === void 0 ? void 0 : options.cache) !== \"reload\") {\n    promise = cache.get(cacheKey);\n  }\n  if (!promise) {\n    promise = (async _hooks$flowApi => {\n      const finalArgs = hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(useProvider) ? await hooks.flowApi.getArgsOfFlowApi(useProvider, args, method) : args;\n      return brick[method](...finalArgs);\n    })();\n    if (!stale) {\n      cache.set(cacheKey, promise);\n    }\n  }\n  return promise;\n}\nfunction isHandleRejectByTransform(onReject) {\n  return !!(onReject !== null && onReject !== void 0 && onReject.transform);\n}\n//# sourceMappingURL=resolveData.js.map","import { cook, preevaluate, shouldAllowRecursiveEvaluations } from \"@next-core/cook\";\nimport { loadProcessorsImperatively } from \"@next-core/loader\";\nimport { supply } from \"@next-core/supply\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage, collectAppGetMenuUsage, collectInstalledAppsHasUsage } from \"@next-core/utils/storyboard\";\nimport { cloneDeep, omit } from \"lodash\";\nimport { customProcessors } from \"../../CustomProcessors.js\";\nimport { checkPermissionsUsage, storyboardFunctions } from \"./StoryboardFunctions.js\";\nimport { getGeneralGlobals } from \"./getGeneralGlobals.js\";\nimport { getDynamicReadOnlyProxy, getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { devtoolsHookEmit, getDevHook } from \"../devtools.js\";\nimport { getMedia } from \"../mediaQuery.js\";\nimport { getStorageItem } from \"./getStorageItem.js\";\nimport { _internalApiGetStoryboardInBootstrapData, getBrickPackages, getRuntime, hooks } from \"../Runtime.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { widgetFunctions } from \"./WidgetFunctions.js\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { hasInstalledApp } from \"../hasInstalledApp.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./computeRealValue.js\";\nconst symbolForRaw = Symbol.for(\"pre.evaluated.raw\");\nconst symbolForContext = Symbol.for(\"pre.evaluated.context\");\nexport function isPreEvaluated(raw) {\n  return !!(raw !== null && raw !== void 0 && raw[symbolForRaw]);\n}\nexport function getPreEvaluatedRaw(pre) {\n  return pre[symbolForRaw];\n}\nexport function shouldDismissMarkingComputed(raw) {\n  if (typeof raw === \"string\") {\n    return shouldAllowRecursiveEvaluations(raw);\n  }\n  return shouldAllowRecursiveEvaluations(raw[symbolForRaw]);\n}\nconst possibleErrorConstructs = new WeakSet([SyntaxError, TypeError, ReferenceError]);\nexport function getCookErrorConstructor(error) {\n  return possibleErrorConstructs.has(error.constructor) ? error.constructor : TypeError;\n}\nexport async function asyncEvaluate(raw,\n// string or pre-evaluated object.\nruntimeContext, options) {\n  const {\n    blockingList,\n    run\n  } = lowLevelEvaluate(raw, runtimeContext, options, true);\n  await Promise.all(blockingList);\n  return run();\n}\nexport function evaluate(raw,\n// string or pre-evaluated object.\nruntimeContext, options) {\n  const {\n    run\n  } = lowLevelEvaluate(raw, runtimeContext, options, false);\n  return run();\n}\nfunction lowLevelEvaluate(raw,\n// string or pre-evaluated object.\nruntimeContext) {\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  let isAsync = arguments.length > 3 ? arguments[3] : undefined;\n  const blockingList = [];\n  if (typeof raw !== \"string\") {\n    // If the `raw` is not a string, it must be a pre-evaluated object.\n    // Then fulfil the context, and restore the original `raw`.\n\n    const passByRuntimeContext = omit(runtimeContext, [\"pendingPermissionsPreCheck\", \"tplStateStoreMap\", \"tplStateStoreScope\", \"formStateStoreMap\", \"formStateStoreScope\"]);\n    runtimeContext = {\n      ...raw[symbolForContext],\n      ...passByRuntimeContext\n    };\n    raw = raw[symbolForRaw];\n  }\n\n  // Collect `APP.getMenu(...)` usage before evaluating.\n  const menuUsage = {\n    usedArgs: new Set()\n  };\n  const hasAppUsage = {\n    usedArgs: new Set()\n  };\n\n  // A `SyntaxError` maybe thrown.\n  let precooked;\n  try {\n    precooked = preevaluate(raw, {\n      cache: true,\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal(node, parent) {\n          collectAppGetMenuUsage(menuUsage, node, parent);\n          collectInstalledAppsHasUsage(hasAppUsage, node, parent);\n        }\n      }\n    });\n  } catch (error) {\n    const message = `${error.message}, in \"${raw}\"`;\n    const errorConstructor = getCookErrorConstructor(error);\n    throw new errorConstructor(message);\n  }\n  if (menuUsage.hasNonStaticUsage) {\n    throw new Error(`Non-static usage of \"APP.getMenu\" is prohibited in v3, check your expression: \"${raw}\"`);\n  }\n  if (hasAppUsage.hasNonStaticUsage) {\n    throw new Error(`Non-static usage of \"INSTALLED_APPS.has\" is prohibited in v3, check your expression: \"${raw}\"`);\n  }\n  const globalVariables = {};\n  const {\n    attemptToVisitGlobals\n  } = precooked;\n\n  // Ignore evaluating if required `event/DATA` is missing in\n  // context. Since they are are provided in different context, whenever\n  // missing one of them, memorize the current context for later consuming.\n  if (options.lazy || attemptToVisitGlobals.has(\"EVENT\") && !hasOwnProperty(runtimeContext, \"event\") || attemptToVisitGlobals.has(\"DATA\") && !hasOwnProperty(runtimeContext, \"data\")) {\n    return {\n      blockingList,\n      run() {\n        return Object.keys(runtimeContext).length > 0 ? {\n          [symbolForRaw]: raw,\n          [symbolForContext]: runtimeContext\n        } : raw;\n      }\n    };\n  }\n  let usedCtx;\n  let usedProcessors;\n  let usedStates;\n  let tplStateStore;\n  const strict = isStrictMode(runtimeContext);\n\n  // For existed TPL usage, treat it as a STATE.\n  if (attemptToVisitGlobals.has(\"STATE\") || !strict && attemptToVisitGlobals.has(\"TPL\")) {\n    tplStateStore = getTplStateStore(runtimeContext, \"STATE\", `: \"${raw}\"`);\n  }\n  let usedFormStates;\n  let formStateStore;\n  if (attemptToVisitGlobals.has(\"FORM_STATE\")) {\n    formStateStore = getFormStateStore(runtimeContext, \"FORM_STATE\", `: \"${raw}\"`);\n  }\n  const devHook = getDevHook();\n  if (isAsync || devHook) {\n    if (attemptToVisitGlobals.has(\"CTX\")) {\n      usedCtx = strictCollectMemberUsage(raw, \"CTX\");\n      isAsync && blockingList.push(runtimeContext.ctxStore.waitFor(usedCtx));\n    }\n    if (tplStateStore) {\n      usedStates = strictCollectMemberUsage(raw, \"STATE\");\n      // istanbul ignore if\n      if (!strict) {\n        const usedTpls = strictCollectMemberUsage(raw, \"TPL\");\n        for (const tpl of usedTpls) {\n          usedStates.add(tpl);\n        }\n      }\n      isAsync && blockingList.push(tplStateStore.waitFor(usedStates));\n    }\n    if (formStateStore) {\n      usedFormStates = strictCollectMemberUsage(raw, \"FORM_STATE\");\n      isAsync && blockingList.push(formStateStore.waitFor(usedFormStates));\n    }\n    if (attemptToVisitGlobals.has(\"PROCESSORS\")) {\n      usedProcessors = strictCollectMemberUsage(raw, \"PROCESSORS\", 2);\n      isAsync && blockingList.push(loadProcessorsImperatively(usedProcessors, getBrickPackages()));\n    }\n  }\n  if (isAsync) {\n    let attemptToCheckPermissions = attemptToVisitGlobals.has(\"PERMISSIONS\");\n    // There maybe `PERMISSIONS.check()` usage in functions\n    if (!attemptToCheckPermissions && attemptToVisitGlobals.has(\"FN\")) {\n      const usedFunctions = [...strictCollectMemberUsage(raw, \"FN\")];\n      attemptToCheckPermissions = checkPermissionsUsage(usedFunctions);\n    }\n    if (attemptToCheckPermissions) {\n      blockingList.push(...runtimeContext.pendingPermissionsPreCheck);\n    }\n    if (menuUsage.usedArgs.size > 0 && hooks !== null && hooks !== void 0 && hooks.menu) {\n      // Block evaluating if has `APP.getMenu(...)` usage.\n      const usedMenuIds = [...menuUsage.usedArgs];\n      blockingList.push(Promise.all(usedMenuIds.map(menuId => hooks.menu.fetchMenuById(menuId, runtimeContext, {\n        getStoryboardByAppId: _internalApiGetStoryboardInBootstrapData,\n        resolveData,\n        asyncComputeRealValue\n      }))));\n    }\n    if (hasAppUsage.usedArgs.size > 0) {\n      var _hooks$checkInstalled;\n      // Only wait for specific apps\n      blockingList.push(hooks === null || hooks === void 0 || (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 ? void 0 : _hooks$checkInstalled.waitForCheckingApps([...hasAppUsage.usedArgs]));\n    }\n  }\n  return {\n    blockingList,\n    run() {\n      var _hooks$menu, _hooks$images;\n      const {\n        app: currentApp,\n        location,\n        query,\n        match,\n        flags,\n        sys,\n        ctxStore,\n        data,\n        event\n      } = runtimeContext;\n      const app = runtimeContext.overrideApp ?? currentApp;\n      for (const variableName of attemptToVisitGlobals) {\n        switch (variableName) {\n          // case \"ALIAS\":\n          case \"ANCHOR\":\n            globalVariables[variableName] = location.hash ? location.hash.substring(1) : null;\n            break;\n          case \"APP\":\n            if (app == null) {\n              throw new ReferenceError(`APP is not defined, in \"${raw}\"`);\n            }\n            globalVariables[variableName] = {\n              ...cloneDeep(app),\n              getMenu: hooks === null || hooks === void 0 || (_hooks$menu = hooks.menu) === null || _hooks$menu === void 0 ? void 0 : _hooks$menu.getMenuById\n            };\n            break;\n          case \"CTX\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(_target, key) {\n                return ctxStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedCtx);\n              }\n            });\n            break;\n          case \"DATA\":\n            globalVariables[variableName] = data;\n            break;\n          case \"EVENT\":\n            globalVariables[variableName] = event;\n            break;\n          case \"FLAGS\":\n            globalVariables[variableName] = getReadOnlyProxy(flags);\n            break;\n          case \"FORM_STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(_target, key) {\n                return formStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedFormStates);\n              }\n            });\n            break;\n          case \"HASH\":\n            globalVariables[variableName] = location.hash;\n            break;\n          case \"INSTALLED_APPS\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              has: hasInstalledApp\n            });\n            break;\n          case \"ITEM\":\n          case \"INDEX\":\n          case \"SIZE\":\n            {\n              const property = variableName === \"ITEM\" ? \"forEachItem\" : variableName === \"INDEX\" ? \"forEachIndex\" : \"forEachSize\";\n              if (!hasOwnProperty(runtimeContext, property)) {\n                // eslint-disable-next-line no-console\n                console.error(`Using \\`${variableName}\\` but no \\`:forEach\\` is found, check your expression: \"${raw}\"`);\n              } else {\n                globalVariables[variableName] = runtimeContext[property];\n              }\n              break;\n            }\n          case \"LOCAL_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"local\")\n            });\n            break;\n          case \"MEDIA\":\n            globalVariables[variableName] = getReadOnlyProxy(getMedia());\n            break;\n          case \"MISC\":\n            globalVariables[variableName] = getRuntime().getMiscSettings();\n            break;\n          case \"PARAMS\":\n            if (query == null) {\n              throw new ReferenceError(`PARAMS is not defined, in \"${raw}\"`);\n            }\n            globalVariables[variableName] = new URLSearchParams(query);\n            break;\n          case \"PATH\":\n            globalVariables[variableName] = getReadOnlyProxy((match === null || match === void 0 ? void 0 : match.params) ?? {});\n            break;\n          case \"PATH_NAME\":\n            globalVariables[variableName] = location.pathname;\n            break;\n          case \"PROCESSORS\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(_target, key) {\n                const pkg = customProcessors.get(key);\n                if (!pkg) {\n                  throw new Error(`'PROCESSORS.${key}' is not registered! Have you installed the relevant brick package?`);\n                }\n                return getDynamicReadOnlyProxy({\n                  get(_t, k) {\n                    return pkg.get(k);\n                  },\n                  ownKeys() {\n                    return Array.from(pkg.keys());\n                  }\n                });\n              },\n              ownKeys() {\n                const keys = new Set();\n                for (const processor of usedProcessors) {\n                  const namespace = processor.split(\".\")[0];\n                  keys.add(namespace);\n                }\n                return Array.from(keys);\n              }\n            });\n            break;\n          case \"QUERY\":\n            if (query == null) {\n              throw new ReferenceError(`QUERY is not defined, in \"${raw}\"`);\n            }\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.get(key)]));\n            break;\n          case \"QUERY_ARRAY\":\n            if (query == null) {\n              throw new ReferenceError(`QUERY_ARRAY is not defined, in \"${raw}\"`);\n            }\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.getAll(key)]));\n            // case \"SEGUE\":\n            break;\n          case \"SESSION_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"session\")\n            });\n            break;\n          // istanbul ignore next\n          case \"TPL\":\n            warnAboutStrictMode(strict, 'Using \"TPL\" in expression', `check your expression: \"${raw}\"`);\n            if (strict) {\n              break;\n            }\n          // eslint-disable-next-line no-fallthrough\n          case \"STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(_target, key) {\n                return tplStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedStates);\n              }\n            });\n            break;\n          case \"SYS\":\n            globalVariables[variableName] = getReadOnlyProxy(sys ?? {});\n            break;\n          case \"__WIDGET_FN__\":\n            globalVariables[variableName] = widgetFunctions;\n            break;\n          case \"__WIDGET_IMG__\":\n            globalVariables[variableName] = hooks === null || hooks === void 0 || (_hooks$images = hooks.images) === null || _hooks$images === void 0 ? void 0 : _hooks$images.widgetImagesFactory;\n            break;\n          case \"__WIDGET_I18N__\":\n            globalVariables[variableName] = widgetI18nFactory;\n            break;\n        }\n      }\n      Object.assign(globalVariables, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        storyboardFunctions,\n        app: app,\n        appendI18nNamespace: runtimeContext.appendI18nNamespace\n      }));\n      try {\n        const result = cook(precooked.expression, precooked.source, {\n          globalVariables: supply(precooked.attemptToVisitGlobals, globalVariables)\n        });\n        const detail = {\n          raw,\n          context: globalVariables,\n          result\n        };\n        devtoolsHookEmit(\"evaluation\", detail);\n        return result;\n      } catch (error) {\n        const message = `${error.message}, in \"${raw}\"`;\n        const errorConstructor = getCookErrorConstructor(error);\n        throw new errorConstructor(message);\n      }\n    }\n  };\n}\n//# sourceMappingURL=evaluate.js.map","export let StateOfUseBrick = /*#__PURE__*/function (StateOfUseBrick) {\n  StateOfUseBrick[StateOfUseBrick[\"INITIAL\"] = 0] = \"INITIAL\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK\"] = 1] = \"USE_BRICK\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_ITEM\"] = 2] = \"USE_BRICK_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_PROPERTIES\"] = 3] = \"USE_BRICK_PROPERTIES\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_TRANSFORM\"] = 4] = \"USE_BRICK_TRANSFORM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_EVENTS\"] = 5] = \"USE_BRICK_EVENTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_IF\"] = 6] = \"USE_BRICK_IF\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS\"] = 7] = \"USE_BRICK_SLOTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM\"] = 8] = \"USE_BRICK_SLOTS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS\"] = 9] = \"USE_BRICK_SLOTS_ITEM_BRICKS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\"] = 10] = \"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_LIFECYCLE\"] = 11] = \"USE_BRICK_LIFECYCLE\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_DATA_SOURCE\"] = 12] = \"USE_BRICK_DATA_SOURCE\";\n  return StateOfUseBrick;\n}({});\nexport function isLazyContentInUseBrick(state) {\n  switch (state) {\n    case StateOfUseBrick.USE_BRICK_PROPERTIES:\n    case StateOfUseBrick.USE_BRICK_TRANSFORM:\n    case StateOfUseBrick.USE_BRICK_EVENTS:\n    case StateOfUseBrick.USE_BRICK_IF:\n    case StateOfUseBrick.USE_BRICK_LIFECYCLE:\n    case StateOfUseBrick.USE_BRICK_DATA_SOURCE:\n      return true;\n  }\n  return false;\n}\nexport function getNextStateOfUseBrick(state, isArray, key) {\n  if (isLazyContentInUseBrick(state)) {\n    return state;\n  }\n  if (isArray) {\n    switch (state) {\n      case StateOfUseBrick.USE_BRICK:\n        return StateOfUseBrick.USE_BRICK_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM;\n    }\n  } else {\n    switch (state) {\n      case StateOfUseBrick.INITIAL:\n        if (key === \"useBrick\") {\n          return StateOfUseBrick.USE_BRICK;\n        }\n        break;\n      case StateOfUseBrick.USE_BRICK:\n      case StateOfUseBrick.USE_BRICK_ITEM:\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:\n        {\n          switch (key) {\n            case \"properties\":\n              return StateOfUseBrick.USE_BRICK_PROPERTIES;\n            case \"transform\":\n              return StateOfUseBrick.USE_BRICK_TRANSFORM;\n            case \"dataSource\":\n              return StateOfUseBrick.USE_BRICK_DATA_SOURCE;\n            case \"events\":\n              return StateOfUseBrick.USE_BRICK_EVENTS;\n            case \"slots\":\n              return StateOfUseBrick.USE_BRICK_SLOTS;\n            case \"children\":\n              return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n            case \"if\":\n              return StateOfUseBrick.USE_BRICK_IF;\n            case \"lifeCycle\":\n              return StateOfUseBrick.USE_BRICK_LIFECYCLE;\n          }\n          break;\n        }\n      case StateOfUseBrick.USE_BRICK_SLOTS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM:\n        if (key === \"bricks\") {\n          return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n        }\n        break;\n    }\n  }\n  return StateOfUseBrick.INITIAL;\n}\n//# sourceMappingURL=getNextStateOfUseBrick.js.map","import { isEvaluable } from \"@next-core/cook\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { transformAndInject, transform, inject } from \"@next-core/inject\";\nimport { asyncEvaluate, isPreEvaluated, evaluate, shouldDismissMarkingComputed } from \"./evaluate.js\";\nimport { getNextStateOfUseBrick, isLazyContentInUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { hasBeenComputed, markAsComputed } from \"./markAsComputed.js\";\nexport async function asyncComputeRealValue(value, runtimeContext) {\n  let internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const preEvaluated = isPreEvaluated(value);\n  if (preEvaluated || typeof value === \"string\") {\n    // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n    // are kept and to be evaluated later.\n    const lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n    let result;\n    let dismissMarkingComputed = lazy;\n    if (preEvaluated || isEvaluable(value)) {\n      result = await asyncEvaluate(value, runtimeContext, {\n        lazy\n      });\n      dismissMarkingComputed = shouldDismissMarkingComputed(value);\n    } else {\n      result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n    }\n    if (!dismissMarkingComputed) {\n      markAsComputed(result);\n    }\n    return result;\n  }\n  if (!isObject(value) || hasBeenComputed(value) || typeof value === \"function\") {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    const nextOptions = getNextComputeOptions(internalOptions, true);\n    return Promise.all(value.map(v => asyncComputeRealValue(v, runtimeContext, nextOptions)));\n  }\n  return Object.fromEntries((await Promise.all(Object.entries(value).map(_ref => {\n    let [k, v] = _ref;\n    return Promise.all([asyncComputeRealValue(k, runtimeContext), asyncComputeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))]);\n  }))).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n}\nexport function computeRealValue(value, runtimeContext) {\n  let internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const preEvaluated = isPreEvaluated(value);\n  if (preEvaluated || typeof value === \"string\") {\n    // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n    // are kept and to be evaluated later.\n    const lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n    let result;\n    let dismissMarkingComputed = lazy;\n    if (preEvaluated || isEvaluable(value)) {\n      result = evaluate(value, runtimeContext);\n      dismissMarkingComputed = shouldDismissMarkingComputed(value);\n    } else {\n      result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n    }\n    if (!dismissMarkingComputed) {\n      markAsComputed(result);\n    }\n    return result;\n  }\n  if (!isObject(value) || hasBeenComputed(value) || typeof value === \"function\") {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    const nextOptions = getNextComputeOptions(internalOptions, true);\n    return value.map(v => computeRealValue(v, runtimeContext, nextOptions));\n  }\n  return Object.fromEntries(Object.entries(value).map(_ref2 => {\n    let [k, v] = _ref2;\n    return [computeRealValue(k, runtimeContext), computeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))];\n  }).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n}\nfunction getNextComputeOptions(internalOptions, isArray, key) {\n  return internalOptions.$$lazyForUseBrick ? {\n    ...internalOptions,\n    $$stateOfUseBrick: getNextStateOfUseBrick(internalOptions.$$stateOfUseBrick, isArray, key)\n  } : internalOptions;\n}\nfunction identity(value) {\n  return value;\n}\n//# sourceMappingURL=computeRealValue.js.map","import { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { isPreEvaluated } from \"./evaluate.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\n\n/**\n * 包含 `if` 条件判断的对象。\n */\n\nexport async function asyncCheckIf(ifContainer, runtimeContext) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? await asyncComputeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n}\nexport function checkIf(ifContainer, runtimeContext) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? computeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n}\nexport function checkIfOfComputed(ifContainer) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!ifContainer.if;\n}\nexport async function asyncCheckBrickIf(brickConf, runtimeContext) {\n  if (isObject(brickConf.if) && !isPreEvaluated(brickConf.if)) {\n    const resolved = await resolveData(brickConf.if, runtimeContext);\n    return checkIfOfComputed(resolved);\n  }\n  return asyncCheckIf(brickConf, runtimeContext);\n}\nfunction checkIfByTransformV3(ifContainer, data) {\n  return checkIf(ifContainer, {\n    data\n  });\n}\n\n// istanbul ignore next\nfunction checkIfByTransformV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return v2Kit.looseCheckIfByTransform;\n  }\n}\n\n// istanbul ignore next\nexport const checkIfByTransform = checkIfByTransformV2Factory() || checkIfByTransformV3;\n//# sourceMappingURL=checkIf.js.map","import { isEvaluable, isTrackAll } from \"@next-core/cook\";\nimport { track, trackAll } from \"@next-core/utils/storyboard\";\nimport { getPreEvaluatedRaw, isPreEvaluated } from \"./evaluate.js\";\nexport function getTracks(value) {\n  let contextNames = false;\n  let stateNames = false;\n  let formStateNames = false;\n  if (typeof value === \"string\" ? isEvaluable(value) : isPreEvaluated(value)) {\n    const raw = typeof value === \"string\" ? value : getPreEvaluatedRaw(value);\n    if (isTrackAll(raw)) {\n      const result = trackAll(raw);\n      if (result) {\n        contextNames = result.context;\n        stateNames = result.state;\n        formStateNames = result.formState;\n      }\n    } else {\n      contextNames = track(raw, \"track context\", \"CTX\");\n      stateNames = track(raw, \"track state\", \"STATE\");\n      formStateNames = track(raw, \"track formstate\", \"FORM_STATE\");\n    }\n  }\n  return {\n    contextNames,\n    stateNames,\n    formStateNames\n  };\n}\n//# sourceMappingURL=getTracks.js.map","import { isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { StateOfUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { getTracks } from \"./getTracks.js\";\nexport function asyncComputeRealPropertyEntries(properties, runtimeContext, trackingContextList) {\n  if (isObject(properties)) {\n    return Object.entries(properties).map(_ref => {\n      let [propName, propValue] = _ref;\n      const {\n        contextNames,\n        stateNames,\n        formStateNames\n      } = getTracks(propValue);\n      if (contextNames || stateNames || formStateNames) {\n        trackingContextList.push({\n          contextNames,\n          stateNames,\n          formStateNames,\n          propName,\n          propValue\n        });\n      }\n      // Related: https://github.com/facebook/react/issues/11347\n      const asyncValue = asyncComputeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      return [propName, asyncValue];\n    });\n  }\n  return [];\n}\nexport async function computePropertyValue(asyncPropertyEntries, propName) {\n  for (const [name, asyncValue, ignoreUndefined] of asyncPropertyEntries) {\n    if (name === propName) {\n      const value = await asyncValue;\n      if (value !== undefined || !ignoreUndefined) {\n        return value;\n      }\n    }\n  }\n}\nexport async function constructAsyncProperties(asyncPropertyEntries) {\n  const props = {};\n  for (const [propName, asyncValue, ignoreUndefined] of asyncPropertyEntries) {\n    const value = await asyncValue;\n    if ((value !== undefined || !ignoreUndefined) && (\n    // For `style` and `dataset`, only object is acceptable.\n    propName !== \"style\" && propName !== \"dataset\" || isObject(value))) {\n      props[propName] = value;\n    }\n  }\n  return props;\n}\nexport function computeRealProperties(properties, runtimeContext) {\n  if (isObject(properties)) {\n    return Object.fromEntries(Object.entries(properties).map(_ref2 => {\n      let [propName, propValue] = _ref2;\n      // Related: https://github.com/facebook/react/issues/11347\n      const realValue = computeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      // For `style` and `dataset`, only object is acceptable.\n      if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n        return [propName, realValue];\n      }\n    }).filter(Boolean));\n  }\n  return {};\n}\n//# sourceMappingURL=computeRealProperties.js.map","export function setRealProperties(brick, realProps) {\n  if (!realProps) {\n    return;\n  }\n  for (const [propName, propValue] of Object.entries(realProps)) {\n    switch (propName) {\n      case \"style\":\n      case \"dataset\":\n        for (const [k, v] of Object.entries(propValue)) {\n          brick[propName][k] = v;\n        }\n        break;\n      case \"constructor\":\n      case \"__proto__\":\n      case \"innerHTML\":\n        // `innerHTML` is dangerous, use `textContent` instead.\n        throw new Error(`set \\`${propName}\\` is prohibited`);\n      default:\n        brick[propName] = propValue;\n    }\n  }\n}\n//# sourceMappingURL=setRealProperties.js.map","import { computeRealProperties } from \"./computeRealProperties.js\";\nimport { setRealProperties } from \"./setRealProperties.js\";\nexport function setProperties(bricks, properties, runtimeContext) {\n  const realProps = computeRealProperties(properties, runtimeContext);\n  if (!Array.isArray(bricks)) {\n    bricks = [bricks];\n  }\n  bricks.forEach(brick => {\n    setRealProperties(brick, realProps);\n  });\n}\n//# sourceMappingURL=setProperties.js.map","import { setProperties } from \"./setProperties.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nexport function listenOnTrackingContext(brick, trackingContextList) {\n  for (const track of trackingContextList) {\n    const listener = () => {\n      if (brick.element) {\n        setProperties(brick.element, {\n          [track.propName]: track.propValue\n        }, brick.runtimeContext);\n      }\n    };\n    brick.disposes ?? (brick.disposes = []);\n    if (track.contextNames) {\n      for (const contextName of track.contextNames) {\n        brick.disposes.push(brick.runtimeContext.ctxStore.onChange(contextName, listener));\n      }\n    }\n    if (track.stateNames) {\n      const tplStateStore = getTplStateStore(brick.runtimeContext, \"STATE\", `: \"${track.propValue}\"`);\n      for (const stateName of track.stateNames) {\n        brick.disposes.push(tplStateStore.onChange(stateName, listener));\n      }\n    }\n    if (track.formStateNames) {\n      const formStateStore = getFormStateStore(brick.runtimeContext, \"FORM_STATE\", `: \"${track.propValue}\"`);\n      for (const stateName of track.formStateNames) {\n        brick.disposes.push(formStateStore.onChange(stateName, listener));\n      }\n    }\n  }\n}\nexport function trackAfterInitial(runtimeContext, trackingContextList, initialTracker) {\n  if (!initialTracker) {\n    return;\n  }\n  for (const {\n    contextNames,\n    stateNames,\n    propValue\n  } of trackingContextList) {\n    if (contextNames) {\n      for (const contextName of contextNames) {\n        initialTracker.disposes.push(runtimeContext.ctxStore.onChange(contextName, initialTracker.listener));\n      }\n    }\n    if (stateNames) {\n      for (const stateName of stateNames) {\n        const tplStateStore = getTplStateStore(runtimeContext, \"STATE\", `: \"${propValue}\"`);\n        initialTracker.disposes.push(tplStateStore.onChange(stateName, initialTracker.listener));\n      }\n    }\n  }\n}\n//# sourceMappingURL=listenOnTrackingContext.js.map","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \".concat(i));\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \".concat(j));\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \".concat(j));\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \".concat(i));\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \".concat(i));\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a, _b = options.delimiter, delimiter = _b === void 0 ? \"/#?\" : _b;\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \".concat(nextType, \" at \").concat(index, \", expected \").concat(type));\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    var isSafe = function (value) {\n        for (var _i = 0, delimiter_1 = delimiter; _i < delimiter_1.length; _i++) {\n            var char = delimiter_1[_i];\n            if (value.indexOf(char) > -1)\n                return true;\n        }\n        return false;\n    };\n    var safePattern = function (prefix) {\n        var prev = result[result.length - 1];\n        var prevText = prefix || (prev && typeof prev === \"string\" ? prev : \"\");\n        if (prev && !prevText) {\n            throw new TypeError(\"Must have text between two parameters, missing text after \\\"\".concat(prev.name, \"\\\"\"));\n        }\n        if (!prevText || isSafe(prevText))\n            return \"[^\".concat(escapeString(delimiter), \"]+?\");\n        return \"(?:(?!\".concat(escapeString(prevText), \")[^\").concat(escapeString(delimiter), \"])+?\");\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || safePattern(prefix),\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? safePattern(prefix) : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\".concat(token.pattern, \")$\"), reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not repeat, but got an array\"));\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not be empty\"));\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to be \").concat(typeOfMessage));\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    var groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n    var index = 0;\n    var execResult = groupsRegex.exec(path.source);\n    while (execResult) {\n        keys.push({\n            // Use parenthesized substring match if available, index otherwise\n            name: execResult[1] || index++,\n            prefix: \"\",\n            suffix: \"\",\n            modifier: \"\",\n            pattern: \"\",\n        });\n        execResult = groupsRegex.exec(path.source);\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\".concat(parts.join(\"|\"), \")\"), flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d, _e = options.delimiter, delimiter = _e === void 0 ? \"/#?\" : _e, _f = options.endsWith, endsWith = _f === void 0 ? \"\" : _f;\n    var endsWithRe = \"[\".concat(escapeString(endsWith), \"]|$\");\n    var delimiterRe = \"[\".concat(escapeString(delimiter), \"]\");\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\".concat(prefix, \"((?:\").concat(token.pattern, \")(?:\").concat(suffix).concat(prefix, \"(?:\").concat(token.pattern, \"))*)\").concat(suffix, \")\").concat(mod);\n                    }\n                    else {\n                        route += \"(?:\".concat(prefix, \"(\").concat(token.pattern, \")\").concat(suffix, \")\").concat(token.modifier);\n                    }\n                }\n                else {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        throw new TypeError(\"Can not repeat \\\"\".concat(token.name, \"\\\" without a prefix and suffix\"));\n                    }\n                    route += \"(\".concat(token.pattern, \")\").concat(token.modifier);\n                }\n            }\n            else {\n                route += \"(?:\".concat(prefix).concat(suffix, \")\").concat(token.modifier);\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += \"\".concat(delimiterRe, \"?\");\n        route += !options.endsWith ? \"$\" : \"(?=\".concat(endsWithRe, \")\");\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n            : endToken === undefined;\n        if (!strict) {\n            route += \"(?:\".concat(delimiterRe, \"(?=\").concat(endsWithRe, \"))?\");\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\".concat(delimiterRe, \"|\").concat(endsWithRe, \")\");\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","// Ref https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/matchPath.js\n\nimport { pathToRegexp, compile } from \"path-to-regexp\";\nconst cache = new Map();\nconst cacheLimit = 10000;\nlet cacheCount = 0;\nfunction compilePath(path, options) {\n  const cacheKey = `${options.end}${options.strict}${options.sensitive}`;\n  let pathCache = cache.get(cacheKey);\n  if (!pathCache) {\n    cache.set(cacheKey, pathCache = new Map());\n  }\n  const cacheResult = pathCache.get(path);\n  if (cacheResult) {\n    return cacheResult;\n  }\n  const keys = [];\n  const regexp = pathToRegexp(path, keys, options);\n  const result = {\n    regexp,\n    keys\n  };\n  if (cacheCount < cacheLimit) {\n    pathCache.set(path, result);\n    cacheCount++;\n  }\n  return result;\n}\n\n/**\n * Public API for matching a URL pathname to a path.\n */\nexport function matchPath(pathname, options) {\n  const {\n    path: p,\n    exact = false,\n    strict = false,\n    sensitive = true\n  } = options;\n  const paths = Array.isArray(p) ? p : [p];\n  return paths.reduce((matched, path) => {\n    if (matched) {\n      return matched;\n    }\n    const {\n      regexp,\n      keys\n    } = compilePath(path, {\n      end: exact,\n      strict,\n      sensitive\n    });\n    const match = regexp.exec(pathname);\n    if (!match) {\n      return null;\n    }\n    const [url, ...values] = match;\n    const isExact = pathname === url;\n    if (exact && !isExact) {\n      return null;\n    }\n    const initialParams = {};\n    const result = {\n      path,\n      // the path used to match\n      url: path === \"/\" && url === \"\" ? \"/\" : url,\n      // the matched portion of the URL\n      isExact,\n      // whether or not we matched exactly\n      params: keys.reduce((memo, key, index) => {\n        memo[key.name] = values[index];\n        return memo;\n      }, initialParams)\n    };\n    return result;\n  }, null);\n}\nexport function toPath(path, pathParams) {\n  return compile(path)(pathParams);\n}\n//# sourceMappingURL=matchPath.js.map","import { matchPath } from \"./matchPath.js\";\nimport { asyncCheckIf } from \"./compute/checkIf.js\";\nimport { hooks } from \"./Runtime.js\";\nexport async function matchRoutes(routes, runtimeContext) {\n  for (const route of routes) {\n    if (typeof route.path !== \"string\") {\n      // eslint-disable-next-line no-console\n      console.error(\"Invalid route with invalid path:\", route);\n      throw new Error(`Invalid route with invalid type of path: ${typeof route.path}`);\n    }\n    const match = matchRoute(route, runtimeContext.app.homepage, runtimeContext.location.pathname);\n    if (match && (await asyncCheckIf(route, runtimeContext))) {\n      if (runtimeContext.app.noAuthGuard || route.public || !(hooks !== null && hooks !== void 0 && hooks.auth) || hooks.auth.isLoggedIn()) {\n        return {\n          match,\n          route\n        };\n      }\n      return \"unauthenticated\";\n    }\n  }\n  return \"missed\";\n}\nexport function matchRoute(route, homepage, pathname) {\n  const routePath = route.path.replace(/^\\$\\{APP.homepage\\}/, homepage);\n  return matchPath(pathname, {\n    path: routePath,\n    exact: route.exact\n  });\n}\n//# sourceMappingURL=matchRoutes.js.map","export const symbolForAsyncComputedPropsFromHost = Symbol.for(\"tpl.asyncComputedPropsFromHost\");\nexport const symbolForTplStateStoreId = Symbol.for(\"tpl.stateStoreId\");\nexport const symbolForTPlExternalForEachItem = Symbol.for(\"tpl.externalForEachItem\");\nexport const symbolForTPlExternalForEachIndex = Symbol.for(\"tpl.externalForEachIndex\");\nexport const symbolForTPlExternalForEachSize = Symbol.for(\"tpl.externalForEachSize\");\n//# sourceMappingURL=constants.js.map","import { pick } from \"lodash\";\nimport { _internalApiGetRenderId } from \"./Runtime.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nconst timeoutIdList = new Set();\nexport function startPoll(task, _ref, pollOptions, runtimeContext) {\n  let {\n    progress,\n    success,\n    error,\n    finally: finallyCallback\n  } = _ref;\n  const {\n    expectPollStopImmediately,\n    expectPollEnd\n  } = pollOptions;\n  const {\n    interval,\n    leadingRequestDelay,\n    continueOnError,\n    delegateLoadingBar\n  } = computeRealValue(pick(pollOptions, [\"interval\", \"leadingRequestDelay\", \"continueOnError\", \"delegateLoadingBar\"]), runtimeContext);\n  const currentRenderId = _internalApiGetRenderId();\n  let currentTimeoutId;\n  async function poll() {\n    timeoutIdList.delete(currentTimeoutId);\n    let shouldStop;\n    try {\n      var _computeRealValue;\n      shouldStop = (_computeRealValue = computeRealValue(expectPollStopImmediately, runtimeContext)) === null || _computeRealValue === void 0 ? void 0 : _computeRealValue();\n      // Stop polling immediately when the expectation is match before task.\n      if (!shouldStop) {\n        var _computeRealValue2;\n        const result = await task();\n        const expectPollStopImmediatelyResult = (_computeRealValue2 = computeRealValue(expectPollStopImmediately, runtimeContext)) === null || _computeRealValue2 === void 0 ? void 0 : _computeRealValue2();\n        // Stop polling immediately when the expectation is match or a different router\n        // is rendering after the task processed.\n        shouldStop = expectPollStopImmediatelyResult || currentRenderId !== _internalApiGetRenderId();\n        if (!shouldStop) {\n          var _computeRealValue3;\n          progress === null || progress === void 0 || progress(result);\n          if ((_computeRealValue3 = computeRealValue(expectPollEnd, runtimeContext)) !== null && _computeRealValue3 !== void 0 && _computeRealValue3(result)) {\n            if (delegateLoadingBar) {\n              window.dispatchEvent(new Event(\"request.end\"));\n            }\n            success === null || success === void 0 || success(result);\n            finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n          } else {\n            delayedPoll(interval ?? 3000);\n          }\n        } else if (expectPollStopImmediatelyResult) {\n          finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n        }\n      } else {\n        finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n      }\n    } catch (e) {\n      var _computeRealValue4;\n      const expectPollStopImmediatelyResult = (_computeRealValue4 = computeRealValue(expectPollStopImmediately, runtimeContext)) === null || _computeRealValue4 === void 0 ? void 0 : _computeRealValue4();\n      // Stop polling immediately when the expectation is match or a different router\n      // is rendering after the task processed.\n      shouldStop = expectPollStopImmediatelyResult || currentRenderId !== _internalApiGetRenderId();\n      if (!shouldStop) {\n        error === null || error === void 0 || error(e);\n        if (continueOnError) {\n          delayedPoll(interval ?? 3000);\n        } else {\n          finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n        }\n      } else if (expectPollStopImmediatelyResult) {\n        finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n      }\n    } finally {\n      // Manually dispatch an event of `request.end` when the polling is stopped immediately.\n      if (delegateLoadingBar && shouldStop) {\n        window.dispatchEvent(new Event(\"request.end\"));\n      }\n    }\n  }\n  function delayedPoll(delay) {\n    currentTimeoutId = setTimeout(poll, delay);\n    timeoutIdList.add(currentTimeoutId);\n  }\n  delayedPoll(leadingRequestDelay ?? 0);\n  if (delegateLoadingBar) {\n    window.dispatchEvent(new Event(\"request.start\"));\n  }\n}\nexport function clearPollTimeout() {\n  for (const timeoutId of timeoutIdList) {\n    clearTimeout(timeoutId);\n  }\n  timeoutIdList.clear();\n}\n//# sourceMappingURL=poll.js.map","export let K = /*#__PURE__*/function (K) {\n  K[\"REQUEST_FAILED\"] = \"REQUEST_FAILED\";\n  K[\"SOMETHING_WENT_WRONG\"] = \"SOMETHING_WENT_WRONG\";\n  K[\"LOGIN_TIMEOUT_MESSAGE\"] = \"LOGIN_TIMEOUT_MESSAGE\";\n  K[\"NETWORK_ERROR\"] = \"NETWORK_ERROR\";\n  K[\"LICENSE_EXPIRED\"] = \"LICENSE_EXPIRED\";\n  K[\"NO_PERMISSION\"] = \"NO_PERMISSION\";\n  K[\"PAGE_NOT_FOUND\"] = \"PAGE_NOT_FOUND\";\n  K[\"APP_NOT_FOUND\"] = \"APP_NOT_FOUND\";\n  K[\"UNKNOWN_ERROR\"] = \"UNKNOWN_ERROR\";\n  K[\"GO_BACK_TO_PREVIOUS_PAGE\"] = \"GO_BACK_TO_PREVIOUS_PAGE\";\n  K[\"GO_BACK_HOME\"] = \"GO_BACK_HOME\";\n  K[\"RELOAD\"] = \"RELOAD\";\n  return K;\n}({});\nconst en = {\n  [K.REQUEST_FAILED]: \"Request Failed\",\n  [K.SOMETHING_WENT_WRONG]: \"Something went wrong!\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"You haven't logged in or your login session has expired. Login right now?\",\n  [K.NETWORK_ERROR]: \"Network error, please check your network.\",\n  [K.LICENSE_EXPIRED]: \"The license authorization has expired, please contact the platform administrator\",\n  [K.NO_PERMISSION]: \"Unauthorized access, unable to retrieve the required resources for this page\",\n  [K.PAGE_NOT_FOUND]: \"Page not found, please check the URL\",\n  [K.APP_NOT_FOUND]: \"App not found, maybe the URL is wrong or you don't have permission to access\",\n  [K.UNKNOWN_ERROR]: \"Oops! Something went wrong\",\n  [K.GO_BACK_TO_PREVIOUS_PAGE]: \"Go back to previous page\",\n  [K.GO_BACK_HOME]: \"Go back to home page\",\n  [K.RELOAD]: \"Reload\"\n};\nconst zh = {\n  [K.REQUEST_FAILED]: \"请求失败\",\n  [K.SOMETHING_WENT_WRONG]: \"出现了一些问题！\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"您还未登录或登录信息已过期，现在重新登录？\",\n  [K.NETWORK_ERROR]: \"网络错误，请检查您的网络连接。\",\n  [K.LICENSE_EXPIRED]: \"License 授权失效，请联系平台管理员\",\n  [K.NO_PERMISSION]: \"没有权限，无法获取页面所需要的资源\",\n  [K.PAGE_NOT_FOUND]: \"请求的页面未找到，请确认 URL 是否正确\",\n  [K.APP_NOT_FOUND]: \"请求的微应用无法找到, 可能是 URL 错误或者无权限访问\",\n  [K.UNKNOWN_ERROR]: \"糟糕！页面出现了一些问题\",\n  [K.GO_BACK_TO_PREVIOUS_PAGE]: \"回到上一页\",\n  [K.GO_BACK_HOME]: \"回到首页\",\n  [K.RELOAD]: \"刷新\"\n};\nexport const NS = \"core/runtime\";\nexport const locales = {\n  en,\n  zh\n};\n//# sourceMappingURL=i18n.js.map","let brick;\nfunction show(options) {\n  if (brick) {\n    return brick.resolve(options);\n  } else {\n    if (options.type === \"confirm\") {\n      const confirmed = confirm(options.content);\n      return new Promise((resolve, reject) => setTimeout(() => {\n        (confirmed ? resolve : reject)();\n      }, 1));\n    } else {\n      alert(options.content);\n      return new Promise(resolve => setTimeout(() => {\n        resolve();\n      }, 1));\n    }\n  }\n}\nexport function loadDialogService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load dialog service failed:\", error);\n  });\n}\nexport const Dialog = Object.freeze({\n  show\n});\n//# sourceMappingURL=Dialog.js.map","export function setLoginStateCookie(location) {\n  // 独立打包应用 登录时间超时后还是由前端控制跳转，后台无法处理设置登录前的 path 和 query 的 cookie 值\n  // 此这场景下前端做下处理\n\n  const {\n    search,\n    pathname\n  } = location;\n  const pathValue = pathname ? window.btoa(encodeURIComponent(pathname)) : \"\";\n  const searchValue = search ? window.btoa(encodeURIComponent(search)) : \"\";\n  document.cookie = `SALOGINPATH=${pathValue}; path=/`;\n  document.cookie = `SALOGINQUERY=${searchValue}; path=/`;\n}\n//# sourceMappingURL=setLoginStateCookie.js.map","import { HttpAbortError, HttpFetchError, HttpResponseError } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getRuntime } from \"./internal/Runtime.js\";\nimport { getHistory } from \"./history.js\";\nimport { K, NS } from \"./internal/i18n.js\";\nimport { Dialog } from \"./Dialog.js\";\nimport { setLoginStateCookie } from \"./setLoginStateCookie.js\";\n\n/**\n * 将 http 请求错误转换为可读的字符串。\n *\n * @remarks\n *\n * 将依次尝试读取返回的 JSON 格式数据的字符串类型的 `error` 和 `msg` 字段，如果没有找到则返回 `error.toString()` 的结果。\n *\n * @param error - 错误对象。\n *\n * @returns 转换为字符串的错误信息。\n */\nexport function httpErrorToString(error) {\n  if (error instanceof Event && error.target instanceof HTMLScriptElement) {\n    return error.target.src;\n  }\n  if (error instanceof HttpFetchError) {\n    return i18n.t(`${NS}:${K.NETWORK_ERROR}`);\n  }\n  if (error instanceof HttpResponseError) {\n    if (error.responseJson) {\n      if (typeof error.responseJson.error === \"string\") {\n        return error.responseJson.error;\n      } else if (typeof error.responseJson.msg === \"string\") {\n        return error.responseJson.msg;\n      }\n    }\n  }\n  if (error == null) {\n    return \"Unknown error\";\n  }\n  return error.toString();\n}\nexport function isUnauthenticatedError(error) {\n  return error instanceof HttpResponseError && error.response.status === 401 && !!error.responseJson && error.responseJson.code === 100003;\n}\nlet unauthenticatedConfirming = false;\nlet lastErrorMessage;\n\n/**\n * 处理 http 请求错误（使用 AntDesign 模态框弹出错误信息）。\n *\n * @param error - 错误对象。\n */\nexport function handleHttpError(error) {\n  // Do nothing if aborted http requests\n  if (error instanceof HttpAbortError) {\n    return;\n  }\n\n  // Redirect to login page if not logged in.\n  if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n    if (unauthenticatedConfirming) {\n      return;\n    }\n    unauthenticatedConfirming = true;\n    Dialog.show({\n      type: \"confirm\",\n      content: i18n.t(`${NS}:${K.LOGIN_TIMEOUT_MESSAGE}`)\n    }).then(() => {\n      redirectToLogin();\n      unauthenticatedConfirming = false;\n    }, () => {\n      unauthenticatedConfirming = false;\n    });\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.error(error);\n  const message = httpErrorToString(error);\n  if (message !== lastErrorMessage) {\n    lastErrorMessage = message;\n    Dialog.show({\n      type: \"error\",\n      title: i18n.t(`${NS}:${K.REQUEST_FAILED}`),\n      content: message,\n      contentStyle: {\n        whiteSpace: \"pre-wrap\",\n        wordBreak: \"break-word\"\n      }\n    }).then(() => {\n      lastErrorMessage = undefined;\n    });\n  }\n  return;\n}\nfunction redirectToLogin() {\n  const ssoEnabled = getRuntime().getFeatureFlags()[\"sso-enabled\"];\n  const history = getHistory();\n  setLoginStateCookie(history.location);\n  history.push(ssoEnabled ? \"/sso-auth/login\" : \"/auth/login\", {\n    from: {\n      ...history.location,\n      state: undefined\n    }\n  });\n}\n//# sourceMappingURL=handleHttpError.js.map","let brick;\nfunction show(options) {\n  if (brick) {\n    brick.resolve(options);\n  } else {\n    alert(options.message);\n  }\n}\nexport function loadNotificationService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load notification service failed:\", error);\n  });\n}\nexport const Notification = Object.freeze({\n  show\n});\n//# sourceMappingURL=Notification.js.map","import { isEvaluable } from \"@next-core/cook\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { checkIf } from \"./compute/checkIf.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { getHistory } from \"../history.js\";\nimport { getProviderBrick } from \"./data/getProviderBrick.js\";\nimport { startPoll } from \"./poll.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { setProperties } from \"./compute/setProperties.js\";\nimport { applyMode, applyTheme } from \"../themeAndMode.js\";\nimport { getTplHostElement, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { handleHttpError } from \"../handleHttpError.js\";\nimport { Notification } from \"../Notification.js\";\nimport { getFormStateStore } from \"./FormRenderer/utils.js\";\nimport { hooks } from \"./Runtime.js\";\nimport { startSSEStream } from \"./sse.js\";\nexport function bindListeners(brick, eventsMap, runtimeContext) {\n  if (!eventsMap) {\n    return;\n  }\n  Object.entries(eventsMap).forEach(_ref => {\n    let [eventType, handlers] = _ref;\n    const listener = listenerFactory(handlers, runtimeContext, {\n      element: brick\n    });\n    brick.addEventListener(eventType, listener);\n\n    // Remember added listeners for unbinding.\n    if (!brick.$$listeners) {\n      brick.$$listeners = [];\n    }\n    brick.$$listeners.push([eventType, listener]);\n\n    // Remember added listeners for devtools.\n    if (!brick.$$eventListeners) {\n      brick.$$eventListeners = [];\n    }\n    for (const handler of [].concat(handlers)) {\n      brick.$$eventListeners.push([eventType, null, handler]);\n    }\n  });\n}\nexport function unbindListeners(brick) {\n  if (brick.$$listeners) {\n    for (const [eventType, listener] of brick.$$listeners) {\n      brick.removeEventListener(eventType, listener);\n    }\n    brick.$$listeners.length = 0;\n  }\n}\nexport function isBuiltinHandler(handler) {\n  return typeof handler.action === \"string\";\n}\nexport function isUseProviderHandler(handler) {\n  return typeof handler.useProvider === \"string\";\n}\nexport function isCustomHandler(handler) {\n  return !!((handler.target || handler.targetRef) && (handler.method || handler.properties));\n}\nexport function isExecuteCustomHandler(handler) {\n  return !!handler.method;\n}\nexport function isSetPropsCustomHandler(handler) {\n  return !!handler.properties;\n}\nexport function isConditionalEventHandler(handler) {\n  return !!handler.then;\n}\nexport function listenerFactory(handlers, runtimeContext, runtimeBrick) {\n  return function (event) {\n    for (const handler of [].concat(handlers)) {\n      if (!checkIf(handler, {\n        ...runtimeContext,\n        event\n      })) {\n        if (handler.else) {\n          listenerFactory(handler.else, runtimeContext, runtimeBrick)(event);\n        }\n        continue;\n      }\n      if (isConditionalEventHandler(handler)) {\n        listenerFactory(handler.then, runtimeContext, runtimeBrick)(event);\n      } else if (isBuiltinHandler(handler)) {\n        const [object, method] = handler.action.split(\".\");\n        switch (handler.action) {\n          case \"history.push\":\n          case \"history.replace\":\n          case \"history.pushQuery\":\n          case \"history.replaceQuery\":\n          case \"history.pushAnchor\":\n          case \"history.block\":\n          case \"history.goBack\":\n          case \"history.goForward\":\n          case \"history.reload\":\n          case \"history.unblock\":\n            handleHistoryAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n\n          // case \"segue.push\":\n          // case \"segue.replace\":\n          // case \"alias.push\":\n          // case \"alias.replace\":\n\n          case \"window.open\":\n            handleWindowOpenAction(event, handler.args, runtimeContext);\n            break;\n          case \"window.postMessage\":\n            handleWindowPostMessageAction(event, handler.args, runtimeContext);\n            break;\n          case \"parent.postMessage\":\n            handleParentPostMessageAction(event, handler.args, runtimeContext);\n            break;\n          case \"location.reload\":\n          case \"location.assign\":\n            handleLocationAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"localStorage.setItem\":\n          case \"localStorage.removeItem\":\n          case \"sessionStorage.setItem\":\n          case \"sessionStorage.removeItem\":\n            handleStorageAction(event, object, method, handler.args, runtimeContext);\n            break;\n          case \"event.preventDefault\":\n            event.preventDefault();\n            break;\n          case \"event.stopPropagation\":\n            event.stopPropagation();\n            break;\n          case \"console.log\":\n          case \"console.error\":\n          case \"console.warn\":\n          case \"console.info\":\n            handleConsoleAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"message.success\":\n          case \"message.error\":\n          case \"message.info\":\n          case \"message.warn\":\n            handleMessageAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"handleHttpError\":\n            handleHttpError(event.detail);\n            break;\n          case \"context.assign\":\n          case \"context.replace\":\n          case \"context.refresh\":\n          case \"context.load\":\n            handleContextAction(event, method, handler.args, handler.batch ?? true, handler.callback, runtimeContext);\n            break;\n          case \"state.update\":\n          case \"state.refresh\":\n          case \"state.load\":\n            handleTplStateAction(event, method, handler.args, handler.batch ?? true, handler.callback, runtimeContext);\n            break;\n          case \"tpl.dispatchEvent\":\n            {\n              const [type, init] = argsFactory(handler.args, runtimeContext, event);\n              const tplHostElement = getTplHostElement(runtimeContext, handler.action, `: ${type}`);\n              tplHostElement.dispatchEvent(new CustomEvent(type, init));\n              break;\n            }\n          case \"formstate.update\":\n            handleFormStateAction(event, handler.args, handler.callback, runtimeContext);\n            break;\n          case \"message.subscribe\":\n          case \"message.unsubscribe\":\n            handleMessageDispatcher(event, method, handler.args, runtimeContext, runtimeBrick, handler.callback);\n            break;\n          case \"theme.setDarkTheme\":\n          case \"theme.setLightTheme\":\n            applyTheme(handler.action === \"theme.setDarkTheme\" ? \"dark\" : \"light\");\n            break;\n          case \"theme.setTheme\":\n            {\n              const [theme] = argsFactory(handler.args, runtimeContext, event);\n              applyTheme(theme);\n              break;\n            }\n          case \"mode.setDashboardMode\":\n          case \"mode.setDefaultMode\":\n            applyMode(handler.action === \"mode.setDashboardMode\" ? \"dashboard\" : \"default\");\n            break;\n\n          // case \"menu.clearMenuTitleCache\":\n          // case \"menu.clearMenuCache\":\n\n          // case \"analytics.event\":\n\n          // case \"preview.debug\":\n\n          default:\n            // eslint-disable-next-line no-console\n            console.error(\"unknown event listener action:\", handler.action);\n        }\n      } else if (isUseProviderHandler(handler)) {\n        handleUseProviderAction(event, handler, runtimeContext, runtimeBrick);\n      } else if (isCustomHandler(handler)) {\n        handleCustomAction(event, handler, runtimeContext, runtimeBrick);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"unknown event handler:\", handler);\n      }\n    }\n  };\n}\nfunction handleUseProviderAction(event, handler, runtimeContext, runtimeBrick) {\n  const method = handler.method !== \"saveAs\" ? \"resolve\" : \"saveAs\";\n  brickCallback(event, handler.useProvider, handler, method, runtimeContext, runtimeBrick);\n}\nfunction handleCustomAction(event, handler, runtimeContext, runtimeBrick) {\n  let targets = [];\n  const rawTarget = handler.target;\n  const rawTargetRef = handler.targetRef;\n  let computedTarget = rawTarget;\n  // Allow `target` to be set as evaluable string.\n  if (typeof rawTarget === \"string\" ? isEvaluable(rawTarget) : isPreEvaluated(rawTarget)) {\n    computedTarget = computeRealValue(rawTarget, {\n      ...runtimeContext,\n      event\n    });\n  }\n  if (typeof computedTarget === \"string\") {\n    if (computedTarget === \"_self\") {\n      targets.push(runtimeBrick.element);\n    } else if (handler.multiple) {\n      targets = Array.from(document.querySelectorAll(computedTarget));\n    } else {\n      const found = document.querySelector(computedTarget);\n      if (found !== null) {\n        targets.push(found);\n      }\n    }\n  } else if (computedTarget) {\n    if (computedTarget instanceof HTMLElement) {\n      targets.push(computedTarget);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(\"unexpected target:\", computedTarget);\n    }\n  } else if (rawTargetRef) {\n    let computedTargetRef = rawTargetRef;\n    // Allow `targetRef` to be set as evaluable string.\n    if (typeof rawTargetRef === \"string\" ? isEvaluable(rawTargetRef) : isPreEvaluated(rawTargetRef)) {\n      computedTargetRef = computeRealValue(rawTargetRef, {\n        ...runtimeContext,\n        event\n      });\n    }\n    const targetRefs = [].concat(computedTargetRef);\n    const tplHostElement = getTplHostElement(runtimeContext, \"targetRef\", `: ${targetRefs.join(\", \")}`);\n    targets.push(...targetRefs.map(ref => {\n      var _tplHostElement$$$get;\n      return (_tplHostElement$$$get = tplHostElement.$$getElementByRef) === null || _tplHostElement$$$get === void 0 ? void 0 : _tplHostElement$$$get.call(tplHostElement, ref);\n    }).filter(Boolean));\n  }\n  if (targets.length === 0) {\n    // eslint-disable-next-line no-console\n    console.error(\"target not found:\", rawTarget || rawTargetRef);\n    return;\n  }\n  if (isExecuteCustomHandler(handler)) {\n    targets.forEach(target => {\n      brickCallback(event, target, handler, handler.method, runtimeContext, runtimeBrick, {\n        useEventAsDefault: true\n      });\n    });\n  } else if (isSetPropsCustomHandler(handler)) {\n    setProperties(targets, handler.properties, {\n      ...runtimeContext,\n      event\n    });\n  }\n}\nasync function brickCallback(event, targetOrProvider, handler, method, runtimeContext, runtimeBrick, options) {\n  const isProvider = isUseProviderHandler(handler);\n  const task = async () => {\n    var _hooks$flowApi;\n    const realTarget = isProvider ? await getProviderBrick(targetOrProvider) : targetOrProvider;\n    if (typeof realTarget[method] !== \"function\") {\n      throw new Error(`target <${realTarget.tagName.toLowerCase()}> has no method: ${method}`);\n    }\n    let computedArgs = argsFactory(handler.args, runtimeContext, event, options);\n    if (isUseProviderHandler(handler) && hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(handler.useProvider)) {\n      var _handler$sse;\n      computedArgs = await hooks.flowApi.getArgsOfFlowApi(handler.useProvider, computedArgs, method, (_handler$sse = handler.sse) === null || _handler$sse === void 0 ? void 0 : _handler$sse.stream);\n    }\n    return realTarget[method](...computedArgs);\n  };\n  if (!handler.callback) {\n    task();\n    return;\n  }\n  const callbackFactory = eventCallbackFactory(handler.callback, runtimeContext, runtimeBrick);\n  const pollableCallback = {\n    progress: callbackFactory(\"progress\"),\n    success: callbackFactory(\"success\"),\n    error: callbackFactory(\"error\"),\n    finally: callbackFactory(\"finally\")\n  };\n  if (isProvider) {\n    var _handler$sse2, _handler$poll;\n    const pollRuntimeContext = {\n      ...runtimeContext,\n      event\n    };\n    const sseStream = computeRealValue((_handler$sse2 = handler.sse) === null || _handler$sse2 === void 0 ? void 0 : _handler$sse2.stream, pollRuntimeContext);\n    if (sseStream) {\n      startSSEStream(task, pollableCallback);\n      return;\n    }\n    const pollEnabled = computeRealValue((_handler$poll = handler.poll) === null || _handler$poll === void 0 ? void 0 : _handler$poll.enabled, pollRuntimeContext);\n    if (pollEnabled) {\n      startPoll(task, pollableCallback, handler.poll, pollRuntimeContext);\n      return;\n    }\n  }\n  try {\n    // Try to catch synchronized tasks too.\n    const result = await task();\n    pollableCallback.success(result);\n  } catch (err) {\n    pollableCallback.error(err);\n  } finally {\n    pollableCallback[\"finally\"]();\n  }\n}\nfunction handleHistoryAction(event, method, args, callback, runtimeContext) {\n  let baseArgsLength = 0;\n  let hasCallback = false;\n  let overrideMethod = method;\n  switch (method) {\n    case \"push\":\n    case \"replace\":\n    case \"pushQuery\":\n    case \"replaceQuery\":\n    case \"pushAnchor\":\n      baseArgsLength = 2;\n      hasCallback = true;\n      break;\n    case \"reload\":\n      hasCallback = true;\n      break;\n    case \"block\":\n      baseArgsLength = 1;\n      overrideMethod = \"setBlockMessage\";\n      break;\n  }\n  let computedArgs = [];\n  if (baseArgsLength > 0) {\n    computedArgs = argsFactory(args, runtimeContext, event, {\n      useEventDetailAsDefault: true\n    });\n    computedArgs.length = baseArgsLength;\n  }\n  if (hasCallback && callback) {\n    const callbackFactory = eventCallbackFactory(callback, runtimeContext, undefined);\n    computedArgs.push(blocked => {\n      callbackFactory(blocked ? \"error\" : \"success\")({\n        blocked\n      });\n      callbackFactory(\"finally\")({\n        blocked\n      });\n    });\n  }\n  getHistory()[overrideMethod](...computedArgs);\n}\nfunction handleWindowOpenAction(event, args, runtimeContext) {\n  const [url, target, features] = argsFactory(args, runtimeContext, event);\n  window.open(url, target || \"_self\", features);\n}\nfunction handleWindowPostMessageAction(event, args, runtimeContext) {\n  const computedArgs = argsFactory(args, runtimeContext, event);\n  if (computedArgs.length === 1) {\n    // Add default target origin\n    computedArgs.push(location.origin);\n  }\n  window.postMessage(...computedArgs);\n}\nfunction handleParentPostMessageAction(event, args, runtimeContext) {\n  if (parent === window) {\n    throw new Error(\"parent is the window itself\");\n  }\n  const computedArgs = argsFactory(args, runtimeContext, event);\n  parent.postMessage(...computedArgs);\n}\nfunction batchUpdate(args, batch, method, store, runtimeContext, event) {\n  if (batch) {\n    store.updateValues(args, method, arg => {\n      return argsFactory(arg, runtimeContext, event)[0];\n    });\n  } else {\n    args.forEach(arg => {\n      const {\n        name,\n        value\n      } = argsFactory([arg], runtimeContext, event)[0];\n      store.updateValue(name, value, method);\n    });\n  }\n}\nfunction handleContextAction(event, method, args, batch, callback, runtimeContext) {\n  const isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && (method === \"assign\" || method === \"replace\")) {\n    batchUpdate(args, batch, method, runtimeContext.ctxStore, runtimeContext, event);\n  } else {\n    const [name, value] = argsFactory(args, runtimeContext, event);\n    runtimeContext.ctxStore.updateValue(name, value, method, callback, runtimeContext);\n  }\n}\nfunction handleTplStateAction(event, method, args, batch, callback, runtimeContext) {\n  const isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && method === \"update\") {\n    const tplStateStore = getTplStateStore(runtimeContext, `state.${method}`, `: ${JSON.stringify(args)}`);\n    batchUpdate(args, batch, \"replace\", tplStateStore, runtimeContext, event);\n  } else {\n    const [name, value] = argsFactory(args, runtimeContext, event);\n    const tplStateStore = getTplStateStore(runtimeContext, `state.${method}`, `: ${name}`);\n    tplStateStore.updateValue(name, value, method === \"update\" ? \"replace\" : method, callback, runtimeContext);\n  }\n}\nfunction handleFormStateAction(event, args, callback, runtimeContext) {\n  const [name, value] = argsFactory(args, runtimeContext, event);\n  const formStateStore = getFormStateStore(runtimeContext, \"formstate.update\", `: ${name}`);\n  formStateStore.updateValue(name, value, \"replace\", callback, runtimeContext);\n}\nfunction handleLocationAction(event, method, args, runtimeContext) {\n  if (method === \"assign\") {\n    const [url] = argsFactory(args, runtimeContext, event);\n    location.assign(url);\n  } else {\n    location[method]();\n  }\n}\nfunction handleStorageAction(event, object, method, args, runtimeContext) {\n  const storage = object === \"localStorage\" ? localStorage : sessionStorage;\n  const [name, value] = argsFactory(args, runtimeContext, event);\n  if (method === \"setItem\") {\n    if (value !== undefined) {\n      storage.setItem(name, JSON.stringify(value));\n    }\n  } else {\n    storage.removeItem(name);\n  }\n}\nfunction handleConsoleAction(event, method, args, runtimeContext) {\n  // eslint-disable-next-line no-console\n  console[method](...argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  }));\n}\nfunction handleMessageAction(event, method, args, runtimeContext) {\n  const computedArgs = argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  });\n  Notification.show({\n    type: method,\n    message: computedArgs[0]\n  });\n}\nasync function handleMessageDispatcher(event, method, args, runtimeContext, runtimeBrick, callback) {\n  const task = () => {\n    var _hooks$messageDispatc;\n    const computedArgs = argsFactory(args, runtimeContext, event);\n    return hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 ? void 0 : _hooks$messageDispatc[method](...computedArgs);\n  };\n  if (!callback) {\n    task();\n    return;\n  }\n  const callbackFactory = eventCallbackFactory(callback, runtimeContext, runtimeBrick);\n  try {\n    const result = await task();\n    callbackFactory(\"success\")(result);\n  } catch (error) {\n    callbackFactory(\"error\")(error);\n  } finally {\n    callbackFactory(\"finally\")();\n  }\n}\nexport function eventCallbackFactory(callback, runtimeContext, runtimeBrick) {\n  return function callbackFactory(type) {\n    return function (result) {\n      const handlers = callback === null || callback === void 0 ? void 0 : callback[type];\n      if (handlers) {\n        try {\n          const event = new CustomEvent(`callback.${type}`, {\n            detail: result\n          });\n          listenerFactory(handlers, runtimeContext, runtimeBrick)(event);\n        } catch (err) {\n          // Do not throw errors in `callback.success` or `callback.progress`,\n          // to avoid the following triggering of `callback.error`.\n          // eslint-disable-next-line\n          console.error(err);\n        }\n      } else if (type === \"error\") {\n        // eslint-disable-next-line\n        console.error(\"Unhandled callback error:\", result);\n      }\n    };\n  };\n}\nfunction argsFactory(args, runtimeContext, event) {\n  let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return Array.isArray(args) ? computeRealValue(args, {\n    ...runtimeContext,\n    event\n  }) : options.useEventAsDefault ? [event] : options.useEventDetailAsDefault ? [event.detail] : [];\n}\n//# sourceMappingURL=bindListeners.js.map","import { _internalApiGetRenderId } from \"./Runtime.js\";\nexport async function startSSEStream(task, _ref) {\n  let {\n    progress,\n    success,\n    error,\n    finally: finallyCallback\n  } = _ref;\n  const currentRenderId = _internalApiGetRenderId();\n  try {\n    const stream = await task();\n    for await (const value of stream) {\n      if (currentRenderId !== _internalApiGetRenderId()) {\n        return;\n      }\n      progress === null || progress === void 0 || progress(value);\n    }\n    if (currentRenderId !== _internalApiGetRenderId()) {\n      return;\n    }\n    success === null || success === void 0 || success();\n  } catch (e) {\n    if (currentRenderId !== _internalApiGetRenderId()) {\n      return;\n    }\n    error === null || error === void 0 || error(e);\n  } finally {\n    finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n  }\n}\n//# sourceMappingURL=sse.js.map","import { getTplStateStore } from \"./utils.js\";\nexport function bindTemplateProxy(brick) {\n  var _tplHostMetadata$prox;\n  const {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n\n  // Error recovering brick may have no runtimeContext.\n  if (!ref || !runtimeContext.tplStateStoreId) {\n    return;\n  }\n  const {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"bindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.set(ref, brick);\n  const events = (_tplHostMetadata$prox = tplHostMetadata.proxy) === null || _tplHostMetadata$prox === void 0 ? void 0 : _tplHostMetadata$prox.events;\n  if (events) {\n    for (const [from, to] of Object.entries(events)) {\n      if (to.ref === ref) {\n        var _ref;\n        const listener = e => {\n          if (e.bubbles) {\n            e.stopPropagation();\n          }\n          hostBrick.element.dispatchEvent(new CustomEvent(from, {\n            detail: e.detail,\n            bubbles: e.bubbles,\n            cancelable: e.cancelable,\n            composed: e.composed\n          }));\n        };\n        const eventType = to.refEvent ?? from;\n        element.addEventListener(eventType, listener);\n        (_ref = element).$$proxyListeners ?? (_ref.$$proxyListeners = []);\n        element.$$proxyListeners.push([eventType, listener]);\n      }\n    }\n  }\n}\nexport function unbindTemplateProxy(brick) {\n  const {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n  if (!(runtimeContext !== null && runtimeContext !== void 0 && runtimeContext.tplStateStoreId) || !ref) {\n    return;\n  }\n  const {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"unbindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.delete(ref);\n  for (const [type, fn] of element.$$proxyListeners ?? []) {\n    element.removeEventListener(type, fn);\n  }\n  delete element.$$proxyListeners;\n}\n//# sourceMappingURL=bindTemplateProxy.js.map","export let RenderTag = /*#__PURE__*/function (RenderTag) {\n  RenderTag[RenderTag[\"ROOT\"] = 1] = \"ROOT\";\n  RenderTag[RenderTag[\"BRICK\"] = 2] = \"BRICK\";\n  RenderTag[RenderTag[\"PLACEHOLDER\"] = 3] = \"PLACEHOLDER\";\n  return RenderTag;\n}({});\n//# sourceMappingURL=enums.js.map","import { bindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { bindListeners } from \"./bindListeners.js\";\nimport { setRealProperties } from \"./compute/setRealProperties.js\";\nimport { RenderTag } from \"./enums.js\";\nexport function unmountTree(mountPoint) {\n  mountPoint.replaceChildren();\n}\nexport function mountTree(root, initializedElement) {\n  window.DISABLE_REACT_FLUSH_SYNC = false;\n  let current = root.child;\n  const portalElements = [];\n  while (current) {\n    if (current.tag === RenderTag.BRICK) {\n      var _current$tplHostMetad;\n      const tagName = current.type;\n      if (tagName.includes(\"-\") && !customElements.get(tagName)) {\n        // eslint-disable-next-line no-console\n        console.error(`Undefined custom element: ${tagName}`);\n      }\n\n      // istanbul ignore if\n      if (tagName === \"basic-bricks.script-brick\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"`basic-bricks.script-brick` is deprecated, please take caution when using it\");\n      }\n      const element = initializedElement && current === root.child ? initializedElement : document.createElement(tagName);\n      current.element = element;\n      if (current.slotId) {\n        element.setAttribute(\"slot\", current.slotId);\n      }\n      if (current.iid) {\n        element.dataset.iid = current.iid;\n      }\n      if ((_current$tplHostMetad = current.tplHostMetadata) !== null && _current$tplHostMetad !== void 0 && _current$tplHostMetad.tplStateStoreId) {\n        element.dataset.tplStateStoreId = current.tplHostMetadata.tplStateStoreId;\n      }\n      setRealProperties(element, current.properties);\n      bindListeners(element, current.events, current.runtimeContext);\n      if (current.tplHostMetadata) {\n        // 先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n        // 避免初始化的一次 state update 操作及其 onChange 事件。\n        element.$$tplStateStore = getTplStateStore({\n          tplStateStoreId: current.tplHostMetadata.tplStateStoreId,\n          tplStateStoreMap: current.runtimeContext.tplStateStoreMap\n        }, \"mount\");\n      }\n      bindTemplateProxy(current);\n      if (current.portal) {\n        portalElements.push(element);\n      } else if (current.return) {\n        if (!current.return.childElements) {\n          current.return.childElements = [];\n        }\n        current.return.childElements.push(element);\n      }\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      let currentReturn = current.return;\n      while (currentReturn) {\n        // Append elements inside out\n        if (currentReturn.childElements) {\n          if (currentReturn.tag === RenderTag.ROOT) {\n            var _currentReturn$contai;\n            (_currentReturn$contai = currentReturn.container) === null || _currentReturn$contai === void 0 || _currentReturn$contai.append(...currentReturn.childElements);\n          } else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            currentReturn.element.append(...currentReturn.childElements);\n          }\n          currentReturn.childElements = undefined;\n        }\n        if (currentReturn.tag === RenderTag.ROOT && portalElements.length > 0) {\n          const portal = typeof currentReturn.createPortal === \"function\" ? currentReturn.createPortal() : currentReturn.createPortal;\n          portal.append(...portalElements);\n        }\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n  setTimeout(() => {\n    window.DISABLE_REACT_FLUSH_SYNC = true;\n  });\n}\n//# sourceMappingURL=mount.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _assertClassBrand from \"@babel/runtime/helpers/assertClassBrand\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet2\";\nimport { isEmpty, remove } from \"lodash\";\nimport { listenerFactory } from \"./bindListeners.js\";\nimport { getHistory } from \"../history.js\";\nimport { getReadOnlyProxy } from \"./proxyFactories.js\";\nimport { mediaEventTarget } from \"./mediaQuery.js\";\nimport { mountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { unbindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { hooks } from \"./Runtime.js\";\nconst commonLifeCycles = [\"onMount\", \"onUnmount\", \"onMediaChange\", \"onScrollIntoView\", \"onMessage\", \"onMessageClose\"];\nconst pageOnlyLifeCycles = [\"onBeforePageLoad\", \"onPageLoad\", \"onPageLeave\", \"onBeforePageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nvar _routeHelper = /*#__PURE__*/new WeakMap();\nvar _memoizedLifeCycle = /*#__PURE__*/new WeakMap();\nvar _observers = /*#__PURE__*/new WeakMap();\nvar _mediaListener = /*#__PURE__*/new WeakMap();\nvar _arbitraryLifeCycle = /*#__PURE__*/new WeakMap();\nvar _memoized = /*#__PURE__*/new WeakMap();\nvar _initialMenuRequestNode = /*#__PURE__*/new WeakMap();\nvar _memoizedMenuRequestNodeMap = /*#__PURE__*/new WeakMap();\nvar _incrementalRenderStates = /*#__PURE__*/new WeakMap();\nvar _RendererContext_brand = /*#__PURE__*/new WeakSet();\nexport class RendererContext {\n  constructor(scope, options) {\n    _classPrivateMethodInitSpec(this, _RendererContext_brand);\n    /**\n     * - page: render as whole page, triggering page life cycles.\n     * - fragment: render as fragment, not triggering page life cycles.\n     */\n    _defineProperty(this, \"scope\", void 0);\n    _defineProperty(this, \"unknownBricks\", void 0);\n    _defineProperty(this, \"renderId\", void 0);\n    _classPrivateFieldInitSpec(this, _routeHelper, void 0);\n    _classPrivateFieldInitSpec(this, _memoizedLifeCycle, {\n      onBeforePageLoad: [],\n      onPageLoad: [],\n      onPageLeave: [],\n      onBeforePageLeave: [],\n      onAnchorLoad: [],\n      onAnchorUnload: [],\n      onMediaChange: [],\n      onScrollIntoView: [],\n      onMount: [],\n      onUnmount: [],\n      onMessage: [],\n      onMessageClose: []\n    });\n    _classPrivateFieldInitSpec(this, _observers, new Map());\n    _classPrivateFieldInitSpec(this, _mediaListener, void 0);\n    _classPrivateFieldInitSpec(this, _arbitraryLifeCycle, new Map());\n    _classPrivateFieldInitSpec(this, _memoized, void 0);\n    _classPrivateFieldInitSpec(this, _initialMenuRequestNode, void 0);\n    _classPrivateFieldInitSpec(this, _memoizedMenuRequestNodeMap, new WeakMap());\n    _classPrivateFieldInitSpec(this, _incrementalRenderStates, new Map());\n    this.scope = scope;\n    this.unknownBricks = (options === null || options === void 0 ? void 0 : options.unknownBricks) ?? \"throw\";\n    _classPrivateFieldSet(_routeHelper, this, options === null || options === void 0 ? void 0 : options.routeHelper);\n    this.renderId = options === null || options === void 0 ? void 0 : options.renderId;\n  }\n  setInitialMenuRequestNode(menuRequestNode) {\n    _classPrivateFieldSet(_initialMenuRequestNode, this, menuRequestNode);\n  }\n  memoizeMenuRequestNode(routes, menuRequestNode) {\n    _classPrivateFieldGet(_memoizedMenuRequestNodeMap, this).set(routes, menuRequestNode);\n  }\n  getMenuRequests() {\n    const menuRequests = [];\n    let current = _classPrivateFieldGet(_initialMenuRequestNode, this);\n    while (current) {\n      if (current.request) {\n        menuRequests.push(current.request);\n      }\n      if (current.child) {\n        current = current.child;\n      } else {\n        var _current;\n        while (current && !current.sibling) {\n          current = current.return;\n        }\n        current = (_current = current) === null || _current === void 0 ? void 0 : _current.sibling;\n      }\n    }\n    return menuRequests;\n  }\n  async reMergeMenuRequestNodes(parentMenuRequestNode, routes) {\n    let menuRequestNode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    const node = _classPrivateFieldGet(_memoizedMenuRequestNodeMap, this).get(routes);\n    _classPrivateFieldGet(_memoizedMenuRequestNodeMap, this).set(routes, menuRequestNode);\n    let current = parentMenuRequestNode.child;\n    let previousSibling;\n    while (current) {\n      if (current === node) {\n        break;\n      }\n      previousSibling = current;\n      current = current.sibling;\n    }\n    if (previousSibling) {\n      previousSibling.sibling = menuRequestNode;\n      menuRequestNode.sibling = node === null || node === void 0 ? void 0 : node.sibling;\n    } else {\n      parentMenuRequestNode.child = menuRequestNode;\n    }\n    await _classPrivateFieldGet(_routeHelper, this).mergeMenus(this.getMenuRequests());\n  }\n  reBailout(output) {\n    return _classPrivateFieldGet(_routeHelper, this).bailout(output);\n  }\n\n  /**\n   * Will always resolve\n   */\n  reCatch(error, returnNode) {\n    return _classPrivateFieldGet(_routeHelper, this).catch(error, returnNode, false, true);\n  }\n  async didPerformIncrementalRender(location, prevLocation) {\n    let finalResult = false;\n    const shouldIgnoreRoutes = [];\n    // Perform incremental rendering from inside out.\n    // This allows nested incremental sub-routes.\n    for (const {\n      parentRoutes,\n      callback\n    } of [..._classPrivateFieldGet(_incrementalRenderStates, this).values()].reverse()) {\n      const parentRoute = parentRoutes[parentRoutes.length - 1];\n      if (shouldIgnoreRoutes.includes(parentRoute)) {\n        // Do not re-render parent routes if any of its children has performed incremental rendering.\n        // In the meantime, allow sibling-routes to perform incremental rendering.\n        continue;\n      }\n      const result = await callback(location, prevLocation);\n      // When result is null, it means the incremental rendering is tried but routes missed.\n      // In this case, we should continue to re-render the parent routes.\n      if (result) {\n        shouldIgnoreRoutes.push(...parentRoutes.slice(0, -1));\n      }\n      // Mark incremental rendering as performed at final if result is true or null.\n      if (result !== false) {\n        finalResult = true;\n      }\n    }\n    return finalResult;\n  }\n\n  /**\n   * When `callback` resolved to `true` which means incremental rendering is performed,\n   * ignore normal rendering.\n   */\n  performIncrementalRender(slotConf, parentRoutes, callback) {\n    // Override stale incremental render callbacks\n    _classPrivateFieldGet(_incrementalRenderStates, this).set(slotConf, {\n      parentRoutes,\n      callback\n    });\n  }\n  registerBrickLifeCycle(brick, lifeCycle) {\n    if (!lifeCycle) {\n      return;\n    }\n    const lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n    for (const key of lifeCycleTypes) {\n      const handlers = lifeCycle[key];\n      if (handlers) {\n        _classPrivateFieldGet(_memoizedLifeCycle, this)[key].push({\n          brick,\n          handlers: handlers\n        });\n      }\n    }\n    // istanbul ignore next\n    if (!isEmpty(lifeCycle.useResolves)) {\n      // eslint-disable-next-line no-console\n      console.error(\"`lifeCycle.useResolves` is dropped in v3:\", lifeCycle);\n    }\n  }\n  registerArbitraryLifeCycle(lifeCycle, fn) {\n    const arbitraryCallbacks = _classPrivateFieldGet(_arbitraryLifeCycle, this).get(lifeCycle);\n    if (arbitraryCallbacks) {\n      arbitraryCallbacks.add(fn);\n    } else {\n      _classPrivateFieldGet(_arbitraryLifeCycle, this).set(lifeCycle, new Set([fn]));\n    }\n  }\n  memoize(slotId, keyPath, node, returnNode) {\n    if (!_classPrivateFieldGet(_memoized, this)) {\n      _classPrivateFieldSet(_memoized, this, new WeakMap());\n    }\n    const memKey = [slotId ?? \"\", ...keyPath].join(\".\");\n    let mem = _classPrivateFieldGet(_memoized, this).get(returnNode);\n    if (!mem) {\n      mem = new Map();\n      _classPrivateFieldGet(_memoized, this).set(returnNode, mem);\n    }\n    mem.set(memKey, {\n      node,\n      last: getLastNode(node),\n      lastNormal: getLastNormalNode(node),\n      lastPortal: getLastPortalNode(node)\n    });\n  }\n  reRender(slotId, keyPath, node, returnNode) {\n    const memKey = [slotId ?? \"\", ...keyPath].join(\".\");\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const memoized = _classPrivateFieldGet(_memoized, this).get(returnNode).get(memKey);\n    const {\n      node: prevNode,\n      last: prevLast,\n      lastNormal: prevLastNormal,\n      lastPortal: prevLastPortal\n    } = memoized;\n    let insertBeforeChild;\n    const insertPortalBeforeChildCandidates = [];\n    if ((prevNode === null || prevNode === void 0 ? void 0 : prevNode.tag) === RenderTag.PLACEHOLDER) {\n      var _getNextNormalNode, _getNextPortalNode;\n      insertBeforeChild = ((_getNextNormalNode = getNextNormalNode(prevNode)) === null || _getNextNormalNode === void 0 ? void 0 : _getNextNormalNode.element) ?? null;\n      // Todo(steve): handle portal bricks from useBrick.\n      const nextSibling = (_getNextPortalNode = getNextPortalNode(prevNode)) === null || _getNextPortalNode === void 0 ? void 0 : _getNextPortalNode.element;\n      if (nextSibling) {\n        insertPortalBeforeChildCandidates.push(nextSibling);\n      }\n    } else {\n      var _prevLastNormal$eleme, _prevLastPortal$eleme;\n      insertBeforeChild = (prevLastNormal === null || prevLastNormal === void 0 || (_prevLastNormal$eleme = prevLastNormal.element) === null || _prevLastNormal$eleme === void 0 ? void 0 : _prevLastNormal$eleme.nextSibling) ?? null;\n      let nextSibling = prevLastPortal === null || prevLastPortal === void 0 || (_prevLastPortal$eleme = prevLastPortal.element) === null || _prevLastPortal$eleme === void 0 ? void 0 : _prevLastPortal$eleme.nextSibling;\n      while (nextSibling) {\n        insertPortalBeforeChildCandidates.push(nextSibling);\n        // Collect all portal bricks from useBrick, until found a normal portal\n        // brick other than from useBrick.\n        // Because useBrick could be removed during unmount.\n        if (!(nextSibling instanceof HTMLElement && nextSibling.tagName === \"DIV\")) {\n          break;\n        }\n        nextSibling = nextSibling.nextSibling;\n      }\n    }\n    const last = getLastNode(node);\n    memoized.node = node;\n    memoized.last = last;\n    memoized.lastNormal = getLastNormalNode(node);\n    memoized.lastPortal = getLastPortalNode(node);\n\n    // Figure out the unchanged prev sibling and next sibling\n    let prevSibling;\n    let current = returnNode.child;\n    while (current && current !== prevLast) {\n      if (current.sibling === prevNode) {\n        prevSibling = current;\n        break;\n      }\n      current = current.sibling;\n    }\n    const fragment = document.createDocumentFragment();\n    const portalFragment = document.createDocumentFragment();\n    const renderRoot = {\n      tag: RenderTag.ROOT,\n      container: fragment,\n      createPortal: portalFragment,\n      child: node\n    };\n\n    // Override `return`\n    current = node;\n    while (current) {\n      current.return = renderRoot;\n      current = current.sibling;\n    }\n\n    // Unmount previous bricks, including their descendants\n    const removeBricks = getBrickRange(prevNode, prevLast);\n    _assertClassBrand(_RendererContext_brand, this, _unmountBricks).call(this, removeBricks);\n    mountTree(renderRoot);\n\n    // Connect back\n    if (prevSibling) {\n      prevSibling.sibling = node;\n    } else {\n      returnNode.child = node;\n    }\n    if (last) {\n      last.sibling = prevLast === null || prevLast === void 0 ? void 0 : prevLast.sibling;\n    }\n\n    // Resume `return`\n    current = node;\n    while (current) {\n      current.return = returnNode;\n      current = current.sibling;\n    }\n    if (fragment.hasChildNodes()) {\n      if (returnNode.tag === RenderTag.ROOT) {\n        var _returnNode$container;\n        (_returnNode$container = returnNode.container) === null || _returnNode$container === void 0 || _returnNode$container.insertBefore(fragment, insertBeforeChild);\n      } else {\n        var _returnNode$element;\n        (_returnNode$element = returnNode.element) === null || _returnNode$element === void 0 || _returnNode$element.insertBefore(fragment, insertBeforeChild);\n      }\n    }\n    if (portalFragment.hasChildNodes()) {\n      var _root;\n      let root = node;\n      while (root && root.return) {\n        root = root.return;\n      }\n      // istanbul ignore next\n      if (((_root = root) === null || _root === void 0 ? void 0 : _root.tag) !== RenderTag.ROOT) {\n        throw new Error(\"Cannot find render root node. This is a bug of Brick Next, please report it.\");\n      }\n      const portal = typeof root.createPortal === \"function\" ? root.createPortal() : root.createPortal;\n      let insertPortalBeforeChild = null;\n      for (const candidate of insertPortalBeforeChildCandidates) {\n        // Those candidates from useBrick could be removed during unmount.\n        // So we need to check if they are still in the portal.\n        if (portal.contains(candidate)) {\n          insertPortalBeforeChild = candidate;\n          break;\n        }\n      }\n      portal.insertBefore(portalFragment, insertPortalBeforeChild);\n    }\n    const newBricks = getBrickRange(node, last);\n    _assertClassBrand(_RendererContext_brand, this, _initializeRerenderBricks).call(this, newBricks);\n  }\n  dispose() {\n    for (const list of Object.values(_classPrivateFieldGet(_memoizedLifeCycle, this))) {\n      list.length = 0;\n    }\n    for (const list of _classPrivateFieldGet(_observers, this).values()) {\n      for (const observer of list) {\n        observer.disconnect();\n      }\n      list.length = 0;\n    }\n    _classPrivateFieldGet(_observers, this).clear();\n    if (_classPrivateFieldGet(_mediaListener, this)) {\n      mediaEventTarget.removeEventListener(\"change\", _classPrivateFieldGet(_mediaListener, this));\n      _classPrivateFieldSet(_mediaListener, this, undefined);\n    }\n    _classPrivateFieldSet(_memoized, this, undefined);\n    _classPrivateFieldGet(_arbitraryLifeCycle, this).clear();\n    _classPrivateFieldGet(_incrementalRenderStates, this).clear();\n    _classPrivateFieldSet(_memoizedMenuRequestNodeMap, this, undefined);\n  }\n\n  // Note: no `onScrollIntoView` and `onMessage`\n\n  dispatchBeforePageLoad() {\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onBeforePageLoad\", new CustomEvent(\"page.beforeLoad\"));\n  }\n  dispatchPageLoad() {\n    const event = new CustomEvent(\"page.load\");\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onPageLoad\", event);\n    // Currently only for e2e testing\n    window.dispatchEvent(event);\n  }\n  dispatchBeforePageLeave(detail) {\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onBeforePageLeave\", new CustomEvent(\"page.beforeLeave\", {\n      detail\n    }));\n  }\n  dispatchPageLeave() {\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onPageLeave\", new CustomEvent(\"page.leave\"));\n  }\n  dispatchAnchorLoad() {\n    const {\n      hash\n    } = getHistory().location;\n    if (hash && hash !== \"#\") {\n      _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onAnchorLoad\", new CustomEvent(\"anchor.load\", {\n        detail: {\n          hash,\n          anchor: hash.substring(1)\n        }\n      }));\n    } else {\n      _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onAnchorUnload\", new CustomEvent(\"anchor.unload\"));\n    }\n  }\n  initializeScrollIntoView() {\n    for (const {\n      brick,\n      handlers: conf\n    } of _classPrivateFieldGet(_memoizedLifeCycle, this).onScrollIntoView) {\n      _assertClassBrand(_RendererContext_brand, this, _addObserver).call(this, brick, conf);\n    }\n  }\n  initializeMediaChange() {\n    _classPrivateFieldSet(_mediaListener, this, event => {\n      _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onMediaChange\", new CustomEvent(\"media.change\", {\n        detail: getReadOnlyProxy(event.detail)\n      }));\n    });\n    mediaEventTarget.addEventListener(\"change\", _classPrivateFieldGet(_mediaListener, this));\n  }\n  initializeMessageDispatcher() {\n    var _hooks$messageDispatc2;\n    for (const {\n      brick,\n      handlers: confList\n    } of _classPrivateFieldGet(_memoizedLifeCycle, this).onMessage) {\n      for (const conf of [].concat(confList)) {\n        var _hooks$messageDispatc;\n        hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 || _hooks$messageDispatc.onMessage(conf.channel, detail => {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"message.push\", {\n            detail\n          }));\n        });\n      }\n    }\n    hooks === null || hooks === void 0 || (_hooks$messageDispatc2 = hooks.messageDispatcher) === null || _hooks$messageDispatc2 === void 0 || _hooks$messageDispatc2.onClose(() => {\n      _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onMessageClose\", new CustomEvent(\"message.close\"));\n    });\n  }\n  dispatchOnMount() {\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onMount\", new CustomEvent(\"mount\"));\n  }\n  dispatchOnUnmount() {\n    _assertClassBrand(_RendererContext_brand, this, _dispatchGeneralLifeCycle).call(this, \"onUnmount\", new CustomEvent(\"unmount\"));\n  }\n}\nfunction _unmountBricks(bricks) {\n  const lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n  const unmountList = [];\n\n  // Clear life cycle handlers, record `onUnmount` at the same time\n  for (const key of lifeCycleTypes) {\n    const removed = remove(_classPrivateFieldGet(_memoizedLifeCycle, this)[key], item => bricks.has(item.brick));\n    if (key === \"onUnmount\") {\n      unmountList.push(...removed);\n    }\n  }\n\n  // Clear intersection observers\n  for (const brick of bricks) {\n    var _brick$element, _brick$element2, _brick$disposes;\n    const observers = _classPrivateFieldGet(_observers, this).get(brick);\n    if (observers !== null && observers !== void 0 && observers.length) {\n      for (const observer of observers) {\n        observer.disconnect();\n      }\n      observers.length = 0;\n      _classPrivateFieldGet(_observers, this).delete(brick);\n    }\n    unbindTemplateProxy(brick);\n    (_brick$element = brick.element) === null || _brick$element === void 0 || delete _brick$element.$$tplStateStore;\n    // Also remove the element\n    (_brick$element2 = brick.element) === null || _brick$element2 === void 0 || _brick$element2.remove();\n    // Dispose context listeners\n    (_brick$disposes = brick.disposes) === null || _brick$disposes === void 0 || _brick$disposes.forEach(dispose => dispose());\n    delete brick.disposes;\n  }\n\n  // Dispatch unmount events\n  const unmountEvent = new CustomEvent(\"unmount\");\n  for (const {\n    brick,\n    handlers\n  } of unmountList) {\n    listenerFactory(handlers, brick.runtimeContext, brick)(unmountEvent);\n  }\n}\nfunction _initializeRerenderBricks(bricks) {\n  const mountEvent = new CustomEvent(\"mount\");\n  for (const {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(_memoizedLifeCycle, this).onMount) {\n    if (bricks.has(brick)) {\n      listenerFactory(handlers, brick.runtimeContext, brick)(mountEvent);\n    }\n  }\n  for (const {\n    brick,\n    handlers: conf\n  } of _classPrivateFieldGet(_memoizedLifeCycle, this).onScrollIntoView) {\n    if (bricks.has(brick)) {\n      _assertClassBrand(_RendererContext_brand, this, _addObserver).call(this, brick, conf);\n    }\n  }\n}\nfunction _dispatchGeneralLifeCycle(type, event) {\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && this.scope === \"fragment\" && pageOnlyLifeCycles.includes(type)) {\n    throw new Error(`\\`lifeCycle.${type}\\` cannot be used in ${this.scope}.\\nThis is a bug of Brick Next, please report it.`);\n  }\n  for (const {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(_memoizedLifeCycle, this)[type]) {\n    listenerFactory(handlers, brick.runtimeContext, brick)(event);\n  }\n  const arbitraryCallbacks = _classPrivateFieldGet(_arbitraryLifeCycle, this).get(type);\n  if (arbitraryCallbacks) {\n    for (const fn of arbitraryCallbacks) {\n      fn();\n    }\n  }\n}\nfunction _addObserver(brick, conf) {\n  const threshold = conf.threshold ?? 0.1;\n  const observer = new IntersectionObserver((entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        if (entry.intersectionRatio >= threshold) {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"scroll.into.view\"));\n          observer.disconnect();\n        }\n      }\n    });\n  }, {\n    threshold\n  });\n  observer.observe(brick.element);\n  let list = _classPrivateFieldGet(_observers, this).get(brick);\n  if (!list) {\n    list = [];\n    _classPrivateFieldGet(_observers, this).set(brick, list);\n  }\n  list.push(observer);\n}\nfunction getLastNode(node) {\n  let last = node;\n  while ((_last = last) !== null && _last !== void 0 && _last.sibling) {\n    var _last;\n    last = last.sibling;\n  }\n  return last;\n}\nfunction getLastNormalNode(node) {\n  return getSpecifiedNormalNode(node, false);\n}\nfunction getNextNormalNode(node) {\n  return getSpecifiedNormalNode(node, true);\n}\nfunction getSpecifiedNormalNode(node, next) {\n  let last;\n  let current = node;\n  while (current) {\n    if (current.tag === RenderTag.BRICK && !current.portal) {\n      if (next) {\n        return current;\n      }\n      last = current;\n    }\n    current = current.sibling;\n  }\n  return last;\n}\nfunction getLastPortalNode(node) {\n  return getSpecifiedPortalNode(node, false);\n}\nfunction getNextPortalNode(node) {\n  return getSpecifiedPortalNode(node, true);\n}\nfunction getSpecifiedPortalNode(node, next) {\n  let last;\n  let current = node;\n  while (current) {\n    if (current.tag === RenderTag.BRICK && current.portal) {\n      if (next) {\n        return current;\n      }\n      last = current;\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      let currentReturn = current.return;\n      while (currentReturn) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n  return last;\n}\nfunction getBrickRange(from, to) {\n  const range = new Set();\n  let current = from;\n  while (current) {\n    if (current.tag === RenderTag.BRICK) {\n      range.add(current);\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current === to) {\n      break;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn2;\n      let currentReturn = current.return;\n      while (currentReturn && currentReturn !== to) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      if (currentReturn === to) {\n        break;\n      }\n      current = (_currentReturn2 = currentReturn) === null || _currentReturn2 === void 0 ? void 0 : _currentReturn2.sibling;\n    }\n  }\n  return range;\n}\n//# sourceMappingURL=RendererContext.js.map","const routeMatchedMap = new Map();\nexport function setMatchedRoute(id, match) {\n  routeMatchedMap.set(id, match);\n}\nexport function getMatchedRoute(id) {\n  return routeMatchedMap.get(id);\n}\nexport function clearMatchedRoutes() {\n  return routeMatchedMap.clear();\n}\n//# sourceMappingURL=routeMatchedMap.js.map","import { pick } from \"lodash\";\nimport { _internalApiGetRenderId, _internalApiGetRuntimeContext, _internalApiGetStoryboardInBootstrapData, getBrickPackages } from \"./Runtime.js\";\nimport { createScopedRuntimeContext, postAsyncRender, renderBrick } from \"./Renderer.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { resolveData } from \"./data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { loadBricksImperatively, loadEditorsImperatively } from \"@next-core/loader\";\nimport { getMatchedRoute } from \"./routeMatchedMap.js\";\nexport const symbolForRootRuntimeContext = Symbol.for(\"root.runtimeContext\");\nexport async function renderUseBrick(useBrick, data, errorBoundary) {\n  var _output$node, _output$node2;\n  const [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext({\n    ...(useBrick[symbolForRootRuntimeContext] ?? _internalApiGetRuntimeContext()),\n    data,\n    pendingPermissionsPreCheck: []\n  });\n  scopedRuntimeContext.tplStateStoreMap ?? (scopedRuntimeContext.tplStateStoreMap = new Map());\n  scopedRuntimeContext.formStateStoreMap ?? (scopedRuntimeContext.formStateStoreMap = new Map());\n  const rendererContext = new RendererContext(\"fragment\");\n  const renderRoot = {\n    tag: RenderTag.ROOT,\n    // Will set during `mountUseBrick`\n    createPortal: null\n  };\n  const transform = useBrick.transform;\n  const strict = isStrictMode();\n  if (transform) {\n    warnAboutStrictMode(strict, \"`useBrick.transform`\", 'please use \"properties\" instead, check your useBrick:', useBrick);\n  }\n  const output = await renderBrick(renderRoot, strict && !errorBoundary ? useBrick : {\n    errorBoundary,\n    ...useBrick,\n    properties: {\n      ...useBrick.properties,\n      ...transform\n    }\n  }, scopedRuntimeContext, rendererContext, [], {});\n  const scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n  await postAsyncRender(output, scopedRuntimeContext, scopedStores);\n  if (((_output$node = output.node) === null || _output$node === void 0 ? void 0 : _output$node.tag) === RenderTag.PLACEHOLDER) {\n    throw new Error(\"The root brick of useBrick cannot be an ignored control node\");\n  }\n  if ((_output$node2 = output.node) !== null && _output$node2 !== void 0 && _output$node2.portal) {\n    throw new Error(\"The root brick of useBrick cannot be a portal brick\");\n  }\n  renderRoot.child = output.node;\n  const tagName = output.node ? output.node.type : null;\n  return {\n    tagName,\n    renderRoot,\n    rendererContext,\n    scopedStores\n  };\n}\nexport function mountUseBrick(_ref, element) {\n  let {\n    renderRoot,\n    rendererContext,\n    scopedStores\n  } = _ref;\n  let portal;\n  renderRoot.createPortal = () => {\n    const portalRoot = document.querySelector(\"#portal-mount-point\");\n    portal = document.createElement(\"div\");\n    portalRoot.appendChild(portal);\n    return portal;\n  };\n  mountTree(renderRoot, element);\n  rendererContext.dispatchOnMount();\n  rendererContext.initializeScrollIntoView();\n  rendererContext.initializeMediaChange();\n  rendererContext.initializeMessageDispatcher();\n  for (const store of scopedStores) {\n    store.mountAsyncData();\n  }\n  return {\n    portal\n  };\n}\nexport function unmountUseBrick(_ref2, mountResult) {\n  let {\n    rendererContext\n  } = _ref2;\n  // if (mountResult.mainBrick) {\n  //   mountResult.mainBrick.unmount();\n  // }\n  if (mountResult.portal) {\n    unmountTree(mountResult.portal);\n    mountResult.portal.remove();\n  }\n  rendererContext.dispatchOnUnmount();\n  rendererContext.dispose();\n}\n\n/** For v2 compatibility of `doTransform` from brick-kit. */\nexport function legacyDoTransform(data, to, options) {\n  if (options) {\n    throw new Error(\"Legacy doTransform does not support options in v3\");\n  }\n  return computeRealValue(to, {\n    ..._internalApiGetRuntimeContext(),\n    data\n  }, {\n    noInject: true\n  });\n}\nexport function updateStoryboard(appId, storyboardPatch) {\n  const storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  Object.assign(storyboard, {\n    ...storyboardPatch,\n    meta: {\n      // Keep runtime fields such as `injectMenus`\n      ...storyboard.meta,\n      ...storyboardPatch.meta\n    },\n    $$fulfilling: null,\n    $$fulfilled: true,\n    $$registerCustomTemplateProcessed: false\n  });\n  registerAppI18n(storyboard);\n}\nexport function updateStoryboardByRoute(appId, newRoute) {\n  const storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  let matched = false;\n  function matchRoute(route) {\n    return route.path === newRoute.path && !route.exact === !newRoute.exact;\n  }\n  function replaceRoutes(routes) {\n    routes.forEach((route, index) => {\n      if (route.type === \"routes\") {\n        replaceRoutes(route.routes);\n      } else {\n        if (matchRoute(route)) {\n          matched = true;\n          routes[index] = newRoute;\n        } else if (Array.isArray(route.bricks)) {\n          replaceBricks(route.bricks);\n        }\n      }\n    });\n  }\n  function replaceBricks(bricks) {\n    bricks.forEach(brick => {\n      if (brick.slots) {\n        for (const slotConf of Object.values(brick.slots)) {\n          if (slotConf.type === \"routes\") {\n            replaceRoutes(slotConf.routes);\n          } else {\n            replaceBricks(slotConf.bricks);\n          }\n        }\n      }\n    });\n  }\n  replaceRoutes(storyboard.routes);\n  if (!matched) {\n    storyboard.routes.unshift(newRoute);\n  }\n}\nexport function updateStoryboardByTemplate(appId, newTemplate, settings) {\n  const tplName = `${appId}.${newTemplate.name}`;\n  // customTemplateRegistry.delete(tplName);\n  customTemplates.define(tplName, {\n    bricks: newTemplate.bricks,\n    proxy: newTemplate.proxy,\n    state: newTemplate.state\n  });\n  updateTemplatePreviewSettings(appId, newTemplate.name, settings);\n}\nexport function updateTemplatePreviewSettings(appId, templateId, settings) {\n  _updatePreviewSettings(appId, `\\${APP.homepage}/_dev_only_/template-preview/${templateId}`, [{\n    brick: templateId,\n    ...pick(settings, \"properties\", \"events\", \"lifeCycle\", \"context\", \"slots\", \"children\")\n  }]);\n}\nfunction getSnippetPreviewPath(snippetId) {\n  return `\\${APP.homepage}/_dev_only_/snippet-preview/${snippetId}`;\n}\nexport function updateStoryboardBySnippet(appId, snippetData) {\n  var _snippetData$bricks;\n  _updatePreviewSettings(appId, getSnippetPreviewPath(snippetData.snippetId), (_snippetData$bricks = snippetData.bricks) !== null && _snippetData$bricks !== void 0 && _snippetData$bricks.length ? snippetData.bricks : [{\n    brick: \"span\"\n  }], snippetData.context);\n}\nexport const updateSnippetPreviewSettings = updateStoryboardBySnippet;\nfunction _updatePreviewSettings(appId, path, bricks, context) {\n  const {\n    routes\n  } = _internalApiGetStoryboardInBootstrapData(appId);\n  const previewRouteIndex = routes.findIndex(route => route.path === path);\n  const newPreviewRoute = {\n    path,\n    bricks,\n    context,\n    menu: false,\n    exact: true\n  };\n  if (previewRouteIndex === -1) {\n    routes.unshift(newPreviewRoute);\n  } else {\n    routes.splice(previewRouteIndex, 1, newPreviewRoute);\n  }\n}\nexport function getContextValue(name, _ref3) {\n  let {\n    tplStateStoreId\n  } = _ref3;\n  const runtimeContext = _internalApiGetRuntimeContext();\n  if (tplStateStoreId) {\n    const tplStateStore = getTplStateStore({\n      ...runtimeContext,\n      tplStateStoreId\n    }, \"STATE\");\n    return tplStateStore.getValue(name);\n  }\n  return runtimeContext.ctxStore.getValue(name);\n}\nexport function getAllContextValues(_ref4) {\n  let {\n    tplStateStoreId\n  } = _ref4;\n  const runtimeContext = _internalApiGetRuntimeContext();\n  if (tplStateStoreId) {\n    const tplStateStore = getTplStateStore({\n      ...runtimeContext,\n      tplStateStoreId\n    }, \"STATE\");\n    return tplStateStore.getAllValues();\n  }\n  return runtimeContext.ctxStore.getAllValues();\n}\nexport function getBrickPackagesById(id) {\n  return getBrickPackages().find(pkg => pkg.id ? pkg.id === id : pkg.filePath.startsWith(`${id}/`));\n}\n\n/**\n * Support loading v3 bricks only.\n */\nexport function loadBricks(bricks) {\n  return loadBricksImperatively(bricks, getBrickPackages());\n}\n\n/**\n * Try the brick packages passed in, before using from bootstrap.\n */\nexport function loadEditors(editors, brickPackages) {\n  return loadEditorsImperatively(editors, brickPackages ?? getBrickPackages());\n}\nexport function getRenderId() {\n  return _internalApiGetRenderId();\n}\nexport async function getAddedContracts(storyboardPatch, _ref5) {\n  let {\n    appId,\n    updateStoryboardType,\n    collectUsedContracts\n  } = _ref5;\n  const storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  let updatedStoryboard;\n\n  // 拿到更新部分的 storyboard 配置，然后扫描一遍，找到新增的 contracts\n  if (updateStoryboardType === \"route\") {\n    updatedStoryboard = {\n      routes: [storyboardPatch]\n    };\n  } else if (updateStoryboardType === \"template\") {\n    updatedStoryboard = {\n      meta: {\n        customTemplates: [storyboardPatch]\n      }\n    };\n  } else if (updateStoryboardType === \"snippet\") {\n    var _storyboard$routes;\n    // snippet 是放在挂载 route 里预览，通过 previewPath 拿到当前修改 route\n    const snippetPreviewPath = getSnippetPreviewPath(storyboardPatch.snippetId);\n    const currentRoute = storyboard === null || storyboard === void 0 || (_storyboard$routes = storyboard.routes) === null || _storyboard$routes === void 0 ? void 0 : _storyboard$routes.find(route => route.path === snippetPreviewPath);\n    updatedStoryboard = {\n      routes: [currentRoute]\n    };\n  }\n  const addedContracts = [];\n  if (updatedStoryboard && collectUsedContracts) {\n    const contractApis = await collectUsedContracts(updatedStoryboard);\n    contractApis.forEach(api => {\n      var _storyboard$meta;\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const [_, namespaceId, name] = api.match(/(.*)@(.*):\\d\\.\\d\\.\\d/);\n      if (!(storyboard !== null && storyboard !== void 0 && (_storyboard$meta = storyboard.meta) !== null && _storyboard$meta !== void 0 && (_storyboard$meta = _storyboard$meta.contracts) !== null && _storyboard$meta !== void 0 && _storyboard$meta.some(contract => contract.namespaceId === namespaceId && contract.name === name))) {\n        addedContracts.push(api);\n      }\n    });\n  }\n  return addedContracts;\n}\nexport async function debugDataValue(debugData, _ref6) {\n  let {\n    tplStateStoreId,\n    routeId\n  } = _ref6;\n  const runtimeContext = {\n    ..._internalApiGetRuntimeContext(),\n    tplStateStoreId,\n    match: getMatchedRoute(routeId)\n  };\n  if (debugData.resolve) {\n    return resolveData(debugData.resolve, runtimeContext, {\n      cache: \"reload\"\n    });\n  }\n  return asyncComputeRealValue(debugData.value, runtimeContext);\n}\nexport function getLegalRuntimeValue(options) {\n  const runtimeContext = _internalApiGetRuntimeContext();\n  return {\n    app: (runtimeContext === null || runtimeContext === void 0 ? void 0 : runtimeContext.overrideApp) ?? (runtimeContext === null || runtimeContext === void 0 ? void 0 : runtimeContext.app),\n    location: pick(location, [\"href\", \"origin\", \"hostname\", \"host\"]),\n    ...pick(runtimeContext, [\"query\", \"sys\"]),\n    match: getMatchedRoute(options === null || options === void 0 ? void 0 : options.routeId)\n  };\n}\nexport { setRealTimeDataInspectRoot, addRealTimeDataInspectHook } from \"./data/realTimeDataInspect.js\";\n//# sourceMappingURL=secret_internals.js.map","import { getAllContextValues } from \"../secret_internals.js\";\nexport let realTimeDataInspectRoot;\nexport const RealTimeDataInspectHooks = [];\nexport function setRealTimeDataInspectRoot(root) {\n  realTimeDataInspectRoot = root;\n  const data = getAllContextValues({\n    tplStateStoreId: root.tplStateStoreId\n  });\n  callRealTimeDataInspectHooks({\n    changeType: \"initialize\",\n    tplStateStoreId: root.tplStateStoreId,\n    detail: {\n      data\n    }\n  });\n}\nexport function addRealTimeDataInspectHook(hook) {\n  RealTimeDataInspectHooks.push(hook);\n}\nexport function callRealTimeDataInspectHooks(detail) {\n  setTimeout(() => {\n    for (const hook of RealTimeDataInspectHooks) {\n      try {\n        hook(detail);\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error(`RealTimeDataInspectHook failed (${detail.changeType}):`, error);\n      }\n    }\n  });\n}\n//# sourceMappingURL=realTimeDataInspect.js.map","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport EventTarget from \"@ungap/event-target\";\nimport { eventCallbackFactory, listenerFactory } from \"../bindListeners.js\";\nimport { asyncCheckIf, checkIf } from \"../compute/checkIf.js\";\nimport { asyncComputeRealValue, computeRealValue } from \"../compute/computeRealValue.js\";\nimport { resolveData } from \"./resolveData.js\";\nimport { resolveDataStore } from \"./resolveDataStore.js\";\nimport { handleHttpError } from \"../../handleHttpError.js\";\nimport { computePropertyValue } from \"../compute/computeRealProperties.js\";\nimport { _internalApiGetRenderId } from \"../Runtime.js\";\nimport { callRealTimeDataInspectHooks, realTimeDataInspectRoot } from \"./realTimeDataInspect.js\";\nimport { isStrictMode } from \"../../isStrictMode.js\";\nconst supportContextResolveTriggerBrickLifeCycle = [\"onBeforePageLoad\", \"onPageLoad\", \"onBeforePageLeave\", \"onPageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nexport class DataStore {\n  // 把 `rendererContext` 放在参数列表的最后，并作为可选，以减少测试文件的调整\n  constructor(type, hostBrick, rendererContext, stateStoreId) {\n    _defineProperty(this, \"type\", void 0);\n    _defineProperty(this, \"data\", new Map());\n    _defineProperty(this, \"changeEventType\", void 0);\n    _defineProperty(this, \"pendingStack\", []);\n    _defineProperty(this, \"hostBrick\", void 0);\n    _defineProperty(this, \"stateStoreId\", void 0);\n    _defineProperty(this, \"batchUpdate\", false);\n    _defineProperty(this, \"batchUpdateContextsNames\", []);\n    _defineProperty(this, \"rendererContext\", void 0);\n    _defineProperty(this, \"routeMap\", new WeakMap());\n    this.type = type;\n    this.changeEventType = this.type === \"FORM_STATE\" ? \"formstate.change\" : this.type === \"STATE\" ? \"state.change\" : \"context.change\";\n    this.hostBrick = hostBrick;\n    this.rendererContext = rendererContext;\n    this.stateStoreId = stateStoreId;\n  }\n  getAllValues() {\n    return Object.fromEntries([...this.data.entries()].map(_ref => {\n      let [name, {\n        value\n      }] = _ref;\n      return [name, value];\n    }));\n  }\n  getValue(name) {\n    var _this$data$get;\n    return (_this$data$get = this.data.get(name)) === null || _this$data$get === void 0 ? void 0 : _this$data$get.value;\n  }\n  notifyRealTimeDataChange(name, value) {\n    if (realTimeDataInspectRoot) {\n      const {\n        tplStateStoreId\n      } = realTimeDataInspectRoot;\n      if (tplStateStoreId ? this.type === \"STATE\" && this.stateStoreId === tplStateStoreId : this.type === \"CTX\") {\n        callRealTimeDataInspectHooks({\n          changeType: \"update\",\n          tplStateStoreId,\n          detail: {\n            name,\n            value\n          }\n        });\n      }\n    }\n  }\n  getAffectListByContext(name) {\n    const affectNames = [name];\n    this.data.forEach((value, key) => {\n      if (value.deps) {\n        const isInDeps = value.deps.some(item => affectNames.includes(item));\n        isInDeps && affectNames.push(key) && affectNames.push(...this.getAffectListByContext(key));\n      }\n    });\n    affectNames.shift();\n    return [...new Set(affectNames)];\n  }\n  updateValues(values, method, argsFactory) {\n    this.batchUpdate = true;\n    this.batchUpdateContextsNames = values.map(item => item.name);\n    if ([...new Set(this.batchUpdateContextsNames)].length !== this.batchUpdateContextsNames.length) {\n      throw new Error(`Batch update not allow to update same item`);\n    }\n    const updateContexts = {};\n    const affectContexts = {};\n    const affectDepsContextNames = [];\n    values.forEach(arg => {\n      const {\n        name,\n        value\n      } = argsFactory([arg]);\n      const updateContextItem = this.data.get(name);\n      affectDepsContextNames.push(...this.getAffectListByContext(name));\n      updateContextItem && (updateContexts[name] = updateContextItem);\n      this.updateValue(name, value, method);\n    });\n    affectDepsContextNames.filter(item => !updateContexts[item]).forEach(name => {\n      const affectContextItem = this.data.get(name);\n      affectContextItem && (affectContexts[name] = affectContextItem);\n    });\n    const triggerEvent = contexts => {\n      for (const key in contexts) {\n        var _context$eventTarget;\n        const context = contexts[key];\n        (_context$eventTarget = context.eventTarget) === null || _context$eventTarget === void 0 || _context$eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n          detail: context.value\n        }));\n      }\n    };\n    triggerEvent(updateContexts);\n    triggerEvent(affectContexts);\n    this.batchUpdate = false;\n    return;\n  }\n  updateValue(name, value, method, callback, callbackRuntimeContext) {\n    const item = this.data.get(name);\n    if (!item) {\n      throw new Error(`${this.type} '${name}' is not defined`);\n    }\n    if (method === \"refresh\" || method === \"load\") {\n      if (!item.useResolve) {\n        throw new Error(`You can not ${method} \"${this.type}.${name}\" which is not using resolve`);\n      }\n      let promise;\n      if (method === \"load\") {\n        // Try to reuse previous request when calling `load`.\n        if (item.loaded) {\n          promise = Promise.resolve(item.value);\n        } else if (item.loading) {\n          promise = item.loading;\n        }\n      }\n      const shouldDismiss = error => {\n        var _this$rendererContext;\n        // If render twice immediately, flow API contracts maybe cleared before\n        // the second rendering, while the page load handlers of the first\n        // rendering can't be cancelled, which throws `FlowApiNotFoundError`.\n        // So we ignore error reporting for this case.\n        let renderId;\n        return (error === null || error === void 0 ? void 0 : error.name) === \"FlowApiNotFoundError\" && !!(renderId = (_this$rendererContext = this.rendererContext) === null || _this$rendererContext === void 0 ? void 0 : _this$rendererContext.renderId) && renderId !== _internalApiGetRenderId();\n      };\n      if (!promise) {\n        promise = item.loading = item.load({\n          cache: method === \"load\" ? \"default\" : \"reload\",\n          ...value\n        });\n        // Do not use the chained promise, since the callbacks need the original promise.\n        promise.then(val => {\n          this.finishLoad(item, val);\n        }, err => {\n          // Let users override error handling.\n          if (item.useResolve && !shouldDismiss(err) && !(callback !== null && callback !== void 0 && callback.error)) {\n            handleHttpError(err);\n          }\n        });\n      }\n      if (callback) {\n        const callbackFactory = eventCallbackFactory(callback, callbackRuntimeContext);\n        promise.then(val => {\n          callbackFactory(\"success\")({\n            value: val\n          });\n          callbackFactory(\"finally\")();\n        }, err => {\n          if (!shouldDismiss(err) && callback.error) {\n            callbackFactory(\"error\")(err);\n          }\n          callbackFactory(\"finally\")();\n        });\n      }\n      return;\n    }\n    if (method === \"replace\") {\n      item.value = value;\n    } else {\n      if (isObject(item.value)) {\n        Object.assign(item.value, value);\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn(`Non-object current value of \"${this.type}.${name}\" for \"context.assign\", try \"context.replace\" instead.`);\n        item.value = value;\n      }\n    }\n    if (this.batchUpdate) return;\n    item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n      detail: item.value\n    }));\n  }\n  finishLoad(item, value) {\n    if (!item.useResolve) {\n      // This happens when a tracked conditional resolve switches from\n      // resolve to fallback after an dep update triggered refresh but\n      // before it's been resolved.\n      return;\n    }\n    item.loaded = true;\n    item.value = value;\n    item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n      detail: value\n    }));\n  }\n  define(dataConfs, runtimeContext, asyncHostPropertyEntries, routePath) {\n    if (Array.isArray(dataConfs) && dataConfs.length > 0) {\n      const pending = resolveDataStore(dataConfs, dataConf => this.resolve(dataConf, runtimeContext, asyncHostPropertyEntries, routePath), this.type, isStrictMode(runtimeContext));\n      this.pendingStack.push(pending);\n    }\n  }\n  onChange(dataName, listener) {\n    var _this$data$get2;\n    const eventTarget = (_this$data$get2 = this.data.get(dataName)) === null || _this$data$get2 === void 0 ? void 0 : _this$data$get2.eventTarget;\n    eventTarget === null || eventTarget === void 0 || eventTarget.addEventListener(this.changeEventType, listener);\n    return () => {\n      eventTarget === null || eventTarget === void 0 || eventTarget.removeEventListener(this.changeEventType, listener);\n    };\n  }\n  async waitFor(dataNames) {\n    for (const {\n      pendingContexts\n    } of this.pendingStack) {\n      await Promise.all([...dataNames].map(ctx => {\n        const p = pendingContexts.get(ctx);\n        return p;\n      }));\n    }\n  }\n  async waitForAll() {\n    // Silent each pending contexts, since the error is handled by batched `pendingResult`\n    for (const {\n      pendingContexts\n    } of this.pendingStack) {\n      for (const p of pendingContexts.values()) {\n        p.catch(() => {\n          /* No-op */\n        });\n      }\n    }\n    for (const {\n      pendingResult\n    } of this.pendingStack) {\n      await pendingResult;\n    }\n  }\n\n  /**\n   * After mount, dispatch the change event when an async data is loaded.\n   *\n   * If param `route` is present, handle data defined in that route (or its descendants) only.\n   */\n  mountAsyncData(route) {\n    this.data.forEach(item => {\n      var _this$routeMap$get;\n      if (item.async && (!route || (_this$routeMap$get = this.routeMap.get(route)) !== null && _this$routeMap$get !== void 0 && _this$routeMap$get.has(item.name))) {\n        // istanbul ignore next\n        if (item.asyncMounted) {\n          // eslint-disable-next-line no-console\n          console.error(`Async data \"${item.name}\" already mounted. This is a bug of Brick Next, please report it.`);\n          return;\n        }\n        item.asyncMounted = true;\n        // An async data always has `loading`\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        item.loading.then(value => {\n          this.finishLoad(item, value);\n        });\n      }\n    });\n  }\n  async resolve(dataConf, runtimeContext, asyncHostPropertyEntries, routePath) {\n    if (!(await asyncCheckIf(dataConf, runtimeContext))) {\n      return false;\n    }\n    let value;\n    if (asyncHostPropertyEntries && (this.type === \"STATE\" ? dataConf.expose : this.type === \"FORM_STATE\")) {\n      value = await computePropertyValue(asyncHostPropertyEntries, dataConf.name);\n    }\n    let load;\n    let loading;\n    let useResolve;\n    let trackConditionalResolve;\n    let resolvePolicy;\n    if (value === undefined) {\n      if (dataConf.resolve) {\n        const hasFallbackValue = hasOwnProperty(dataConf, \"value\");\n        // Track conditional resolve only if all matches:\n        //   - Track enabled\n        //   - Has fallback value\n        //   - Referencing other data in `resolve.if`\n        trackConditionalResolve = dataConf.track && hasFallbackValue && hasOwnProperty(dataConf.resolve, \"if\") && strictCollectMemberUsage(dataConf.resolve.if, this.type).size > 0;\n        const resolveConf = {\n          transform: \"value\",\n          ...dataConf.resolve\n        };\n        useResolve = await asyncCheckIf(dataConf.resolve, runtimeContext);\n        if (useResolve || trackConditionalResolve) {\n          load = async options => {\n            var _this$rendererContext2;\n            return (await resolveData(resolveConf, runtimeContext, {\n              ...options,\n              renderId: (_this$rendererContext2 = this.rendererContext) === null || _this$rendererContext2 === void 0 ? void 0 : _this$rendererContext2.renderId\n            })).value;\n          };\n        }\n        if (useResolve) {\n          // `async` take precedence over `lazy`\n          resolvePolicy = dataConf.resolve.async ? \"async\" : dataConf.resolve.lazy ? \"lazy\" : \"eager\";\n          if (resolvePolicy === \"eager\") {\n            value = await load();\n          } else if (resolvePolicy === \"async\") {\n            loading = load();\n          }\n        } else if (!hasFallbackValue) {\n          return false;\n        }\n      }\n      if ((!useResolve || resolvePolicy !== \"eager\") && dataConf.value !== undefined) {\n        // If the context has no resolve, just use its `value`.\n        // Or if the resolve is ignored or lazy, use its `value` as a fallback.\n        value = await asyncComputeRealValue(dataConf.value, runtimeContext);\n      }\n    }\n    if (this.data.has(dataConf.name)) {\n      throw new Error(`${this.type} '${dataConf.name}' has already been declared`);\n    }\n    const newData = {\n      name: dataConf.name,\n      value,\n      // This is required for tracking context, even if no `onChange` is specified.\n      eventTarget: new EventTarget(),\n      useResolve,\n      load,\n      loaded: resolvePolicy === \"eager\",\n      loading,\n      async: resolvePolicy === \"async\",\n      deps: []\n    };\n    if (resolvePolicy === \"lazy\") {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      const {\n        trigger\n      } = dataConf.resolve;\n      if (trigger && supportContextResolveTriggerBrickLifeCycle.includes(trigger)) {\n        var _this$rendererContext3;\n        (_this$rendererContext3 = this.rendererContext) === null || _this$rendererContext3 === void 0 || _this$rendererContext3.registerArbitraryLifeCycle(trigger, () => {\n          this.updateValue(dataConf.name, undefined, \"load\");\n        });\n      }\n    }\n    if (dataConf.onChange) {\n      newData.eventTarget.addEventListener(this.changeEventType, listenerFactory(dataConf.onChange, runtimeContext));\n    }\n    if (dataConf.track) {\n      const deps = strictCollectMemberUsage(trackConditionalResolve ? [dataConf.resolve, dataConf.value] : load ? dataConf.resolve : dataConf.value, this.type);\n      !load && (newData.deps = [...deps]);\n      for (const dep of deps) {\n        this.onChange(dep, this.batchAddListener(() => {\n          newData.useResolve = trackConditionalResolve ? checkIf(dataConf.resolve, runtimeContext) : !!load;\n          if (newData.useResolve) {\n            this.updateValue(dataConf.name, {\n              cache: \"default\"\n            }, \"refresh\");\n          } else {\n            this.updateValue(dataConf.name, computeRealValue(dataConf.value, runtimeContext), \"replace\");\n          }\n        }, dataConf));\n      }\n    }\n    newData.eventTarget.addEventListener(this.changeEventType, e => {\n      this.notifyRealTimeDataChange(dataConf.name, e.detail);\n    });\n    this.data.set(dataConf.name, newData);\n    if (Array.isArray(routePath)) {\n      for (const route of routePath) {\n        const names = this.routeMap.get(route);\n        if (names) {\n          names.add(dataConf.name);\n        } else {\n          this.routeMap.set(route, new Set([dataConf.name]));\n        }\n      }\n    }\n    return true;\n  }\n  disposeDataInRoutes(routes) {\n    for (const route of routes) {\n      const names = this.routeMap.get(route);\n      if (names !== undefined) {\n        for (const name of names) {\n          this.data.delete(name);\n        }\n      }\n    }\n  }\n  batchAddListener(listener, contextConf) {\n    return event => {\n      if (this.batchUpdate && this.batchUpdateContextsNames.includes(contextConf.name)) {\n        return;\n      }\n      listener(event);\n    };\n  }\n}\n//# sourceMappingURL=DataStore.js.map","import { collectMemberUsage } from \"@next-core/utils/storyboard\";\nexport function resolveDataStore(contextConfs, resolveContext) {\n  let keyword = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"CTX\";\n  let strict = arguments.length > 3 ? arguments[3] : undefined;\n  const dependencyMap = getDependencyMapOfContext(contextConfs, keyword, strict);\n  // There maybe multiple context confs for a specific name, since there are conditional contexts.\n  // This is a map of how many pending context confs for each context name.\n  const pendingDeps = new Map();\n  for (const contextName of Array.from(dependencyMap.keys()).map(contextConf => contextConf.name)) {\n    pendingDeps.set(contextName, (pendingDeps.get(contextName) ?? 0) + 1);\n  }\n  const hasNonStaticUsage = Array.from(dependencyMap.values()).some(stats => stats.hasNonStaticUsage);\n  const processed = new WeakSet();\n  const deferredContexts = new Map();\n  const pendingContexts = new Map([...new Set(contextConfs.map(contextConf => contextConf.name))].map(contextName => [contextName, new Promise((resolve, reject) => {\n    deferredContexts.set(contextName, {\n      resolve,\n      reject\n    });\n  })]));\n  const wrapResolve = async contextConf => {\n    processed.add(contextConf);\n    const resolved = await resolveContext(contextConf);\n    dependencyMap.delete(contextConf);\n    const left = pendingDeps.get(contextConf.name) ?? 0;\n    if (resolved) {\n      // Assert: contextConf.name exists in deferredContexts\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      deferredContexts.get(contextConf.name).resolve();\n      pendingDeps.delete(contextConf.name);\n      if (left === 0) {\n        throw new Error(`Duplicated context defined: ${contextConf.name}`);\n      }\n    } else {\n      // Assert: left >= 1\n      if (left === 1) {\n        // Assert: contextConf.name exists in deferredContexts\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        deferredContexts.get(contextConf.name).resolve();\n        pendingDeps.delete(contextConf.name);\n      } else {\n        pendingDeps.set(contextConf.name, left - 1);\n      }\n    }\n    await scheduleNext();\n  };\n  let scheduleAsSerial = hasNonStaticUsage;\n  async function scheduleNext() {\n    const readyContexts = Array.from(dependencyMap.entries()).filter(predicateNextResolveFactory(pendingDeps, scheduleAsSerial)).map(entry => entry[0]).filter(contextConf => !processed.has(contextConf));\n    await Promise.all(readyContexts.map(wrapResolve));\n  }\n  const pendingResult = scheduleNext().then(async () => {\n    // If there are still contexts left, it implies one of these situations:\n    //   - Circular contexts.\n    //     Such as: a depends on b, while b depends on a.\n    //   - Related contexts are all ignored.\n    //     Such as: a depends on b,\n    //     while both them are ignore by a falsy result of `if`.\n    if (dependencyMap.size > 0) {\n      // This will throw if circular contexts detected.\n      detectCircularContexts(dependencyMap, keyword);\n      scheduleAsSerial = true;\n      await scheduleNext();\n    }\n    // There maybe ignored contexts which are still not fulfilled.\n    // We treat them as RESOLVED.\n    for (const deferred of deferredContexts.values()) {\n      deferred.resolve();\n    }\n  }).catch(error => {\n    // There maybe contexts left not fulfilled, when an error occurred.\n    // We treat them as REJECTED.\n    for (const deferred of deferredContexts.values()) {\n      deferred.reject(error);\n    }\n    throw error;\n  });\n  return {\n    pendingResult,\n    pendingContexts\n  };\n}\nfunction predicateNextResolveFactory(pendingDeps, scheduleAsSerial) {\n  return (entry, index) =>\n  // When contexts contain computed CTX accesses, it implies a dynamic dependency map.\n  // So make them process sequentially, keep the same behavior as before.\n  scheduleAsSerial ? index === 0 :\n  // A context is ready when it has no pending dependencies.\n  ![...entry[1].usedProperties].some(dep => pendingDeps.has(dep));\n}\nexport function getDependencyMapOfContext(contextConfs) {\n  let keyword = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"CTX\";\n  let strict = arguments.length > 2 ? arguments[2] : undefined;\n  const depsMap = new Map();\n  for (const contextConf of contextConfs) {\n    const data = [contextConf.if, contextConf.value, contextConf.resolve];\n    const stats = collectMemberUsage(data, keyword);\n    if (!strict && keyword === \"STATE\") {\n      const legacyTplStats = collectMemberUsage(data, \"TPL\");\n      // Merge stats with legacyTplStats\n      for (const prop of legacyTplStats.usedProperties) {\n        stats.usedProperties.add(prop);\n      }\n      if (legacyTplStats.hasNonStaticUsage) {\n        stats.hasNonStaticUsage = true;\n      }\n    }\n    depsMap.set(contextConf, stats);\n  }\n  return depsMap;\n}\nfunction detectCircularContexts(dependencyMap, keyword) {\n  const duplicatedMap = new Map(dependencyMap);\n  const pendingDeps = new Set(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name));\n  const next = () => {\n    let processedAtLeastOne = false;\n    for (const [contextConf, stats] of duplicatedMap.entries()) {\n      if (![...stats.usedProperties].some(dep => pendingDeps.has(dep))) {\n        duplicatedMap.delete(contextConf);\n        pendingDeps.delete(contextConf.name);\n        processedAtLeastOne = true;\n      }\n    }\n    if (processedAtLeastOne) {\n      next();\n    }\n  };\n  next();\n  if (duplicatedMap.size > 0) {\n    throw new ReferenceError(`Circular ${keyword} detected: ${Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name).join(\", \")}`);\n  }\n}\n//# sourceMappingURL=resolveDataStore.js.map","import { hasOwnProperty } from \"@next-core/utils/general\";\nimport { clamp } from \"lodash\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachIndex, symbolForTPlExternalForEachItem, symbolForTPlExternalForEachSize, symbolForTplStateStoreId } from \"./constants.js\";\nimport { computePropertyValue } from \"../compute/computeRealProperties.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nexport function setupTemplateProxy(hostContext, ref, slots) {\n  const {\n    reversedProxies,\n    asyncHostPropertyEntries,\n    externalSlots,\n    tplStateStoreId,\n    hostBrick\n  } = hostContext;\n  let asyncComputedProps;\n  if (ref && reversedProxies) {\n    const propertyProxies = reversedProxies.properties.get(ref);\n    if (propertyProxies) {\n      const getComputedProps = asyncHostProps => {\n        return propertyProxies.map(_ref => {\n          let {\n            from,\n            to\n          } = _ref;\n          const filtered = asyncHostProps.filter(entry => entry[0] === from);\n          if (filtered.length > 0 && to.refProperty) {\n            return [to.refProperty, computePropertyValue(filtered, from), true];\n          }\n        }).filter(Boolean);\n      };\n      asyncComputedProps = getComputedProps(asyncHostPropertyEntries);\n    }\n    const slotProxies = reversedProxies.slots.get(ref);\n    if (slotProxies && externalSlots) {\n      // Use an approach like template-literal's quasis:\n      // `quasi0${0}quais1${1}quasi2...`\n      // Every quasi (indexed by `refPosition`) can be slotted with multiple bricks.\n      const quasisMap = new Map();\n      for (const {\n        from,\n        to\n      } of slotProxies) {\n        var _externalSlots$from;\n        const insertBricks = ((_externalSlots$from = externalSlots[from]) === null || _externalSlots$from === void 0 ? void 0 : _externalSlots$from.bricks) ?? [];\n        if (!insertBricks.length) {\n          continue;\n        }\n        const refToSlot = to.refSlot ?? from;\n        let expandableSlot = quasisMap.get(refToSlot);\n        if (!expandableSlot) {\n          expandableSlot = [];\n          // The size of quasis should be the existed slotted bricks' size plus one.\n          const size = hasOwnProperty(slots, refToSlot) ? slots[refToSlot].bricks.length + 1 : 1;\n          for (let i = 0; i < size; i += 1) {\n            expandableSlot.push([]);\n          }\n          quasisMap.set(refToSlot, expandableSlot);\n        }\n        const refPosition = to.refPosition ?? -1;\n        // External bricks of a template, should not access the template internal forEach `ITEM`.\n        // For some existing templates who is *USING* this bug, we keep the old behavior.\n        const hostHasForEach = hasOwnProperty(hostBrick.runtimeContext, \"forEachItem\");\n        expandableSlot[clamp(refPosition < 0 ? expandableSlot.length + refPosition : refPosition, 0, expandableSlot.length - 1)].push(...(!hostHasForEach ? insertBricks : setupTemplateExternalBricksWithForEach(insertBricks, hostBrick.runtimeContext.forEachItem, hostBrick.runtimeContext.forEachIndex, hostBrick.runtimeContext.forEachSize)));\n      }\n      for (const [slotName, quasis] of quasisMap.entries()) {\n        if (!hasOwnProperty(slots, slotName)) {\n          slots[slotName] = {\n            type: \"bricks\",\n            bricks: []\n          };\n        }\n        const slotConf = slots[slotName];\n        slotConf.bricks = quasis.flatMap((bricks, index) => index < slotConf.bricks.length ? bricks.concat(slotConf.bricks[index]) : bricks);\n        if (slotConf.bricks.length === 0) {\n          delete slots[slotName];\n        }\n      }\n    }\n  }\n  return {\n    [symbolForAsyncComputedPropsFromHost]: asyncComputedProps,\n    [symbolForTplStateStoreId]: tplStateStoreId\n  };\n}\n\n// External bricks of a template, have the same forEachItem context as their host.\nfunction setupTemplateExternalBricksWithForEach(bricks, forEachItem, forEachIndex, forEachSize) {\n  return bricks.map(_ref2 => {\n    let {\n      children,\n      slots,\n      ...brick\n    } = _ref2;\n    return {\n      ...brick,\n      [symbolForTPlExternalForEachItem]: forEachItem,\n      [symbolForTPlExternalForEachIndex]: forEachIndex,\n      [symbolForTPlExternalForEachSize]: forEachSize,\n      // Keep `:forEach` bricks as original, since they have their own forEachItem context.\n      slots: brick.brick === \":forEach\" ? childrenToSlots(children, slots) : Object.fromEntries(Object.entries(childrenToSlots(children, slots) ?? {}).map(_ref3 => {\n        let [slotName, slotConf] = _ref3;\n        return [slotName, slotConf.type === \"routes\" ? {\n          type: \"routes\",\n          routes: setupTemplateExternalRoutesWithForEach(slotConf.routes, forEachItem, forEachIndex, forEachSize)\n        } : {\n          type: \"bricks\",\n          bricks: setupTemplateExternalBricksWithForEach(slotConf.bricks, forEachItem, forEachIndex, forEachSize)\n        }];\n      }))\n    };\n  });\n}\nfunction setupTemplateExternalRoutesWithForEach(routes, forEachItem, forEachIndex, forEachSize) {\n  return routes.map(route => route.type === \"routes\" ? {\n    ...route,\n    routes: setupTemplateExternalRoutesWithForEach(route.routes, forEachItem, forEachIndex, forEachSize)\n  } : route.type === \"redirect\" ? route : {\n    ...route,\n    bricks: setupTemplateExternalBricksWithForEach(route.bricks, forEachItem, forEachIndex, forEachSize)\n  });\n}\n//# sourceMappingURL=setupTemplateProxy.js.map","import { isObject } from \"@next-core/utils/general\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nexport function setupUseBrickInTemplate(props, hostContext) {\n  function walk(props) {\n    if (!isObject(props) || typeof props === \"function\") {\n      return props;\n    }\n    if (Array.isArray(props)) {\n      return props.map(walk);\n    }\n    return Object.fromEntries(Object.entries(props).map(_ref => {\n      let [key, value] = _ref;\n      return isObject(value) && key === \"useBrick\" ? Array.isArray(value) ? [key, value.map(setup)] : [key, setup(value)] : [key, walk(value)];\n    }).concat(Object.getOwnPropertySymbols(props).map(k => [k, props[k]])));\n  }\n  function setup(item) {\n    const {\n      properties,\n      slots: originalSlots,\n      children,\n      ...restConf\n    } = item;\n    const transpiledSlots = childrenToSlots(children, originalSlots);\n    const slots = Object.fromEntries(Object.entries(transpiledSlots ?? {}).map(_ref2 => {\n      let [slotName, slotConf] = _ref2;\n      return [slotName, {\n        type: \"bricks\",\n        bricks: (slotConf.bricks ?? []).map(setup)\n      }];\n    }));\n    return {\n      ...restConf,\n      properties: walk(properties),\n      slots,\n      ...setupTemplateProxy(hostContext, restConf.ref, slots)\n    };\n  }\n  return walk(props);\n}\n//# sourceMappingURL=setupUseBrickInTemplate.js.map","import { uniqueId } from \"lodash\";\nimport { customTemplates } from \"../../CustomTemplates.js\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { setupUseBrickInTemplate } from \"./setupUseBrickInTemplate.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nimport { hooks } from \"../Runtime.js\";\nexport function expandCustomTemplate(tplTagName, brickConf, hostBrick, asyncHostPropertyEntries, rendererContext) {\n  var _hooks$flowApi;\n  const tplStateStoreId = uniqueId(\"tpl-state-\");\n  const runtimeContext = {\n    ...hostBrick.runtimeContext,\n    tplStateStoreId\n  };\n\n  // There is a boundary for `forEach*` and `FORM_STATE` between template internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.forEachIndex;\n  delete runtimeContext.forEachSize;\n  delete runtimeContext.formStateStoreId;\n  const tplStateStore = new DataStore(\"STATE\", hostBrick, rendererContext, tplStateStoreId);\n  runtimeContext.tplStateStoreMap.set(tplStateStoreId, tplStateStore);\n  if (runtimeContext.tplStateStoreScope) {\n    runtimeContext.tplStateStoreScope.push(tplStateStore);\n  }\n  const {\n    bricks,\n    proxy,\n    state,\n    contracts\n  } = customTemplates.get(tplTagName);\n  hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 || _hooks$flowApi.collectWidgetContract(contracts);\n  tplStateStore.define(state, runtimeContext, asyncHostPropertyEntries);\n  const {\n    slots: originalExternalSlots,\n    children: externalChildren,\n    ...restBrickConf\n  } = brickConf;\n  const newBrickConf = {\n    ...restBrickConf,\n    brick: tplTagName\n  };\n  hostBrick.tplHostMetadata = {\n    internalBricksByRef: new Map(),\n    tplStateStoreId,\n    proxy\n  };\n\n  // Reversed proxies are used for expand storyboard before rendering page.\n  const reversedProxies = {\n    properties: new Map(),\n    slots: new Map()\n    // mergeBases: new Map(),\n  };\n  if (proxy !== null && proxy !== void 0 && proxy.properties) {\n    for (const [from, to] of Object.entries(proxy.properties)) {\n      let proxies = reversedProxies.properties.get(to.ref);\n      if (!proxies) {\n        proxies = [];\n        reversedProxies.properties.set(to.ref, proxies);\n      }\n      proxies.push({\n        from,\n        to\n      });\n    }\n  }\n  if (proxy !== null && proxy !== void 0 && proxy.slots) {\n    for (const [from, to] of Object.entries(proxy.slots)) {\n      let proxies = reversedProxies.slots.get(to.ref);\n      if (!proxies) {\n        proxies = [];\n        reversedProxies.slots.set(to.ref, proxies);\n      }\n      proxies.push({\n        from,\n        to\n      });\n    }\n  }\n  const hostContext = {\n    reversedProxies,\n    asyncHostPropertyEntries,\n    externalSlots: childrenToSlots(externalChildren, originalExternalSlots),\n    tplStateStoreId,\n    hostBrick: hostBrick\n  };\n  newBrickConf.slots = {\n    \"\": {\n      type: \"bricks\",\n      bricks: bricks.map(item => expandBrickInTemplate(item, hostContext))\n    }\n  };\n  return newBrickConf;\n}\nfunction expandBrickInTemplate(brickConfInTemplate, hostContext) {\n  // Ignore `if: null` to make `looseCheckIf` working.\n  if (brickConfInTemplate.if === null) {\n    delete brickConfInTemplate.if;\n  }\n  const {\n    properties,\n    slots: slotsInTemplate,\n    children: childrenInTemplate,\n    ...restBrickConfInTemplate\n  } = brickConfInTemplate;\n  const transpiledSlots = childrenToSlots(childrenInTemplate, slotsInTemplate);\n  const slots = Object.fromEntries(Object.entries(transpiledSlots ?? {}).map(_ref => {\n    let [slotName, slotConf] = _ref;\n    return [slotName, {\n      type: \"bricks\",\n      bricks: (slotConf.bricks ?? []).map(item => expandBrickInTemplate(item, hostContext))\n    }];\n  }));\n  return {\n    ...restBrickConfInTemplate,\n    properties: setupUseBrickInTemplate(properties, hostContext),\n    slots,\n    ...setupTemplateProxy(hostContext, restBrickConfInTemplate.ref, slots)\n  };\n}\n//# sourceMappingURL=expandCustomTemplate.js.map","export const FORM_RENDERER = \"form-renderer.form-renderer\";\nexport const symbolForFormStateStoreId = Symbol.for(\"form.stateStoreId\");\n//# sourceMappingURL=constants.js.map","import { hasOwnProperty } from \"@next-core/utils/general\";\nimport { uniqueId } from \"lodash\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { getDefaultProperties } from \"./getDefaultProperties.js\";\nimport { symbolForFormStateStoreId } from \"./constants.js\";\nexport const formContainers = [\"forms.general-form\", \"form.general-form\", \"eo-form\"];\nexport function expandFormRenderer(formData, hostBrickConf, hostBrick, asyncHostPropertyEntries, rendererContext) {\n  var _hostBrickConf$proper;\n  const normalizedFormData = typeof formData === \"string\" ? JSON.parse(formData) : formData;\n  const formStateStoreId = uniqueId(\"form-state-\");\n  const runtimeContext = {\n    ...hostBrick.runtimeContext,\n    formStateStoreId\n  };\n\n  // There is a boundary for `forEach*` and `STATE` between form internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.forEachIndex;\n  delete runtimeContext.forEachSize;\n  delete runtimeContext.tplStateStoreId;\n  const formStateStore = new DataStore(\"FORM_STATE\", undefined, rendererContext, formStateStoreId);\n  runtimeContext.formStateStoreMap.set(formStateStoreId, formStateStore);\n  if (runtimeContext.formStateStoreScope) {\n    runtimeContext.formStateStoreScope.push(formStateStore);\n  }\n\n  // Always add a state of `params`.\n  const context = normalizedFormData.context ?? [];\n  if (!context.some(ctx => ctx.name === \"params\")) {\n    context.push({\n      name: \"params\"\n    });\n  }\n  formStateStore.define(context, runtimeContext, asyncHostPropertyEntries);\n  const formConf = formSchemaToBrick(normalizedFormData.formSchema, normalizedFormData.fields, formStateStoreId);\n  if (formContainers.includes(formConf.brick) && hostBrickConf.events) {\n    formConf.events = mergeEvents(formConf.events, hostBrickConf.events);\n  }\n  const renderRoot = typeof ((_hostBrickConf$proper = hostBrickConf.properties) === null || _hostBrickConf$proper === void 0 ? void 0 : _hostBrickConf$proper.renderRoot) !== \"boolean\" || hostBrickConf.properties.renderRoot;\n  if (renderRoot) {\n    return {\n      ...hostBrickConf,\n      slots: undefined,\n      children: [{\n        brick: \"eo-micro-view\",\n        properties: {\n          style: {\n            padding: \"12px\"\n          }\n        },\n        children: [formConf]\n      }]\n    };\n  }\n  return {\n    ...hostBrickConf,\n    slots: undefined,\n    children: [formConf]\n  };\n}\nfunction formSchemaToBrick(schema, fields, formStateStoreId) {\n  const {\n    id,\n    bricks,\n    events,\n    context,\n    mountPoint,\n    instanceId: iid\n  } = schema;\n  let {\n    brick,\n    properties\n  } = schema;\n\n  // 根据字段类型获取默认配置\n  const field = fields.find(item => item.fieldId === id);\n  if (field) {\n    const defaults = getDefaultProperties(field);\n    if (!brick) {\n      brick = defaults.brick;\n    }\n    properties = {\n      ...defaults.properties,\n      ...properties\n    };\n  }\n  const brickConf = {\n    brick,\n    properties,\n    iid,\n    slot: mountPoint,\n    events,\n    context,\n    children: formSchemasToBricks(bricks, fields, formStateStoreId),\n    [symbolForFormStateStoreId]: formStateStoreId\n  };\n  if (hasOwnProperty(schema, \"if\")) {\n    brickConf.if = schema.if;\n  }\n  return brickConf;\n}\nfunction formSchemasToBricks(schemas, fields, formStateStoreId) {\n  if (Array.isArray(schemas)) {\n    return schemas.map(schema => formSchemaToBrick(schema, fields, formStateStoreId));\n  }\n}\nfunction mergeEvents(targetEvents, sourceEvents) {\n  const events = targetEvents ?? {};\n  for (const [eventType, handlers] of Object.entries(sourceEvents)) {\n    events[eventType] = hasOwnProperty(events, eventType) ? [events[eventType], handlers].flat() : handlers;\n  }\n  return events;\n}\n//# sourceMappingURL=expandFormRenderer.js.map","export function getDefaultProperties(field) {\n  let defaultValue;\n  const commonProps = {\n    id: field.fieldId,\n    name: field.fieldId,\n    label: field.name,\n    dataset: {\n      testid: field.fieldId\n    }\n  };\n  const getReadOnlyAndRequired = () => {\n    var _field$limit, _field$limit2;\n    return {\n      readOnly: (_field$limit = field.limit) === null || _field$limit === void 0 ? void 0 : _field$limit.includes(\"READONLY\"),\n      required: (_field$limit2 = field.limit) === null || _field$limit2 === void 0 ? void 0 : _field$limit2.includes(\"REQUIRED\")\n    };\n  };\n  switch (field.fieldType) {\n    case \"INT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          placeholder: field.description,\n          precision: 0,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        }\n      };\n      break;\n    case \"BOOLEAN\":\n      defaultValue = {\n        brick: \"forms.general-switch\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired()\n        }\n      };\n      break;\n    case \"FLOAT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        }\n      };\n      break;\n    case \"ENUM\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        }\n      };\n      break;\n    case \"ENUMS\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          mode: \"multiple\",\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        }\n      };\n      break;\n    case \"DATE\":\n    case \"TIME\":\n      defaultValue = {\n        brick: \"forms.general-date-picker\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          placeholder: field.description\n        }\n      };\n      break;\n    case \"IP\":\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          placeholder: field.description,\n          pattern: \"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))\",\n          message: {\n            pattern: \"输入字符不匹配IP格式\"\n          }\n        }\n      };\n      break;\n    case \"JSON\":\n      defaultValue = {\n        brick: \"forms.general-textarea\",\n        properties: {\n          ...commonProps\n        }\n      };\n      break;\n    case \"ARRAY\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: {\n          ...commonProps\n        }\n      };\n      break;\n    case \"STRUCTURE\":\n    case \"STRUCTURE_ARRAY\":\n      defaultValue = {\n        brick: \"forms.cmdb-instance-select-panel\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired()\n        }\n      };\n      break;\n    default:\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: {\n          ...commonProps,\n          ...getReadOnlyAndRequired(),\n          placeholder: field.description\n        }\n      };\n  }\n  return defaultValue;\n}\n//# sourceMappingURL=getDefaultProperties.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _assertClassBrand from \"@babel/runtime/helpers/assertClassBrand\";\nimport { FORM_RENDERER } from \"./constants.js\";\nimport { formContainers } from \"./expandFormRenderer.js\";\nvar _FormElement_brand = /*#__PURE__*/new WeakSet();\nclass FormElement extends HTMLElement {\n  constructor() {\n    super(...arguments);\n    _classPrivateMethodInitSpec(this, _FormElement_brand);\n    _defineProperty(this, \"renderRoot\", void 0);\n  }\n  get $$typeof() {\n    return \"formRenderer\";\n  }\n  validate() {\n    _assertClassBrand(_FormElement_brand, this, _proxyFormMethod).call(this, \"validate\");\n  }\n  setInitValue() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _assertClassBrand(_FormElement_brand, this, _proxyFormMethod).call(this, \"setInitValue\", args);\n  }\n  resetFields() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    _assertClassBrand(_FormElement_brand, this, _proxyFormMethod).call(this, \"resetFields\", args);\n  }\n}\nfunction _proxyFormMethod(method) {\n  var _this$firstElementChi, _containerElement$tag;\n  let args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  const containerElement = this.renderRoot !== false ? (_this$firstElementChi = this.firstElementChild) === null || _this$firstElementChi === void 0 ? void 0 : _this$firstElementChi.firstElementChild : this.firstElementChild;\n  const tagName = containerElement === null || containerElement === void 0 || (_containerElement$tag = containerElement.tagName) === null || _containerElement$tag === void 0 ? void 0 : _containerElement$tag.toLowerCase();\n  if (formContainers.includes(tagName)) {\n    containerElement[method](...args);\n  } else {\n    // eslint-disable-next-line no-console\n    console.error(`no ${method} method in the container element`, {\n      container: tagName\n    });\n  }\n}\nexport function registerFormRenderer() {\n  customElements.get(FORM_RENDERER) || customElements.define(FORM_RENDERER, FormElement);\n}\n//# sourceMappingURL=registerFormRenderer.js.map","import { loadBricksImperatively, BrickLoadError } from \"@next-core/loader\";\nimport { HttpResponseError } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { httpErrorToString } from \"../handleHttpError.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { _internalApiGetPresetBricks, getBrickPackages } from \"./Runtime.js\";\nimport { K, NS } from \"./i18n.js\";\nimport { getBasePath } from \"../getBasePath.js\";\nexport class PageNotFoundError extends Error {\n  constructor(message) {\n    // Pass remaining arguments (including vendor specific ones) to parent constructor\n    super(message);\n    this.name = \"PageNotFoundError\";\n\n    // Maintains proper stack trace for where our error was thrown (only available on V8)\n    // istanbul ignore else\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, BrickLoadError);\n    }\n  }\n}\n\n/**\n * Will always resolve\n */\nexport async function ErrorNode(error, returnNode, pageLevel) {\n  const {\n    title,\n    variant,\n    showLink,\n    showDescription\n  } = getRefinedErrorConf(error);\n  if (pageLevel) {\n    const presetBricks = _internalApiGetPresetBricks();\n    const errorBrick = presetBricks.error ?? \"illustrations.error-message\";\n    if (errorBrick !== false) {\n      const linkBrick = \"eo-link\";\n      const bricks = (showLink ? [errorBrick, linkBrick] : [errorBrick]).filter(brick => !customElements.get(brick));\n      try {\n        await Promise.race([loadBricksImperatively(bricks, getBrickPackages()),\n        // Timeout after 3 seconds\n        new Promise((_resolve, reject) => setTimeout(() => {\n          reject(new Error(\"timeout\"));\n        }, 3e3))]);\n        const node = {\n          tag: RenderTag.BRICK,\n          type: errorBrick,\n          properties: {\n            errorTitle: title,\n            description: showDescription ? httpErrorToString(error) : undefined,\n            variant,\n            dataset: {\n              errorBoundary: \"\"\n            }\n          },\n          runtimeContext: null,\n          return: returnNode\n        };\n        if (showLink) {\n          node.child = getLinkNode(showLink, linkBrick, node, \"\");\n        }\n        return node;\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.error(\"Failed to load brick:\", bricks.join(\", \"), e);\n      }\n    }\n  }\n  const useDefaultError = pageLevel && !!customElements.get(\"easyops-default-error\");\n  const node = {\n    tag: RenderTag.BRICK,\n    type: useDefaultError ? \"easyops-default-error\" : \"div\",\n    properties: {\n      errorTitle: title,\n      dataset: {\n        errorBoundary: \"\"\n      },\n      style: {\n        color: \"var(--color-error)\"\n      }\n    },\n    runtimeContext: null,\n    return: returnNode\n  };\n  const descriptionNode = {\n    tag: RenderTag.BRICK,\n    type: \"div\",\n    properties: {\n      textContent: useDefaultError ? showDescription ? httpErrorToString(error) : \"\" : showDescription ? `${title}: ${httpErrorToString(error)}` : title\n    },\n    runtimeContext: null,\n    return: node\n  };\n  node.child = descriptionNode;\n  if (pageLevel && showLink) {\n    descriptionNode.sibling = getLinkNode(showLink, \"a\", node, useDefaultError ? \"link\" : \"\");\n  }\n  return node;\n}\nfunction getLinkNode(showLink, brick, parent, slotId) {\n  return {\n    tag: RenderTag.BRICK,\n    type: brick,\n    slotId,\n    properties: {\n      textContent: showLink === \"home\" ? i18n.t(`${NS}:${K.GO_BACK_HOME}`) : showLink === \"reload\" ? i18n.t(`${NS}:${K.RELOAD}`) : i18n.t(`${NS}:${K.GO_BACK_TO_PREVIOUS_PAGE}`),\n      href: showLink === \"home\" ? getBasePath() : showLink === \"reload\" ? location.href : undefined\n    },\n    events: showLink === \"previous\" ? {\n      click: {\n        action: \"history.goBack\"\n      }\n    } : undefined,\n    runtimeContext: null,\n    return: parent\n  };\n}\nfunction getRefinedErrorConf(error) {\n  var _error$response, _error$responseJson;\n  if (error instanceof PageNotFoundError) {\n    return error.message === \"app not found\" ? {\n      showLink: \"home\",\n      title: i18n.t(`${NS}:${K.APP_NOT_FOUND}`),\n      variant: \"no-permission\"\n    } : {\n      showLink: \"home\",\n      variant: \"not-found\",\n      title: i18n.t(`${NS}:${K.PAGE_NOT_FOUND}`)\n    };\n  }\n  if (error instanceof BrickLoadError || error instanceof Error && error.name === \"ChunkLoadError\" || error instanceof Event && error.type === \"error\" && error.target instanceof HTMLScriptElement) {\n    return {\n      showDescription: true,\n      title: i18n.t(`${NS}:${K.NETWORK_ERROR}`),\n      variant: \"internet-disconnected\",\n      showLink: \"reload\"\n    };\n  }\n  if (error instanceof HttpResponseError && ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403) {\n    return {\n      showLink: \"previous\",\n      showDescription: true,\n      title: i18n.t(`${NS}:${K.NO_PERMISSION}`),\n      variant: \"no-permission\"\n    };\n  }\n  if (error instanceof HttpResponseError && ((_error$responseJson = error.responseJson) === null || _error$responseJson === void 0 ? void 0 : _error$responseJson.code) === \"200000\") {\n    return {\n      showDescription: true,\n      title: i18n.t(`${NS}:${K.LICENSE_EXPIRED}`),\n      variant: \"license-expired\"\n    };\n  }\n  return {\n    showLink: \"previous\",\n    showDescription: true,\n    title: i18n.t(`${NS}:${K.UNKNOWN_ERROR}`),\n    variant: \"unknown-error\"\n  };\n}\n//# sourceMappingURL=ErrorNode.js.map","import { enqueueStableLoadBricks, flushStableLoadBricks, loadBricksImperatively, loadProcessorsImperatively, loadScript, loadStyle } from \"@next-core/loader\";\nimport { isTrackAll } from \"@next-core/cook\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport { debounce, isEqual } from \"lodash\";\nimport { asyncCheckBrickIf } from \"./compute/checkIf.js\";\nimport { asyncComputeRealPropertyEntries, constructAsyncProperties } from \"./compute/computeRealProperties.js\";\nimport { resolveData } from \"./data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nimport { listenOnTrackingContext, trackAfterInitial } from \"./compute/listenOnTrackingContext.js\";\nimport { matchRoute, matchRoutes } from \"./matchRoutes.js\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachIndex, symbolForTPlExternalForEachItem, symbolForTPlExternalForEachSize, symbolForTplStateStoreId } from \"./CustomTemplates/constants.js\";\nimport { expandCustomTemplate } from \"./CustomTemplates/expandCustomTemplate.js\";\nimport { getTagNameOfCustomTemplate, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { getBrickPackages, hooks } from \"./Runtime.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { getTracks } from \"./compute/getTracks.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { FORM_RENDERER, symbolForFormStateStoreId } from \"./FormRenderer/constants.js\";\nimport { expandFormRenderer } from \"./FormRenderer/expandFormRenderer.js\";\nimport { registerFormRenderer } from \"./FormRenderer/registerFormRenderer.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { getPreEvaluatedRaw } from \"./compute/evaluate.js\";\nimport { matchHomepage } from \"./matchStoryboard.js\";\nimport { listenerFactory } from \"./bindListeners.js\";\nimport { setupRootRuntimeContext } from \"./setupRootRuntimeContext.js\";\nimport { setMatchedRoute } from \"./routeMatchedMap.js\";\nimport { ErrorNode } from \"./ErrorNode.js\";\nexport async function renderRoutes(returnNode, routes, _runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, isIncremental, initialTracker) {\n  const matched = await matchRoutes(routes, _runtimeContext);\n  const output = getEmptyRenderOutput();\n  const menuRequestNode = output.menuRequestNode = {\n    return: menuRequestReturnNode\n  };\n  switch (matched) {\n    case \"missed\":\n      break;\n    case \"unauthenticated\":\n      output.unauthenticated = true;\n      break;\n    default:\n      {\n        var _hooks$checkPermissio;\n        const route = output.route = matched.route;\n        output.path = matched.match.path;\n        const runtimeContext = {\n          ..._runtimeContext,\n          match: matched.match\n        };\n        if (route.iid) {\n          setMatchedRoute(route.iid, matched.match);\n        }\n        if (isIncremental) {\n          runtimeContext.ctxStore.disposeDataInRoutes(routes);\n        }\n        const routePath = parentRoutes.concat(route);\n        runtimeContext.ctxStore.define(route.context, runtimeContext, undefined, routePath);\n        runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissionsForBrickOrRoute(route, value => asyncComputeRealValue(value, runtimeContext)));\n\n        // Currently, this is only used for brick size-checking: these bricks\n        // will be loaded before page rendering, but they will NOT be rendered.\n        const {\n          preLoadBricks\n        } = route;\n        if (Array.isArray(preLoadBricks)) {\n          output.blockingList.push(loadBricksImperatively(preLoadBricks, getBrickPackages()));\n        }\n        if (route.type === \"redirect\") {\n          let redirectTo;\n          if (typeof route.redirect === \"string\") {\n            redirectTo = await asyncComputeRealValue(route.redirect, runtimeContext);\n          } else {\n            const resolved = await resolveData({\n              transform: \"redirect\",\n              ...route.redirect\n            }, runtimeContext);\n            redirectTo = resolved.redirect;\n          }\n          if (typeof redirectTo !== \"string\") {\n            // eslint-disable-next-line no-console\n            console.error(\"Unexpected redirect result:\", redirectTo);\n            throw new Error(`Unexpected type of redirect result: ${typeof redirectTo}`);\n          }\n          output.redirect = {\n            path: redirectTo\n          };\n        } else {\n          const menuRequest = loadMenu(route.menu, runtimeContext);\n          if (menuRequest) {\n            menuRequestNode.request = menuRequest;\n          }\n          if (!isIncremental) {\n            rendererContext.memoizeMenuRequestNode(routes, menuRequestNode);\n          }\n          let newOutput;\n          if (route.type === \"routes\") {\n            newOutput = await renderRoutes(returnNode, route.routes, runtimeContext, rendererContext, routePath, menuRequestNode, slotId, undefined, initialTracker);\n          } else {\n            newOutput = await renderBricks(returnNode, route.bricks, runtimeContext, rendererContext, routePath, menuRequestNode, slotId, undefined, undefined, initialTracker);\n          }\n          mergeRenderOutput(output, newOutput);\n          appendMenuRequestNode(menuRequestNode, newOutput.menuRequestNode);\n        }\n      }\n  }\n  return output;\n}\nexport async function renderBricks(returnNode, bricks, runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, tplStack, keyPath, initialTracker) {\n  setupRootRuntimeContext(bricks, runtimeContext, true);\n  const output = getEmptyRenderOutput();\n  const kPath = keyPath ?? [];\n  // 多个构件并行异步转换，但转换的结果按原顺序串行合并。\n  const rendered = await Promise.all(bricks.map((brickConf, index) => renderBrick(returnNode, brickConf, runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, kPath.concat(index), tplStack && new Map(tplStack), initialTracker)));\n  rendered.forEach((item, index) => {\n    if (item.hasTrackingControls) {\n      // Memoize a render node before it's been merged.\n      rendererContext.memoize(slotId, kPath.concat(index), item.node, returnNode);\n    }\n    mergeRenderOutput(output, item);\n  });\n  return output;\n}\nexport async function renderBrick(returnNode, brickConf, _runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId) {\n  let keyPath = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : [];\n  let tplStack = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : new Map();\n  let initialTracker = arguments.length > 9 ? arguments[9] : undefined;\n  try {\n    return await legacyRenderBrick(returnNode, brickConf, _runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, keyPath, tplStack, initialTracker);\n  } catch (error) {\n    if (brickConf.errorBoundary) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error caught by error boundary:\", error);\n      return {\n        node: await ErrorNode(error, returnNode),\n        blockingList: []\n      };\n    } else {\n      throw error;\n    }\n  }\n}\nasync function legacyRenderBrick(returnNode, brickConf, _runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, keyPath, tplStack, initialTracker) {\n  var _hooks$checkPermissio2, _runtimeContext$app;\n  const output = getEmptyRenderOutput();\n  if (!brickConf.brick) {\n    if (brickConf.template) {\n      // eslint-disable-next-line no-console\n      console.error(\"Legacy templates are dropped in v3:\", brickConf);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(\"Invalid brick:\", brickConf);\n    }\n    return output;\n  }\n\n  // Translate `if: \"<%= ... %>\"` to `brick: \":if\", dataSource: \"<%= ... %>\"`.\n  // In other words, translate tracking if expressions to tracking control nodes of `:if`.\n  const {\n    if: brickIf,\n    permissionsPreCheck,\n    ...restBrickConf\n  } = brickConf;\n  if (isGeneralizedTrackAll(brickIf)) {\n    return renderBrick(returnNode, {\n      brick: \":if\",\n      dataSource: brickIf,\n      // `permissionsPreCheck` maybe required before computing `if`.\n      permissionsPreCheck,\n      slots: {\n        \"\": {\n          type: \"bricks\",\n          bricks: [restBrickConf]\n        }\n      },\n      // These symbols have to be copied to the new brick conf.\n      ...Object.getOwnPropertySymbols(brickConf).reduce((acc, symbol) => ({\n        ...acc,\n        [symbol]: brickConf[symbol]\n      }), {})\n    }, _runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, keyPath, tplStack, initialTracker);\n  }\n  const tplStateStoreId = brickConf[symbolForTplStateStoreId];\n  const formStateStoreId = brickConf[symbolForFormStateStoreId];\n  const runtimeContext = {\n    ..._runtimeContext,\n    tplStateStoreId,\n    formStateStoreId\n  };\n  if (hasOwnProperty(brickConf, symbolForTPlExternalForEachItem)) {\n    // The external bricks of a template should restore their `forEach*` from their host.\n    runtimeContext.forEachItem = brickConf[symbolForTPlExternalForEachItem];\n    runtimeContext.forEachIndex = brickConf[symbolForTPlExternalForEachIndex];\n    runtimeContext.forEachSize = brickConf[symbolForTPlExternalForEachSize];\n  }\n  const {\n    context\n  } = brickConf;\n  // istanbul ignore next\n  if (Array.isArray(context) && context.length > 0) {\n    const strict = isStrictMode(runtimeContext);\n    warnAboutStrictMode(strict, \"Defining context on bricks\", \"check your brick:\", brickConf);\n    if (!strict) {\n      runtimeContext.ctxStore.define(context, runtimeContext);\n    }\n  }\n  runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 || (_hooks$checkPermissio2 = hooks.checkPermissions) === null || _hooks$checkPermissio2 === void 0 ? void 0 : _hooks$checkPermissio2.preCheckPermissionsForBrickOrRoute(brickConf, value => asyncComputeRealValue(value, runtimeContext)));\n  if (!(await asyncCheckBrickIf(brickConf, runtimeContext))) {\n    return output;\n  }\n  const brickName = brickConf.brick;\n  if (brickName.startsWith(\":\")) {\n    ensureValidControlBrick(brickName);\n    const {\n      dataSource\n    } = brickConf;\n    const {\n      contextNames,\n      stateNames\n    } = getTracks(dataSource);\n    const lowerLevelRenderControlNode = async (runtimeContext, tracker, trackDataSource) => {\n      var _slots$slot;\n      // First, compute the `dataSource`\n      const computedDataSource = await asyncComputeRealValue(dataSource, runtimeContext);\n      if (trackDataSource) {\n        trackAfterInitial(runtimeContext, [{\n          contextNames,\n          stateNames,\n          propValue: dataSource\n        }], tracker);\n      }\n\n      // Then, get the matched slot.\n      const slot = brickName === \":forEach\" ? \"\" : brickName === \":switch\" ? String(computedDataSource) : computedDataSource ? \"\" : \"else\";\n\n      // Don't forget to transpile children to slots.\n      const slots = childrenToSlots(brickConf.children, brickConf.slots);\n\n      // Then, get the bricks in that matched slot.\n      const bricks = slots && hasOwnProperty(slots, slot) && ((_slots$slot = slots[slot]) === null || _slots$slot === void 0 ? void 0 : _slots$slot.bricks);\n      if (!Array.isArray(bricks)) {\n        return getEmptyRenderOutput();\n      }\n      switch (brickName) {\n        case \":forEach\":\n          {\n            if (!Array.isArray(computedDataSource)) {\n              return getEmptyRenderOutput();\n            }\n            return renderForEach(returnNode, computedDataSource, bricks, runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, tplStack, keyPath, tracker);\n          }\n        case \":if\":\n        case \":switch\":\n          {\n            return renderBricks(returnNode, bricks, runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, tplStack, keyPath, tracker);\n          }\n      }\n    };\n    const renderControlNode = async (runtimeContext, type) => {\n      var _ref;\n      let changedAfterInitial = false;\n      const tracker = {\n        disposes: [],\n        listener: () => {\n          changedAfterInitial = true;\n        }\n      };\n      let rerenderCount = 0;\n      let rawOutput;\n      let uninitialized = true;\n\n      // When perform an incremental sub-route render, for control nodes,\n      // context maybe changed just after their data source being computed,\n      // as well as props of their children bricks being computed, and before\n      // bricks being mounted. Thus these changes may not take any effects.\n      // So we need to track the context changes after the initial render,\n      // and perform re-renders for these control nodes if necessary.\n      while (uninitialized || changedAfterInitial) {\n        changedAfterInitial = false;\n        rawOutput = await lowerLevelRenderControlNode(runtimeContext, tracker, uninitialized && type === \"initial\");\n        tracker.disposes.forEach(dispose => dispose());\n        tracker.disposes.length = 0;\n        uninitialized = false;\n        // istanbul ignore next\n        if (++rerenderCount > 10) {\n          throw new Error(`Maximum rerender stack overflowed (iid: ${brickConf.iid})`);\n        }\n      }\n      (_ref = rawOutput).node ?? (_ref.node = {\n        tag: RenderTag.PLACEHOLDER,\n        return: returnNode\n      });\n      return rawOutput;\n    };\n    const controlledOutput = await renderControlNode(runtimeContext, \"initial\");\n    const {\n      onMount,\n      onUnmount\n    } = brickConf.lifeCycle ?? {};\n    if (contextNames || stateNames) {\n      controlledOutput.hasTrackingControls = true;\n      let renderId = 0;\n      const listener = async () => {\n        const currentRenderId = ++renderId;\n        const [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext(runtimeContext);\n        const reControlledOutput = await renderControlNode(scopedRuntimeContext, \"rerender\");\n        const scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n        await postAsyncRender(reControlledOutput, scopedRuntimeContext, scopedStores);\n\n        // Ignore stale renders\n        if (renderId === currentRenderId) {\n          if (onUnmount) {\n            listenerFactory(onUnmount, runtimeContext)(new CustomEvent(\"unmount\", {\n              detail: {\n                rerender: true\n              }\n            }));\n          }\n          rendererContext.reRender(slotId, keyPath, reControlledOutput.node, returnNode);\n          if (onMount) {\n            listenerFactory(onMount, scopedRuntimeContext)(new CustomEvent(\"mount\", {\n              detail: {\n                rerender: true\n              }\n            }));\n          }\n          for (const store of scopedStores) {\n            store.mountAsyncData();\n          }\n        }\n      };\n      // Enable leading invocation, to keep tracking orders.\n      const debouncedListener = debounce(listener, 0, {\n        leading: true,\n        trailing: true\n      });\n      const runtimeBrick = returnNode.tag === RenderTag.BRICK ? returnNode : null;\n      const disposes = runtimeBrick ? runtimeBrick.disposes ?? (runtimeBrick.disposes = []) : [];\n      if (contextNames) {\n        for (const contextName of contextNames) {\n          disposes.push(runtimeContext.ctxStore.onChange(contextName, debouncedListener));\n        }\n      }\n      if (stateNames) {\n        for (const contextName of stateNames) {\n          const tplStateStore = getTplStateStore(runtimeContext, \"STATE\", `: \"${dataSource}\"`);\n          disposes.push(tplStateStore.onChange(contextName, debouncedListener));\n        }\n      }\n    }\n    if (onMount) {\n      rendererContext.registerArbitraryLifeCycle(\"onMount\", () => {\n        listenerFactory(onMount, runtimeContext)(new CustomEvent(\"mount\", {\n          detail: {\n            rerender: false\n          }\n        }));\n      });\n    }\n    if (onUnmount) {\n      rendererContext.registerArbitraryLifeCycle(\"onUnmount\", () => {\n        listenerFactory(onUnmount, runtimeContext)(new CustomEvent(\"unmount\", {\n          detail: {\n            rerender: false\n          }\n        }));\n      });\n    }\n    return controlledOutput;\n  }\n\n  // Widgets need to be defined before rendering.\n  if (/\\.tpl-/.test(brickName) && !customTemplates.get(brickName)) {\n    await catchLoad(loadBricksImperatively([brickName], getBrickPackages()), \"brick\", brickName, rendererContext.unknownBricks);\n  }\n  const tplTagName = getTagNameOfCustomTemplate(brickName, (_runtimeContext$app = runtimeContext.app) === null || _runtimeContext$app === void 0 ? void 0 : _runtimeContext$app.id);\n  if (tplTagName) {\n    const tplCount = tplStack.get(tplTagName) ?? 0;\n    if (tplCount >= 10) {\n      throw new Error(`Maximum custom template stack overflowed: \"${tplTagName}\"`);\n    }\n    tplStack.set(tplTagName, tplCount + 1);\n  } else if (brickName.includes(\"-\") && !customElements.get(brickName)) {\n    if (brickName === FORM_RENDERER) {\n      registerFormRenderer();\n    } else {\n      output.blockingList.push(catchLoad(enqueueStableLoadBricks([brickName], getBrickPackages()), \"brick\", brickName, rendererContext.unknownBricks));\n    }\n  }\n  let formData;\n  let confProps;\n  if (brickName === FORM_RENDERER) {\n    var _brickConf$properties;\n    ({\n      formData,\n      ...confProps\n    } = brickConf.properties ?? {});\n    if ((_brickConf$properties = brickConf.properties) !== null && _brickConf$properties !== void 0 && _brickConf$properties.compute) {\n      formData = await asyncComputeRealValue(formData, runtimeContext);\n    }\n  } else {\n    confProps = brickConf.properties;\n  }\n  const trackingContextList = [];\n  const asyncPropertyEntries = asyncComputeRealPropertyEntries(confProps, runtimeContext, trackingContextList);\n  const computedPropsFromHost = brickConf[symbolForAsyncComputedPropsFromHost];\n  if (computedPropsFromHost) {\n    asyncPropertyEntries.push(...computedPropsFromHost);\n  }\n  const isScript = brickName === \"script\";\n  if (isScript || brickName === \"link\") {\n    const props = await constructAsyncProperties(asyncPropertyEntries);\n    if (isScript ? props.src : props.rel === \"stylesheet\" && props.href) {\n      const prefix = window.PUBLIC_ROOT ?? \"\";\n      if (isScript) {\n        const {\n          src,\n          ...attrs\n        } = props;\n        await catchLoad(loadScript(src, prefix, attrs), \"script\", src, \"silent\");\n      } else {\n        const {\n          href,\n          ...attrs\n        } = props;\n        await catchLoad(loadStyle(href, prefix, attrs), \"stylesheet\", href, \"silent\");\n      }\n      return output;\n    }\n  }\n  const brick = {\n    tag: RenderTag.BRICK,\n    type: tplTagName || brickName,\n    return: returnNode,\n    slotId,\n    events: brickConf.events,\n    runtimeContext,\n    portal: brickConf.portal,\n    iid: brickConf.iid,\n    ref: brickConf.ref\n  };\n  output.node = brick;\n\n  // 在最终挂载前，先加载所有可能用到的 processors。\n  const usedProcessors = strictCollectMemberUsage([brickConf.events, brickConf.lifeCycle], \"PROCESSORS\", 2);\n  if (usedProcessors.size > 0) {\n    output.blockingList.push(catchLoad(loadProcessorsImperatively(usedProcessors, getBrickPackages()), \"processors\", [...usedProcessors].join(\", \"), rendererContext.unknownBricks));\n  }\n\n  // 加载构件属性和加载子构件等任务，可以并行。\n  const blockingList = [];\n\n  // Note: properties here has already been initialized.\n  trackAfterInitial(runtimeContext, trackingContextList, initialTracker);\n  const loadProperties = async () => {\n    brick.properties = await constructAsyncProperties(asyncPropertyEntries);\n    listenOnTrackingContext(brick, trackingContextList);\n  };\n  blockingList.push(loadProperties());\n  rendererContext.registerBrickLifeCycle(brick, brickConf.lifeCycle);\n  let expandedBrickConf = brickConf;\n  if (tplTagName) {\n    expandedBrickConf = expandCustomTemplate(tplTagName, brickConf, brick, asyncPropertyEntries, rendererContext);\n  } else if (brickName === FORM_RENDERER) {\n    expandedBrickConf = expandFormRenderer(formData, brickConf, brick, asyncPropertyEntries, rendererContext);\n  }\n  if (expandedBrickConf.portal) {\n    // A portal brick has no slotId.\n    brick.slotId = undefined;\n  }\n  let childRuntimeContext;\n  if (tplTagName) {\n    // There is a boundary for `forEachItem` between template internals and externals.\n    childRuntimeContext = {\n      ...runtimeContext\n    };\n    delete childRuntimeContext.forEachItem;\n    delete childRuntimeContext.forEachIndex;\n    delete childRuntimeContext.forEachSize;\n  } else {\n    childRuntimeContext = runtimeContext;\n  }\n  const loadChildren = async () => {\n    const slots = childrenToSlots(expandedBrickConf.children, expandedBrickConf.slots);\n    if (!slots) {\n      return;\n    }\n    const routeSlotFromIndexToSlotId = new Map();\n    const rendered = await Promise.all(Object.entries(slots).map((_ref2, index) => {\n      let [childSlotId, slotConf] = _ref2;\n      if (slotConf.type !== \"routes\") {\n        return renderBricks(brick, slotConf.bricks, childRuntimeContext, rendererContext, parentRoutes, menuRequestReturnNode, childSlotId, tplStack, undefined, initialTracker);\n      }\n      const parentRoute = parentRoutes[parentRoutes.length - 1];\n      if (parentRoute !== null && parentRoute !== void 0 && parentRoute.incrementalSubRoutes) {\n        routeSlotFromIndexToSlotId.set(index, childSlotId);\n        rendererContext.performIncrementalRender(slotConf, parentRoutes, async (location, prevLocation) => {\n          const {\n            homepage\n          } = childRuntimeContext.app;\n          const {\n            pathname\n          } = location;\n          // Ignore if any one of homepage and parent routes not matched.\n          if (!matchHomepage(homepage, pathname) || !parentRoutes.every(route => {\n            let prevMatch;\n            let newMatch;\n            return (prevMatch = matchRoute(route, homepage, prevLocation.pathname)) && (newMatch = matchRoute(route, homepage, pathname)) && (route !== parentRoute || isEqual(prevMatch.params, newMatch.params));\n          })) {\n            return false;\n          }\n          const [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext({\n            ...childRuntimeContext,\n            location,\n            query: new URLSearchParams(location.search)\n          });\n          let failed = false;\n          let incrementalOutput;\n          let scopedStores = [];\n          try {\n            incrementalOutput = await renderRoutes(brick, slotConf.routes, scopedRuntimeContext, rendererContext, parentRoutes, menuRequestReturnNode, childSlotId, true);\n\n            // Do not ignore incremental rendering even if all sub-routes are missed.\n            // Since parent route is matched.\n            if (incrementalOutput.route) {\n              // Bailout if redirect or unauthenticated is set\n              if (rendererContext.reBailout(incrementalOutput)) {\n                return true;\n              }\n              scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n              await postAsyncRender(incrementalOutput, scopedRuntimeContext, [scopedRuntimeContext.ctxStore, ...scopedStores]);\n            }\n            await rendererContext.reMergeMenuRequestNodes(menuRequestReturnNode, slotConf.routes, incrementalOutput.menuRequestNode);\n          } catch (error) {\n            // eslint-disable-next-line no-console\n            console.error(\"Incremental sub-router failed:\", error);\n            const result = await rendererContext.reCatch(error, brick);\n            if (!result) {\n              return true;\n            }\n            ({\n              failed,\n              output: incrementalOutput\n            } = result);\n\n            // Assert: no errors will be throw\n            await rendererContext.reMergeMenuRequestNodes(menuRequestReturnNode, slotConf.routes, incrementalOutput.menuRequestNode);\n          }\n          rendererContext.reRender(childSlotId, [], incrementalOutput.node, brick);\n          if (!failed) {\n            scopedRuntimeContext.ctxStore.mountAsyncData(incrementalOutput.route);\n            for (const store of scopedStores) {\n              store.mountAsyncData();\n            }\n          }\n\n          // When result is null, it means the incremental rendering is tried but routes missed.\n          // In this case, we should continue to re-render the parent routes.\n          return incrementalOutput.route ? true : null;\n        });\n      }\n      return renderRoutes(brick, slotConf.routes, childRuntimeContext, rendererContext, parentRoutes, menuRequestReturnNode, childSlotId, undefined, initialTracker);\n    }));\n    const childrenOutput = {\n      ...output,\n      node: undefined,\n      blockingList: [],\n      menuRequestNode: undefined\n    };\n    rendered.forEach((item, index) => {\n      if (routeSlotFromIndexToSlotId.has(index)) {\n        // Memoize a render node before it's been merged.\n        rendererContext.memoize(routeSlotFromIndexToSlotId.get(index), [], item.node, brick);\n      }\n      mergeRenderOutput(childrenOutput, item);\n      mergeSiblingRenderMenuRequest(childrenOutput, item);\n    });\n    if (childrenOutput.node) {\n      brick.child = childrenOutput.node;\n    }\n    mergeRenderOutput(output, {\n      ...childrenOutput,\n      node: undefined\n    });\n    appendMenuRequestNode(menuRequestReturnNode, output.menuRequestNode = childrenOutput.menuRequestNode);\n  };\n  blockingList.push(loadChildren());\n  await Promise.all(blockingList);\n  return output;\n}\nfunction isGeneralizedTrackAll(brickIf) {\n  return typeof brickIf === \"string\" ? isTrackAll(brickIf) : isPreEvaluated(brickIf) &&\n  // istanbul ignore next: covered by e2e tests\n  isTrackAll(getPreEvaluatedRaw(brickIf));\n}\nfunction ensureValidControlBrick(brick) {\n  if (brick !== \":forEach\" && brick !== \":if\" && brick !== \":switch\") {\n    throw new Error(`Unknown storyboard control node: \"${brick}\"`);\n  }\n}\nasync function renderForEach(returnNode, dataSource, bricks, runtimeContext, rendererContext, parentRoutes, menuRequestReturnNode, slotId, tplStack, keyPath, initialTracker) {\n  const output = getEmptyRenderOutput();\n  const size = dataSource.length;\n  const rendered = await Promise.all(dataSource.map((item, i) => Promise.all(bricks.map((brickConf, j) => renderBrick(returnNode, brickConf, {\n    ...runtimeContext,\n    forEachItem: item,\n    forEachIndex: i,\n    forEachSize: size\n  }, rendererContext, parentRoutes, menuRequestReturnNode, slotId, keyPath.concat(i * size + j), tplStack && new Map(tplStack), initialTracker)))));\n\n  // 多层构件并行异步转换，但转换的结果按原顺序串行合并。\n  rendered.flat().forEach((item, index) => {\n    if (item.hasTrackingControls) {\n      // Memoize a render node before it's been merged.\n      rendererContext.memoize(slotId, keyPath.concat(index), item.node, returnNode);\n    }\n    mergeRenderOutput(output, item);\n  });\n  return output;\n}\nexport function getDataStores(runtimeContext) {\n  return [runtimeContext.ctxStore, ...runtimeContext.tplStateStoreMap.values(), ...runtimeContext.formStateStoreMap.values()];\n}\nexport function postAsyncRender(output, runtimeContext, stores) {\n  flushStableLoadBricks();\n  return Promise.all([...output.blockingList, ...stores.map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck]);\n}\nexport function createScopedRuntimeContext(runtimeContext) {\n  const tplStateStoreScope = [];\n  const formStateStoreScope = [];\n  const scopedRuntimeContext = {\n    ...runtimeContext,\n    tplStateStoreScope,\n    formStateStoreScope\n  };\n  return [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope];\n}\nfunction loadMenu(menuConf, runtimeContext) {\n  if (!menuConf) {\n    return;\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"brick\") {\n    // eslint-disable-next-line no-console\n    console.error(\"Set menu with brick is dropped in v3:\", menuConf);\n    throw new Error(\"Set menu with brick is dropped in v3\");\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"resolve\") {\n    // eslint-disable-next-line no-console\n    console.warn(\"Set menu with resolve is not supported in v3 yet:\", menuConf);\n    return;\n  }\n  return asyncComputeRealValue(menuConf, runtimeContext);\n}\nfunction mergeRenderOutput(output, newOutput) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const {\n    blockingList,\n    node,\n    menuRequestNode,\n    hasTrackingControls,\n    ...rest\n  } = newOutput;\n  output.blockingList.push(...blockingList);\n  if (node) {\n    if (output.node) {\n      let last = output.node;\n      while (last.sibling) {\n        last = last.sibling;\n      }\n      last.sibling = node;\n    } else {\n      output.node = node;\n    }\n  }\n  Object.assign(output, rest);\n}\nfunction mergeSiblingRenderMenuRequest(output, newOutput) {\n  const menuRequestNode = newOutput.menuRequestNode;\n  if (menuRequestNode) {\n    if (output.menuRequestNode) {\n      let last = output.menuRequestNode;\n      while (last.sibling) {\n        last = last.sibling;\n      }\n      last.sibling = menuRequestNode;\n    } else {\n      output.menuRequestNode = menuRequestNode;\n    }\n  }\n}\nfunction appendMenuRequestNode(menuRequestReturnNode, menuRequestNode) {\n  if (!menuRequestNode) {\n    return;\n  }\n  if (menuRequestReturnNode.child) {\n    let last = menuRequestReturnNode.child;\n    while (last.sibling) {\n      last = last.sibling;\n    }\n    last.sibling = menuRequestNode;\n  } else {\n    menuRequestReturnNode.child = menuRequestNode;\n  }\n}\nfunction getEmptyRenderOutput() {\n  return {\n    blockingList: []\n  };\n}\nexport function childrenToSlots(children, originalSlots) {\n  let newSlots = originalSlots;\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && children && !Array.isArray(children)) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Specified brick children but not array:\", `<${typeof children}>`, children);\n  }\n  if (Array.isArray(children) && !newSlots) {\n    newSlots = {};\n    for (const child of children) {\n      const slot = child.slot ?? \"\";\n      if (!hasOwnProperty(newSlots, slot)) {\n        newSlots[slot] = {\n          type: \"bricks\",\n          bricks: []\n        };\n      }\n      newSlots[slot].bricks.push(child);\n    }\n  }\n  return newSlots;\n}\nfunction catchLoad(promise, type, name, unknownPolicy) {\n  return unknownPolicy === \"silent\" ? promise.catch(e => {\n    // eslint-disable-next-line no-console\n    console.error(`Load %s \"%s\" failed:`, type, name, e);\n  }) : promise;\n}\n//# sourceMappingURL=Renderer.js.map","import { isObject } from \"@next-core/utils/general\";\nimport { symbolForRootRuntimeContext } from \"./secret_internals.js\";\nimport { childrenToSlots } from \"./Renderer.js\";\nexport function setupRootRuntimeContext(bricks, runtimeContext, shallow) {\n  function walk(props) {\n    if (!isObject(props) || typeof props === \"function\") {\n      return;\n    }\n    if (Array.isArray(props)) {\n      props.map(walk);\n      return;\n    }\n    for (const [key, value] of Object.entries(props)) {\n      if (isObject(value) && key === \"useBrick\") {\n        if (Array.isArray(value)) {\n          value.forEach(v => setupBrick(v, true));\n        } else {\n          setupBrick(value, true,\n          // For inside useBrick, we always need to setup recursively.\n          true);\n        }\n      } else {\n        walk(value);\n      }\n    }\n  }\n  function setupBrick(brick, inUseBrick, forceRecursive) {\n    if (inUseBrick) {\n      brick[symbolForRootRuntimeContext] = runtimeContext;\n    }\n    walk(brick.properties);\n    if (shallow && !forceRecursive) {\n      return;\n    }\n    const transpiledSlots = childrenToSlots(brick.children, brick.slots);\n    for (const slotConf of Object.values(transpiledSlots ?? {})) {\n      for (const brick of slotConf.bricks ?? []) {\n        setupBrick(brick, inUseBrick);\n      }\n    }\n  }\n  for (const brick of bricks) {\n    setupBrick(brick);\n  }\n}\n//# sourceMappingURL=setupRootRuntimeContext.js.map","import { getBasePath } from \"./getBasePath.js\";\nlet misc;\n\n/** 运行时页面信息。*/\n\nexport function getPageInfo() {\n  if (!misc) {\n    misc = {\n      isInIframe: false,\n      isInIframeOfSameSite: false,\n      isInIframeOfNext: false,\n      isInIframeOfVisualBuilder: false,\n      isInIframeOfLegacyConsole: false\n    };\n    if (window !== window.parent) {\n      misc.isInIframe = true;\n      try {\n        // Handle:\n        // - Previewing in visual builder by iframe.\n        // - Nesting next in next.\n        // - Nesting console in next.\n        if (window.origin === window.parent.origin) {\n          misc.isInIframeOfSameSite = true;\n          const selfIsNext = getBasePath() === \"/next/\";\n          const parentPathname = window.parent.location.pathname;\n          const parentIsNext = parentPathname.startsWith(\"/next/\");\n          misc.isInIframeOfNext = (Number(selfIsNext) ^ Number(parentIsNext)) === 0;\n          const prefix = parentIsNext ? \"/next\" : \"\";\n          // Allow visual-builder-* extension apps.\n          misc.isInIframeOfVisualBuilder = parentPathname.startsWith(`${prefix}/visual-builder/`) || parentPathname.startsWith(`${prefix}/visual-builder-`);\n          misc.isInIframeOfLegacyConsole = selfIsNext && !parentIsNext;\n        }\n      } catch {\n        // do nothing\n      }\n    }\n    Object.freeze(misc);\n  }\n  return misc;\n}\n//# sourceMappingURL=getPageInfo.js.map","import { http } from \"@next-core/http\";\nlet nativeController;\nexport function initAbortController() {\n  if (!window.AbortController) {\n    return;\n  }\n  nativeController = new AbortController();\n  http.interceptors.request.use(config => {\n    var _config$options;\n    return {\n      ...config,\n      options: {\n        ...config.options,\n        signal: (_config$options = config.options) !== null && _config$options !== void 0 && _config$options.noAbortOnRouteChange ? null : nativeController.signal\n      }\n    };\n  });\n}\nexport function abortPendingRequest() {\n  if (nativeController) {\n    nativeController.abort();\n    nativeController = new AbortController();\n  }\n}\n//# sourceMappingURL=abortController.js.map","import { loadBricksImperatively } from \"@next-core/loader\";\nimport { getBrickPackages, getRuntime, hooks } from \"./internal/Runtime.js\";\nimport { omit } from \"lodash\";\nlet brick;\nexport const WATEMARK_BRICKNAME = \"basic.show-watermark\";\nexport function setWatermark() {\n  var _window$APP_ROOT, _window$APP_ROOT2, _hooks$auth, _watermarkConfig$flag, _watermarkConfig$flag2;\n  const flags = getRuntime().getFeatureFlags();\n  const settings = getRuntime().getMiscSettings();\n  if (!flags[\"show-watermark\"]) {\n    return;\n  }\n  const isDeveloper = ((_window$APP_ROOT = window.APP_ROOT) === null || _window$APP_ROOT === void 0 || (_window$APP_ROOT = _window$APP_ROOT.match(/versions\\/([^/]+)\\//)) === null || _window$APP_ROOT === void 0 ? void 0 : _window$APP_ROOT[1]) === \"0.0.0\" || ((_window$APP_ROOT2 = window.APP_ROOT) === null || _window$APP_ROOT2 === void 0 || (_window$APP_ROOT2 = _window$APP_ROOT2.match(/micro-apps\\/(?:v2|v3)\\/[^/]+\\/([^/]+)/)) === null || _window$APP_ROOT2 === void 0 ? void 0 : _window$APP_ROOT2[1]) === \"0.0.0\";\n  const username = (hooks === null || hooks === void 0 || (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 || (_hooks$auth = _hooks$auth.getAuth()) === null || _hooks$auth === void 0 ? void 0 : _hooks$auth.username) ?? \"\";\n  const watermarkConfig = settings.watermarkConfig ?? {\n    flags: {}\n  };\n  const content = [...(typeof watermarkConfig.content === \"string\" ? [watermarkConfig.content] : watermarkConfig.content ?? []), (_watermarkConfig$flag = watermarkConfig.flags) !== null && _watermarkConfig$flag !== void 0 && _watermarkConfig$flag[\"show-development\"] && isDeveloper ? \"Development\" : \"\", (_watermarkConfig$flag2 = watermarkConfig.flags) !== null && _watermarkConfig$flag2 !== void 0 && _watermarkConfig$flag2[\"show-user\"] ? username : \"\"].filter(Boolean);\n\n  // Do not call showWatermark if there is no content\n  if (content.length === 0) {\n    return;\n  }\n  const defaultProps = {\n    content,\n    zIndex: 1001,\n    width: 200,\n    font: {\n      fontSize: 28\n    },\n    gap: [190, 190],\n    ...omit(watermarkConfig, [\"content\", \"flags\"])\n  };\n  if (brick) {\n    brick.resolve(defaultProps);\n  } else {\n    loadBricksImperatively([WATEMARK_BRICKNAME], getBrickPackages()).then(() => {\n      brick = document.createElement(WATEMARK_BRICKNAME);\n      brick.resolve(defaultProps);\n    },\n    // istanbul ignore next\n    error => {\n      // eslint-disable-next-line no-console\n      console.error(\"Load watermark service failed:\", error);\n    });\n  }\n}\n//# sourceMappingURL=setWatermark.js.map","import { customTemplates } from \"../CustomTemplates.js\";\nexport function registerCustomTemplates(storyboard) {\n  var _storyboard$meta;\n  if (storyboard.$$registerCustomTemplateProcessed) {\n    return;\n  }\n  storyboard.$$registerCustomTemplateProcessed = true;\n  const templates = (_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.customTemplates;\n  if (Array.isArray(templates)) {\n    for (const tpl of templates) {\n      const tagName = tpl.name.includes(\".\") ? tpl.name : `${storyboard.app.id}.${tpl.name}`;\n      customTemplates.define(tagName, tpl);\n    }\n  }\n}\n//# sourceMappingURL=registerCustomTemplates.js.map","export function setUIVersion(version) {\n  // 仅允许特定的 UI 版本\n  let ui;\n  switch (version) {\n    case \"8.2\":\n      ui = \"v8-2\";\n      break;\n    default:\n      ui = \"v8\";\n  }\n  document.documentElement.dataset.ui = ui;\n}\n//# sourceMappingURL=setUIVersion.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport _assertClassBrand from \"@babel/runtime/helpers/assertClassBrand\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet2\";\nimport { locationsAreEqual } from \"history\";\nimport { HttpAbortError } from \"@next-core/http\";\nimport { clearExpressionASTCache, clearFunctionASTCache } from \"@next-core/cook\";\nimport { uniqueId } from \"lodash\";\nimport { getHistory } from \"../history.js\";\nimport { getDataStores, postAsyncRender, renderRoutes } from \"./Renderer.js\";\nimport { DataStore } from \"./data/DataStore.js\";\nimport { clearResolveCache } from \"./data/resolveData.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { isOutsideApp, matchStoryboard } from \"./matchStoryboard.js\";\nimport { registerStoryboardFunctions } from \"./compute/StoryboardFunctions.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { applyMode, applyTheme, getLocalAppsTheme, setMode, setTheme } from \"../themeAndMode.js\";\nimport { _internalApiGetAppInBootstrapData, getRuntime, hooks } from \"./Runtime.js\";\nimport { getPageInfo } from \"../getPageInfo.js\";\nimport { resetAllComputedMarks } from \"./compute/markAsComputed.js\";\nimport { handleHttpError, isUnauthenticatedError } from \"../handleHttpError.js\";\nimport { abortPendingRequest, initAbortController } from \"./abortController.js\";\nimport { setLoginStateCookie } from \"../setLoginStateCookie.js\";\nimport { registerCustomTemplates } from \"./registerCustomTemplates.js\";\nimport { fulfilStoryboard } from \"./fulfilStoryboard.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { insertPreviewRoutes } from \"./insertPreviewRoutes.js\";\nimport { devtoolsHookEmit } from \"./devtools.js\";\nimport { setUIVersion } from \"../setUIVersion.js\";\nimport { setAppVariable } from \"../setAppVariable.js\";\nimport { setWatermark } from \"../setWatermark.js\";\nimport { clearMatchedRoutes } from \"./routeMatchedMap.js\";\nimport { ErrorNode, PageNotFoundError } from \"./ErrorNode.js\";\nvar _storyboards = /*#__PURE__*/new WeakMap();\nvar _rendering = /*#__PURE__*/new WeakMap();\nvar _nextRender = /*#__PURE__*/new WeakMap();\nvar _runtimeContext = /*#__PURE__*/new WeakMap();\nvar _rendererContext = /*#__PURE__*/new WeakMap();\nvar _rendererContextTrashCan = /*#__PURE__*/new WeakMap();\nvar _redirectCount = /*#__PURE__*/new WeakMap();\nvar _renderId = /*#__PURE__*/new WeakMap();\nvar _currentApp = /*#__PURE__*/new WeakMap();\nvar _previousApp = /*#__PURE__*/new WeakMap();\nvar _navConfig = /*#__PURE__*/new WeakMap();\nvar _Router_brand = /*#__PURE__*/new WeakSet();\nexport class Router {\n  constructor(storyboards) {\n    _classPrivateMethodInitSpec(this, _Router_brand);\n    _classPrivateFieldInitSpec(this, _storyboards, void 0);\n    _classPrivateFieldInitSpec(this, _rendering, false);\n    _classPrivateFieldInitSpec(this, _nextRender, void 0);\n    _classPrivateFieldInitSpec(this, _runtimeContext, void 0);\n    _classPrivateFieldInitSpec(this, _rendererContext, void 0);\n    _classPrivateFieldInitSpec(this, _rendererContextTrashCan, new Set());\n    _classPrivateFieldInitSpec(this, _redirectCount, 0);\n    _classPrivateFieldInitSpec(this, _renderId, void 0);\n    _classPrivateFieldInitSpec(this, _currentApp, void 0);\n    _classPrivateFieldInitSpec(this, _previousApp, void 0);\n    _classPrivateFieldInitSpec(this, _navConfig, void 0);\n    _classPrivateFieldSet(_storyboards, this, storyboards);\n    const _history = getHistory();\n    window.addEventListener(\"beforeunload\", event => {\n      const message = _assertClassBrand(_Router_brand, this, _getBlockMessageBeforePageLave).call(this, {});\n      // See examples in https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload\n      if (message) {\n        // Cancel the event\n        // If you prevent default behavior in Mozilla Firefox prompt will always be shown\n        event.preventDefault();\n        // Chrome requires returnValue to be set\n        event.returnValue = \"\";\n      } else {\n        // the absence of a returnValue property on the event will guarantee the browser unload happens\n        delete event.returnValue;\n      }\n    });\n    _history.block((location, action) => _assertClassBrand(_Router_brand, this, _getBlockMessageBeforePageLave).call(this, {\n      location,\n      action\n    }));\n  }\n  getRenderId() {\n    return _classPrivateFieldGet(_renderId, this);\n  }\n\n  // istanbul ignore next\n  getRuntimeContext() {\n    return _classPrivateFieldGet(_runtimeContext, this);\n  }\n  getRecentApps() {\n    return {\n      currentApp: _classPrivateFieldGet(_currentApp, this),\n      previousApp: _classPrivateFieldGet(_previousApp, this)\n    };\n  }\n  getNavConfig() {\n    return _classPrivateFieldGet(_navConfig, this);\n  }\n  bootstrap() {\n    initAbortController();\n    const history = getHistory();\n    let nextPrevLocation = history.location;\n    history.listen((location, action) => {\n      const prevLocation = nextPrevLocation;\n      nextPrevLocation = location;\n      if (_classPrivateFieldGet(_rendering, this)) {\n        _classPrivateFieldSet(_nextRender, this, {\n          location,\n          prevLocation,\n          action\n        });\n      } else {\n        _assertClassBrand(_Router_brand, this, _queuedRender).call(this, {\n          location,\n          prevLocation,\n          action\n        }).catch(handleHttpError);\n      }\n    });\n    return _assertClassBrand(_Router_brand, this, _queuedRender).call(this, {\n      location: history.location\n    });\n  }\n}\nfunction _getBlockMessageBeforePageLave(detail) {\n  var _classPrivateFieldGet2;\n  const history = getHistory();\n  const previousMessage = history.getBlockMessage();\n  (_classPrivateFieldGet2 = _classPrivateFieldGet(_rendererContext, this)) === null || _classPrivateFieldGet2 === void 0 || _classPrivateFieldGet2.dispatchBeforePageLeave(detail);\n  const message = history.getBlockMessage();\n  if (!previousMessage && message) {\n    // Auto unblock only if new block was introduced by `onBeforePageLeave`.\n    history.unblock();\n  }\n  return message;\n}\nfunction _safeRedirect(to, state, from) {\n  var _this$redirectCount, _this$redirectCount2;\n  if ((_classPrivateFieldSet(_redirectCount, this, (_this$redirectCount = _classPrivateFieldGet(_redirectCount, this), _this$redirectCount2 = _this$redirectCount++, _this$redirectCount)), _this$redirectCount2) > 10) {\n    const message = `Infinite redirect detected: from \"${from.pathname}${from.search}${from.hash}\" to \"${to}\"`;\n    // istanbul ignore else: error cannot be caught in test\n    if (process.env.NODE_ENV === \"test\") {\n      // eslint-disable-next-line no-console\n      console.error(message);\n      return;\n    } else {\n      throw new Error(message);\n    }\n  }\n  getHistory().replace(to, state);\n}\nasync function _queuedRender(next) {\n  _classPrivateFieldSet(_rendering, this, true);\n  try {\n    await _assertClassBrand(_Router_brand, this, _preRender).call(this, next);\n  } finally {\n    _classPrivateFieldSet(_rendering, this, false);\n    if (_classPrivateFieldGet(_nextRender, this)) {\n      const nextRender = _classPrivateFieldGet(_nextRender, this);\n      _classPrivateFieldSet(_nextRender, this, undefined);\n      await _assertClassBrand(_Router_brand, this, _queuedRender).call(this, nextRender);\n    }\n  }\n}\nasync function _preRender(_ref) {\n  let {\n    location,\n    prevLocation,\n    action\n  } = _ref;\n  if (prevLocation) {\n    var _prevLocation$state, _location$state, _location$state2, _classPrivateFieldGet4;\n    let ignoreRendering;\n    const omittedLocationProps = {\n      hash: undefined,\n      state: undefined\n    };\n    // Omit the \"key\" when checking whether locations are equal in certain situations.\n    if (\n    // When current location is triggered by browser action of hash link.\n    location.key === undefined ||\n    // When current location is triggered by browser action of non-push-or-replace,\n    // such as goBack or goForward,\n    action === \"POP\" && (\n    // and the previous location was triggered by hash link,\n    prevLocation.key === undefined ||\n    // or the previous location specified notify false.\n    ((_prevLocation$state = prevLocation.state) === null || _prevLocation$state === void 0 ? void 0 : _prevLocation$state.notify) === false)) {\n      omittedLocationProps.key = undefined;\n    }\n    if (locationsAreEqual({\n      ...prevLocation,\n      ...omittedLocationProps\n    }, {\n      ...location,\n      ...omittedLocationProps\n    }) || action !== \"POP\" && ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.notify) === false) {\n      // Ignore rendering if location not changed except hash, state and optional key.\n      // Ignore rendering if notify is `false`.\n      ignoreRendering = true;\n    }\n    if (!ignoreRendering && !((_location$state2 = location.state) !== null && _location$state2 !== void 0 && _location$state2.noIncremental)) {\n      var _classPrivateFieldGet3;\n      ignoreRendering = await ((_classPrivateFieldGet3 = _classPrivateFieldGet(_rendererContext, this)) === null || _classPrivateFieldGet3 === void 0 ? void 0 : _classPrivateFieldGet3.didPerformIncrementalRender(location, prevLocation));\n    }\n    if (ignoreRendering) {\n      return;\n    }\n    abortPendingRequest();\n    (_classPrivateFieldGet4 = _classPrivateFieldGet(_rendererContext, this)) === null || _classPrivateFieldGet4 === void 0 || _classPrivateFieldGet4.dispatchPageLeave();\n    if (action === \"POP\") {\n      const storyboard = matchStoryboard(_classPrivateFieldGet(_storyboards, this), location.pathname);\n      // When a browser action of goBack or goForward is performing,\n      // force reload when the target page is a page of an outside app.\n      if (isOutsideApp(storyboard)) {\n        window.location.reload();\n        return;\n      }\n    }\n    devtoolsHookEmit(\"locationChange\");\n  }\n  return _assertClassBrand(_Router_brand, this, _render).call(this, location, !prevLocation);\n}\nasync function _render(location, isBootstrap) {\n  var _hooks$flowApi, _hooks$pageView, _classPrivateFieldGet5, _storyboard$app;\n  const renderId = _classPrivateFieldSet(_renderId, this, uniqueId(\"render-id-\"));\n  resetAllComputedMarks();\n  clearResolveCache();\n  hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 || _hooks$flowApi.clearCollectWidgetContract();\n  const history = getHistory();\n  history.unblock();\n\n  // const renderStartTime = performance.now();\n  const finishPageView = hooks === null || hooks === void 0 || (_hooks$pageView = hooks.pageView) === null || _hooks$pageView === void 0 ? void 0 : _hooks$pageView.create();\n  const storyboard = matchStoryboard(_classPrivateFieldGet(_storyboards, this), location.pathname);\n  const previousApp = (_classPrivateFieldGet5 = _classPrivateFieldGet(_runtimeContext, this)) === null || _classPrivateFieldGet5 === void 0 ? void 0 : _classPrivateFieldGet5.app;\n  const currentAppId = storyboard === null || storyboard === void 0 || (_storyboard$app = storyboard.app) === null || _storyboard$app === void 0 ? void 0 : _storyboard$app.id;\n  //  dynamically change the value of the APP variable, if it's union app\n  if (window.BOOTSTRAP_UNION_FILE && currentAppId && currentAppId !== (previousApp === null || previousApp === void 0 ? void 0 : previousApp.id)) {\n    setAppVariable({\n      appId: currentAppId,\n      version: storyboard.app.currentVersion\n    });\n  }\n  if (storyboard !== null && storyboard !== void 0 && storyboard.app) {\n    await fulfilStoryboard(storyboard);\n  }\n  const currentApp = _classPrivateFieldSet(_currentApp, this, storyboard === null || storyboard === void 0 ? void 0 : storyboard.app);\n  setWatermark();\n\n  // Storyboard maybe re-assigned, e.g. when open launchpad.\n  const appChanged = previousApp && currentApp ? previousApp.id !== currentApp.id : previousApp !== currentApp;\n  clearExpressionASTCache();\n  if (appChanged) {\n    clearFunctionASTCache();\n  }\n\n  // TODO: handle favicon\n\n  // Set `Router::#currentApp` before calling `getFeatureFlags()`\n  const flags = getRuntime().getFeatureFlags();\n  const prevRendererContext = _classPrivateFieldGet(_rendererContext, this);\n  const redirectTo = (to, state) => {\n    finishPageView === null || finishPageView === void 0 || finishPageView({\n      status: \"redirected\"\n    });\n    _classPrivateFieldGet(_rendererContextTrashCan, this).add(prevRendererContext);\n    _assertClassBrand(_Router_brand, this, _safeRedirect).call(this, to, state, location);\n  };\n  const redirectToLogin = () => {\n    const to = flags[\"sso-enabled\"] ? \"/sso-auth/login\" : \"/auth/login\";\n    setLoginStateCookie(location);\n    redirectTo(to, {\n      from: location\n    });\n  };\n  const main = document.querySelector(\"#main-mount-point\");\n  const portal = document.querySelector(\"#portal-mount-point\");\n  const renderRoot = {\n    tag: RenderTag.ROOT,\n    container: main,\n    createPortal: portal\n  };\n  const cleanUpPreviousRender = () => {\n    var _hooks$messageDispatc;\n    unmountTree(main);\n    unmountTree(portal);\n\n    // Note: redirects can lead to multiple trash renderer contexts.\n    _classPrivateFieldGet(_rendererContextTrashCan, this).add(prevRendererContext);\n    for (const item of _classPrivateFieldGet(_rendererContextTrashCan, this)) {\n      if (item) {\n        item.dispatchOnUnmount();\n        item.dispose();\n      }\n    }\n    _classPrivateFieldGet(_rendererContextTrashCan, this).clear();\n    hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 || _hooks$messageDispatc.reset();\n    if (appChanged) {\n      _classPrivateFieldSet(_previousApp, this, previousApp);\n      window.dispatchEvent(new CustomEvent(\"app.change\", {\n        detail: {\n          previousApp,\n          currentApp\n        }\n      }));\n    }\n  };\n  setTheme(currentApp && (getLocalAppsTheme()[currentApp.id] || currentApp.theme) || \"light\");\n  setMode(\"default\");\n  if (currentApp) {\n    var _hooks$checkInstalled, _hooks$auth, _hooks$checkPermissio, _storyboard$meta, _hooks$flowApi2, _storyboard$meta2;\n    hooks === null || hooks === void 0 || (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 || _hooks$checkInstalled.preCheckInstalledApps(storyboard, appId => !!_internalApiGetAppInBootstrapData(appId));\n    const routeHelper = {\n      bailout: output => {\n        if (output.unauthenticated) {\n          redirectToLogin();\n          return true;\n        }\n        if (output.redirect) {\n          redirectTo(output.redirect.path, output.redirect.state);\n          return true;\n        }\n        // Reset redirect count if no redirect is set.\n        _classPrivateFieldSet(_redirectCount, this, 0);\n      },\n      mergeMenus: async menuRequests => {\n        const menuConfs = await Promise.all(menuRequests);\n        _classPrivateFieldSet(_navConfig, this, mergeMenuConfs(menuConfs));\n        window.dispatchEvent(new CustomEvent(\"navConfig.change\", {\n          detail: _classPrivateFieldGet(_navConfig, this)\n        }));\n      },\n      catch: async (error, returnNode, isCurrentBootstrap, isReCatch) => {\n        if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n          redirectToLogin();\n          return;\n        } else if (error instanceof HttpAbortError) {\n          _classPrivateFieldGet(_rendererContextTrashCan, this).add(prevRendererContext);\n          return;\n        } else {\n          const noAuthGuardLoginPath = getRuntime().getMiscSettings().noAuthGuardLoginPath;\n          if (isUnauthenticatedError(error) && noAuthGuardLoginPath) {\n            redirectTo(noAuthGuardLoginPath, {\n              from: location\n            });\n            return;\n          }\n          if (isCurrentBootstrap) {\n            throw error;\n          }\n          return {\n            failed: true,\n            output: {\n              node: await ErrorNode(error, returnNode, !isReCatch),\n              blockingList: []\n            }\n          };\n        }\n      }\n    };\n    const rendererContext = _classPrivateFieldSet(_rendererContext, this, new RendererContext(\"page\", {\n      routeHelper,\n      renderId\n    }));\n    const runtimeContext = _classPrivateFieldSet(_runtimeContext, this, {\n      app: currentApp,\n      location,\n      query: new URLSearchParams(location.search),\n      flags,\n      sys: {\n        ...(hooks === null || hooks === void 0 || (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 ? void 0 : _hooks$auth.getAuth()),\n        ...getPageInfo(),\n        settings: {\n          brand: getRuntime().getBrandSettings()\n        }\n      },\n      ctxStore: new DataStore(\"CTX\", undefined, rendererContext),\n      pendingPermissionsPreCheck: [hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissions(storyboard)],\n      tplStateStoreMap: new Map(),\n      formStateStoreMap: new Map()\n    });\n    _classPrivateFieldSet(_navConfig, this, undefined);\n    registerCustomTemplates(storyboard);\n    registerStoryboardFunctions((_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.functions, currentApp);\n    hooks === null || hooks === void 0 || (_hooks$flowApi2 = hooks.flowApi) === null || _hooks$flowApi2 === void 0 || _hooks$flowApi2.collectContract((_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.contracts);\n    let failed = false;\n    let output;\n    let stores = [];\n    try {\n      clearMatchedRoutes();\n      const rootMenuRequestNode = {};\n      output = await renderRoutes(renderRoot, insertPreviewRoutes(storyboard.routes), runtimeContext, rendererContext, [], rootMenuRequestNode);\n      if (routeHelper.bailout(output)) {\n        return;\n      }\n      stores = getDataStores(runtimeContext);\n      await postAsyncRender(output, runtimeContext, stores);\n      rootMenuRequestNode.child = output.menuRequestNode;\n      rendererContext.setInitialMenuRequestNode(rootMenuRequestNode);\n      await routeHelper.mergeMenus(rendererContext.getMenuRequests());\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Router failed:\", error);\n      const result = await routeHelper.catch(error, renderRoot, isBootstrap);\n      if (!result) {\n        return;\n      }\n      ({\n        failed,\n        output\n      } = result);\n    }\n    renderRoot.child = output.node;\n    cleanUpPreviousRender();\n    if (output.route && output.route.type !== \"routes\" || failed) {\n      if (!failed) {\n        // There is a window to set theme and mode by `lifeCycle.onBeforePageLoad`.\n        rendererContext.dispatchBeforePageLoad();\n      }\n      applyTheme();\n      applyMode();\n      setUIVersion(currentApp === null || currentApp === void 0 ? void 0 : currentApp.uiVersion);\n      mountTree(renderRoot);\n\n      // Scroll to top after each rendering.\n      // See https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/scroll-restoration.md\n      window.scrollTo(0, 0);\n      if (!failed) {\n        rendererContext.dispatchPageLoad();\n        rendererContext.dispatchAnchorLoad();\n        rendererContext.dispatchOnMount();\n        rendererContext.initializeScrollIntoView();\n        rendererContext.initializeMediaChange();\n        rendererContext.initializeMessageDispatcher();\n        for (const store of stores) {\n          store.mountAsyncData();\n        }\n        finishPageView === null || finishPageView === void 0 || finishPageView({\n          status: \"ok\",\n          path: output.path,\n          pageTitle: document.title\n        });\n      } else {\n        finishPageView === null || finishPageView === void 0 || finishPageView({\n          status: \"failed\"\n        });\n      }\n      devtoolsHookEmit(\"rendered\");\n      return;\n    }\n  } else if (!window.NO_AUTH_GUARD && hooks !== null && hooks !== void 0 && hooks.auth && !hooks.auth.isLoggedIn()) {\n    // Todo(steve): refine after api-gateway supports fetching storyboards before logged in.\n    // Redirect to login if no storyboard is matched.\n    redirectToLogin();\n    return;\n  } else {\n    cleanUpPreviousRender();\n  }\n  applyTheme();\n  applyMode();\n  const node = await ErrorNode(new PageNotFoundError(currentApp ? \"page not found\" : \"app not found\"), renderRoot, true);\n  renderRoot.child = node;\n  mountTree(renderRoot);\n\n  // Scroll to top after each rendering.\n  window.scrollTo(0, 0);\n  finishPageView === null || finishPageView === void 0 || finishPageView({\n    status: \"not-found\"\n  });\n  devtoolsHookEmit(\"rendered\");\n}\nfunction mergeMenuConfs(menuConfs) {\n  const navConfig = {\n    breadcrumb: []\n  };\n  for (const menuConf of menuConfs) {\n    const {\n      breadcrumb\n    } = menuConf;\n    if (breadcrumb) {\n      if (breadcrumb.overwrite) {\n        navConfig.breadcrumb = breadcrumb.items;\n      } else {\n        navConfig.breadcrumb.push(...breadcrumb.items);\n      }\n    }\n  }\n  return navConfig;\n}\n//# sourceMappingURL=Router.js.map","export function setAppVariable(params) {\n  const {\n    appId,\n    version\n  } = params;\n  if (window.APP_ROOT_TPL) {\n    window.APP_ID = appId;\n    window.APP_ROOT = window.APP_ROOT_TPL.replace(\"{id}\", appId).replace(\"{version}\", version);\n  }\n}\n//# sourceMappingURL=setAppVariable.js.map","import { hooks } from \"./Runtime.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nexport async function fulfilStoryboard(storyboard) {\n  if (storyboard.$$fulfilled) {\n    return;\n  }\n  if (!storyboard.$$fulfilling) {\n    storyboard.$$fulfilling = doFulfilStoryboard(storyboard);\n  }\n  return storyboard.$$fulfilling;\n}\nasync function doFulfilStoryboard(storyboard) {\n  var _hooks$fulfilStoryboa;\n  await (hooks === null || hooks === void 0 || (_hooks$fulfilStoryboa = hooks.fulfilStoryboard) === null || _hooks$fulfilStoryboa === void 0 ? void 0 : _hooks$fulfilStoryboa.call(hooks, storyboard));\n  registerAppI18n(storyboard);\n  Object.assign(storyboard, {\n    $$fulfilled: true,\n    $$fulfilling: null\n  });\n}\n//# sourceMappingURL=fulfilStoryboard.js.map","import { findLastIndex } from \"lodash\";\nexport function insertPreviewRoutes(routes) {\n  // Insert preview routes for iframe only.\n  if (window.parent === window) {\n    return routes;\n  }\n  let mergedRoutes = routes;\n  const specificTemplatePreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/template-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificTemplatePreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/template-preview/:templateId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificTemplatePreviewIndex + 1)];\n  const specificSnippetPreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/snippet-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificSnippetPreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/snippet-preview/:snippetId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificSnippetPreviewIndex + 1)];\n  return mergedRoutes;\n}\n//# sourceMappingURL=insertPreviewRoutes.js.map","// Allow inject brick packages in a runtime other than Brick Next.\nexport const injectedBrickPackages =\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntypeof BRICK_PACKAGES !== \"undefined\" ? BRICK_PACKAGES : null;\n//# sourceMappingURL=injected.js.map","import { inputToRGB, rgbToHex, rgbToHsv } from '@ctrl/tinycolor';\n\nvar hueStep = 2; // 色相阶梯\n\nvar saturationStep = 0.16; // 饱和度阶梯，浅色部分\n\nvar saturationStep2 = 0.05; // 饱和度阶梯，深色部分\n\nvar brightnessStep1 = 0.05; // 亮度阶梯，浅色部分\n\nvar brightnessStep2 = 0.15; // 亮度阶梯，深色部分\n\nvar lightColorCount = 5; // 浅色数量，主色上\n\nvar darkColorCount = 4; // 深色数量，主色下\n// 暗色主题颜色映射关系表\n\nvar darkColorMap = [{\n  index: 7,\n  opacity: 0.15\n}, {\n  index: 6,\n  opacity: 0.25\n}, {\n  index: 5,\n  opacity: 0.3\n}, {\n  index: 5,\n  opacity: 0.45\n}, {\n  index: 5,\n  opacity: 0.65\n}, {\n  index: 5,\n  opacity: 0.85\n}, {\n  index: 4,\n  opacity: 0.9\n}, {\n  index: 3,\n  opacity: 0.95\n}, {\n  index: 2,\n  opacity: 0.97\n}, {\n  index: 1,\n  opacity: 0.98\n}]; // Wrapper function ported from TinyColor.prototype.toHsv\n// Keep it here because of `hsv.h * 360`\n\nfunction toHsv(_ref) {\n  var r = _ref.r,\n      g = _ref.g,\n      b = _ref.b;\n  var hsv = rgbToHsv(r, g, b);\n  return {\n    h: hsv.h * 360,\n    s: hsv.s,\n    v: hsv.v\n  };\n} // Wrapper function ported from TinyColor.prototype.toHexString\n// Keep it here because of the prefix `#`\n\n\nfunction toHex(_ref2) {\n  var r = _ref2.r,\n      g = _ref2.g,\n      b = _ref2.b;\n  return \"#\".concat(rgbToHex(r, g, b, false));\n} // Wrapper function ported from TinyColor.prototype.mix, not treeshakable.\n// Amount in range [0, 1]\n// Assume color1 & color2 has no alpha, since the following src code did so.\n\n\nfunction mix(rgb1, rgb2, amount) {\n  var p = amount / 100;\n  var rgb = {\n    r: (rgb2.r - rgb1.r) * p + rgb1.r,\n    g: (rgb2.g - rgb1.g) * p + rgb1.g,\n    b: (rgb2.b - rgb1.b) * p + rgb1.b\n  };\n  return rgb;\n}\n\nfunction getHue(hsv, i, light) {\n  var hue; // 根据色相不同，色相转向不同\n\n  if (Math.round(hsv.h) >= 60 && Math.round(hsv.h) <= 240) {\n    hue = light ? Math.round(hsv.h) - hueStep * i : Math.round(hsv.h) + hueStep * i;\n  } else {\n    hue = light ? Math.round(hsv.h) + hueStep * i : Math.round(hsv.h) - hueStep * i;\n  }\n\n  if (hue < 0) {\n    hue += 360;\n  } else if (hue >= 360) {\n    hue -= 360;\n  }\n\n  return hue;\n}\n\nfunction getSaturation(hsv, i, light) {\n  // grey color don't change saturation\n  if (hsv.h === 0 && hsv.s === 0) {\n    return hsv.s;\n  }\n\n  var saturation;\n\n  if (light) {\n    saturation = hsv.s - saturationStep * i;\n  } else if (i === darkColorCount) {\n    saturation = hsv.s + saturationStep;\n  } else {\n    saturation = hsv.s + saturationStep2 * i;\n  } // 边界值修正\n\n\n  if (saturation > 1) {\n    saturation = 1;\n  } // 第一格的 s 限制在 0.06-0.1 之间\n\n\n  if (light && i === lightColorCount && saturation > 0.1) {\n    saturation = 0.1;\n  }\n\n  if (saturation < 0.06) {\n    saturation = 0.06;\n  }\n\n  return Number(saturation.toFixed(2));\n}\n\nfunction getValue(hsv, i, light) {\n  var value;\n\n  if (light) {\n    value = hsv.v + brightnessStep1 * i;\n  } else {\n    value = hsv.v - brightnessStep2 * i;\n  }\n\n  if (value > 1) {\n    value = 1;\n  }\n\n  return Number(value.toFixed(2));\n}\n\nfunction generate(color) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var patterns = [];\n  var pColor = inputToRGB(color);\n\n  for (var i = lightColorCount; i > 0; i -= 1) {\n    var hsv = toHsv(pColor);\n    var colorString = toHex(inputToRGB({\n      h: getHue(hsv, i, true),\n      s: getSaturation(hsv, i, true),\n      v: getValue(hsv, i, true)\n    }));\n    patterns.push(colorString);\n  }\n\n  patterns.push(toHex(pColor));\n\n  for (var _i = 1; _i <= darkColorCount; _i += 1) {\n    var _hsv = toHsv(pColor);\n\n    var _colorString = toHex(inputToRGB({\n      h: getHue(_hsv, _i),\n      s: getSaturation(_hsv, _i),\n      v: getValue(_hsv, _i)\n    }));\n\n    patterns.push(_colorString);\n  } // dark theme patterns\n\n\n  if (opts.theme === 'dark') {\n    return darkColorMap.map(function (_ref3) {\n      var index = _ref3.index,\n          opacity = _ref3.opacity;\n      var darkColorString = toHex(mix(inputToRGB(opts.backgroundColor || '#141414'), inputToRGB(patterns[index]), opacity * 100));\n      return darkColorString;\n    });\n  }\n\n  return patterns;\n}\n\nvar presetPrimaryColors = {\n  red: '#F5222D',\n  volcano: '#FA541C',\n  orange: '#FA8C16',\n  gold: '#FAAD14',\n  yellow: '#FADB14',\n  lime: '#A0D911',\n  green: '#52C41A',\n  cyan: '#13C2C2',\n  blue: '#1890FF',\n  geekblue: '#2F54EB',\n  purple: '#722ED1',\n  magenta: '#EB2F96',\n  grey: '#666666'\n};\nvar presetPalettes = {};\nvar presetDarkPalettes = {};\nObject.keys(presetPrimaryColors).forEach(function (key) {\n  presetPalettes[key] = generate(presetPrimaryColors[key]);\n  presetPalettes[key].primary = presetPalettes[key][5]; // dark presetPalettes\n\n  presetDarkPalettes[key] = generate(presetPrimaryColors[key], {\n    theme: 'dark',\n    backgroundColor: '#141414'\n  });\n  presetDarkPalettes[key].primary = presetDarkPalettes[key][5];\n});\nvar red = presetPalettes.red;\nvar volcano = presetPalettes.volcano;\nvar gold = presetPalettes.gold;\nvar orange = presetPalettes.orange;\nvar yellow = presetPalettes.yellow;\nvar lime = presetPalettes.lime;\nvar green = presetPalettes.green;\nvar cyan = presetPalettes.cyan;\nvar blue = presetPalettes.blue;\nvar geekblue = presetPalettes.geekblue;\nvar purple = presetPalettes.purple;\nvar magenta = presetPalettes.magenta;\nvar grey = presetPalettes.grey;\n\nexport { blue, cyan, geekblue, generate, gold, green, grey, lime, magenta, orange, presetDarkPalettes, presetPalettes, presetPrimaryColors, purple, red, volcano, yellow };\n","import { generate } from \"@ant-design/colors\";\nexport function getStyleByBaseColors(theme, baseColors, backgroundColor) {\n  return (theme === \"dark\" ? getDarkStyle : getLightStyle)(\"\".concat(getCssVariableDefinitionsByPalettes(generatePalettes(baseColors, theme, backgroundColor), theme), \"\\n\").concat(getMigratedCssVariableDefinitions(theme, baseColors, backgroundColor)));\n}\nexport function getStyleByBrandColor(theme, brandColor) {\n  return (theme === \"dark\" ? getDarkStyle : getLightStyle)(getCssVariableDefinitionsByBrand(brandColor));\n}\nexport function getStyleByVariables(theme, variables) {\n  return (theme === \"dark\" ? getDarkStyle : getLightStyle)(getCssVariableDefinitionsByVariables(variables));\n}\nfunction getLightStyle(cssVariableDefinitions) {\n  return \":root,\\n[data-override-theme=\\\"light\\\"] {\\n\".concat(cssVariableDefinitions, \"}\");\n}\nfunction getDarkStyle(cssVariableDefinitions) {\n  return \"html[data-theme=\\\"dark-v2\\\"],\\n[data-override-theme=\\\"dark-v2\\\"] {\\n\".concat(cssVariableDefinitions, \"}\");\n}\nfunction getCssVariableDefinitionsByPalettes(palettes, theme) {\n  return Object.entries(palettes).flatMap(_ref => {\n    var [colorName, palette] = _ref;\n    ensureBaseColorName(colorName);\n    return palette.map((color, index) => [\"  --palette-\".concat(colorName, \"-\").concat(index + 1, \"-channel: \").concat(getRgbChannel(color), \";\")].concat(theme === \"dark\" ? [] : \"  --palette-\".concat(colorName, \"-\").concat(index + 1, \": rgb(var(--palette-\").concat(colorName, \"-\").concat(index + 1, \"-channel));\")).join(\"\\n\"))\n    // Concat an empty string to make a double-line-break for each group of color name.\n    .concat(\"\");\n  }).join(\"\\n\");\n}\nfunction generatePalettes(baseColors, theme, backgroundColor) {\n  return Object.fromEntries(Object.entries(baseColors).map(_ref2 => {\n    var [colorName, baseColor] = _ref2;\n    return [colorName, generate(baseColor, theme === \"dark\" ? {\n      theme,\n      backgroundColor\n    } : undefined)];\n  }));\n}\nfunction getCssVariableDefinitionsByBrand(color) {\n  if (typeof color === \"string\") {\n    return \"  --color-brand: \".concat(color, \";\\n\");\n  }\n  return [\"  --color-brand: \".concat(color.default, \";\"), \"  --color-brand-hover: \".concat(color.hover, \";\"), \"  --color-brand-active: \".concat(color.active, \";\"), \"\"].join(\"\\n\");\n}\nfunction getCssVariableDefinitionsByVariables(variables) {\n  return Object.entries(variables).map(_ref3 => {\n    var [name, color] = _ref3;\n    ensureCssVariableName(name);\n    return \"  \".concat(name, \": \").concat(color, \";\");\n  }).concat(\"\").join(\"\\n\");\n}\nfunction ensureCssVariableName(name) {\n  if (!/^--[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(name)) {\n    throw new Error(\"Invalid css variable name: \".concat(JSON.stringify(name)));\n  }\n}\nfunction ensureBaseColorName(name) {\n  if (!/^[a-z0-9]+(?:-[a-z0-9]+)*$/.test(name)) {\n    throw new Error(\"Invalid base color name: \".concat(JSON.stringify(name)));\n  }\n}\nfunction getMigratedCssVariableDefinitions(theme, baseColors, backgroundColor) {\n  var migrateMap = {\n    green: \"green\",\n    red: \"red\",\n    blue: \"blue\",\n    orange: \"orange\",\n    cyan: \"cyan\",\n    purple: \"purple\",\n    geekblue: \"indigo\"\n  };\n  return Object.entries(migrateMap).flatMap(_ref4 => {\n    var [legacyColorName, newColorName] = _ref4;\n    return [\"  --theme-\".concat(legacyColorName, \"-color-rgb-channel: \").concat(getRgbChannel(getActualBaseColor(baseColors[newColorName], theme, backgroundColor)), \";\"), ...(theme === \"dark\" ? [] : [\"  --theme-\".concat(legacyColorName, \"-color: var(--palette-\").concat(newColorName, \"-6);\"), \"  --theme-\".concat(legacyColorName, \"-border-color: var(--palette-\").concat(newColorName, \"-3);\")]), \"  --theme-\".concat(legacyColorName, \"-background: var(--palette-\").concat(newColorName, \"-\").concat(theme === \"dark\" ? 2 : 1, \");\"), \"\"];\n  }).join(\"\\n\");\n}\nfunction getRgbChannel(color) {\n  return color.match(/[0-9a-fA-F]{2}/g).map(hex => parseInt(hex, 16)).join(\", \");\n}\nfunction getActualBaseColor(baseColor, theme, backgroundColor) {\n  return theme === \"dark\" ? generate(baseColor, {\n    theme,\n    backgroundColor\n  })[5] : baseColor;\n}\n//# sourceMappingURL=index.js.map","import { getStyleByBaseColors, getStyleByBrandColor, getStyleByVariables } from \"@next-core/color-theme\";\nexport function customizeColorTheme(theme) {\n  if (!theme) {\n    return;\n  }\n  if (theme.brandColor) {\n    applyColorTheme({\n      type: \"brandColor\",\n      ...theme.brandColor\n    });\n  } else if (theme.baseColors) {\n    applyColorTheme({\n      type: \"baseColors\",\n      ...theme.baseColors\n    });\n  } else if (theme.variables) {\n    applyColorTheme({\n      type: \"variables\",\n      ...theme.variables\n    });\n  }\n}\nexport function applyColorTheme(options) {\n  const style = [];\n  const themes = [\"light\", \"dark\"];\n  themes.forEach(theme => {\n    if (options[theme]) {\n      switch (options.type) {\n        case \"brandColor\":\n          style.push(getStyleByBrandColor(theme, options[theme]));\n          break;\n        case \"baseColors\":\n          style.push(getStyleByBaseColors(theme, options[theme], options.backgroundColor));\n          break;\n        case \"variables\":\n          style.push(getStyleByVariables(theme, options[theme]));\n          break;\n      }\n    }\n  });\n  if (style.length > 0) {\n    const element = document.createElement(\"style\");\n    element.textContent = style.join(\"\\n\\n\");\n    document.head.appendChild(element);\n    return () => {\n      element.remove();\n    };\n  }\n}\n//# sourceMappingURL=customizeColorTheme.js.map","// istanbul ignore file\n// Todo(steve): This file will be removed in the future.\nimport { hooks } from \"./internal/Runtime.js\";\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function authenticate() {\n  var _hooks$auth, _hooks$auth$authentic;\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  hooks === null || hooks === void 0 || (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 || (_hooks$auth$authentic = _hooks$auth.authenticate) === null || _hooks$auth$authentic === void 0 || _hooks$auth$authentic.call(_hooks$auth, ...args);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function getAuth() {\n  var _hooks$auth2;\n  return hooks === null || hooks === void 0 || (_hooks$auth2 = hooks.auth) === null || _hooks$auth2 === void 0 ? void 0 : _hooks$auth2.getAuth();\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function logout() {\n  var _hooks$auth3, _hooks$auth3$logout;\n  return hooks === null || hooks === void 0 || (_hooks$auth3 = hooks.auth) === null || _hooks$auth3 === void 0 || (_hooks$auth3$logout = _hooks$auth3.logout) === null || _hooks$auth3$logout === void 0 ? void 0 : _hooks$auth3$logout.call(_hooks$auth3);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function isLoggedIn() {\n  var _hooks$auth4;\n  return hooks === null || hooks === void 0 || (_hooks$auth4 = hooks.auth) === null || _hooks$auth4 === void 0 ? void 0 : _hooks$auth4.isLoggedIn();\n}\n//# sourceMappingURL=auth.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomEditorRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, new Map());\n  }\n  define(editorName, editorFunc) {\n    if (_classPrivateFieldGet(_registry, this).has(editorName)) {\n      // eslint-disable-next-line no-console\n      console.error(`Custom editor of \"${editorName}\" already registered`);\n      return;\n    }\n    _classPrivateFieldGet(_registry, this).set(editorName, editorFunc);\n  }\n  get(editorName) {\n    return _classPrivateFieldGet(_registry, this).get(editorName);\n  }\n}\nexport const customEditors = new CustomEditorRegistry();\n//# sourceMappingURL=CustomEditors.js.map","import { getProviderBrick } from \"./internal/data/getProviderBrick.js\";\nimport { resolveByProvider } from \"./internal/data/resolveData.js\";\nexport async function fetchByProvider(provider, args, options) {\n  const providerBrick = await getProviderBrick(provider);\n  return resolveByProvider(providerBrick, provider, \"resolve\", args, options);\n}\n//# sourceMappingURL=fetchByProvider.js.map","import { i18n } from \"@next-core/i18n\";\nimport { uniqueId } from \"lodash\";\nimport { getDataStores, postAsyncRender, renderBricks } from \"./internal/Renderer.js\";\nimport { RendererContext } from \"./internal/RendererContext.js\";\nimport { DataStore } from \"./internal/data/DataStore.js\";\nimport { mountTree, unmountTree } from \"./internal/mount.js\";\nimport { applyMode, applyTheme, setMode, setTheme } from \"./themeAndMode.js\";\nimport { RenderTag } from \"./internal/enums.js\";\nimport { registerStoryboardFunctions } from \"./internal/compute/StoryboardFunctions.js\";\nimport { registerAppI18n } from \"./internal/registerAppI18n.js\";\nimport { registerCustomTemplates } from \"./internal/registerCustomTemplates.js\";\nimport { setUIVersion } from \"./setUIVersion.js\";\nimport { ErrorNode } from \"./internal/ErrorNode.js\";\nexport function unstable_createRoot(container) {\n  let {\n    portal: _portal,\n    scope = \"fragment\",\n    unknownBricks\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let portal = _portal;\n  let createPortal;\n  if (_portal) {\n    createPortal = _portal;\n  } else {\n    // Create portal container when necessary.\n    createPortal = () => {\n      portal = document.createElement(\"div\");\n      portal.style.position = \"absolute\";\n      portal.style.width = portal.style.height = \"0\";\n      document.body.append(portal);\n      return portal;\n    };\n  }\n  let unmounted = false;\n  let rendererContext;\n  let clearI18nBundles;\n  return {\n    async render(brick) {\n      let {\n        theme,\n        uiVersion,\n        language,\n        context,\n        functions,\n        templates,\n        i18n: i18nData,\n        url,\n        app\n      } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      if (unmounted) {\n        throw new Error(\"The root is unmounted and cannot be rendered any more\");\n      }\n      const bricks = [].concat(brick);\n      const previousRendererContext = rendererContext;\n      const renderId = uniqueId(\"render-id-\");\n      rendererContext = new RendererContext(scope, {\n        unknownBricks,\n        renderId\n      });\n      const runtimeContext = {\n        ctxStore: new DataStore(\"CTX\", undefined, rendererContext),\n        pendingPermissionsPreCheck: [],\n        tplStateStoreMap: new Map(),\n        formStateStoreMap: new Map()\n      };\n      if (url) {\n        const urlObj = new URL(url);\n        runtimeContext.query = urlObj.searchParams;\n        runtimeContext.location = {\n          pathname: urlObj.pathname,\n          search: urlObj.search,\n          hash: urlObj.hash,\n          state: undefined\n        };\n      }\n      const renderRoot = {\n        tag: RenderTag.ROOT,\n        container,\n        createPortal\n      };\n      if (scope === \"page\") {\n        var _clearI18nBundles;\n        setTheme(theme ?? \"light\");\n        setMode(\"default\");\n        setUIVersion(uiVersion);\n        if (language) {\n          await i18n.changeLanguage(language);\n        }\n        app ?? (app = {\n          id: \"demo\",\n          homepage: \"/demo\"\n        });\n        runtimeContext.app = app;\n        const demoStoryboard = {\n          app,\n          meta: {\n            i18n: i18nData,\n            customTemplates: templates\n          }\n        };\n\n        // Register i18n.\n        (_clearI18nBundles = clearI18nBundles) === null || _clearI18nBundles === void 0 || _clearI18nBundles();\n        clearI18nBundles = registerAppI18n(demoStoryboard);\n\n        // Register custom templates.\n        registerCustomTemplates(demoStoryboard);\n\n        // Register functions.\n        registerStoryboardFunctions(functions, app);\n      }\n      runtimeContext.ctxStore.define(context, runtimeContext);\n      let failed = false;\n      let output;\n      let stores = [];\n      try {\n        output = await renderBricks(renderRoot, bricks, runtimeContext, rendererContext, [], {});\n        stores = getDataStores(runtimeContext);\n        await postAsyncRender(output, runtimeContext, stores);\n      } catch (error) {\n        failed = true;\n        output = {\n          node: await ErrorNode(error, renderRoot, scope === \"page\"),\n          blockingList: []\n        };\n      }\n      renderRoot.child = output.node;\n      previousRendererContext === null || previousRendererContext === void 0 || previousRendererContext.dispatchOnUnmount();\n      previousRendererContext === null || previousRendererContext === void 0 || previousRendererContext.dispose();\n      unmountTree(container);\n      if (portal) {\n        unmountTree(portal);\n      }\n      if (scope === \"page\") {\n        if (!failed) {\n          rendererContext.dispatchBeforePageLoad();\n        }\n        applyTheme();\n        applyMode();\n      }\n      mountTree(renderRoot);\n      if (scope === \"page\") {\n        window.scrollTo(0, 0);\n      }\n      if (!failed) {\n        for (const store of stores) {\n          store.mountAsyncData();\n        }\n        if (scope === \"page\") {\n          rendererContext.dispatchPageLoad();\n          // rendererContext.dispatchAnchorLoad();\n        }\n        rendererContext.dispatchOnMount();\n        rendererContext.initializeScrollIntoView();\n        rendererContext.initializeMediaChange();\n        rendererContext.initializeMessageDispatcher();\n      }\n    },\n    unmount() {\n      if (unmounted) {\n        return;\n      }\n      unmounted = true;\n      unmountTree(container);\n      if (portal) {\n        unmountTree(portal);\n        // Only remove the portal from its parent when it's dynamic created.\n        if (!_portal) {\n          portal.remove();\n        }\n      }\n    }\n  };\n}\n//# sourceMappingURL=createRoot.js.map","import { isEvaluable } from \"@next-core/cook\";\nimport { inject } from \"@next-core/inject\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { getHistory } from \"./index.js\";\nimport { _internalApiGetRuntimeContext } from \"./internal/Runtime.js\";\nimport { evaluate } from \"./internal/compute/evaluate.js\";\nimport { hasBeenComputed, markAsComputed } from \"./internal/compute/markAsComputed.js\";\n\n/**\n * An equivalent of `computeRealValue` but for external usages, with no custom\n * context or options.\n *\n * @param value - Any value which may contains evaluations or placeholders.\n * @returns Computed real value.\n */\nexport function getRealValue(value) {\n  let {\n    useRealTimeQuery\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const ctx = {\n    ..._internalApiGetRuntimeContext()\n  };\n  if (useRealTimeQuery) {\n    ctx.query = new URLSearchParams(getHistory().location.search);\n  }\n  const compute = data => {\n    if (typeof data === \"string\") {\n      if (isEvaluable(data)) {\n        const result = evaluate(data, ctx);\n        markAsComputed(result);\n        return result;\n      }\n      return inject(data, ctx);\n    }\n    if (!isObject(data) || hasBeenComputed(value)) {\n      return data;\n    }\n    if (Array.isArray(data)) {\n      return data.map(v => compute(v));\n    }\n    return Object.fromEntries(Object.entries(data).map(_ref => {\n      let [k, v] = _ref;\n      return [compute(k), compute(v)];\n    }));\n  };\n  return compute(value);\n}\n//# sourceMappingURL=getRealValue.js.map","const stack = [];\nexport function instantiateModalStack() {\n  let initialIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1000;\n  let index = -1;\n  const pull = () => {\n    if (index > -1) {\n      const found = stack.indexOf(index);\n      // Assert: found should always be greater than -1\n      // istanbul ignore else\n      if (found > -1) {\n        stack.splice(found, 1);\n      }\n    }\n  };\n  const push = () => {\n    // Handle pushes without pull\n    pull();\n    // Find the next available index\n    index = (stack[stack.length - 1] ?? -1) + 1;\n    stack.push(index);\n    return index + initialIndex;\n  };\n  return {\n    push,\n    pull\n  };\n}\n//# sourceMappingURL=ModalStack.js.map"],"names":["rgbToRgb","r","g","b","rgbToHsl","max","Math","min","h","s","l","d","hue2rgb","p","q","t","hslToRgb","rgbToHsv","v","hsvToRgb","i","floor","f","mod","rgbToHex","allow3Char","hex","round","toString","startsWith","charAt","join","rgbaToHex","a","allow4Char","parseFloat","convertHexToDecimal","parseIntFromHex","val","parseInt","numberInputToObject","color","names","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","goldenrod","gold","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavenderblush","lavender","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","inputToRGB","rgb","ok","format","trim","toLowerCase","length","named","match","matchers","exec","rgba","hsl","hsla","hsv","hsva","hex8","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","String","substr","Object","prototype","hasOwnProperty","call","CSS_UNIT","concat","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","RegExp","Boolean","bound01","n","indexOf","isOnePointZero","isPercent","isPercentage","abs","clamp01","boundAlpha","isNaN","convertToPercentage","Number","pad2","c","_assertClassBrand","e","has","arguments","TypeError","_checkPrivateRedeclaration","obj","privateCollection","_classPrivateFieldGet2","get","_classPrivateFieldInitSpec","privateMap","value","set","_classPrivateFieldSet2","_classPrivateMethodInitSpec","privateSet","add","_defineProperty","key","defineProperty","enumerable","configurable","writable","toPropertyKey","Symbol","toPrimitive","_typeof","o","iterator","constructor","getBasePath","base","document","querySelector","getAttribute","matchStoryboard","storyboards","pathname","sortedStoryboards","orderBy","storyboard","_storyboard$app$homep","app","homepage","matchHomepage","replace","isOutsideApp","_getRuntime$getCurren","getRuntime","getCurrentApp","id","window","STANDALONE_MICRO_APPS","standaloneMode","blocked","getUserConfirmation","message","callback","confirm","historyOverridden","browserHistory","push","originalPush","originalReplace","updateFactory","method","path","state","pathIsString","parsePath","_bootstrapData9","bootstrapData","_internalApiMatchStoryboard","location","substring","createHref","getV2RuntimeFromDll","_window$BRICK_NEXT_VE","dll","BRICK_NEXT_VERSIONS","createHistory","createBrowserHistory","basename","assign","updateQueryFactory","query","options","undefined","extraQuery","clear","keepHash","urlSearchParams","URLSearchParams","search","params","entries","Array","isArray","delete","item","append","hash","blockMessage","pushQuery","replaceQuery","pushAnchor","notify","reload","noIncremental","setBlockMessage","getBlockMessage","unblock","historyExtended","getHistory","v2Kit","getHistoryV2Factory","_registry","WeakMap","customProcessors","freeze","define","processorFullName","processorFunc","registerCustomProcessor","getCustomProcessorsV2","this","Map","namespace","processorName","split","pkg","Error","registerAppI18n","_ref","meta","i18n","i18nNamespace","getI18nNamespace","languages","forEach","_ref2","lang","resources","addResourceBundle","removeResourceBundle","type","widgetI18nFactory","widgetId","getFixedT","registerWidgetI18n","i18nData","registerWidgetI18nV2Factory","ns","MESSAGE_SOURCE_PANEL","FRAME_ACTIVE_CHANGE","PANEL_CHANGE","selectedPanel","frameIsActive","devtoolsHookEmit","payload","devtools","getDevHook","emit","_devtools$emit","requestIdleCallback","setTimeout","__BRICK_NEXT_DEVTOOLS_HOOK__","THROW","readOnlyHandler","deleteProperty","setPrototypeOf","getReadOnlyProxy","object","Proxy","getDynamicReadOnlyProxy","ownKeys","fromEntries","map","theme","storage","JsonStorage","localStorage","LOCAL_STORAGE_APPS_THEME_KEY","setTheme","getTheme","getCurrentTheme","documentElement","dataset","applyTheme","dispatchEvent","CustomEvent","detail","batchSetAppsLocalTheme","appsTheme","setItem","getLocalAppsTheme","result","getItem","console","error","mode","setMode","getCurrentMode","applyMode","getCssPropertyValue","name","_window$getComputedSt","el","getComputedStyle","getPropertyValue","getGeneralGlobals","attemptToVisitGlobals","globalVariables","variableName","variable","getIndividualGlobal","_hooks$images","_hooks$images2","_hooks$checkPermissio","collectCoverage","widgetVersion","appendI18nNamespace","storyboardFunctions","isStoryboardFunction","hooks","images","widgetImagesFactory","imagesFactory","isBuildPush","currentVersion","identity","filter","fakeI18nText","i18nText","check","fakeCheckPermissions","checkPermissions","href","origin","host","hostname","data","en","StoryboardFunctionRegistryFactory","debuggerOverrides","registeredFunctions","overrides","precookFunction","cook","supply","_target","fn","processed","cooked","collector","createCollector","precooked","source","typescript","beforeVisit","cacheKey","currentApp","function","rules","noVar","LodashWithStaticFields","_","ArrayConstructor","ObjectWithStaticFields","beforeEvaluate","beforeCall","beforeBranch","debug","getStoryboardFunction","registerStoryboardFunctions","functions","deps","collectMemberUsageInFunction","hasPermissionsCheck","perm","updateStoryboardFunction","newFn","checkPermissionsUsage","functionNames","checkedFunctions","Set","some","clearGlobalExecutionContextStack","__dev_only_clearGlobalExecutionContextStack","getGlobalExecutionContextStack","__dev_only_getGlobalExecutionContextStack","EventTarget","wm","create","proto","target","dispatch","info","once","removeEventListener","listener","handleEvent","_stopImmediatePropagationFlag","secret","listeners","event","slice","currentTarget","splice","MediaBreakpoint","mediaBreakpointMinWidthMap","xLarge","large","medium","small","xSmall","mediaEventTarget","breakpointMatchesMap","MEDIA","handleMatchesChange","breakpoint","changed","matches","minWidth","mediaQueryList","matchMedia","addEventListener","addListener","getMedia","getStorageItem","storageType","sessionStorage","JSON","parse","isStrictMode","runtimeContext","_getRuntime","flags","getFeatureFlags","warnAboutStrictMode","strict","_len","extraLogs","_key","punctuation","warn","allowedNativeProps","customTemplates","tagName","registerCustomTemplate","getCustomTemplatesV2","_constructor$proxy","_compatibleConstructo","registered","customElements","proxyProperties","proxy","properties","validProxyProps","legacyTplVariables","asVariable","mergeProperty","refTransform","ref","compatibleConstructor","expose","tpl","exposedStates","uniq","proxyMethods","methods","props","entry","nativeProps","prop","HTMLElement","TplElement","$$typeof","_dev_only_definedProperties","_dev_only_definedMethods","$$getElementByRef","_this$$$tplStateStore","$$tplStateStore","hostBrick","tplHostMetadata","internalBricksByRef","element","connectedCallback","shadowRoot","attachShadow","fragment","createDocumentFragment","style","createElement","textContent","slot","appendChild","disconnectedCallback","propName","getValue","_this$$$tplStateStore2","updateValue","from","to","refProperty","_this$$$getElementByR","refMethod","getTplStateStore","using","extraInfo","tplStateStoreId","tplStateStoreMap","store","getTplHostElement","hostElement","widgetFunctionRegistry","widgetFunctions","registerWidgetFunctions","registerWidgetFunctionsV2Factory","semver","validateAndParse","version","shift","isWildcard","tryParse","compareStrings","ap","bp","forceType","compareSegments","compare","v1","v2","operator","assertValidOperator","res","n1","n2","p1","pop","p2","compareVersions","operatorResMap","includes","allowedOperators","keys","op","hasInstalledApp","appId","matchVersion","_internalApiGetAppInBootstrapData","checkInstalledApps","getCheckedApp","installStatus","getFormStateStore","formStateStoreId","formStateStoreMap","pool","async","getProviderBrick","provider","_hooks$flowApi","isFlowApi","flowApi","isFlowApiProvider","FLOW_API_PROVIDER","brick","registerFlowApiProvider","loadBricksImperatively","getBrickPackages","computed","WeakSet","markAsComputed","isObject","hasBeenComputed","getPrototypeOf","values","cache","resolveData","resolveConf","useProvider","args","onReject","legacyProvider","field","legacyField","hasLegacyField","providerBrick","actualArgs","Promise","all","asyncComputeRealValue","renderId","promise","resolveByProvider","_internalApiGetRenderId","transform","isHandleRejectByTransform","originalArgs","stale","stringify","finalArgs","getArgsOfFlowApi","symbolForRaw","for","symbolForContext","isPreEvaluated","raw","getPreEvaluatedRaw","pre","shouldDismissMarkingComputed","shouldAllowRecursiveEvaluations","possibleErrorConstructs","SyntaxError","ReferenceError","getCookErrorConstructor","evaluate","run","lowLevelEvaluate","isAsync","blockingList","passByRuntimeContext","omit","menuUsage","usedArgs","hasAppUsage","preevaluate","withParent","beforeVisitGlobal","node","parent","collectAppGetMenuUsage","collectInstalledAppsHasUsage","hasNonStaticUsage","lazy","usedCtx","usedProcessors","usedStates","tplStateStore","usedFormStates","formStateStore","devHook","strictCollectMemberUsage","ctxStore","waitFor","usedTpls","loadProcessorsImperatively","attemptToCheckPermissions","usedFunctions","pendingPermissionsPreCheck","size","menu","usedMenuIds","menuId","fetchMenuById","getStoryboardByAppId","_internalApiGetStoryboardInBootstrapData","_hooks$checkInstalled","waitForCheckingApps","_hooks$menu","sys","overrideApp","cloneDeep","getMenu","getMenuById","property","getMiscSettings","_t","k","processor","getAll","expression","context","StateOfUseBrick","isLazyContentInUseBrick","USE_BRICK_PROPERTIES","USE_BRICK_TRANSFORM","USE_BRICK_EVENTS","USE_BRICK_IF","USE_BRICK_LIFECYCLE","USE_BRICK_DATA_SOURCE","getNextStateOfUseBrick","USE_BRICK","USE_BRICK_ITEM","USE_BRICK_SLOTS_ITEM_BRICKS","USE_BRICK_SLOTS_ITEM_BRICKS_ITEM","INITIAL","USE_BRICK_SLOTS","USE_BRICK_SLOTS_ITEM","internalOptions","preEvaluated","$$lazyForUseBrick","$$stateOfUseBrick","dismissMarkingComputed","isEvaluable","asyncEvaluate","noInject","transformAndInject","inject","nextOptions","getNextComputeOptions","ignoreSymbols","getOwnPropertySymbols","computeRealValue","asyncCheckIf","ifContainer","if","checkIf","checkIfOfComputed","checkIfByTransform","looseCheckIfByTransform","checkIfByTransformV2Factory","getTracks","contextNames","stateNames","formStateNames","isTrackAll","trackAll","formState","track","computePropertyValue","asyncPropertyEntries","asyncValue","ignoreUndefined","constructAsyncProperties","setRealProperties","realProps","propValue","setProperties","bricks","realValue","computeRealProperties","trackAfterInitial","trackingContextList","initialTracker","contextName","disposes","onChange","stateName","escapeString","str","sensitive","stringToRegexp","tokens","_a","_b","start","_c","end","_d","encode","x","_e","delimiter","_f","endsWith","endsWithRe","delimiterRe","route","_i","tokens_1","token","prefix","suffix","pattern","modifier","endToken","isEndDelimited","tokensToRegexp","char","index","count","j","code","charCodeAt","lexer","prefixes","tryConsume","mustConsume","nextType","consumeText","safePattern","prev","prevText","delimiter_1","isSafe","name_1","pattern_1","pathToRegexp","groupsRegex","execResult","regexpToRegexp","paths","parts","arrayToRegexp","cacheLimit","cacheCount","matchPath","exact","reduce","matched","regexp","pathCache","cacheResult","compilePath","url","isExact","memo","matchRoute","symbolForAsyncComputedPropsFromHost","symbolForTplStateStoreId","symbolForTPlExternalForEachItem","symbolForTPlExternalForEachIndex","symbolForTPlExternalForEachSize","timeoutIdList","K","REQUEST_FAILED","SOMETHING_WENT_WRONG","LOGIN_TIMEOUT_MESSAGE","NETWORK_ERROR","LICENSE_EXPIRED","NO_PERMISSION","PAGE_NOT_FOUND","APP_NOT_FOUND","UNKNOWN_ERROR","GO_BACK_TO_PREVIOUS_PAGE","GO_BACK_HOME","RELOAD","zh","NS","locales","Dialog","show","resolve","confirmed","content","reject","alert","setLoginStateCookie","pathValue","btoa","encodeURIComponent","searchValue","cookie","httpErrorToString","Event","HTMLScriptElement","src","HttpFetchError","HttpResponseError","responseJson","msg","isUnauthenticatedError","response","status","lastErrorMessage","unauthenticatedConfirming","handleHttpError","HttpAbortError","NO_AUTH_GUARD","then","ssoEnabled","history","redirectToLogin","title","contentStyle","whiteSpace","wordBreak","Notification","bindListeners","eventsMap","eventType","handlers","listenerFactory","$$listeners","$$eventListeners","handler","isBuiltinHandler","action","isUseProviderHandler","isCustomHandler","targetRef","isConditionalEventHandler","runtimeBrick","handleHistoryAction","handleWindowOpenAction","handleWindowPostMessageAction","handleParentPostMessageAction","handleLocationAction","handleStorageAction","preventDefault","stopPropagation","handleConsoleAction","handleMessageAction","handleContextAction","batch","handleTplStateAction","init","argsFactory","handleFormStateAction","handleMessageDispatcher","handleUseProviderAction","handleCustomAction","else","brickCallback","targets","rawTarget","rawTargetRef","computedTarget","multiple","querySelectorAll","found","computedTargetRef","targetRefs","tplHostElement","_tplHostElement$$$get","isExecuteCustomHandler","useEventAsDefault","isSetPropsCustomHandler","targetOrProvider","isProvider","task","realTarget","computedArgs","_handler$sse","sse","stream","callbackFactory","eventCallbackFactory","pollableCallback","progress","success","finally","_handler$sse2","_handler$poll","pollRuntimeContext","finallyCallback","currentRenderId","startSSEStream","poll","enabled","pollOptions","expectPollStopImmediately","expectPollEnd","interval","leadingRequestDelay","continueOnError","delegateLoadingBar","pick","currentTimeoutId","shouldStop","_computeRealValue","_computeRealValue2","expectPollStopImmediatelyResult","_computeRealValue3","delayedPoll","_computeRealValue4","delay","startPoll","err","baseArgsLength","hasCallback","overrideMethod","useEventDetailAsDefault","features","open","postMessage","batchUpdate","updateValues","arg","every","removeItem","_hooks$messageDispatc","messageDispatcher","bindTemplateProxy","_tplHostMetadata$prox","events","bubbles","cancelable","composed","refEvent","$$proxyListeners","unbindTemplateProxy","RenderTag","unmountTree","mountPoint","replaceChildren","mountTree","root","initializedElement","DISABLE_REACT_FLUSH_SYNC","current","child","portalElements","tag","BRICK","_current$tplHostMetad","slotId","setAttribute","iid","portal","return","childElements","sibling","_currentReturn","currentReturn","_currentReturn$contai","ROOT","container","createPortal","commonLifeCycles","pageOnlyLifeCycles","_routeHelper","_memoizedLifeCycle","_observers","_mediaListener","_arbitraryLifeCycle","_memoized","_initialMenuRequestNode","_memoizedMenuRequestNodeMap","_incrementalRenderStates","_RendererContext_brand","RendererContext","scope","onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload","onMediaChange","onScrollIntoView","onMount","onUnmount","onMessage","onMessageClose","unknownBricks","routeHelper","setInitialMenuRequestNode","menuRequestNode","memoizeMenuRequestNode","routes","getMenuRequests","menuRequests","request","_current","reMergeMenuRequestNodes","parentMenuRequestNode","previousSibling","mergeMenus","reBailout","output","bailout","reCatch","returnNode","catch","didPerformIncrementalRender","prevLocation","finalResult","shouldIgnoreRoutes","parentRoutes","reverse","parentRoute","performIncrementalRender","slotConf","registerBrickLifeCycle","lifeCycle","lifeCycleTypes","isEmpty","useResolves","registerArbitraryLifeCycle","arbitraryCallbacks","memoize","keyPath","memKey","mem","last","getLastNode","lastNormal","getLastNormalNode","lastPortal","getLastPortalNode","reRender","memoized","prevNode","prevLast","prevLastNormal","prevLastPortal","insertBeforeChild","insertPortalBeforeChildCandidates","PLACEHOLDER","_getNextNormalNode","_getNextPortalNode","getSpecifiedNormalNode","getNextNormalNode","nextSibling","getSpecifiedPortalNode","getNextPortalNode","_prevLastNormal$eleme","_prevLastPortal$eleme","prevSibling","portalFragment","renderRoot","removeBricks","getBrickRange","_unmountBricks","_returnNode$container","_returnNode$element","hasChildNodes","insertBefore","_root","insertPortalBeforeChild","candidate","contains","newBricks","_initializeRerenderBricks","dispose","list","observer","disconnect","dispatchBeforePageLoad","_dispatchGeneralLifeCycle","dispatchPageLoad","dispatchBeforePageLeave","dispatchPageLeave","dispatchAnchorLoad","anchor","initializeScrollIntoView","conf","_addObserver","initializeMediaChange","initializeMessageDispatcher","_hooks$messageDispatc2","confList","channel","onClose","dispatchOnMount","dispatchOnUnmount","unmountList","removed","remove","_brick$element","_brick$element2","_brick$disposes","observers","unmountEvent","mountEvent","threshold","IntersectionObserver","isIntersecting","intersectionRatio","observe","_last","next","range","_currentReturn2","routeMatchedMap","getMatchedRoute","symbolForRootRuntimeContext","renderUseBrick","useBrick","errorBoundary","_output$node","_output$node2","scopedRuntimeContext","tplStateStoreScope","formStateStoreScope","createScopedRuntimeContext","_internalApiGetRuntimeContext","rendererContext","renderBrick","scopedStores","postAsyncRender","mountUseBrick","portalRoot","mountAsyncData","unmountUseBrick","mountResult","legacyDoTransform","updateStoryboard","storyboardPatch","$$fulfilling","$$fulfilled","$$registerCustomTemplateProcessed","updateStoryboardByRoute","newRoute","replaceRoutes","replaceBricks","slots","unshift","updateStoryboardByTemplate","newTemplate","settings","tplName","updateTemplatePreviewSettings","templateId","_updatePreviewSettings","getSnippetPreviewPath","snippetId","updateStoryboardBySnippet","snippetData","_snippetData$bricks","updateSnippetPreviewSettings","previewRouteIndex","findIndex","newPreviewRoute","getContextValue","_ref3","getAllContextValues","_ref4","getAllValues","getBrickPackagesById","find","filePath","loadBricks","loadEditors","editors","brickPackages","loadEditorsImperatively","getRenderId","getAddedContracts","_ref5","updateStoryboardType","collectUsedContracts","updatedStoryboard","_storyboard$routes","snippetPreviewPath","addedContracts","api","_storyboard$meta","namespaceId","contracts","contract","debugDataValue","debugData","_ref6","routeId","getLegalRuntimeValue","realTimeDataInspectRoot","RealTimeDataInspectHooks","setRealTimeDataInspectRoot","callRealTimeDataInspectHooks","changeType","addRealTimeDataInspectHook","hook","supportContextResolveTriggerBrickLifeCycle","DataStore","stateStoreId","changeEventType","_this$data$get","notifyRealTimeDataChange","getAffectListByContext","affectNames","batchUpdateContextsNames","updateContexts","affectContexts","affectDepsContextNames","updateContextItem","affectContextItem","triggerEvent","contexts","_context$eventTarget","eventTarget","callbackRuntimeContext","useResolve","loaded","loading","shouldDismiss","_this$rendererContext","load","finishLoad","dataConfs","asyncHostPropertyEntries","routePath","pending","contextConfs","resolveContext","keyword","dependencyMap","depsMap","contextConf","stats","collectMemberUsage","legacyTplStats","usedProperties","getDependencyMapOfContext","pendingDeps","deferredContexts","pendingContexts","wrapResolve","resolved","left","scheduleNext","scheduleAsSerial","readyContexts","dep","predicateNextResolveFactory","pendingResult","duplicatedMap","processedAtLeastOne","detectCircularContexts","deferred","resolveDataStore","dataConf","pendingStack","dataName","_this$data$get2","dataNames","ctx","waitForAll","_this$routeMap$get","routeMap","asyncMounted","trackConditionalResolve","resolvePolicy","hasFallbackValue","_this$rendererContext2","newData","trigger","_this$rendererContext3","batchAddListener","disposeDataInRoutes","setupTemplateProxy","hostContext","reversedProxies","externalSlots","asyncComputedProps","propertyProxies","asyncHostProps","filtered","slotProxies","quasisMap","_externalSlots$from","insertBricks","refToSlot","refSlot","expandableSlot","refPosition","hostHasForEach","clamp","setupTemplateExternalBricksWithForEach","forEachItem","forEachIndex","forEachSize","slotName","quasis","flatMap","children","childrenToSlots","setupTemplateExternalRoutesWithForEach","setupUseBrickInTemplate","walk","setup","originalSlots","restConf","transpiledSlots","expandCustomTemplate","tplTagName","brickConf","uniqueId","collectWidgetContract","originalExternalSlots","externalChildren","restBrickConf","newBrickConf","proxies","expandBrickInTemplate","brickConfInTemplate","slotsInTemplate","childrenInTemplate","restBrickConfInTemplate","FORM_RENDERER","symbolForFormStateStoreId","formContainers","formSchemaToBrick","schema","fields","instanceId","fieldId","defaults","defaultValue","commonProps","label","testid","getReadOnlyAndRequired","_field$limit","_field$limit2","readOnly","limit","required","fieldType","placeholder","description","precision","inputBoxStyle","width","getDefaultProperties","formSchemasToBricks","schemas","_FormElement_brand","FormElement","super","validate","_proxyFormMethod","setInitValue","resetFields","_len2","_key2","_this$firstElementChi","_containerElement$tag","containerElement","firstElementChild","PageNotFoundError","captureStackTrace","BrickLoadError","ErrorNode","pageLevel","variant","showLink","showDescription","_error$response","_error$responseJson","getRefinedErrorConf","errorBrick","_internalApiGetPresetBricks","linkBrick","race","_resolve","errorTitle","getLinkNode","useDefaultError","descriptionNode","click","renderRoutes","_runtimeContext","menuRequestReturnNode","isIncremental","noAuthGuard","public","auth","isLoggedIn","matchRoutes","unauthenticated","preCheckPermissionsForBrickOrRoute","preLoadBricks","redirectTo","redirect","menuRequest","menuConf","loadMenu","newOutput","renderBricks","mergeRenderOutput","appendMenuRequestNode","tplStack","shallow","setupBrick","inUseBrick","forceRecursive","setupRootRuntimeContext","kPath","hasTrackingControls","_hooks$checkPermissio2","_runtimeContext$app","template","brickIf","permissionsPreCheck","isGeneralizedTrackAll","dataSource","acc","symbol","asyncCheckBrickIf","brickName","ensureValidControlBrick","lowerLevelRenderControlNode","tracker","trackDataSource","_slots$slot","computedDataSource","rendered","flat","renderForEach","renderControlNode","changedAfterInitial","rawOutput","rerenderCount","uninitialized","controlledOutput","reControlledOutput","rerender","debouncedListener","debounce","leading","trailing","test","catchLoad","getTagNameOfCustomTemplate","tplCount","enqueueStableLoadBricks","formData","confProps","_brickConf$properties","compute","asyncComputeRealPropertyEntries","computedPropsFromHost","isScript","rel","PUBLIC_ROOT","attrs","loadScript","loadStyle","listenOnTrackingContext","loadProperties","childRuntimeContext","expandedBrickConf","hostBrickConf","_hostBrickConf$proper","normalizedFormData","formConf","formSchema","targetEvents","sourceEvents","mergeEvents","padding","expandFormRenderer","routeSlotFromIndexToSlotId","childSlotId","incrementalSubRoutes","prevMatch","newMatch","isEqual","incrementalOutput","failed","childrenOutput","mergeSiblingRenderMenuRequest","loadChildren","legacyRenderBrick","getDataStores","stores","flushStableLoadBricks","rest","newSlots","unknownPolicy","misc","nativeController","getPageInfo","isInIframe","isInIframeOfSameSite","isInIframeOfNext","isInIframeOfVisualBuilder","isInIframeOfLegacyConsole","selfIsNext","parentPathname","parentIsNext","registerCustomTemplates","templates","setUIVersion","ui","WATEMARK_BRICKNAME","_storyboards","_rendering","_nextRender","_rendererContext","_rendererContextTrashCan","_redirectCount","_renderId","_currentApp","_previousApp","_navConfig","_Router_brand","Router","_history","_getBlockMessageBeforePageLave","returnValue","block","getRuntimeContext","getRecentApps","previousApp","getNavConfig","bootstrap","AbortController","http","interceptors","use","config","_config$options","signal","noAbortOnRouteChange","nextPrevLocation","listen","_queuedRender","previousMessage","_safeRedirect","_this$redirectCount","_this$redirectCount2","_preRender","nextRender","_prevLocation$state","_location$state","_location$state2","_classPrivateFieldGet4","ignoreRendering","omittedLocationProps","_classPrivateFieldGet3","locationsAreEqual","abort","_render","isBootstrap","_hooks$pageView","_classPrivateFieldGet5","_storyboard$app","clearCollectWidgetContract","finishPageView","pageView","currentAppId","BOOTSTRAP_UNION_FILE","APP_ROOT_TPL","APP_ID","APP_ROOT","setAppVariable","_hooks$fulfilStoryboa","fulfilStoryboard","doFulfilStoryboard","_window$APP_ROOT","_window$APP_ROOT2","_hooks$auth","_watermarkConfig$flag","_watermarkConfig$flag2","isDeveloper","username","getAuth","watermarkConfig","defaultProps","zIndex","font","fontSize","gap","setWatermark","appChanged","clearExpressionASTCache","clearFunctionASTCache","prevRendererContext","main","cleanUpPreviousRender","reset","_hooks$flowApi2","_storyboard$meta2","preCheckInstalledApps","menuConfs","navConfig","breadcrumb","overwrite","items","mergeMenuConfs","isCurrentBootstrap","isReCatch","noAuthGuardLoginPath","brand","getBrandSettings","preCheckPermissions","collectContract","rootMenuRequestNode","mergedRoutes","specificTemplatePreviewIndex","findLastIndex","specificSnippetPreviewIndex","insertPreviewRoutes","uiVersion","scrollTo","pageTitle","injectedBrickPackages","BRICK_PACKAGES","hueStep","saturationStep","saturationStep2","brightnessStep1","brightnessStep2","lightColorCount","darkColorCount","darkColorMap","opacity","toHsv","toHex","getHue","light","hue","getSaturation","saturation","toFixed","generate","opts","patterns","pColor","colorString","_hsv","_colorString","rgb1","rgb2","backgroundColor","presetPrimaryColors","volcano","geekblue","presetPalettes","presetDarkPalettes","getLightStyle","cssVariableDefinitions","getDarkStyle","getRgbChannel","getActualBaseColor","baseColor","applyColorTheme","brandColor","default","hover","active","getStyleByBrandColor","baseColors","palettes","colorName","palette","ensureBaseColorName","getCssVariableDefinitionsByPalettes","generatePalettes","legacyColorName","newColorName","getMigratedCssVariableDefinitions","getStyleByBaseColors","variables","ensureCssVariableName","getCssVariableDefinitionsByVariables","getStyleByVariables","head","runtime","router","processedBrickPackages","createRuntime","panel","initializeI18n","language","on","Runtime","primary","Reflect","getRuntimeV2Factory","_initialized","_bootstrapped","initialize","_data$settings","deepFreeze","normalizeBootstrapData","notification","dialog","loadNotificationService","loader","loadDialogService","customizeColorTheme","_router","_router2","_bootstrapData","_router3","featureFlags","_bootstrapData2","_router4","_bootstrapData3","base_title","getLaunchpadSettings","_bootstrapData4","columns","rows","launchpad","getDesktops","_bootstrapData5","desktops","getLaunchpadSiteMap","_bootstrapData6","siteSort","toggleLaunchpadEffect","body","classList","toggle","applyPageTitle","_router5","baseTitle","localeTitle","_router6","_bootstrapData7","pubDeps","bricksMap","pkgName","processPublicDepsPackages","STANDALONE_BRICK_PACKAGES","PUBLIC_DEPS","_bootstrapData8","presetBricks","_router7","_router8","_bootstrapData10","_internalApiGetStoryb","authenticate","_hooks$auth$authentic","_hooks$auth2","logout","_hooks$auth3","_hooks$auth3$logout","_hooks$auth4","customEditors","editorName","editorFunc","fetchByProvider","unstable_createRoot","_portal","position","height","clearI18nBundles","unmounted","render","previousRendererContext","urlObj","URL","searchParams","_clearI18nBundles","changeLanguage","demoStoryboard","unmount","getRealValue","useRealTimeQuery","stack","instantiateModalStack","initialIndex","pull"],"sourceRoot":""}