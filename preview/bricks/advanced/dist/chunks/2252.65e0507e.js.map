{"version":3,"file":"chunks/2252.65e0507e.js","mappings":"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","sources":["webpack:///../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///../../node_modules/@next-api-sdk/micro-app-sdk/dist/esm/api/micro_app/permission/validatePermissions.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/auth.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/checkPermissions.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/websocket/MessageService.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/websocket/MessageDispatcher.js","webpack:///../../node_modules/@next-api-sdk/micro-app-standalone-sdk/dist/esm/api/micro_app_standalone/runtime/searchMicroAppStandalone.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/checkInstalledApps.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/flowApi/FlowApiProvider.js","webpack:///../../node_modules/@next-api-sdk/api-gateway-sdk/dist/esm/api/api_gateway/contract/searchSingleContract.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/flowApi/CollectContracts.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/flowApi/FlowApi.js","webpack:///../../node_modules/@next-api-sdk/cmdb-sdk/dist/esm/api/cmdb/instance/postSearch.js","webpack:///../../node_modules/@next-api-sdk/micro-app-sdk/dist/esm/api/micro_app/installed_micro_app/getMenusInfo.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/constants.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/mergeMenu.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/loadDynamicMenuItems.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/reorderMenuItems.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/computeMenuData.js","webpack:///../../node_modules/@next-api-sdk/cmdb-sdk/dist/esm/api/cmdb/instance/getDetail.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/fetchMenuTitle.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/fetchMenuById.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/menu/getMenusOfStandaloneApp.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/analytics/transport.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/analytics/analytics.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/analytics/http.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/analytics/pageView.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/index.js","webpack:///../../node_modules/@next-core/easyops-runtime/dist/esm/auth-v2.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nexport default function _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 校验系统权限\n * @endpoint POST /api/micro_app/v1/permission/validate\n */\nexport var PermissionApi_validatePermissions = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.micro_app.permission.ValidatePermissions@1.0.0 */(yield http.post(\"api/gateway/micro_app.permission.ValidatePermissions/api/micro_app/v1/permission/validate\", data, options)).data\n    );\n  });\n  return function PermissionApi_validatePermissions(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=validatePermissions.js.map","import { resetPermissionPreChecks } from \"./checkPermissions.js\";\nconst auth = {};\n\n/** @internal */\n\n/** @internal */\nexport function authenticate(newAuth) {\n  Object.assign(auth, {\n    org: newAuth.org,\n    username: newAuth.username,\n    userInstanceId: newAuth.userInstanceId,\n    loginFrom: newAuth.loginFrom,\n    accessRule: newAuth.accessRule,\n    isAdmin: newAuth.isAdmin,\n    csrfToken: newAuth.csrfToken,\n    license: newAuth.license,\n    accessToken: newAuth.accessToken,\n    userShowValue: newAuth.userShowValue\n  });\n}\n\n/**\n * 获取当前登录认证信息。\n *\n * @returns 当前登录认证信息。\n */\nexport function getAuth() {\n  return {\n    ...auth\n  };\n}\n\n/** @internal */\nexport function logout() {\n  for (const key of Object.keys(auth)) {\n    auth[key] = undefined;\n  }\n  resetPermissionPreChecks();\n}\n\n/**\n * 查看当前是否已登录。\n *\n * @returns 当前是否已登录。\n */\nexport function isLoggedIn() {\n  return auth.username !== undefined;\n}\n//# sourceMappingURL=auth.js.map","import { scanPermissionActionsInAny, scanPermissionActionsInStoryboard } from \"@next-core/utils/storyboard\";\nimport { PermissionApi_validatePermissions } from \"@next-api-sdk/micro-app-sdk\";\nimport { getAuth, isLoggedIn } from \"./auth.js\";\nconst checkingPermissions = new Map();\nconst checkedPermissions = [];\nconst permissionMap = new Map();\nexport function preCheckPermissions(storyboard) {\n  if (isLoggedIn() && !getAuth().isAdmin) {\n    const usedActions = scanPermissionActionsInStoryboard(storyboard);\n    return validatePermissions(usedActions);\n  }\n}\nexport async function preCheckPermissionsForBrickOrRoute(container, asyncComputeRealValue) {\n  if (isLoggedIn() && !getAuth().isAdmin && Array.isArray(container.permissionsPreCheck)) {\n    const actions = await asyncComputeRealValue(container.permissionsPreCheck);\n    return validatePermissions(actions);\n  }\n}\nexport function preCheckPermissionsForAny(data) {\n  if (isLoggedIn() && !getAuth().isAdmin) {\n    const usedActions = scanPermissionActionsInAny(data);\n    return validatePermissions(usedActions);\n  }\n}\nexport async function validatePermissions(usedActions) {\n  // Do not request known actions.\n  const uncheckedActions = usedActions.filter(action => !checkedPermissions.includes(action));\n  if (uncheckedActions.length === 0) {\n    return;\n  }\n  const checkingTasks = [];\n  const restActions = [];\n  for (const action of uncheckedActions) {\n    const promise = checkingPermissions.get(action);\n    if (promise) {\n      checkingTasks.push(promise);\n    } else {\n      restActions.push(action);\n    }\n  }\n  if (restActions.length > 0) {\n    const task = (async () => {\n      try {\n        const result = await PermissionApi_validatePermissions({\n          actions: restActions\n        }, {\n          noAbortOnRouteChange: true\n        });\n        for (const item of result.actions) {\n          permissionMap.set(item.action, item.authorizationStatus);\n          if (item.authorizationStatus === \"undefined\") {\n            // eslint-disable-next-line no-console\n            console.error(`Undefined permission action: \"${item.action}\"`);\n          }\n        }\n      } catch (error) {\n        // Allow pre-check to fail, and\n        // make it not crash when the backend service is not updated.\n        // eslint-disable-next-line no-console\n        console.error(\"Pre-check permissions failed\", error);\n      } finally {\n        checkedPermissions.push(...restActions);\n      }\n    })();\n    for (const action of restActions) {\n      checkingPermissions.set(action, task);\n    }\n    checkingTasks.push(task);\n  }\n  await Promise.all(checkingTasks);\n}\n\n/**\n * Check the current logged-in user whether to have all\n * permissions of actions passed to it.\n *\n * @param actions - Required permission actions.\n */\nexport function checkPermissions() {\n  if (!isLoggedIn()) {\n    return false;\n  }\n  if (getAuth().isAdmin) {\n    return true;\n  }\n  for (var _len = arguments.length, actions = new Array(_len), _key = 0; _key < _len; _key++) {\n    actions[_key] = arguments[_key];\n  }\n  for (const action of actions) {\n    // Only **exclusively authorized** permissions are ok.\n    // Those scenarios below will fail:\n    // - unauthorized actions (pre-check results)\n    // - undefined actions (pre-check results)\n    // - Un-pre-checked or pre-check failed\n    switch (permissionMap.get(action)) {\n      case \"unauthorized\":\n      case \"undefined\":\n        return false;\n      case undefined:\n        // eslint-disable-next-line no-console\n        console.error(`Un-checked permission action: \"${action}\", please make sure the permission to check is defined in permissionsPreCheck.`);\n        return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Reset permission pre-checks after logged-out.\n */\nexport function resetPermissionPreChecks() {\n  checkingPermissions.clear();\n  checkedPermissions.length = 0;\n  permissionMap.clear();\n}\n//# sourceMappingURL=checkPermissions.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _assertClassBrand from \"@babel/runtime/helpers/assertClassBrand\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet2\";\nconst RETRY_TIMEOUT_UNIT = 1000;\nconst RETRY_LIMIT = 5;\nvar _url = /*#__PURE__*/new WeakMap();\nvar _ws = /*#__PURE__*/new WeakMap();\nvar _queuedMessages = /*#__PURE__*/new WeakMap();\nvar _messageListeners = /*#__PURE__*/new WeakMap();\nvar _closeListeners = /*#__PURE__*/new WeakMap();\nvar _retryCount = /*#__PURE__*/new WeakMap();\nvar _closed = /*#__PURE__*/new WeakMap();\nvar _MessageService_brand = /*#__PURE__*/new WeakSet();\nexport class MessageService {\n  constructor(url) {\n    _classPrivateMethodInitSpec(this, _MessageService_brand);\n    _classPrivateFieldInitSpec(this, _url, void 0);\n    _classPrivateFieldInitSpec(this, _ws, void 0);\n    _classPrivateFieldInitSpec(this, _queuedMessages, []);\n    _classPrivateFieldInitSpec(this, _messageListeners, new Set());\n    _classPrivateFieldInitSpec(this, _closeListeners, new Set());\n    _classPrivateFieldInitSpec(this, _retryCount, 0);\n    _classPrivateFieldInitSpec(this, _closed, false);\n    _classPrivateFieldSet(_url, this, url);\n  }\n  send(data) {\n    // Connect when data is sent for the first time\n    if (!_classPrivateFieldGet(_ws, this)) {\n      _classPrivateFieldSet(_ws, this, _assertClassBrand(_MessageService_brand, this, _connect).call(this));\n    }\n    const stringifiedData = JSON.stringify(data);\n    if (_classPrivateFieldGet(_ws, this).readyState === WebSocket.OPEN) {\n      _classPrivateFieldGet(_ws, this).send(stringifiedData);\n    } else {\n      _classPrivateFieldGet(_queuedMessages, this).push(stringifiedData);\n    }\n  }\n  onMessage(listener) {\n    _classPrivateFieldGet(_messageListeners, this).add(listener);\n  }\n  onClose(listener) {\n    _classPrivateFieldGet(_closeListeners, this).add(listener);\n  }\n  reset() {\n    _classPrivateFieldGet(_queuedMessages, this).length = 0;\n    _classPrivateFieldGet(_messageListeners, this).clear();\n    _classPrivateFieldGet(_closeListeners, this).clear();\n  }\n  close() {\n    var _classPrivateFieldGet2;\n    _classPrivateFieldSet(_closed, this, true);\n    if (((_classPrivateFieldGet2 = _classPrivateFieldGet(_ws, this)) === null || _classPrivateFieldGet2 === void 0 ? void 0 : _classPrivateFieldGet2.readyState) === WebSocket.OPEN) {\n      _classPrivateFieldGet(_ws, this).close();\n    }\n  }\n}\nfunction _connect() {\n  // eslint-disable-next-line no-console\n  console.log(\"WebSocket connecting ...\");\n  const ws = new WebSocket(_classPrivateFieldGet(_url, this));\n  let resetRetryCountTimeout;\n  ws.addEventListener(\"open\", e => {\n    // eslint-disable-next-line no-console\n    console.log(\"WebSocket open:\", e);\n\n    // If server closes the socket not more than 1 second after it's opened,\n    // we should not reset the retry count.\n    resetRetryCountTimeout = setTimeout(() => {\n      resetRetryCountTimeout = undefined;\n      _classPrivateFieldSet(_retryCount, this, 0);\n    }, 1e3);\n    for (const msg of _classPrivateFieldGet(_queuedMessages, this)) {\n      ws.send(msg);\n    }\n    _classPrivateFieldGet(_queuedMessages, this).length = 0;\n  });\n  ws.addEventListener(\"close\", e => {\n    if (_classPrivateFieldGet(_closed, this)) {\n      return;\n    }\n    if (resetRetryCountTimeout !== undefined) {\n      clearTimeout(resetRetryCountTimeout);\n    }\n    // eslint-disable-next-line no-console\n    console.log(\"WebSocket close:\", e);\n    for (const listener of _classPrivateFieldGet(_closeListeners, this)) {\n      listener();\n    }\n    // Error code 1000 means that the connection was closed normally.\n    if (e.code !== 1000) {\n      _assertClassBrand(_MessageService_brand, this, _reconnect).call(this);\n    }\n  });\n  ws.addEventListener(\"error\", e => {\n    // No need to reconnect in error event listener,\n    // there will always be a close event along with the error event.\n    // eslint-disable-next-line no-console\n    console.error(\"WebSocket error:\", e);\n  });\n  ws.addEventListener(\"message\", e => {\n    const response = JSON.parse(e.data);\n    for (const listener of _classPrivateFieldGet(_messageListeners, this)) {\n      listener(response);\n    }\n  });\n  return ws;\n}\nfunction _reconnect() {\n  // istanbul ignore next: currently can't mock this\n  if (_classPrivateFieldGet(_retryCount, this) >= RETRY_LIMIT) {\n    // eslint-disable-next-line no-console\n    console.error(\"WebSocket connect retry limit exceeded\");\n    return;\n  }\n  // Double the timeout for each retry\n  const delay = Math.pow(2, _classPrivateFieldGet(_retryCount, this)) * RETRY_TIMEOUT_UNIT;\n  // eslint-disable-next-line no-console\n  console.log(\"WebSocket will reconnect after %d seconds\", delay / 1000);\n  setTimeout(() => {\n    var _this$retryCount, _this$retryCount2;\n    _classPrivateFieldSet(_retryCount, this, (_this$retryCount = _classPrivateFieldGet(_retryCount, this), _this$retryCount2 = _this$retryCount++, _this$retryCount)), _this$retryCount2;\n    _classPrivateFieldSet(_ws, this, _assertClassBrand(_MessageService_brand, this, _connect).call(this));\n  }, delay);\n}\n//# sourceMappingURL=MessageService.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateGetter from \"@babel/runtime/helpers/classPrivateGetter\";\nimport _assertClassBrand from \"@babel/runtime/helpers/assertClassBrand\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet2\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet2\";\nimport { getBasePath } from \"@next-core/runtime\";\nimport { escapeRegExp } from \"lodash\";\nimport { MessageService } from \"./MessageService.js\";\nvar _ms = /*#__PURE__*/new WeakMap();\nvar _memoizedChannels = /*#__PURE__*/new WeakMap();\nvar _channelPayloads = /*#__PURE__*/new WeakMap();\nvar _MessageDispatcher_brand = /*#__PURE__*/new WeakSet();\nexport class MessageDispatcher {\n  constructor() {\n    _classPrivateMethodInitSpec(this, _MessageDispatcher_brand);\n    _classPrivateFieldInitSpec(this, _ms, void 0);\n    _classPrivateFieldInitSpec(this, _memoizedChannels, {\n      sub: new Map(),\n      unsub: new Map()\n    });\n    _classPrivateFieldInitSpec(this, _channelPayloads, new Map());\n  }\n  subscribe(channel, payload) {\n    const stringifiedPayload = JSON.stringify(payload);\n    return _assertClassBrand(_MessageDispatcher_brand, this, _subOrUnsub).call(this, \"sub\", channel, payload, stringifiedPayload);\n  }\n  unsubscribe(channel) {\n    const stringifiedPayload = _classPrivateFieldGet(_channelPayloads, this).get(channel);\n    if (!stringifiedPayload) {\n      const msg = `The message channel to unsubscribe \"${channel}\" is not found`;\n      // eslint-disable-next-line no-console\n      console.error(msg);\n      return Promise.reject(new Error(msg));\n    }\n    const payload = JSON.parse(stringifiedPayload);\n    const result = _assertClassBrand(_MessageDispatcher_brand, this, _subOrUnsub).call(this, \"unsub\", channel, payload, stringifiedPayload);\n    _classPrivateFieldGet(_memoizedChannels, this).sub.delete(stringifiedPayload);\n    result.then(() => {\n      _classPrivateFieldGet(_channelPayloads, this).delete(channel);\n    });\n    return result;\n  }\n  onMessage(channel, listener) {\n    let stringifiedPayload = _classPrivateFieldGet(_channelPayloads, this).get(channel);\n    let warned = false;\n    _classPrivateGetter(_MessageDispatcher_brand, this, _get_ms).onMessage(response => {\n      if (!stringifiedPayload) {\n        stringifiedPayload = _classPrivateFieldGet(_channelPayloads, this).get(channel);\n      }\n      if (!stringifiedPayload) {\n        if (!warned) {\n          // eslint-disable-next-line no-console\n          console.error(`Message channel: \"${channel}\" not found`);\n          warned = true;\n        }\n        return;\n      }\n      if (response.event === \"MESSAGE.PUSH\" && matchMessageChannel(stringifiedPayload, response.payload)) {\n        listener(response.payload.message);\n      }\n    });\n  }\n  onClose(listener) {\n    _classPrivateGetter(_MessageDispatcher_brand, this, _get_ms).onClose(listener);\n  }\n  reset() {\n    var _classPrivateFieldGet2;\n    _classPrivateFieldGet(_memoizedChannels, this).sub.clear();\n    _classPrivateFieldGet(_memoizedChannels, this).unsub.clear();\n    _classPrivateFieldGet(_channelPayloads, this).clear();\n    (_classPrivateFieldGet2 = _classPrivateFieldGet(_ms, this)) === null || _classPrivateFieldGet2 === void 0 || _classPrivateFieldGet2.reset();\n  }\n}\nfunction _get_ms(_this) {\n  if (!_classPrivateFieldGet(_ms, _this)) {\n    const protocol = location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const url = `${protocol}//${window.location.host}${getBasePath()}api/websocket_service/v1/ws`;\n    _classPrivateFieldSet(_ms, _this, new MessageService(url));\n  }\n  return _classPrivateFieldGet(_ms, _this);\n}\nfunction _subOrUnsub(type, channel, payload, stringifiedPayload) {\n  const hit = _classPrivateFieldGet(_memoizedChannels, this)[type].get(stringifiedPayload);\n  if (hit) {\n    return hit;\n  }\n  const request = {\n    event: type === \"sub\" ? \"TOPIC.SUB\" : \"TOPIC.UNSUB\",\n    payload\n  };\n  const promise = new Promise((resolve, reject) => {\n    const identity = getIdentity(payload);\n    _classPrivateGetter(_MessageDispatcher_brand, this, _get_ms).onMessage(response => {\n      const isSuccess = response.event === (type === \"sub\" ? \"TOPIC.SUB_SUCCESS\" : \"TOPIC.UNSUB_SUCCESS\");\n      const isFailed = response.event === (type === \"sub\" ? \"TOPIC.SUB_FAILED\" : \"TOPIC.UNSUB_FAILED\");\n      if ((isSuccess || isFailed) &&\n      // Put this after event type checks, to prevent unnecessary\n      // JSON stringify.\n      identity === getIdentity(response.payload)) {\n        (isSuccess ? resolve : reject)(response);\n      }\n    });\n    _classPrivateGetter(_MessageDispatcher_brand, this, _get_ms).send(request);\n  });\n  if (type === \"sub\") {\n    _classPrivateFieldGet(_channelPayloads, this).set(channel, stringifiedPayload);\n  }\n  _classPrivateFieldGet(_memoizedChannels, this)[type].set(stringifiedPayload, promise);\n  return promise;\n}\nfunction getIdentity(payload) {\n  const {\n    system,\n    topic\n  } = payload;\n  return JSON.stringify({\n    system,\n    topic\n  });\n}\nfunction matchMessageChannel(stringifiedPayload, responsePayload) {\n  const payload = JSON.parse(stringifiedPayload);\n  return payload.system === responsePayload.system && (\n  // Exact match\n  payload.topic === responsePayload.topic ||\n  // Wildcards match\n  // For `ab.cd.*`:\n  // - Matches `ab.cd.r` or `ab.cd.x.yz`\n  // - DOES NOT match `ab.cd.x/yz` or `ab.x.cd` or `x.ab.cd.yz`\n  typeof payload.topic === \"string\" && payload.topic.includes(\"*\") && new RegExp(`^${payload.topic.replace(/([^*]*)\\*([^*]*)/g, (_m, p1, p2) => `${escapeRegExp(p1)}[^/]*${escapeRegExp(p2)}`)}$`).test(responsePayload.topic));\n}\n//# sourceMappingURL=MessageDispatcher.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 查询独立部署小产品\n * @endpoint POST /api/v1/micro_app_standalone/search\n */\nexport var RuntimeApi_searchMicroAppStandalone = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.micro_app_standalone.runtime.SearchMicroAppStandalone@1.0.1 */(yield http.post(\"api/gateway/micro_app_standalone.runtime.SearchMicroAppStandalone/api/v1/micro_app_standalone/search\", data, options)).data\n    );\n  });\n  return function RuntimeApi_searchMicroAppStandalone(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=searchMicroAppStandalone.js.map","import { traverseStoryboardExpressions, collectInstalledAppsHasUsage } from \"@next-core/utils/storyboard\";\nimport { RuntimeApi_searchMicroAppStandalone } from \"@next-api-sdk/micro-app-standalone-sdk\";\nconst checkingApps = new Map();\nconst checkedApps = new Map();\nexport function preCheckInstalledApps(storyboard, hasAppInBootstrap) {\n  if (window.STANDALONE_MICRO_APPS && !window.NO_AUTH_GUARD) {\n    const appIds = scanInstalledAppsUsage(storyboard);\n    const searchIds = [];\n    for (const appId of appIds) {\n      // Do not check these apps already checking or in bootstrap.\n      if (!checkingApps.has(appId) && !hasAppInBootstrap(appId)) {\n        searchIds.push(appId);\n      }\n    }\n    if (searchIds.length === 0) {\n      return;\n    }\n    const promise = RuntimeApi_searchMicroAppStandalone({\n      query: {\n        appId: {\n          $in: searchIds\n        }\n      },\n      fields: [\"appId\", \"currentVersion\", \"installStatus\"]\n    }).catch(error => {\n      // Allow search micro app to fail, and\n      // make it not crash when the backend service is not updated.\n      // eslint-disable-next-line no-console\n      console.error(\"Get off site standalone micro-apps failed\", error);\n    });\n    for (const appId of searchIds) {\n      checkingApps.set(appId, promise.then(result => {\n        var _result$list;\n        const app = result === null || result === void 0 || (_result$list = result.list) === null || _result$list === void 0 ? void 0 : _result$list.find(item => item.appId === appId);\n        const checkedApp = app ? {\n          ...app,\n          id: appId\n        } : undefined;\n        checkedApps.set(appId, checkedApp);\n        return checkedApp;\n      }));\n    }\n  }\n}\nexport async function waitForCheckingApps(appIds) {\n  await Promise.all(appIds.map(appId => checkingApps.get(appId)));\n}\nexport function getCheckedApp(appId) {\n  if (window.STANDALONE_MICRO_APPS) {\n    return checkedApps.get(appId);\n  }\n}\nfunction scanInstalledAppsUsage(storyboard) {\n  const usage = {\n    usedArgs: new Set()\n  };\n  // `INSTALLED_APPS.has(...)` is not available in storyboard functions\n  const {\n    customTemplates,\n    menus\n  } = storyboard.meta ?? {};\n  traverseStoryboardExpressions([storyboard.routes, customTemplates, menus], (node, parent) => {\n    collectInstalledAppsHasUsage(usage, node, parent);\n  }, \"INSTALLED_APPS\");\n  return [...usage.usedArgs];\n}\n//# sourceMappingURL=checkInstalledApps.js.map","import { createProviderClass } from \"@next-core/utils/general\";\nimport { http } from \"@next-core/http\";\nimport { isEmpty, isObject } from \"lodash\";\nimport { createSSEStream } from \"@next-core/utils/general\";\nexport const FLOW_API_PROVIDER = \"core.provider-flow-api\";\nfunction hasFields(ext_fields, type) {\n  return ext_fields.some(item => item.source === type);\n}\nexport function processExtFields(ext_fields) {\n  const hasQueryParams = hasFields(ext_fields, \"query\");\n  const hasBodyParams = hasFields(ext_fields, \"body\");\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  if (hasQueryParams) {\n    if (hasBodyParams) {\n      const [data, params, options] = args;\n      return {\n        data: data,\n        options: {\n          params: params,\n          ...options\n        }\n      };\n    }\n    const [params, options] = args;\n    return {\n      data: {},\n      options: {\n        params: params,\n        ...options\n      }\n    };\n  }\n\n  // only hasBodyParams or default\n  const [data, options] = args;\n  return {\n    data,\n    options: options\n  };\n}\nexport function hasFileType(request) {\n  if ((request === null || request === void 0 ? void 0 : request.type) !== \"object\") {\n    return false;\n  }\n  const processFields = fields => {\n    return !isEmpty(fields) && fields.some(field => [\"file\", \"file[]\"].includes(field.type) || processFields(field.fields));\n  };\n  return processFields(request.fields);\n}\nexport function transformFormData(data) {\n  if (data instanceof FormData) {\n    return data;\n  }\n  const formData = new FormData();\n  for (const [key, value] of Object.entries(data)) {\n    if (Array.isArray(value)) {\n      value.forEach(v => {\n        formData.append(key, v);\n      });\n    } else if (isObject(value) && !(value instanceof Blob) && !(value instanceof Date)) {\n      Object.entries(value).forEach(_ref => {\n        let [k, v] = _ref;\n        formData.append(`${key}[${k}]`, v);\n      });\n    } else {\n      formData.append(key, value);\n    }\n  }\n  return formData;\n}\nexport async function callFlowApi(_ref2) {\n  let {\n    url,\n    originalUri,\n    method = \"GET\",\n    responseWrapper = true,\n    ext_fields = [],\n    request,\n    isFileType,\n    stream\n  } = _ref2;\n  const isSimpleRequest = [\"get\", \"delete\", \"head\"].includes(method.toLowerCase());\n  const defaultOptions = isFileType ? {\n    responseType: \"blob\"\n  } : {};\n  let response;\n  for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    args[_key2 - 1] = arguments[_key2];\n  }\n  if (isSimpleRequest) {\n    var _originalUri$match, _request$fields;\n    const noParams = originalUri && (request === null || request === void 0 ? void 0 : request.type) === \"object\" ? (((_originalUri$match = originalUri.match(/:([^/]+)/g)) === null || _originalUri$match === void 0 ? void 0 : _originalUri$match.length) ?? 0) === (((_request$fields = request.fields) === null || _request$fields === void 0 ? void 0 : _request$fields.length) ?? 0) : false;\n    let params;\n    let options;\n    if (noParams) {\n      [options] = args;\n    } else {\n      [params, options] = args;\n    }\n    if (stream) {\n      var _options;\n      const stream = await createSSEStream(http.getUrlWithParams(url, params), {\n        ...defaultOptions,\n        ...options,\n        method,\n        headers: Object.fromEntries([...new Headers(((_options = options) === null || _options === void 0 ? void 0 : _options.headers) ?? {}).entries()])\n      });\n      return stream;\n    }\n    response = await http.simpleRequest(method, url, {\n      params,\n      ...defaultOptions,\n      ...options\n    });\n  } else {\n    const isUploadType = hasFileType(request);\n    const result = processExtFields(ext_fields, ...args);\n    const data = isUploadType ? transformFormData(result.data) : result.data;\n    if (stream) {\n      var _result$options;\n      const {\n        body,\n        headers\n      } = http.getBodyAndHeaders(data, (_result$options = result.options) === null || _result$options === void 0 ? void 0 : _result$options.headers);\n      const stream = await createSSEStream(url, {\n        ...defaultOptions,\n        ...result.options,\n        method,\n        headers: Object.fromEntries([...new Headers(headers ?? {}).entries()]),\n        body\n      });\n      return stream;\n    }\n    response = await http.requestWithBody(method, url, data, {\n      ...defaultOptions,\n      ...result.options\n    });\n  }\n  return (isFileType ? false : responseWrapper) ? response.data : response;\n}\nexport function registerFlowApiProvider() {\n  customElements.define(FLOW_API_PROVIDER, createProviderClass(callFlowApi));\n}\n//# sourceMappingURL=FlowApiProvider.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 通过defaultOrg查找单个契约信息\n * @endpoint POST /api/contract/single_search\n */\nexport var ContractApi_searchSingleContract = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.api_gateway.contract.SearchSingleContract@1.0.0 */(yield http.post(\"api/contract/single_search\", data, options)).data\n    );\n  });\n  return function ContractApi_searchSingleContract(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=searchSingleContract.js.map","const contractsMap = new Map();\nconst widgetContractMap = new Map();\nconst debugContractMap = new Map();\nconst addContract = (contracts, map) => {\n  contracts === null || contracts === void 0 || contracts.forEach(contract => {\n    map.set(`${contract.namespaceId}.${contract.name}`, contract);\n  });\n};\nexport function collectContract(contracts) {\n  addContract(contracts, contractsMap);\n}\nexport function collectWidgetContract(contracts) {\n  addContract(contracts, widgetContractMap);\n}\nexport function clearCollectWidgetContract() {\n  widgetContractMap.clear();\n}\nexport function collectDebugContract(contracts) {\n  addContract(contracts, debugContractMap);\n}\nexport function clearDebugContract() {\n  debugContractMap.clear();\n}\nexport function getContract(name) {\n  return contractsMap.get(name) || widgetContractMap.get(name) || debugContractMap.get(name);\n}\n//# sourceMappingURL=CollectContracts.js.map","import yaml from \"js-yaml\";\nimport { ContractApi_searchSingleContract } from \"@next-api-sdk/api-gateway-sdk\";\nimport { getContract } from \"./CollectContracts.js\";\nconst remoteContractCache = new Map();\n\n// Legacy Custom API: `${namespace}@${name}`\n// Flow API: `${namespace}@${name}:${version}`\nexport function isFlowApiProvider(provider) {\n  return provider.includes(\"@\");\n}\nexport async function getArgsOfFlowApi(provider, originalArgs, method, stream) {\n  if (!provider.includes(\":\")) {\n    throw new Error(`You're using legacy Custom API \"${provider}\" which is dropped in v3, please use Flow API instead`);\n  }\n  const apiDefinition = await fetchFlowApiDefinition(provider);\n  if (!apiDefinition) {\n    throw new FlowApiNotFoundError(`Flow API not found: \"${provider}\"`);\n  }\n  const apiProfile = getApiProfileFromApiDefinition(provider, apiDefinition);\n  return getApiArgsFromApiProfile(apiProfile, originalArgs, method, stream);\n}\nfunction getApiArgsFromApiProfile(_ref, originalArgs, method, stream) {\n  let {\n    uri,\n    method: apiMethod,\n    ext_fields,\n    name,\n    namespace,\n    serviceName,\n    responseWrapper,\n    version,\n    isFileType,\n    request\n  } = _ref;\n  // `saveAs` requires the first argument to be the filename.\n  const isDownload = method === \"saveAs\";\n  let fileName;\n  if (isDownload) {\n    fileName = originalArgs.shift();\n  }\n  const {\n    url,\n    args\n  } = getTransformedUriAndRestArgs(uri, originalArgs, name, namespace, serviceName, version);\n  return [...(isDownload ? [fileName] : []), {\n    url,\n    originalUri: uri,\n    method: apiMethod,\n    ext_fields,\n    responseWrapper,\n    request,\n    isFileType,\n    stream\n  }, ...args];\n}\nfunction getTransformedUriAndRestArgs(uri, originalArgs, name, namespace, serviceName, version) {\n  const prefix = version ? serviceName === \"logic.api.gateway\" || serviceName !== null && serviceName !== void 0 && serviceName.startsWith(\"logic.api.gateway.\") ? \"\" : serviceName ? `api/gateway/${serviceName}` : `api/gateway/${namespace}.${name}@${version}` : `api/gateway/api_service.${namespace}.${name}`;\n  const restArgs = originalArgs.slice();\n  const transformedUri = uri.replace(/:([^/]+)/g, () => restArgs.shift());\n  return {\n    url: prefix ? prefix + transformedUri : transformedUri.replace(/^\\//, \"\"),\n    args: restArgs\n  };\n}\nfunction getApiProfileFromApiDefinition(provider, api) {\n  var _contract$response;\n  const contract = typeof api.contract === \"string\" ? yaml.safeLoad(api.contract, {\n    schema: yaml.JSON_SCHEMA,\n    json: true\n  }) : api.contract;\n  const {\n    uri,\n    method = \"GET\",\n    ext_fields\n  } = (contract === null || contract === void 0 ? void 0 : contract.endpoint) ?? {};\n  const responseWrapper = contract !== null && contract !== void 0 && contract.response ? contract.response.wrapper !== false : false;\n  if (!uri) {\n    throw new Error(`Missing endpoint.uri in contract of provider \"${provider}\"`);\n  }\n  return {\n    uri,\n    method: method.toLowerCase() === \"list\" ? \"get\" : method,\n    ext_fields,\n    name: api.name,\n    namespace: api.namespace,\n    serviceName: api.serviceName,\n    version: api.version,\n    isFileType: (contract === null || contract === void 0 || (_contract$response = contract.response) === null || _contract$response === void 0 ? void 0 : _contract$response.type) === \"file\",\n    responseWrapper,\n    request: contract === null || contract === void 0 ? void 0 : contract.request\n  };\n}\nasync function fetchFlowApiDefinition(provider) {\n  const [namespaceName, nameWithVersion] = provider.split(\"@\");\n  const [name, version] = nameWithVersion.split(\":\");\n\n  // Do not cache the result of `geContract`, which will lead to no contract\n  // will be found when render twice immediately.\n  const contract = getContract(`${namespaceName}.${name}`);\n  if (contract) {\n    return {\n      name: contract.name,\n      namespace: contract.namespaceId,\n      serviceName: contract.serviceName,\n      version: contract.version,\n      contract: {\n        endpoint: contract.endpoint,\n        response: contract.response,\n        request: contract.request\n      }\n    };\n  }\n  let promise = remoteContractCache.get(provider);\n  if (!promise) {\n    promise = fetchFlowApiDefinitionFromRemote(namespaceName, name, version);\n    remoteContractCache.set(provider, promise);\n  }\n  return promise;\n}\nasync function fetchFlowApiDefinitionFromRemote(namespace, name, version) {\n  var _contractData$namespa;\n  const {\n    contractData\n  } = await ContractApi_searchSingleContract({\n    contractName: `${namespace}.${name}`,\n    version\n  });\n\n  // return undefined if don't found contract\n  return contractData ? {\n    name: contractData.name,\n    namespace: (_contractData$namespa = contractData.namespace) === null || _contractData$namespa === void 0 || (_contractData$namespa = _contractData$namespa[0]) === null || _contractData$namespa === void 0 ? void 0 : _contractData$namespa.name,\n    serviceName: contractData.serviceName,\n    version: contractData.version,\n    contract: {\n      endpoint: contractData.endpoint,\n      response: contractData.response,\n      request: contractData.request\n    }\n  } : null;\n}\nclass FlowApiNotFoundError extends Error {\n  constructor(message) {\n    // Pass remaining arguments (including vendor specific ones) to parent constructor\n    super(message);\n    this.name = \"FlowApiNotFoundError\";\n\n    // Maintains proper stack trace for where our error was thrown (only available on V8)\n    // istanbul ignore else\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, FlowApiNotFoundError);\n    }\n  }\n}\n//# sourceMappingURL=FlowApi.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 搜索实例\n * @endpoint POST /object/:objectId/instance/_search\n */\nexport var InstanceApi_postSearch = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (objectId, data, options) {\n    return (/**! @contract easyops.api.cmdb.instance.PostSearch@1.1.0 */(yield http.post(\"api/gateway/cmdb.instance.PostSearch/object/\".concat(objectId, \"/instance/_search\"), data, options)).data\n    );\n  });\n  return function InstanceApi_postSearch(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=postSearch.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取菜单信息\n * @endpoint GET /api/v1/micro-app/menus/:menuId\n */\nexport var InstalledMicroAppApi_getMenusInfo = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (menuId, params, options) {\n    return (/**! @contract easyops.api.micro_app.installed_micro_app.GetMenusInfo@1.0.0 */(yield http.get(\"api/gateway/micro_app.installed_micro_app.GetMenusInfo/api/v1/micro-app/menus/\".concat(menuId), _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function InstalledMicroAppApi_getMenusInfo(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=getMenusInfo.js.map","export const symbolAppId = Symbol(\"appId\");\nexport const symbolMenuI18nNamespace = Symbol(\"menuI18nNamespace\");\nexport const symbolOverrideApp = Symbol(\"overrideApp\");\n//# sourceMappingURL=constants.js.map","import { i18n } from \"@next-core/i18n\";\nimport { symbolAppId, symbolMenuI18nNamespace, symbolOverrideApp } from \"./constants.js\";\nimport { loadDynamicMenuItems } from \"./loadDynamicMenuItems.js\";\nexport async function mergeMenu(menuList, runtimeContext, helpers) {\n  const mainMenu = menuList.find(menu => menu.type !== \"inject\");\n  if (!mainMenu) {\n    return undefined;\n  }\n  const validMenuList = [];\n  const injectWithMenus = new Map();\n  const menuWithI18n = new WeakMap();\n  for (const menu of menuList) {\n    if (menu.i18n) {\n      const menuI18nNamespace = `menu/${menu.menuId}~${menu.app[0].appId}+${menu.instanceId}`;\n      // Support any language in `menu.i18n`.\n      Object.entries(menu.i18n).forEach(_ref => {\n        let [lang, resources] = _ref;\n        i18n.addResourceBundle(lang, menuI18nNamespace, resources);\n      });\n      menuWithI18n.set(menu, menuI18nNamespace);\n    }\n  }\n  await Promise.all(menuList.map(menu => loadDynamicMenuItems(menu, runtimeContext, menuWithI18n, helpers)));\n  for (const menu of menuList) {\n    var _menu$items;\n    if ((_menu$items = menu.items) !== null && _menu$items !== void 0 && _menu$items.length) {\n      if (menu.type === \"inject\" && menu.injectMenuGroupId) {\n        let injectingMenus = injectWithMenus.get(menu.injectMenuGroupId);\n        if (!injectingMenus) {\n          injectingMenus = [];\n          injectWithMenus.set(menu.injectMenuGroupId, injectingMenus);\n        }\n        injectingMenus.push(menu);\n      } else {\n        validMenuList.push(menu);\n      }\n    }\n  }\n  return {\n    ...mainMenu,\n    items: validMenuList.flatMap(menu =>\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    processGroupInject(menu.items, menu, injectWithMenus, menuWithI18n)),\n    [symbolMenuI18nNamespace]: menuWithI18n.get(mainMenu),\n    [symbolOverrideApp]: mainMenu.overrideApp\n  };\n}\nfunction processGroupInject(items, menu, injectWithMenus, menuWithI18n) {\n  return items === null || items === void 0 ? void 0 : items.map(item => {\n    const foundInjectingMenus = item.groupId && injectWithMenus.get(item.groupId);\n    if (foundInjectingMenus) {\n      // Each menu to be injected with should be injected only once.\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      injectWithMenus.delete(item.groupId);\n    }\n    return {\n      ...item,\n      children: (processGroupInject(item.children, menu, injectWithMenus, menuWithI18n) ?? []).concat(foundInjectingMenus ? foundInjectingMenus.flatMap(injectingMenu =>\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      processGroupInject(injectingMenu.items, injectingMenu, injectWithMenus, menuWithI18n)) : []),\n      [symbolAppId]: menu.app[0].appId,\n      [symbolMenuI18nNamespace]: menuWithI18n.get(menu),\n      [symbolOverrideApp]: menu.overrideApp\n    };\n  });\n}\n//# sourceMappingURL=mergeMenu.js.map","import { preCheckPermissionsForAny } from \"../checkPermissions.js\";\nexport async function loadDynamicMenuItems(menu, runtimeContext, menuWithI18n, helpers) {\n  if (menu.dynamicItems && menu.itemsResolve) {\n    const overrideAppId = menu.app[0].appId;\n    const newRuntimeContext = {\n      ...runtimeContext,\n      pendingPermissionsPreCheck: [...runtimeContext.pendingPermissionsPreCheck, preCheckPermissionsForAny(menu.itemsResolve)]\n    };\n    if (overrideAppId !== runtimeContext.app.id) {\n      var _helpers$getStoryboar;\n      newRuntimeContext.overrideApp = window.STANDALONE_MICRO_APPS ? menu.overrideApp : (_helpers$getStoryboar = helpers.getStoryboardByAppId(overrideAppId)) === null || _helpers$getStoryboar === void 0 ? void 0 : _helpers$getStoryboar.app;\n      newRuntimeContext.appendI18nNamespace = menuWithI18n.get(menu);\n    }\n    const resolved = await helpers.resolveData({\n      transform: \"items\",\n      ...menu.itemsResolve\n    }, newRuntimeContext);\n    menu.items = resolved.items;\n  }\n}\n//# sourceMappingURL=loadDynamicMenuItems.js.map","import { sortBy } from \"lodash\";\nexport function reorderMenu(menuData) {\n  menuData.items = reorderMenuItems(menuData.items);\n}\nfunction reorderMenuItems(list) {\n  return sortMenuItems(list).map(item => ({\n    ...item,\n    children: reorderMenuItems(item.children)\n  }));\n}\nfunction sortMenuItems(list) {\n  return sortBy(list, item => item.sort ?? -Infinity);\n}\n//# sourceMappingURL=reorderMenuItems.js.map","import { symbolAppId, symbolMenuI18nNamespace, symbolOverrideApp } from \"./constants.js\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { pipes } from \"@next-core/pipes\";\nimport { isEvaluable } from \"@next-core/cook\";\nexport function computeMenuData(data, overrideAppId, runtimeContext, helpers) {\n  if (\"titleDataSource\" in data && isObject(data.titleDataSource) && Object.entries(data.titleDataSource).every(_ref => {\n    let [, value] = _ref;\n    return value === null || value === \"\";\n  })) {\n    delete data.titleDataSource;\n  }\n  if (\"if\" in data && data.if === null) {\n    delete data.if;\n  }\n  if (\"to\" in data && data.to && !isEvaluable(data.to)) {\n    const yaml = pipes.yaml(data.to);\n    if (isObject(yaml) && [\"pathname\", \"search\", \"hash\"].some(key => hasOwnProperty(yaml, key))) {\n      data.to = yaml;\n    }\n  }\n  let newRuntimeContext = runtimeContext;\n  if (overrideAppId !== runtimeContext.app.id) {\n    var _helpers$getStoryboar;\n    const overrideApp = window.STANDALONE_MICRO_APPS ? data[symbolOverrideApp] : (_helpers$getStoryboar = helpers.getStoryboardByAppId(overrideAppId)) === null || _helpers$getStoryboar === void 0 ? void 0 : _helpers$getStoryboar.app;\n    newRuntimeContext = {\n      ...runtimeContext,\n      overrideApp,\n      appendI18nNamespace: data[symbolMenuI18nNamespace]\n    };\n  }\n  return helpers.asyncComputeRealValue(data, newRuntimeContext, {\n    ignoreSymbols: true\n  });\n}\nexport function computeMenuItems(items, runtimeContext, helpers) {\n  return Promise.all(items.map(async _ref2 => {\n    let {\n      children,\n      ...rest\n    } = _ref2;\n    const [computedRest, computedChildren] = await Promise.all([computeMenuData(rest, rest[symbolAppId], runtimeContext, helpers), children && (await computeMenuItems(children, runtimeContext, helpers))]);\n    return {\n      ...computedRest,\n      children: computedChildren\n    };\n  }));\n}\n//# sourceMappingURL=computeMenuData.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取实例详情\n * @endpoint GET /object/:objectId/instance/:instanceId\n */\nexport var InstanceApi_getDetail = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (objectId, instanceId, params, options) {\n    return (/**! @contract easyops.api.cmdb.instance.GetDetail@1.0.0 */(yield http.get(\"api/gateway/cmdb.instance.GetDetail/object/\".concat(objectId, \"/instance/\").concat(instanceId), _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function InstanceApi_getDetail(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=getDetail.js.map","import { isEmpty } from \"lodash\";\nimport { InstanceApi_getDetail } from \"@next-api-sdk/cmdb-sdk\";\nconst menuTitleCache = new Map();\nexport async function fetchMenuTitle(menuData) {\n  if (menuData.title || isEmpty(menuData.titleDataSource)) {\n    return menuData.title;\n  }\n  const cacheKey = JSON.stringify(menuData.titleDataSource);\n  const cachedTitle = menuTitleCache.get(cacheKey);\n  if (cachedTitle !== undefined) {\n    return cachedTitle;\n  }\n  const {\n    objectId,\n    instanceId,\n    attributeId\n  } = menuData.titleDataSource;\n  const attr = attributeId ?? \"name\";\n  const instanceData = await InstanceApi_getDetail(objectId, instanceId, {\n    fields: attr\n  });\n  let title;\n  if (attributeId === \"#showKey\" && Array.isArray(instanceData[attr])) {\n    const [primary, ...rest] = instanceData[attr];\n    title = rest.length > 0 ? `${primary}(${rest.join(\",\")})` : String(primary);\n  } else {\n    title = String(instanceData[attr]);\n  }\n  menuTitleCache.set(cacheKey, title);\n  return title;\n}\n//# sourceMappingURL=fetchMenuTitle.js.map","import { InstanceApi_postSearch } from \"@next-api-sdk/cmdb-sdk\";\nimport { InstalledMicroAppApi_getMenusInfo } from \"@next-api-sdk/micro-app-sdk\";\nimport { omit, pick } from \"lodash\";\nimport { checkIfOfComputed } from \"@next-core/runtime\";\nimport { mergeMenu } from \"./mergeMenu.js\";\nimport { reorderMenu } from \"./reorderMenuItems.js\";\nimport { computeMenuItems, computeMenuData } from \"./computeMenuData.js\";\nimport { fetchMenuTitle } from \"./fetchMenuTitle.js\";\nimport { getMenusOfStandaloneApp } from \"./getMenusOfStandaloneApp.js\";\nimport { preCheckPermissionsForAny } from \"../checkPermissions.js\";\nconst menuPromises = new Map();\nconst menuCache = new Map();\nfunction transformMenuItems(menuItems) {\n  return menuItems === null || menuItems === void 0 ? void 0 : menuItems.filter(checkIfOfComputed).map(item => {\n    const children = transformMenuItems(item.children);\n    const transformedMenuItem = item.type === \"group\" ? {\n      type: \"group\",\n      title: item.text,\n      childLayout: item.childLayout,\n      items: children,\n      groupId: item.groupId,\n      groupFrom: item.groupFrom\n    } : children !== null && children !== void 0 && children.length ? {\n      type: \"subMenu\",\n      childLayout: item.childLayout,\n      title: item.text,\n      icon: item.icon,\n      items: children,\n      defaultExpanded: item.defaultExpanded\n    } : omit(item, [\"type\", \"items\", \"children\"]);\n    return transformedMenuItem;\n  });\n}\nexport function getMenuById(menuId) {\n  return menuCache.get(menuId);\n}\nexport function fetchMenuById(menuId, runtimeContext, helpers) {\n  let promise = menuPromises.get(menuId);\n  if (!promise) {\n    promise = _fetchMenuById(menuId, runtimeContext, helpers);\n  }\n  return promise;\n}\nasync function _fetchMenuById(menuId, runtimeContext, helpers) {\n  const menuList = window.STANDALONE_MICRO_APPS ? getMenusOfStandaloneApp(menuId, runtimeContext.app.id, helpers) : runtimeContext.flags[\"three-level-menu-layout\"] ? (await InstalledMicroAppApi_getMenusInfo(menuId, {\n    menuObjectId: \"EASYOPS_STORYBOARD_MENU\"\n  })).menus : (await InstanceApi_postSearch(\"EASYOPS_STORYBOARD_MENU\", {\n    page: 1,\n    page_size: 200,\n    fields: {\n      menuId: true,\n      title: true,\n      icon: true,\n      link: true,\n      titleDataSource: true,\n      defaultCollapsed: true,\n      defaultCollapsedBreakpoint: true,\n      type: true,\n      injectMenuGroupId: true,\n      dynamicItems: true,\n      itemsResolve: true,\n      items: true,\n      i18n: true,\n      \"items.children\": true,\n      \"app.appId\": true\n    },\n    query: {\n      menuId: {\n        $eq: menuId\n      },\n      app: {\n        $size: {\n          $gt: 0\n        }\n      }\n    }\n  })).list;\n  const menuData = await mergeMenu(menuList, runtimeContext, helpers);\n  if (!menuData) {\n    throw new Error(`Menu not found: ${menuId}`);\n  }\n  reorderMenu(menuData);\n  const {\n    items,\n    app,\n    ...restMenuData\n  } = menuData;\n  const newRuntimeContext = {\n    ...runtimeContext,\n    pendingPermissionsPreCheck: [...runtimeContext.pendingPermissionsPreCheck, preCheckPermissionsForAny([items, restMenuData])]\n  };\n  delete newRuntimeContext.tplStateStoreId;\n  delete newRuntimeContext.forEachItem;\n  delete newRuntimeContext.forEachIndex;\n  delete newRuntimeContext.forEachSize;\n  const rootAppId = app[0].appId;\n  const [computedMenuData, computedMenuItems] = await Promise.all([computeMenuData(restMenuData, rootAppId, newRuntimeContext, helpers), computeMenuItems(items, newRuntimeContext, helpers)]);\n  const finalMenuData = {\n    title: await fetchMenuTitle(computedMenuData),\n    ...pick(computedMenuData, [\"icon\", \"link\", \"defaultCollapsed\", \"defaultCollapsedBreakpoint\"]),\n    menuItems: transformMenuItems(computedMenuItems)\n  };\n\n  // Todo(steve): reconsider the menu cache strategy\n  menuCache.set(menuId, finalMenuData);\n}\n//# sourceMappingURL=fetchMenuById.js.map","export function getMenusOfStandaloneApp(menuId, appId, helpers) {\n  var _storyboard$meta, _storyboard$meta2;\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const storyboard = helpers.getStoryboardByAppId(appId);\n  const menus = ((_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.injectMenus) ?? ((_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.menus) ?? [];\n  return menus.filter(menu => menu.menuId === menuId).map(menu => {\n    var _menu$app;\n    return {\n      ...menu,\n      ...((_menu$app = menu.app) !== null && _menu$app !== void 0 && (_menu$app = _menu$app[0]) !== null && _menu$app !== void 0 && _menu$app.appId ? {} : {\n        app: [{\n          appId\n        }]\n      })\n    };\n  });\n\n  // Todo: maybe: fetch menus from STANDALONE_MENU@EASYOPS\n}\n//# sourceMappingURL=getMenusOfStandaloneApp.js.map","export const events = [];\nconst MAXIMUM_WAITING_TIME = 5 * 1000;\nconst MAXIMUM_LOGGED_EVENTS = 10;\nlet timer = null;\nexport const transportOptions = {\n  maxWaitingTime: MAXIMUM_WAITING_TIME,\n  maxLoggedEvents: MAXIMUM_LOGGED_EVENTS\n};\nexport function createTransport(api, options) {\n  Object.assign(transportOptions, {\n    ...options,\n    api\n  });\n  return {\n    sendOnExit,\n    emit\n  };\n}\nfunction nextTime(callback) {\n  return (window.requestIdleCallback || window.requestAnimationFrame || (cb => setTimeout(cb, 17)))(callback);\n}\nfunction emit() {\n  clearTimeout(timer);\n  events.length > transportOptions.maxLoggedEvents ? send() : timer = setTimeout(send, transportOptions.maxWaitingTime);\n}\nfunction send() {\n  if (events.length === 0) {\n    return;\n  }\n  const transportEvents = events.splice(0, transportOptions.maxLoggedEvents);\n  const transportData = buildTransportData(transportEvents);\n  sendBeacon(transportOptions.api, transportData);\n  events.length && nextTime(send);\n}\nfunction sendBeacon(requestUrl, data) {\n  const headers = {\n    type: \"application/json\"\n  };\n  const blob = new Blob([JSON.stringify(data)], headers);\n  window.navigator.sendBeacon(requestUrl, blob);\n}\nfunction sendOnExit() {\n  window.addEventListener(\"beforeunload\", send, false);\n}\nfunction buildTransportData(data) {\n  return {\n    model: \"easyops.FRONTEND_STAT\",\n    columns: [\"_ver\", \"st\", \"et\", \"lt\", \"size\", \"time\", \"traceId\", \"code\", \"duration\", \"page\", \"uid\", \"username\", \"api\", \"type\", \"msg\", \"status\", \"pageId\", \"route\", \"apiCount\", \"maxApiTimeCost\", \"apiSizeCost\", \"pageTitle\"],\n    data\n  };\n}\n//# sourceMappingURL=transport.js.map","import { createTransport, events } from \"./transport.js\";\nlet initialized = false;\nlet transport;\nlet pageState = null;\nlet isFirstPageView = true;\nconst stashedApiMetrics = [];\nexport function initialize(api) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (initialized) {\n    return;\n  }\n  initialized = true;\n  if (!transport) {\n    transport = createTransport(api, options);\n    transport.sendOnExit();\n  }\n}\nexport function createPageView() {\n  stashedApiMetrics.length = 0;\n  pageState = null;\n}\nexport function finishPageView(metric) {\n  const pageId = generateUUID();\n  const {\n    lt,\n    route\n  } = metric;\n  pageState = {\n    lt,\n    route,\n    pageId\n  };\n  events.push({\n    ...metric,\n    pageId,\n    apiCount: stashedApiMetrics.length,\n    maxApiTimeCost: Math.max(0, ...stashedApiMetrics.map(api => api.duration)),\n    size: stashedApiMetrics.map(api => api.size).filter(size => size > 0).reduce((prev, current) => prev + current, 0)\n  });\n  for (const item of stashedApiMetrics) {\n    events.push({\n      ...item,\n      ...pageState\n    });\n  }\n  stashedApiMetrics.length = 0;\n  transport.emit();\n}\nexport function earlyFinishPageView() {\n  events.push(...stashedApiMetrics);\n  stashedApiMetrics.length = 0;\n}\nexport function pushApiMetric(metric) {\n  if (pageState) {\n    events.push({\n      ...metric,\n      type: \"apiRequest\",\n      ...pageState\n    });\n  } else {\n    stashedApiMetrics.push(metric);\n  }\n}\n\n// Ref https://medium.com/teads-engineering/generating-uuids-at-scale-on-the-web-2877f529d2a2\nfunction generateUUID() {\n  const url = URL.createObjectURL(new Blob([]));\n  let uuid = url.substring(url.lastIndexOf(\"/\") + 1);\n  URL.revokeObjectURL(url);\n  // 第一次渲染加上特殊标记\n  if (isFirstPageView) {\n    uuid = \"88-\" + uuid;\n    isFirstPageView = false;\n  }\n  return uuid;\n}\n//# sourceMappingURL=analytics.js.map","import { HttpResponseError, HttpParseError, HttpAbortError } from \"@next-core/http\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { getAuth } from \"../auth.js\";\nimport { pushApiMetric } from \"./analytics.js\";\nconst symbolHttpAnalytics = Symbol(\"HttpAnalytics\");\nexport function onRequest(config) {\n  const perfStartTime = Math.round(performance.now());\n  const st = Date.now();\n  config[symbolHttpAnalytics] = {\n    st,\n    time: Math.round(st / 1000),\n    perfStartTime\n  };\n  return config;\n}\nexport function onResponse(response, config) {\n  return onResponseOrError(false, response, config);\n}\nexport function onResponseError(error, config) {\n  return onResponseOrError(true, error, config);\n}\nfunction onResponseOrError(hasError, responseOrError, config) {\n  const perfEndTime = Math.round(performance.now());\n  const et = Date.now();\n  const {\n    [symbolHttpAnalytics]: meta,\n    url\n  } = config;\n  if (meta && !(hasError && responseOrError instanceof HttpAbortError)) {\n    delete config[symbolHttpAnalytics];\n    const {\n      st,\n      time,\n      perfStartTime\n    } = meta;\n    const {\n      userInstanceId: uid,\n      username\n    } = getAuth();\n    let code;\n    let message;\n    let traceId;\n    let size;\n    let status;\n    let headers;\n    let data;\n    if (hasError) {\n      const isHttpResponseError = responseOrError instanceof HttpResponseError;\n      if (isHttpResponseError || responseOrError instanceof HttpParseError) {\n        ({\n          status,\n          headers\n        } = responseOrError.response);\n        if (isHttpResponseError) {\n          data = responseOrError.responseJson;\n        }\n      }\n    } else {\n      ({\n        status,\n        data,\n        headers\n      } = responseOrError);\n    }\n    if (isObject(data)) {\n      ({\n        code,\n        message\n      } = data);\n    }\n    if (headers instanceof Headers) {\n      traceId = headers.get(\"x-b3-traceid\");\n      size = headers.get(\"content-length\");\n    }\n    pushApiMetric({\n      st,\n      _ver: st,\n      uid,\n      username,\n      time,\n      et,\n      page: location.href,\n      duration: perfEndTime - perfStartTime,\n      api: url,\n      type: \"api\",\n      code: code ?? -1,\n      msg: message ?? \"\",\n      status,\n      traceId: traceId ?? \"\",\n      size: size ? Number(size) : -1\n    });\n  }\n  return hasError ? Promise.reject(responseOrError) : responseOrError;\n}\n//# sourceMappingURL=http.js.map","import { createPageView, earlyFinishPageView, finishPageView } from \"./analytics.js\";\nimport { getAuth } from \"../auth.js\";\nexport function create() {\n  const perfStartTime = Math.round(performance.now());\n  const startTime = Date.now();\n  createPageView();\n  return function finish(_ref) {\n    let {\n      status,\n      path,\n      pageTitle\n    } = _ref;\n    if (status !== \"ok\") {\n      earlyFinishPageView();\n      return;\n    }\n    const renderTime = Math.round(performance.now()) - perfStartTime;\n    const endTime = Date.now();\n    const {\n      username\n    } = getAuth();\n    finishPageView({\n      type: \"page\",\n      page: location.href,\n      _ver: startTime,\n      time: Math.round(startTime / 1000),\n      st: startTime,\n      et: endTime,\n      lt: renderTime,\n      pageTitle,\n      username,\n      route: path\n    });\n\n    // For bricks which would take actions with render time.\n    window.dispatchEvent(new CustomEvent(\"route.render\", {\n      detail: {\n        renderTime\n      }\n    }));\n  };\n}\n//# sourceMappingURL=pageView.js.map","// istanbul ignore file\nimport { checkPermissions as _checkPermissions, preCheckPermissions, preCheckPermissionsForBrickOrRoute } from \"./checkPermissions.js\";\nimport { MessageDispatcher } from \"./websocket/MessageDispatcher.js\";\nimport * as authV3 from \"./auth.js\";\nimport { authV2Factory } from \"./auth-v2.js\";\nimport * as _checkInstalledApps from \"./checkInstalledApps.js\";\nexport { _checkInstalledApps as checkInstalledApps };\nimport * as _flowApi from \"./flowApi/index.js\";\nexport { _flowApi as flowApi };\nimport * as _menu from \"./menu/index.js\";\nexport { _menu as menu };\nimport * as _analytics from \"./analytics/index.js\";\nexport { _analytics as analytics };\nexport const checkPermissions = Object.freeze({\n  checkPermissions: _checkPermissions,\n  preCheckPermissions,\n  preCheckPermissionsForBrickOrRoute\n});\nexport const messageDispatcher = new MessageDispatcher();\nexport const auth = authV2Factory() || authV3;\n//# sourceMappingURL=index.js.map","// istanbul ignore file\nimport { getV2RuntimeFromDll } from \"@next-core/runtime\";\nimport { pick } from \"lodash\";\nexport function authV2Factory() {\n  const v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return Object.freeze(pick(v2Kit, [\"authenticate\", \"getAuth\", \"isLoggedIn\", \"logout\"]));\n  }\n}\n//# sourceMappingURL=auth-v2.js.map"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","_defineProperty","obj","Object","defineProperty","enumerable","configurable","writable","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","push","_objectSpread2","length","forEach","getOwnPropertyDescriptors","defineProperties","PermissionApi_validatePermissions","_ref","data","options","http","post","_x","_x2","auth","authenticate","newAuth","assign","org","username","userInstanceId","loginFrom","accessRule","isAdmin","csrfToken","license","accessToken","userShowValue","getAuth","logout","checkingPermissions","clear","checkedPermissions","permissionMap","isLoggedIn","Map","preCheckPermissionsForAny","validatePermissions","scanPermissionActionsInAny","async","usedActions","uncheckedActions","action","includes","checkingTasks","restActions","promise","get","task","result","actions","noAbortOnRouteChange","item","set","authorizationStatus","console","all","RETRY_TIMEOUT_UNIT","RETRY_LIMIT","_url","WeakMap","_ws","_queuedMessages","_messageListeners","_closeListeners","_retryCount","_closed","_MessageService_brand","WeakSet","MessageService","constructor","url","Set","send","_connect","call","stringifiedData","JSON","stringify","readyState","WebSocket","OPEN","onMessage","listener","add","onClose","reset","close","_classPrivateFieldGet2","log","ws","resetRetryCountTimeout","addEventListener","setTimeout","msg","clearTimeout","code","_reconnect","response","parse","delay","Math","pow","_this$retryCount","_ms","_memoizedChannels","_channelPayloads","_MessageDispatcher_brand","_get_ms","_this","location","protocol","window","host","getBasePath","_subOrUnsub","type","channel","payload","stringifiedPayload","hit","request","event","identity","getIdentity","isSuccess","isFailed","system","topic","RuntimeApi_searchMicroAppStandalone","checkingApps","checkedApps","preCheckInstalledApps","storyboard","hasAppInBootstrap","STANDALONE_MICRO_APPS","NO_AUTH_GUARD","appIds","usage","usedArgs","customTemplates","menus","meta","traverseStoryboardExpressions","routes","node","parent","collectInstalledAppsHasUsage","scanInstalledAppsUsage","searchIds","appId","has","query","$in","fields","catch","_result$list","app","list","find","checkedApp","id","waitForCheckingApps","map","getCheckedApp","FLOW_API_PROVIDER","hasFields","ext_fields","some","source","callFlowApi","_ref2","originalUri","method","responseWrapper","isFileType","stream","isSimpleRequest","toLowerCase","defaultOptions","responseType","_len2","Array","_key2","_originalUri$match","_request$fields","params","_options","match","createSSEStream","getUrlWithParams","headers","fromEntries","Headers","entries","simpleRequest","isUploadType","processFields","isEmpty","field","hasFileType","hasQueryParams","hasBodyParams","_len","_key","processExtFields","FormData","formData","isArray","v","append","isObject","Blob","Date","k","transformFormData","_result$options","body","getBodyAndHeaders","requestWithBody","registerFlowApiProvider","customElements","define","createProviderClass","ContractApi_searchSingleContract","contractsMap","widgetContractMap","debugContractMap","addContract","contracts","contract","namespaceId","name","collectContract","collectWidgetContract","clearCollectWidgetContract","collectDebugContract","clearDebugContract","remoteContractCache","isFlowApiProvider","provider","getArgsOfFlowApi","originalArgs","Error","apiDefinition","namespaceName","nameWithVersion","split","version","getContract","namespace","serviceName","endpoint","_contractData$namespa","contractData","contractName","fetchFlowApiDefinitionFromRemote","fetchFlowApiDefinition","FlowApiNotFoundError","apiProfile","api","_contract$response","schema","json","uri","wrapper","getApiProfileFromApiDefinition","apiMethod","isDownload","fileName","shift","prefix","startsWith","restArgs","slice","transformedUri","replace","getTransformedUriAndRestArgs","getApiArgsFromApiProfile","message","super","captureStackTrace","InstanceApi_postSearch","objectId","concat","_x3","InstalledMicroAppApi_getMenusInfo","menuId","symbolAppId","Symbol","symbolMenuI18nNamespace","symbolOverrideApp","mergeMenu","menuList","runtimeContext","helpers","mainMenu","menu","validMenuList","injectWithMenus","menuWithI18n","i18n","menuI18nNamespace","instanceId","lang","resources","addResourceBundle","dynamicItems","itemsResolve","overrideAppId","newRuntimeContext","pendingPermissionsPreCheck","_helpers$getStoryboar","overrideApp","getStoryboardByAppId","appendI18nNamespace","resolved","resolveData","transform","items","loadDynamicMenuItems","_menu$items","injectMenuGroupId","injectingMenus","flatMap","processGroupInject","foundInjectingMenus","groupId","delete","children","injectingMenu","reorderMenu","menuData","reorderMenuItems","sortBy","sort","sortMenuItems","computeMenuData","titleDataSource","every","if","to","isEvaluable","yaml","pipes","hasOwnProperty","asyncComputeRealValue","ignoreSymbols","computeMenuItems","rest","computedRest","computedChildren","InstanceApi_getDetail","_x4","menuTitleCache","fetchMenuTitle","title","cacheKey","cachedTitle","attributeId","attr","instanceData","primary","join","String","menuPromises","menuCache","transformMenuItems","menuItems","checkIfOfComputed","text","childLayout","groupFrom","icon","defaultExpanded","omit","getMenuById","fetchMenuById","_storyboard$meta","_storyboard$meta2","injectMenus","_menu$app","getMenusOfStandaloneApp","flags","menuObjectId","page","page_size","link","defaultCollapsed","defaultCollapsedBreakpoint","$eq","$size","$gt","restMenuData","tplStateStoreId","forEachItem","forEachIndex","forEachSize","rootAppId","computedMenuData","computedMenuItems","finalMenuData","pick","_fetchMenuById","events","timer","transportOptions","maxWaitingTime","maxLoggedEvents","emit","transportData","model","columns","splice","callback","requestUrl","blob","navigator","sendBeacon","requestIdleCallback","requestAnimationFrame","cb","sendOnExit","transport","initialized","pageState","isFirstPageView","stashedApiMetrics","initialize","createTransport","symbolHttpAnalytics","onRequest","config","perfStartTime","round","performance","now","st","time","onResponse","onResponseOrError","onResponseError","hasError","responseOrError","perfEndTime","et","HttpAbortError","uid","traceId","size","status","isHttpResponseError","HttpResponseError","HttpParseError","responseJson","metric","_ver","href","duration","Number","create","startTime","path","pageTitle","renderTime","endTime","pageId","URL","createObjectURL","uuid","substring","lastIndexOf","revokeObjectURL","generateUUID","lt","route","apiCount","maxApiTimeCost","max","reduce","prev","current","finishPageView","dispatchEvent","CustomEvent","detail","freeze","checkPermissions","preCheckPermissions","scanPermissionActionsInStoryboard","preCheckPermissionsForBrickOrRoute","container","permissionsPreCheck","messageDispatcher","sub","unsub","subscribe","unsubscribe","warned","responsePayload","RegExp","_m","p1","p2","escapeRegExp","test","matchMessageChannel","v2Kit","getV2RuntimeFromDll","authV2Factory"],"sourceRoot":""}