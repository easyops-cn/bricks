"use strict";(self.webpackChunk_next_bricks_markdown=self.webpackChunk_next_bricks_markdown||[]).push([[869],{3869:(e,t,n)=>{n.r(t);var a,i,o,r,l,c,s,u,m,h,d,k,p,v,b,Z,w,g,y,f,E,C,M,N,S,W=n(3028),_=n(4795),j=n(6234),I=n(3395),Q=n(1815),q=n(381),x=n(687),V=n(2604),U=n(7896),B=n(8657),D=n.n(B),F=n(72),G=n(8787),O=(n(8161),n(4534)),$=n(6226),A=n(8858),J=n(4611),z=n(3991),K=n(8652),L=n(790),P=n(4426),T=n(6669),R=n(4547),X=n(6160),Y=n(3011),H=n(7529),ee=n(2642),te=n(2812),ne=n(1527),ae=n(7106),ie=n(5576),oe=(0,G.wrapBrick)("eo-form-item"),re=(0,G.wrapBrick)("eo-icon"),le=e=>{var{icon:t,onClick:n,tooltip:a}=e;return D().createElement("div",{className:"menu-btn-box",onMouseDown:e=>{null==n||n(),e.preventDefault()}},D().createElement(re,(0,U.Z)({style:{verticalAlign:"middle"}},t)),a&&D().createElement("div",{className:"menuIconTooltip"},a))},{defineElement:ce,property:se,event:ue}=(0,F.createDecorators)();i=ce("eo-markdown-editor",{styleTexts:[O.Z],alias:["markdown.markdown-editor"]}),o=se(),l=se(),s=se({type:Boolean}),m=se(),d=se(),p=se({attribute:!1}),b=ue({type:"image.upload"}),y=ue({type:"markdown.value.change"});var me=new WeakMap,he=new WeakMap,de=new WeakMap,ke=new WeakMap,pe=new WeakMap,ve=new WeakMap,be=new WeakMap,Ze=new WeakMap,we=new WeakMap,ge=new WeakMap;class ye extends ie.G{constructor(){super(...arguments),(0,I.Z)(this,ge,{get:Me,set:Ce}),(0,I.Z)(this,Ze,{get:Ee,set:fe}),(0,I.Z)(this,me,{writable:!0,value:(M(this),r(this))}),(0,I.Z)(this,he,{writable:!0,value:c(this)}),(0,I.Z)(this,de,{writable:!0,value:u(this)}),(0,I.Z)(this,ke,{writable:!0,value:h(this)}),(0,I.Z)(this,pe,{writable:!0,value:k(this)}),(0,I.Z)(this,ve,{writable:!0,value:v(this)}),(0,I.Z)(this,be,{writable:!0,value:Z(this)}),(0,j.Z)(this,"handleUploadImage",(e=>{(0,x.Z)(this,Ze).emit(e)})),(0,I.Z)(this,we,{writable:!0,value:f(this)}),(0,j.Z)(this,"handleMarkdownValueChange",(e=>{var t;null===(t=this.getFormElement())||void 0===t||t.formStore.onChange(this.name,e),this.value=e,(0,x.Z)(this,ge).emit(e)}))}get name(){return(0,x.Z)(this,me)}set name(e){(0,q.Z)(this,me,e)}get label(){return(0,x.Z)(this,he)}set label(e){(0,q.Z)(this,he,e)}get required(){return(0,x.Z)(this,de)}set required(e){(0,q.Z)(this,de,e)}get value(){return(0,x.Z)(this,ke)}set value(e){(0,q.Z)(this,ke,e)}get bucketName(){return(0,x.Z)(this,pe)}set bucketName(e){(0,q.Z)(this,pe,e)}get containerStyle(){return(0,x.Z)(this,ve)}set containerStyle(e){(0,q.Z)(this,ve,e)}render(){return D().createElement(J.iz,null,D().createElement(ee.cL,null,D().createElement(Ne,{formElement:this.getFormElement(),name:this.name,label:this.label,required:this.required,curElement:this,bucketName:this.bucketName,value:this.value,containerStyle:this.containerStyle,onUploadImage:this.handleUploadImage,onMarkdownValueChange:this.handleMarkdownValueChange})))}}function fe(e){g(this,e)}function Ee(){return w(this)}function Ce(e){C(this,e)}function Me(){return E(this)}function Ne(e){var{bucketName:t,containerStyle:n,value:a,formElement:i,onUploadImage:o,onMarkdownValueChange:r}=e,[l,c]=(0,B.useState)(!1),s=function(){var n=(0,_.Z)((function*(n,a){for(var i=[],r=[],l=0;l<n.length;l++){var c=n.item(l);c&&c.type.includes("image")&&i.push(c)}try{r=yield Promise.all(i.map(function(){var n=(0,_.Z)((function*(n){var i,r=yield(0,$.Q)(t,{file:n,width:1280,height:800}),l=(i=null==r?void 0:r.objectName,"/next/api/gateway/object_store.object_store.GetObject/api/v1/objectStore/bucket/".concat(e.bucketName,"/object/").concat(i)),c=n.name;return o&&o({name:c,src:l}),a.nodes.image.createAndFill({src:l,alt:c})}));return function(e){return n.apply(this,arguments)}}()))}catch(e){}return r}));return function(e,t){return n.apply(this,arguments)}}(),u=(0,ee.eK)(),m=(0,ee.AQ)(),h=(0,ee.mg)(),d=(0,B.useMemo)((()=>[X.r0,ne.$Q,ne.eJ,e=>(0,_.Z)((function*(){e.set(ne.$Q.key,{view:u({component:ne.zI})})})),(0,ne.l5)(m)].flat()),[u,m]),{get:k}=(0,J.jE)((e=>A.ML.make().config((n=>{n.set(A.KP,e),a&&n.set(A.Dn,a),n.get(R.QC).markdownUpdated(((e,t,n)=>{r&&r(t)})).focus((e=>{c(!0)})).blur((e=>{c(!1)})),t&&n.update(P.mS.key,(e=>(0,W.Z)((0,W.Z)({},e),{},{uploader:s}))),n.update(H.Vn.key,(e=>(0,W.Z)((0,W.Z)({},e),{},{configureRefractor:()=>te.$})))})).config(K.Q).use(R.X3).use(z.iO).use(L.m8).use(X.r0).use(Y.WY).use(P.ws).use(d).use(H.MS).use((0,T.u)(z.W0.node,(()=>h({component:ae.d}))))),[]);function p(e,t){var n;return null===(n=k())||void 0===n?void 0:n.action((0,T.lB)(e,t))}(0,B.useEffect)((()=>{var e;i&&void 0!==a&&!l&&(null===(e=k())||void 0===e||e.action((0,T.ko)(a)))}),[k(),a]);var v=[{icon:{lib:"antd",icon:"undo"},onClick:()=>p(L.N7.key),tooltip:"撤销"},{icon:{lib:"antd",icon:"redo"},onClick:()=>p(L.Ow.key),tooltip:"重做"},{icon:{lib:"antd",icon:"bold"},onClick:()=>p(z.gG.key),tooltip:"粗体"},{icon:{lib:"antd",icon:"italic"},onClick:()=>p(z.QF.key),tooltip:"斜体"},{icon:{lib:"antd",icon:"strikethrough"},onClick:()=>p(X.S2.key),tooltip:"删除线"},{icon:{lib:"antd",icon:"table"},onClick:()=>p(X.Jp.key),tooltip:"表格"},{icon:{lib:"antd",icon:"unordered-list"},onClick:()=>p(z.$m.key),tooltip:"无序列表"},{icon:{lib:"antd",icon:"ordered-list"},onClick:()=>p(z.vd.key),tooltip:"有序列表"},{icon:{lib:"fa",icon:"quote-right"},onClick:()=>p(z.vs.key),tooltip:"块引用"}];return D().createElement(oe,e,D().createElement("div",{className:"markdown-container",style:n},D().createElement("div",{className:"menu-container-outter"},D().createElement("div",{className:"menu-container-inner prose"},v.map((e=>D().createElement(le,(0,U.Z)({},e,{key:JSON.stringify(e.icon)})))))),D().createElement("div",{className:"editor-container"},D().createElement(J.Nl,null))))}N=ye,({e:[r,c,u,h,k,v,Z,w,g,f,E,C,M],c:[S,a]}=(0,V.Z)(N,[[o,1,"name"],[l,1,"label"],[s,1,"required"],[m,1,"value"],[d,1,"bucketName"],[p,1,"containerStyle"],[b,1,"uploadImage",e=>(0,x.Z)(e,be),(e,t)=>(0,q.Z)(e,be,t)],[y,1,"markdownValueChange",e=>(0,x.Z)(e,we),(e,t)=>(0,q.Z)(e,we,t)]],[i],0,(e=>Ze.has((0,Q.Z)(e))),ie.G)),a()}}]);
//# sourceMappingURL=869.f470d760.js.map