"use strict";(self.webpackChunk_next_bricks_basic=self.webpackChunk_next_bricks_basic||[]).push([[422],{3885:(e,t,i)=>{i.r(t),i.d(t,{lockBodyScroll:()=>n});var r=i(628),a=(i(6438),new Set);function n(e,t){if(t){if(a.add(e),!document.body.classList.contains("disable-scroll")){var i=(r=document.documentElement.clientWidth,Math.abs(window.innerWidth-r));document.body.classList.add("disable-scroll"),document.body.style.setProperty("--body-scroll-lock-size","".concat(i,"px"))}}else a.delete(e),0===a.size&&(document.body.classList.remove("disable-scroll"),document.body.style.removeProperty("--body-scroll-lock-size"));var r}customElements.define("basic.lock-body-scroll",(0,r.createProviderClass)(n))},4102:(e,t,i)=>{i.d(t,{c:()=>m});var r=i(8657),a=i.n(r),n=i(4511),o=i(3958),s=i(5037),l=0,c="data:image/svg+xml;base64,".concat(window.btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 180" style="background: rgb(238, 240, 244);"><g transform="translate(-12, -12)"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" color="current" x="160" y="90"><g fill="currentColor" fill-rule="nonzero"><path d="M21.042 2.11c1.19 0 2.156.966 2.156 2.156v15.288c0 1.19-.966 2.156-2.156 2.156H2.925a2.157 2.157 0 0 1-2.156-2.156V4.266c0-1.192.965-2.157 2.156-2.157h18.117Zm0 1.5H2.925a.656.656 0 0 0-.656.656v15.288c0 .361.294.656.656.656h18.117a.657.657 0 0 0 .656-.656V4.266a.657.657 0 0 0-.656-.657Z" style="&#10;  fill: #9FAECF;&#10;"/><path d="M9.516 5.344a2.298 2.298 0 1 1-.002 4.595 2.298 2.298 0 0 1 .002-4.595ZM19.847 18.117H4.123a.469.469 0 0 1-.406-.703l1.868-4.453c.722-1.25 2.527-1.25 3.249 0l.864 1.5a.938.938 0 0 0 1.657-.063l2.818-5.87c.51-1.063 2.027-1.063 2.536.003l3.56 8.916c.15.31-.078.67-.422.67Z" style="&#10;  fill: #57689C;&#10;"/></g></svg></g></svg>')),d=(0,n.wrapBrick)("eo-icon");function m(e){var{index:t,src:i,fallback:n,placeholder:m,alt:p,width:v,height:u,style:h,onClick:g,preview:w=!0}=e,f=(0,r.useMemo)((()=>[i,n,c]),[i,n]),{status:b,src:y}=(0,o.Z)(f),[k]=a().useState(++l),{onlyPreview:x,registerImage:Z}=(0,r.useContext)(s.ImageListContext);return(0,r.useEffect)((()=>Z(k,{uuid:k,src:y,preview:w,index:t,alt:p})),[]),(0,r.useEffect)((()=>{Z(k,{uuid:k,src:y,preview:w,index:t,alt:p})}),[y,w,p,t]),x?null:a().createElement(a().Fragment,null,a().createElement("div",{className:"image-wrapper",onClick:()=>null==g?void 0:g(k,w),style:{width:v,height:u}},a().createElement("img",{className:"image",src:y,alt:p,width:v,height:u,style:h}),"loading"===b&&a().createElement("div",{"aria-hidden":"true",className:"image-placeholder"},m),!!w&&a().createElement("div",{className:"image-mask"},a().createElement("div",{className:"image-mask-info"},a().createElement(d,{lib:"antd",theme:"outlined",icon:"eye",className:"image-mask-info-icon"}),"预览"))))}},349:(e,t,i)=>{i.d(t,{Y:()=>d});var r=i(8657),a=i.n(r),n=i(5037),o=i(2278),s=i(4102),l=i(5178),{Provider:c}=n.ImageListContext,d=(0,r.forwardRef)((function(e,t){var{imgList:i,width:n,height:d,onlyPreview:m,onVisibleChange:p}=e,[v,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)(void 0),w=(e,t)=>{t&&(g(e),u(!0),null==p||p(!0))},[f,b]=(0,r.useState)(new Map),y=Array.from(f.values()).filter((e=>!!e.preview)).sort(((e,t)=>e.index-t.index));return(0,r.useImperativeHandle)(t,(()=>({openPreview:e=>{var t,i;(0,l.isNil)(e)?g(null===(t=y[0])||void 0===t?void 0:t.uuid):g(null===(i=y.find((t=>t.index===e)))||void 0===i?void 0:i.uuid),u(!0),null==p||p(!0)},closePreview:()=>{u(!1),null==p||p(!1)}}))),a().createElement(a().Fragment,null,a().createElement(c,{value:{previewImageList:y,currentUUid:h,onlyPreview:m,setCurrentUUid:g,registerImage:(e,t)=>(b((i=>new Map(i).set(e,t))),()=>{b((t=>{var i=new Map(t);return i.delete(e)?i:t}))})}},null==i?void 0:i.map(((e,t)=>a().createElement(s.c,{key:t,index:t,src:e.src,fallback:e.fallback,placeholder:e.placeholder,alt:e.alt,width:e.width||n,height:e.height||d,style:e.style,preview:e.preview,onClick:w}))),a().createElement(o.M,{visible:v,onClose:()=>{u(!1),null==p||p(!1)}})))}))},5037:(e,t,i)=>{i.d(t,{ImageListContext:()=>r});var r=(0,i(8657).createContext)({previewImageList:[],currentUUid:void 0,onlyPreview:!1,setCurrentUUid:()=>null,registerImage:()=>()=>null})},2278:(e,t,i)=>{i.d(t,{M:()=>v});var r=i(8657),a=i.n(r),n=i(4511),o=i(2779),s=i.n(o),l=i(7243),c=i(2347),d=i(5037),m=i(3885),p=(0,n.wrapBrick)("eo-icon"),v=e=>{var t,i,{visible:n,onClose:o,scaleStep:v=.5}=e,{transform:u,resetTransform:h,updateTransform:g,dispatchZoomChange:w}=(0,l.Z)(),f=(0,r.useRef)(null);(0,r.useEffect)((()=>{n||h(),f.current&&(0,m.lockBodyScroll)(f.current,!!n)}),[n]);var{previewImageList:b,currentUUid:y,setCurrentUUid:k}=(0,r.useContext)(d.ImageListContext),x=b.map((e=>e.uuid)),Z=x.indexOf(y),E=[{icon:a().createElement(p,{lib:"antd",theme:"outlined",icon:"close"}),onClick:o,type:"close"},{icon:a().createElement(p,{lib:"antd",theme:"outlined",icon:"zoom-in"}),onClick:()=>{w(c.iX+v)},type:"zoom-in",disabled:u.scale>=c.Fv},{icon:a().createElement(p,{lib:"antd",theme:"outlined",icon:"zoom-out"}),onClick:()=>{w(c.iX-v)},type:"zoom-out",disabled:u.scale<=c.vL},{icon:a().createElement(p,{lib:"antd",theme:"outlined",icon:"rotate-right"}),onClick:()=>{g({rotate:u.rotate+90})},type:"rotate-right"},{icon:a().createElement(p,{lib:"antd",theme:"outlined",icon:"rotate-left"}),onClick:()=>{g({rotate:u.rotate-90})},type:"rotate-left"}];return a().createElement("div",{className:"preview-root",ref:f,style:{visibility:n?"visible":"hidden"}},a().createElement("div",{className:"preview-mask"}),a().createElement("div",{className:"preview-wrap"},a().createElement("div",{className:"preview-image-wrap",onClick:e=>{e.target===e.currentTarget&&(null==o||o())}},a().createElement("img",{className:"preview-image",draggable:!1,src:null===(t=b[Z])||void 0===t?void 0:t.src,alt:null===(i=b[Z])||void 0===i?void 0:i.alt,style:{transform:"translate3d(".concat(u.translateX,"px, ").concat(u.translateY,"px, 0) scale3d(").concat(u.scale,", ").concat(u.scale,", 1) rotate(").concat(u.rotate,"deg)")}}))),a().createElement("div",{className:"preview-operations"},a().createElement("div",{className:s()("preview-switch","preview-switch-left",{"preview-switch-disabled":Z<=0}),onClick:()=>{k(x[Z-1<=0?0:Z-1])}},a().createElement(p,{lib:"antd",theme:"outlined",icon:"left"})),a().createElement("div",{className:s()("preview-switch","preview-switch-right",{"preview-switch-disabled":Z>=b.length-1}),onClick:()=>{var e=Z+1>=b.length-1?b.length-1:Z+1;k(x[e])}},a().createElement(p,{lib:"antd",theme:"outlined",icon:"right"})),a().createElement("div",{className:"preview-operations-bar"},a().createElement("div",{className:"preview-operations-progress"},"".concat(Z+1," / ").concat(b.length)),E.map((e=>{var{icon:t,type:i,disabled:r,onClick:n}=e;return a().createElement("div",{"data-testid":"preview-operations-button-".concat(i),className:s()("preview-operations-button",{"preview-operations-button-disabled":!!r}),onClick:n,key:i},t)})))))}},3958:(e,t,i)=>{i.d(t,{Z:()=>c});var r=i(4795),a=i(8657),n=i.n(a),o=new Map,s=e=>new Promise(((t,i)=>{var r=new Image;r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e})),l=e=>new Promise(((t,i)=>{!function(){var a=(0,r.Z)((function*(){for(var r of e)if(o.has(r)||o.set(r,s(r)),yield o.get(r))return void t(r);i(e[e.length-1])}));return function(){return a.apply(this,arguments)}}()()}));function c(e){var[t,i]=n().useState(),[r,o]=n().useState();return(0,a.useEffect)((()=>{var t=[].concat(e).filter(Boolean);o(void 0),t.length?(i("loading"),l(t).then((e=>{i("normal"),o(e)})).catch((e=>{i("error"),o(e)}))):i("normal")}),[e]),{status:t,src:r}}},7243:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(3028),a=i(8657),n=i(2347),o={translateX:0,translateY:0,scale:1,rotate:0};function s(){var[e,t]=(0,a.useState)(o),i=e=>{requestAnimationFrame((()=>{t((t=>(0,r.Z)((0,r.Z)({},t),e)))}))};return{transform:e,resetTransform:()=>{t(o)},updateTransform:i,dispatchZoomChange:t=>{var r=e.scale*t;r>n.Fv?r=n.Fv:r<n.vL&&(r=n.vL),i({scale:r})}}}},5929:(e,t,i)=>{i.r(t),i.d(t,{Image:()=>k});var r,a,n,o,s,l,c,d,m,p,v,u,h,g,w,f,b,y,k,x=i(3395),Z=i(6666),E=i(1815),C=i(381),L=i(687),N=i(2604),P=i(8657),z=i.n(P),I=i(5366),M=i(4511),S=i(6941),U=i(6929),_=(i(8161),i(349)),{defineElement:F,property:R,method:W,event:B}=(0,I.createDecorators)();a=F("eo-image",{styleTexts:[S.Z,U.Z],alias:["basic.general-image"]}),n=R({attribute:!1}),s=R(),c=R(),m=R({type:Boolean}),v=W(),u=W(),h=B({type:"visibleChange"});var T=new WeakMap,X=new WeakMap,A=new WeakMap,Y=new WeakMap,H=new WeakMap,V=new WeakMap,j=new WeakMap;class q extends M.ReactNextElement{constructor(){super(...arguments),(0,x.Z)(this,V,{get:O,set:D}),(0,Z.Z)(this,"_ImageListRef",(0,P.createRef)()),(0,x.Z)(this,T,{writable:!0,value:(b(this),o(this))}),(0,x.Z)(this,X,{writable:!0,value:l(this)}),(0,x.Z)(this,A,{writable:!0,value:d(this)}),(0,x.Z)(this,Y,{writable:!0,value:p(this)}),(0,x.Z)(this,H,{writable:!0,value:g(this)}),(0,x.Z)(this,j,{writable:!0,value:e=>{(0,L.Z)(this,V).emit(e)}})}get imgList(){return(0,L.Z)(this,T)}set imgList(e){(0,C.Z)(this,T,e)}get width(){return(0,L.Z)(this,X)}set width(e){(0,C.Z)(this,X,e)}get height(){return(0,L.Z)(this,A)}set height(e){(0,C.Z)(this,A,e)}get onlyPreview(){return(0,L.Z)(this,Y)}set onlyPreview(e){(0,C.Z)(this,Y,e)}open(e){var t;null===(t=this._ImageListRef.current)||void 0===t||t.openPreview(e)}close(){var e;null===(e=this._ImageListRef.current)||void 0===e||e.closePreview()}render(){return z().createElement(_.Y,{ref:this._ImageListRef,imgList:this.imgList,width:this.width,height:this.height,onlyPreview:this.onlyPreview,onVisibleChange:(0,L.Z)(this,j)})}}function D(e){f(this,e)}function O(){return w(this)}y=q,({e:[o,l,d,p,g,w,f,b],c:[k,r]}=(0,N.Z)(y,[[n,1,"imgList"],[s,1,"width"],[c,1,"height"],[m,1,"onlyPreview"],[v,2,"open"],[u,2,"close"],[h,1,"visibleChange",e=>(0,L.Z)(e,H),(e,t)=>(0,C.Z)(e,H,t)]],[a],0,(e=>j.has((0,E.Z)(e))),M.ReactNextElement)),r()},2347:(e,t,i)=>{i.d(t,{Fv:()=>a,iX:()=>n,vL:()=>r});var r=1,a=50,n=1},3744:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(9601),a=i.n(r),n=i(2609),o=i.n(n)()(a());o.push([e.id,"body.disable-scroll{overflow:hidden;padding-right:var(--body-scroll-lock-size)}",""]);const s=o},6941:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(9601),a=i.n(r),n=i(2609),o=i.n(n)()(a());o.push([e.id,".image-wrapper{position:relative}.image{vertical-align:middle}.image-placeholder{position:absolute;top:0;right:0;bottom:0;left:0}.image-wrapper:hover .image-mask{opacity:1}.image-mask{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:14px;color:#fff;background:rgba(0,0,0,0.5);cursor:pointer;opacity:0;transition:opacity 0.3s}.image-mask-info{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px}.image-mask-info-icon{margin-right:4px;vertical-align:middle}",""]);const s=o.toString()},6929:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(9601),a=i.n(r),n=i(2609),o=i.n(n)()(a());o.push([e.id,".preview-mask{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000;background-color:var(--antd-modal-mask-bg)}.preview-wrap{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000}.preview-image-wrap{position:absolute;inset:0;display:flex;justify-content:center;align-items:center}.preview-image{max-width:100%;max-height:100%;vertical-align:middle;transition:transform 0.3s cubic-bezier(0.215,0.61,0.355,1) 0s;cursor:-webkit-grab;cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.preview-operations{position:fixed;z-index:1080}.preview-switch{font-size:18px;width:40px;height:40px;position:fixed;top:50%;transform:translateY(-50%);border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:1081;background:rgba(0,0,0,0.1);color:#fff;cursor:pointer;transition:background,color 0.3s}.preview-switch:not(.preview-switch-disabled):hover{background:rgba(0,0,0,0.2)}.preview-switch-disabled{color:rgba(255,255,255,0.25);background:none;cursor:not-allowed}.preview-switch-left{left:12px}.preview-switch-right{right:12px}.preview-operations-bar{position:fixed;left:0;right:0;top:0;font-size:14px;color:#fff;background:rgba(0,0,0,0.1);display:flex;flex-direction:row-reverse;align-items:center}.preview-operations-progress{position:absolute;left:50%;transform:translateX(-50%)}.preview-operations-button{font-size:18px;margin-left:12px;padding:12px;cursor:pointer;transition:background,color 0.3s}.preview-operations-button:last-of-type{margin-left:0}.preview-operations-button:hover{background:rgba(0,0,0,0.2)}.preview-operations-button-disabled{color:rgba(255,255,255,0.25);pointer-events:none}",""]);const s=o.toString()},6438:(e,t,i)=>{var r=i(6062),a=i.n(r),n=i(4036),o=i.n(n),s=i(6793),l=i.n(s),c=i(7892),d=i.n(c),m=i(1173),p=i.n(m),v=i(2464),u=i.n(v),h=i(3744),g={};g.styleTagTransform=u(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=p(),a()(h.Z,g),h.Z&&h.Z.locals&&h.Z.locals}}]);
//# sourceMappingURL=eo-image.50dd08d9.js.map