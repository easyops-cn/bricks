"use strict";(self.webpackChunk_next_bricks_ui_test=self.webpackChunk_next_bricks_ui_test||[]).push([[5776,3028],{8053:(e,t,n)=>{n.r(t),n.d(t,{injectPreviewAgent:()=>u});var r=n(3028),o=n(4795),a=n(628),i=n(5062),s=n(7113),c=n(997),l=!1,p=(0,i.getHistory)();function u(e,t){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((function*(e,t){if(!l){l=!0;var n=t=>{window.parent.postMessage((0,r.Z)({channel:"ui-test-preview"},t),e)};n({type:"initialized"}),(0,s.iZ)(e);var o=!1;window.addEventListener("message",(e=>{var t;if("ui-test-preview"===(null===(t=e.data)||void 0===t?void 0:t.channel))switch(e.data.type){case"toggle-record":(0,c.V)(e.data.payload.recording,o);break;case"toggle-inspecting":(0,s.Kf)(o=e.data.payload.inspecting);break;case"reload":location.reload();break;case"back":p.goBack();break;case"forward":p.goForward();break;case"hover-over-tree-node":(0,s.kI)(e.data.payload.relatedCommands);break;case"set-active-tree-node":(0,s.DK)(e.data.payload.relatedCommands)}})),p.listen((e=>{n({type:"url-change",payload:{url:location.origin+p.createHref(e)}})})),window.addEventListener("scroll",(()=>{n({type:"scroll",payload:{x:window.scrollX,y:window.scrollY}})}))}}))).apply(this,arguments)}customElements.define("ui-test.inject-preview-agent",(0,a.createProviderClass)(u))},7113:(e,t,n)=>{n.d(t,{AO:()=>r,DK:()=>g,Kf:()=>c,iZ:()=>s,kI:()=>y,p0:()=>w});var r,o=n(3028),a=n(1211),i=!1;function s(e){r=e}function c(e){if(i!==e){i=e;var t=e?"addEventListener":"removeEventListener";window[t]("click",l,!0),window[t]("mousedown",p,!0),window[t]("mouseover",p,!0),window[t]("mouseup",p,!0),window[t]("pointerdown",d,!0),window[t]("pointerover",f,!0),window[t]("pointerup",p,!0),window[t]("pointerleave",v,!0)}}function l(e){e.preventDefault(),e.stopPropagation(),function(e){var t=w(e.composedPath());t.length>0&&window.parent.postMessage({channel:"ui-test-preview",type:"inspect-select",payload:{targets:t.map((e=>e.selector))}},r)}(e)}function p(e){e.preventDefault(),e.stopPropagation()}var u=(0,a.throttle)((e=>{var t=w(e);window.parent.postMessage({channel:"ui-test-preview",type:"inspect-hover",payload:{outlines:t.length>0?[m(t[0])]:[]}},r)}),100,{leading:!1});function d(e){e.preventDefault(),e.stopPropagation(),u(e.composedPath())}function f(e){e.preventDefault(),e.stopPropagation(),u(e.composedPath())}function v(e){e.preventDefault(),e.stopPropagation(),window.parent.postMessage({channel:"ui-test-preview",type:"inspect-hover",payload:{outlines:[]}},r)}function w(e){var t=[];for(var n of e)if(n.nodeType===Node.ELEMENT_NODE&&n instanceof HTMLElement){if(n.id&&("main-mount-point"===n.id||"portal-mount-point"===n.id))break;var r=n.tagName.toLowerCase();if("slot"===r)continue;n.dataset.testid?t.push({element:n,selector:{type:"testid",value:n.dataset.testid,tag:r}}):n.id&&t.push({element:n,selector:{type:"id",value:n.id,tag:r}})}return t.length>1&&(0,a.isEqual)(t[0].selector,{tag:"button",type:"testid",value:"button"})&&"basic-bricks.general-button"===t[1].selector.tag&&t.shift(),t}function y(e){window.parent.postMessage({channel:"ui-test-preview",type:"inspect-hover",payload:{outlines:h(e)}},r)}function g(e){window.parent.postMessage({channel:"ui-test-preview",type:"inspect-active",payload:{outlines:h(e)}},r)}function h(e){var t=[],n=[document],r=!1,a=function(e){var[t]=null!=s?s:[];switch(e){case"findByTestId":case"findAllByTestId":if("string"==typeof t){var n='[data-testid="'.concat(t,'"]');c((t=>"findByTestId"===e?t.querySelector(n):[...t.querySelectorAll(n)]),{type:"testid",value:t});break}l();break;case"get":if("string"==typeof t){/^#[-\w]+$/.test(t)?c((e=>[...e.querySelectorAll(t)]),{type:"id",value:t.substring(1)}):c((e=>[...e.querySelectorAll(t)]),{type:"css-selector",value:t});break}l();break;case"find":if("string"==typeof t){c((e=>[...e.querySelectorAll(t)]),{type:"css-selector",value:t});break}l()}};for(var{name:i,params:s}of e)a(i);function c(e,a){r&&(t.length=0);var i=[];for(var s of n){var c=e(s),l=b(c);if(l&&!c)break;for(var p of l?[c]:c)t.push({element:p,selector:(0,o.Z)((0,o.Z)({},a),{},{tag:p.tagName.toLowerCase()})}),i.push(p);if(l)break}n=i,r=!0}function l(){r&&(t.length=0),n=[],r=!0}return t.map(m)}function b(e){return!Array.isArray(e)}function m(e){var{element:t,selector:n}=e,{width:r,height:o,left:a,top:i}=t.getBoundingClientRect();return{width:r,height:o,left:a+window.scrollX,top:i+window.scrollY,selector:n}}},997:(e,t,n)=>{n.d(t,{V:()=>c});var r,o,a=n(7113),i=!1,s=null;function c(e,t){i!==e&&(i=e,t&&(0,a.Kf)(!e),e?(o=[],window.addEventListener("click",l,{capture:!0,passive:!0}),window.addEventListener("dblclick",l,{capture:!0,passive:!0}),window.addEventListener("keydown",p,{capture:!0,passive:!0})):(u(),s=null,window.removeEventListener("click",l,{capture:!0}),window.removeEventListener("dblclick",l,{capture:!0}),window.removeEventListener("keydown",p,{capture:!0}),o.length>0&&window.parent.postMessage({channel:"ui-test-preview",type:"record-complete",payload:{steps:o}},a.AO)))}function l(e){u(),s=null;var t=(0,a.p0)(e.composedPath());0!==t.length&&o.push({event:e.type,targets:t.map((e=>e.selector))})}function p(e){var t,n=(0,a.p0)(e.composedPath()),o=n[0];if(0!==n.length)switch(o.element!==(null===(t=s)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.element)&&(u(),s=n,r=[]),e.key){case"Backspace":r.push("{backspace}");break;case"Enter":r.push("{enter}");break;case"Escape":r.push("{esc}");break;default:1===e.key.length&&r.push(e.key)}else s=null}function u(){s&&r.length>0&&o.push({event:"type",targets:s.map((e=>e.selector)),text:r.join("")})}},4795:(e,t,n)=>{function r(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,c,"next",e)}function c(e){r(i,o,a,s,c,"throw",e)}s(void 0)}))}}n.d(t,{Z:()=>o})},6666:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(5850);function o(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},3028:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(6666);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},5850:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(6522);function o(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==(0,r.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,r.Z)(t)?t:String(t)}},6522:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:()=>r})}}]);
//# sourceMappingURL=inject-preview-agent.24b9b78d.js.map