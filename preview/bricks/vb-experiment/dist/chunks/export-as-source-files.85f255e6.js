"use strict";(self.webpackChunk_next_bricks_vb_experiment=self.webpackChunk_next_bricks_vb_experiment||[]).push([[732],{3298:(e,n,t)=>{t.r(n),t.d(n,{exportAsSourceFiles:()=>I});var r=t(4795),o=t(6107),a=t(1297),i=t.n(a),l=t(6782),s=t(554),c=t(8828),p=t(311),d=t(7243),f=t(1639),u=t(8003),m=t(299),y=t(5125),x=t(9602),h=t(7287),g=t(2524),j=t(3626),v=t(8223),_=t(4450),b=t(3239),A=t(7040),k=t(3870),w=t(8649),S=t(5670),E=t(5202);function I(e){return N.apply(this,arguments)}function N(){return(N=(0,r.Z)((function*(e){var n,t,r,o,a,s,{projectDetail:c,storyboard:p}=e,I=new(i()),N=I.folder("project"),T=N.folder("src"),C={extracts:[],namePool:new Map},F=(0,f.I$)(p.routes,[],C),R={id:c.appId,name:c.name,homepage:c.appSetting.homepage,layoutType:c.appSetting.layoutType,theme:c.appSetting.theme,noAuthGuard:c.appSetting.noAuthGuard,locales:c.appSetting.locales,defaultConfig:JSON.parse(c.appSetting.defaultConfig||"{}"),menuIcon:JSON.parse(c.appSetting.icon||"null"),standaloneMode:!0};T.file("app.js",yield O("export default ".concat(JSON.stringify(R,null,2),";")));var M=null!==(n=p.meta)&&void 0!==n?n:{},Z=null!==(t=M.customTemplates)&&void 0!==t?t:[],D=null!==(r=M.functions)&&void 0!==r?r:[],G=null!==(o=M.menus)&&void 0!==o?o:[],U=null!==(a=M.contracts)&&void 0!==a?a:[],W=null!==(s=M.i18n)&&void 0!==s?s:{};delete M.customTemplates,delete M.functions,delete M.menus,delete M.contracts,delete M.i18n,delete M.workflows,delete M.mocks,delete M.userGroups;var z=(0,f.LK)(Z,["components"],C);C.extracts.push({name:"index",path:["components"],node:z,nodeType:"others"});var B=(0,u.B)(C.extracts);T.file("index.js",x),T.file("routes.jsx",yield O((0,m.R)(F,"routes",["routes.jsx"])));var H=T.folder("resources"),K=H.folder("functions"),L=[],$=[];for(var q of D){if("index"===q.name)throw new Error('Unexpected function name: "index"');var Q=new Set,{code:V}=(0,d.transform)(q.source,{filename:"expr.".concat(q.typescript?"ts":"js"),plugins:[...q.typescript?["syntax-typescript"]:[],S.Z,[E.Z,{imports:Q}]]}),X=Q.has("FN");X&&Q.delete("FN");var Y=[];Q.size>0&&Y.push("import { ".concat([...Q].join(", "),' } from "next-jsx/runtime";')),X&&Y.push('import FN from "./index.js";'),Y.length>0&&(V="".concat(Y.join("\n"),"\n\n").concat(V)),K.file("".concat(q.name,".").concat(q.typescript?"ts":"js"),V),$.push("import ".concat(q.name,' from "./').concat(q.name,'.js";')),L.push(q.name)}K.file("index.js",yield O("".concat($.join("\n"),"\n\nconst FN = { ").concat(L.join(",")," };\n\nexport default FN;")));var ee=H.folder("menus"),ne=[],te=[];for(var re of G){if(J(re),"index"===re.menuId)throw new Error('Unexpected menu id: "index"');var oe="".concat(re.menuId,".js");ee.file(oe,yield O((0,m.R)(re,"menu",["resources","menus",oe])));var ae=re.menuId.replace(/^\d+|[^\w]+/g,"_");w.h8.has(ae)&&(ae="".concat(ae,"__2")),te.push("import ".concat(ae,' from "./').concat(oe,'";')),ne.push(ae)}ee.file("index.js",yield O("".concat(te.join("\n"),"\n\nexport default [").concat(ne.join(","),"]")));var ie=H.folder("contracts"),le=[],se=[];for(var ce of U){if("index"===ce.name)throw new Error('Unexpected contract name: "index"');ie.file("".concat(ce.name,".js"),yield O("export default ".concat(JSON.stringify(ce),";")));var pe=ce.name.replace(/^\d+|[^\w]+/g,"_");se.push("import ".concat(pe,' from "./').concat(ce.name,'.js";')),le.push(pe)}ie.file("index.js",yield O("".concat(se.join("\n"),"\n\nexport default [").concat(le.join(","),"]"))),H.folder("i18n").file("index.js",yield O("export default ".concat(JSON.stringify(W),";"))),H.file("meta.js",yield O("export default ".concat(JSON.stringify(M,null,2),";"))),H.file("index.js",y),yield P(B,T,[]),N.folder("mock-micro-apps").folder(c.appId).file(".gitignore","*\n!.gitignore"),N.file(".editorconfig",h),N.file(".gitignore",g),N.file("dev.config.mjs",v),N.file("declarations.d.ts",j),N.file("jsconfig.json",_),N.file("next-jsx.config.js",b.replaceAll("__APP_ID__",c.appId)),N.file("package.json",A.replaceAll("__APP_ID__",c.appId)),N.file("README.md",k.replaceAll("__PROJECT_NAME__",c.name).replaceAll("__PROJECT_HOMEPAGE__",c.appSetting.homepage));var de=yield I.generateAsync({type:"blob"});(0,l.saveAs)(de,"project.zip")}))).apply(this,arguments)}function O(e){return T.apply(this,arguments)}function T(){return T=(0,r.Z)((function*(e){var{typescript:n,semi:t=!0,printWidth:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return yield(0,s.WU)(e,{parser:n?"babel-ts":"babel",plugins:[c,p],semi:t,printWidth:r,trailingComma:"es5"})})),T.apply(this,arguments)}function P(e,n,t){return C.apply(this,arguments)}function C(){return(C=(0,r.Z)((function*(e,n,t){for(var r of e){var o=[...t,r.name];if("folder"===r.type){var a=n.folder(r.name);yield P(r.items,a,o)}else n.file("".concat(r.name,".js").concat("routes"===r.nodeType||"bricks"===r.nodeType||"template"===r.nodeType?"x":""),yield O((0,m.R)(r.node,r.nodeType,o)))}}))).apply(this,arguments)}function J(e){for(var[n,t]of Object.entries(e))switch(n){case"items":if(Array.isArray(t))for(var r of t)F(r);break;case"type":"main"===t&&delete e[n];break;case"if":break;case"i18n":0===Object.keys(t).length&&delete e[n];break;default:null!==t&&!1!==t||delete e[n]}}function F(e){for(var[n,t]of Object.entries(e))switch(n){case"children":Array.isArray(t)&&t.length>0&&F(t);break;case"if":break;case"activeExcludes":case"activeIncludes":Array.isArray(t)&&0===t.length&&delete e[n];break;default:null!==t&&!1!==t||delete e[n]}}customElements.define("vb-experiment.export-as-source-files",(0,o.createProviderClass)(I))}}]);
//# sourceMappingURL=export-as-source-files.85f255e6.js.map