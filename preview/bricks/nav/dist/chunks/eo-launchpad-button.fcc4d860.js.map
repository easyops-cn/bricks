{"version":3,"file":"chunks/eo-launchpad-button.fcc4d860.js","mappings":";kRASAA,EAAAA,EAAAA,qBAAoBC,EAAAA,GAAIC,EAAAA,GAExB,MAAM,cAAEC,IAAkBC,EAAAA,EAAAA,oBAE1B,IAAAC,EAKA,MAAAC,UAG8BC,EAAAA,iBAC5BC,MAAAA,GACE,OAAOC,IAAAA,cAACC,EAAAA,EAAwB,KAClC,EACDC,EAAAL,GAAAD,EAAAO,IAAAC,EAAAA,EAAAA,GAAAF,EAAA,CAPAR,EAAc,sBAAuB,CACpCW,WAAY,CAACC,EAAAA,MACb,YAC4BR,EAAAA,kBAAgBS,EAAAJ,mDCrBvC,MAAMK,EAOXC,WAAAA,CAAYC,IAA8BC,EAAAA,EAAAA,GAAA,kBANN,OAAIA,EAAAA,EAAAA,GAAA,0BACZ,IAAKA,EAAAA,EAAAA,GAAA,yBACoB,OAAIA,EAAAA,EAAAA,GAAA,mBACpC,IAAKA,EAAAA,EAAAA,GAAA,oBAIxBC,KAAKF,KAAOA,CACd,CAEAG,gBAAAA,GACE,IAAKD,KAAKE,kBAAmB,CAC3BF,KAAKE,mBAAoB,EACzB,MAAMC,EAAwBC,UAC5BJ,KAAKK,WAAa,KAClBL,KAAKM,OAAO,EAG4B,mBAA/BC,OAAOC,oBAChBR,KAAKK,WAAaE,OAAOC,oBAAoBL,GAE7CH,KAAKK,WAAaI,WAChBN,EAGN,CACF,CAEAG,KAAAA,CAAMI,GAWJ,IAAIC,EACJ,OAXIX,KAAKK,aAEkC,mBAA9BE,OAAOK,mBAChBA,mBAAmBZ,KAAKK,YAExBQ,aAAab,KAAKK,YAEpBL,KAAKK,WAAa,MAIfL,KAAKc,aAAcJ,IACtBV,KAAKc,YAAa,EAClBH,EAAUX,KAAKF,OACfa,EACGI,OAAOC,IAENC,QAAQD,MAAMA,GACdhB,KAAKkB,kBAAoB,IAAI,IAE9BC,SAAQ,KACPnB,KAAKc,YAAa,CAAK,IAEtBd,KAAKkB,oBACRlB,KAAKkB,kBAAoBP,IAEvBD,GAICV,KAAKkB,kBAHDP,CAIb,4DCvDSS,EAA6C,WACtD,IAAIC,GAAO,QAAkB,UAAWC,EAAMC,GAC5C,aAA0F,EAAAC,KAAKC,KAAK,kFAAmFH,EAAMC,IAC7L,IACF,IACA,OAAO,SAAuCG,EAAIC,GAChD,OAAON,EAAKO,MAAM5B,KAAM6B,UAC1B,CACF,CARwD,kDCA7CC,EAAgC,CAACC,EAAYR,IAAuF,EAAAC,KAAKQ,OAAO,mFAAmFC,OAAOF,GAAaR,sECCvPW,EAA2C,WACpD,IAAIb,GAAO,QAAkB,UAAWc,EAAQZ,GAC9C,aAAwF,EAAAC,KAAKY,IAAI,iFAAiF,QAAc,OAAc,CAAC,EAAGb,GAAU,CAAC,EAAG,CAC5NY,aAEJ,IACF,IACA,OAAO,SAAqCT,EAAIC,GAC9C,OAAON,EAAKO,MAAM5B,KAAM6B,UAC1B,CACF,CAVsD,oCCP/C,MAAMQ,EACXxC,WAAAA,CACUyC,GAER,IADQC,EAAcV,UAAAW,OAAA,QAAAC,IAAAZ,UAAA,GAAAA,UAAA,GAAG,cAAa,KAD9BS,QAAAA,EAAgB,KAChBC,OAAAA,CACP,CAEHG,OAAAA,CAAiBC,EAAcC,GAC7B5C,KAAKsC,QAAQI,QAAQ1C,KAAKuC,OAASI,EAAME,KAAKC,UAAUF,GAC1D,CAEAG,OAAAA,CAAiBJ,GACf,OAAOE,KAAKG,MAAMhD,KAAKsC,QAAQS,QAAQ/C,KAAKuC,OAASI,GACvD,CAEAM,UAAAA,CAAWN,GACT,OAAO3C,KAAKsC,QAAQW,WAAWjD,KAAKuC,OAASI,EAC/C,CAEAO,KAAAA,GACE,OAAOlD,KAAKsC,QAAQY,OACtB","sources":["webpack:///./src/launchpad/index.tsx","webpack:///./src/shared/DeferredService.ts","webpack:///../../node_modules/@next-api-sdk/user-service-sdk/dist/esm/api/user_service/launchpad/createCollection.js","webpack:///../../node_modules/@next-api-sdk/user-service-sdk/dist/esm/api/user_service/launchpad/deleteCollection.js","webpack:///../../node_modules/@next-api-sdk/user-service-sdk/dist/esm/api/user_service/launchpad/listCollection.js","webpack:///../../src/JsonStorage.ts"],"sourcesContent":["import React from \"react\";\nimport { createDecorators } from \"@next-core/element\";\nimport { ReactNextElement } from \"@next-core/react-element\";\nimport { LaunchpadButton as LaunchpadButtonComponent } from \"./LaunchpadButton/LaunchpadButton.js\";\nimport { initializeReactI18n } from \"@next-core/i18n/react\";\nimport \"@next-core/theme\";\nimport { NS, locales } from \"./i18n.js\";\nimport styleText from \"./LaunchpadButton/LaunchpadButton.shadow.css\";\n\ninitializeReactI18n(NS, locales);\n\nconst { defineElement } = createDecorators();\n\n/**\n * Launchpad 按钮构件\n * @author sailor\n * @insider\n */\n@defineElement(\"eo-launchpad-button\", {\n  styleTexts: [styleText],\n})\nclass LaunchpadButton extends ReactNextElement {\n  render() {\n    return <LaunchpadButtonComponent />;\n  }\n}\n\nexport { LaunchpadButton };\n","export class DeferredService {\n  private preFetchId: number | null = null;\n  private preFetchScheduled = false;\n  private firstFetchPromise: Promise<unknown> | null = null;\n  private isFetching = false;\n  private readonly task: () => Promise<unknown>;\n\n  constructor(task: () => Promise<unknown>) {\n    this.task = task;\n  }\n\n  schedulePrefetch(): void {\n    if (!this.preFetchScheduled) {\n      this.preFetchScheduled = true;\n      const preFetchLaunchpadInfo = async (): Promise<void> => {\n        this.preFetchId = null;\n        this.fetch();\n      };\n      // istanbul ignore if\n      if (typeof window.requestIdleCallback === \"function\") {\n        this.preFetchId = window.requestIdleCallback(preFetchLaunchpadInfo);\n      } else {\n        this.preFetchId = setTimeout(\n          preFetchLaunchpadInfo\n        ) as unknown as number;\n      }\n    }\n  }\n\n  fetch(eager?: boolean): Promise<unknown> {\n    if (this.preFetchId) {\n      // istanbul ignore if\n      if (typeof window.cancelIdleCallback === \"function\") {\n        cancelIdleCallback(this.preFetchId);\n      } else {\n        clearTimeout(this.preFetchId);\n      }\n      this.preFetchId = null;\n    }\n\n    let promise: Promise<unknown>;\n    if (!this.isFetching || eager) {\n      this.isFetching = true;\n      promise = this.task();\n      promise\n        .catch((error) => {\n          // eslint-disable-next-line no-console\n          console.error(error);\n          this.firstFetchPromise = null;\n        })\n        .finally(() => {\n          this.isFetching = false;\n        });\n      if (!this.firstFetchPromise) {\n        this.firstFetchPromise = promise;\n      }\n      if (eager) {\n        return promise;\n      }\n    }\n    return this.firstFetchPromise!;\n  }\n}\n","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 新增我的收藏\n * @endpoint POST /api/v1/launchpad/collection\n */\nexport var LaunchpadApi_createCollection = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (data, options) {\n    return (/**! @contract easyops.api.user_service.launchpad.CreateCollection@1.0.0 */(yield http.post(\"api/gateway/user_service.launchpad.CreateCollection/api/v1/launchpad/collection\", data, options)).data\n    );\n  });\n  return function LaunchpadApi_createCollection(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=createCollection.js.map","import { http } from \"@next-core/http\";\n\n/**\n * @description 删除我的收藏\n * @endpoint DELETE /api/v1/launchpad/collection/:instanceId\n */\nexport var LaunchpadApi_deleteCollection = (instanceId, options) => /**! @contract easyops.api.user_service.launchpad.DeleteCollection@1.0.0 */http.delete(\"api/gateway/user_service.launchpad.DeleteCollection/api/v1/launchpad/collection/\".concat(instanceId), options);\n//# sourceMappingURL=deleteCollection.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { http } from \"@next-core/http\";\n/**\n * @description 获取我的收藏列表\n * @endpoint LIST /api/v1/launchpad/collection\n */\nexport var LaunchpadApi_listCollection = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (params, options) {\n    return (/**! @contract easyops.api.user_service.launchpad.ListCollection@1.0.0 */(yield http.get(\"api/gateway/user_service.launchpad.ListCollection/api/v1/launchpad/collection\", _objectSpread(_objectSpread({}, options), {}, {\n        params\n      }))).data\n    );\n  });\n  return function LaunchpadApi_listCollection(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n//# sourceMappingURL=listCollection.js.map","export class JsonStorage {\n  constructor(\n    private storage: Storage,\n    private prefix: string = \"brick-next-\"\n  ) {}\n\n  setItem<T = any>(name: string, value: T): void {\n    this.storage.setItem(this.prefix + name, JSON.stringify(value));\n  }\n\n  getItem<T = any>(name: string): T {\n    return JSON.parse(this.storage.getItem(this.prefix + name) as string) as T;\n  }\n\n  removeItem(name: string): void {\n    return this.storage.removeItem(this.prefix + name);\n  }\n\n  clear(): void {\n    return this.storage.clear();\n  }\n}\n"],"names":["initializeReactI18n","NS","locales","defineElement","createDecorators","_LaunchpadButton","LaunchpadButton","ReactNextElement","render","React","LaunchpadButtonComponent","_LaunchpadButton2","_initClass","_applyDecs","styleTexts","styleText","c","DeferredService","constructor","task","_defineProperty","this","schedulePrefetch","preFetchScheduled","preFetchLaunchpadInfo","async","preFetchId","fetch","window","requestIdleCallback","setTimeout","eager","promise","cancelIdleCallback","clearTimeout","isFetching","catch","error","console","firstFetchPromise","finally","LaunchpadApi_createCollection","_ref","data","options","http","post","_x","_x2","apply","arguments","LaunchpadApi_deleteCollection","instanceId","delete","concat","LaunchpadApi_listCollection","params","get","JsonStorage","storage","prefix","length","undefined","setItem","name","value","JSON","stringify","getItem","parse","removeItem","clear"],"sourceRoot":""}