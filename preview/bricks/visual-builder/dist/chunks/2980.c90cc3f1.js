"use strict";(globalThis.webpackChunk_next_bricks_visual_builder=globalThis.webpackChunk_next_bricks_visual_builder||[]).push([[2980],{4940:(e,t,o)=>{o.d(t,{e:()=>a,l:()=>l});var n=o(8769);const a=(0,n.createContext)({});function l(){return(0,n.useContext)(a)}},7758:(e,t,o)=>{o.d(t,{cU:()=>L});var n=o(9575),a=o(8769),l=o.n(a),r=o(1030),i=o.n(r),c=o(3373),s=o.n(c),d=o(9406),u=o(4940);let p=function(e){return e.inside="inside",e.top="top",e.bottom="bottom",e}({});const f=(0,a.createContext)({});function h(){return(0,a.useContext)(f)}var m=o(4295),b=o(5223);const g=(0,m.wrapBrick)("eo-icon");function v(e){let{data:t,className:o,gap:n,isFirst:r,isLast:i,actions:c,actionsHidden:d,onActionClick:u}=e;const p=(0,a.useMemo)((()=>null==c?void 0:c.filter((e=>(0,b.checkIfByTransform)(e,t)))),[c,t]);return d||null==p||!p.length?null:l().createElement("div",{className:s()("actionsBar",o),style:{gap:n}},p.map((e=>l().createElement(x,{key:e.action,action:e,data:t,isFirst:r,isLast:i,onActionClick:u}))))}function x(e){let{action:t,data:o,isFirst:n,isLast:r,onActionClick:i}=e;const c=n&&"move-up"===t.action||r&&"move-down"===t.action,d=(0,a.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),c||null==i||i({action:t.action,data:o})}),[t.action,o,c,i]),u=(0,a.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]);return l().createElement("a",{className:s()("action",{disabled:c}),title:t.title,role:"button",onClick:d,onContextMenu:u,onMouseDown:u},l().createElement(g,t.icon))}const k=(0,m.wrapBrick)("eo-link"),y=(0,m.wrapBrick)("eo-icon"),w=10,E="0 0 0 1px #ba6d30",C=(0,a.createContext)(!1);function L(e){let{nodes:t,placeholder:o,searchPlaceholder:n,isDrag:r,noSearch:c,allowDrag:u,allowDragToRoot:h,allowDragToInside:m,dropEmit:b}=e;const[g,v]=(0,a.useState)(""),[x,k]=(0,a.useState)(r),[w,E]=(0,a.useState)(),[L,S]=(0,a.useState)(),[I,M]=(0,a.useState)(),[A,B]=(0,a.useState)(),[D,R]=(0,a.useState)(),[P,F]=(0,a.useState)(),{nodeKey:T,onBrickDrop:z,contextMenuFactory:$,matchNode:_}=(0,d.o)(),K=(0,a.useMemo)((()=>function(e,t){const o=(e,n,a,l)=>{const r=e.shift();if(r){e.length>0&&e.splice(0,1,`${r}/${e[0]}`);const i=n.find((e=>e&&e.key===r&&e.isContainer));if(i)n[l]=null,o(e,i.children,a);else{const i=r.split("/"),c={name:i.pop(),key:r,parentPath:i?i.join("/"):i,originKey:a.key,data:{[t]:r,isContainer:!0},children:[],icon:{icon:"folder",lib:"antd",theme:"filled",color:"orange"},isContainer:!0};"number"==typeof l?n[l]=c:n.push(c),o(e,c.children,a)}}else n.push(a)};return e.forEach(((t,n)=>{if(t.path){const a=t.path.split("/").filter(Boolean);o(a,e,t,n)}})),e.filter(Boolean)}((null==t?void 0:t.slice())??[],T)),[t,T]),O=(0,a.useCallback)((e=>{v(e.target.value)}),[]),j=(0,a.useMemo)((()=>null==$?void 0:$()),[$]),W=null==g?void 0:g.trim().toLowerCase(),H=(0,a.useMemo)((()=>{if(c||!W||!K)return K;const e=t=>{var o;t.matchedSelf=_(t,W);const n=null===(o=t.children)||void 0===o?void 0:o.map(e).includes(!0);return t.matched=t.matchedSelf||n,t.matched};return K.forEach(e),K.slice()}),[c,W,K,_]),U=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e;for(;o;){if(o.draggable&&(t||o!==e)&&"A"!==o.tagName)return o;o=o.parentElement}},Y=function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(const a of e)if(a.data[o]===t&&(n=a),a.children&&(n=Y(a.children,t,o,n)),n)break;return n},V=()=>{S(null),B(null),M(null),R(null),k(!1)};return(0,a.useEffect)((()=>{k(r)}),[r]),(0,a.useEffect)((()=>(window.addEventListener("dragend",V),()=>{window.removeEventListener("dragend",V)})),[]),l().createElement("div",{style:{height:"100%"},className:"tree-wrapper",onContextMenu:j},null!=K&&K.length?l().createElement("div",null,!c&&l().createElement("div",{className:"searchBox",onContextMenu:e=>e.stopPropagation()},l().createElement("span",{className:s()("filter-input-wrapper",{focus:P})},l().createElement("span",{className:"prefix"},l().createElement(y,{icon:"search",lib:"antd",theme:"outlined"})),l().createElement("input",{value:g,onChange:O,onFocus:()=>F(!0),onBlur:()=>F(!1),autoComplete:"off",placeholder:n}),l().createElement("span",{className:"suffix"},g?l().createElement(y,{className:"clear-button",icon:"close-circle",lib:"antd",theme:"filled",onClick:()=>{v("")}}):null))),l().createElement(C.Provider,{value:!!g},l().createElement(f.Provider,{value:{allow:u,allowDragToRoot:h,dragElement:L,dragOverElement:A,dragStatus:D,onDragStart:(e,t)=>{var o;if(e.stopPropagation(),!u)return;const n=e.target;null!==(o=n.dataset)&&void 0!==o&&o.container||(k(!0),function(e,t){const o=document.createElement("canvas");document.body.append(o);const n=o.getContext("2d");o.width=n.measureText(t).width+60,o.height=20,o.style.position="absolute",o.style.left="-100%",o.style.zIndex="-100",n.fillStyle="#333333",n.fillRect(0,0,o.width,o.height),n.fillStyle="#999999",n.font="bold 14px Arial",n.fillText(t,20,15),e.dataTransfer.setDragImage(o,0,0)}(e,n.innerText),S(n),E(t))}}},l().createElement("div",{className:s()({hightlight:r}),onDragOver:e=>{if(e.preventDefault(),!x)return;if("workbenchTree-placeholder-dom"===e.target.className)return;const t=(e=>{const t=U(e.target),o=t.dataset.uid;if(t===L||null!=o&&o.includes(":"))return;const{top:n,bottom:a}=t.getBoundingClientRect();let l;const r=m?5:10;return l=e.clientY<n+r?p.top:e.clientY>a-r?p.bottom:m?p.inside:D,{element:t,node:Y(K,o,T),status:l}})(e);!t||null!=L&&L.contains(t.element)||(B(t.element),M(t.node),R(t.status))},onDrop:e=>{if(x){if(z){let t=A;[p.top,p.bottom].includes(D)&&(t=U(t,!1)),z(e,{curElement:L,overElement:A,parentElement:t,overStatus:D})}else if(h||1!==Number(A.dataset.level)){let e=I;const t=(o,n)=>{for(let a=0;a<o.length;a++){if(o[a].key===n){e=o[a];break}o[a].children&&t(o[a].children,n)}},o=A.dataset.uid;t(K,o);const n=t=>{let o=!1;const{container:a,uid:l}=A.dataset,r=a?e.originKey:l,i=t.filter((e=>(e.children&&(e.children=n(e.children)),e.key===r&&(o=!0),e.key!==w.key)));return o&&i.splice(i.findIndex((e=>e.key===r))+("bottom"===D?1:0),0,w),i},a=function(e){const t=[],o=e=>{e.forEach((e=>{e.isContainer?o(e.children):t.push(i().omit(e,["path","icon"]))}))};return o(e),t}(K),l=w.isContainer?a.find((e=>e.key===w.originKey)):w;l.data.path=e.parentPath||e.path,b({nodes:n(a),curNode:l,overNode:e,status:D})}V()}}},l().createElement(N,{nodes:H,level:1}))))):l().createElement("div",{className:"placeholder"},o))}function N(e){let{nodes:t,level:o}=e;const n=t.length-1;return l().createElement("ul",{className:"tree"},t.filter((e=>(0,b.checkIfOfComputed)(e))).map(((e,t)=>l().createElement(I,{key:e.key,node:e,level:o,isFirst:0===t,isLast:t===n}))))}function S(e){let{style:t}=e;const{dragStatus:o}=h(),n={height:22,border:"1px dashed goldenrod",opacity:o===p.inside?"0":"1",...t};return l().createElement("li",{className:"workbenchTree-placeholder-dom",style:n})}function I(e){var t,o,i;let{node:c,level:f,isFirst:m,isLast:b}=e;const g=!(null!==(t=c.children)&&void 0!==t&&t.length),x=c.isContainer,{hoverKey:L,activeKey:I,basePaddingLeft:M,showMatchedNodeOnly:A,fixedActionsFor:B,collapsible:D,collapsedNodes:R,nodeKey:P,clickFactory:F,mouseEnterFactory:T,mouseLeaveFactory:z,contextMenuFactory:$,onNodeToggle:_,getCollapsedId:K,skipNotify:O}=(0,d.o)(),{allow:j,allowDragToRoot:W,onDragStart:H,dragElement:U,dragOverElement:Y,dragStatus:V}=h(),{actions:q,actionsHidden:G,onActionClick:J}=(0,u.l)(),Q=f*w+M-2,X=(0,a.useContext)(C),[Z,ee]=(0,a.useState)(null),[te,oe]=(0,a.useState)(!1),[ne,ae]=(0,a.useState)((null==R?void 0:R.includes(null==K?void 0:K(c)))??!1),le=(0,a.useMemo)((()=>null==T?void 0:T(c)),[T,c]),re=(0,a.useMemo)((()=>null==z?void 0:z(c)),[z,c]),ie=(0,a.useCallback)((e=>{var t;e.stopPropagation(),null==$||null===(t=$(c))||void 0===t||t(e)}),[$,c]),ce=I&&c.key===I,se=(0,a.useMemo)((()=>ce?e=>{var t;null==e||null===(t=e.scrollIntoView)||void 0===t||t.call(e,{block:"center",inline:"center"})}:null),[]),de=(0,a.useMemo)((()=>{return x?c.key:c.data?"mount-point"===(e=c.data).type?e.parent[P]||`${e.parent.$$uid}:${e.mountPoint}`:e[P]||e.$$uid:void 0;var e}),[P,c,x]);(0,a.useEffect)((()=>{V!==p.inside&&[p.top,p.bottom].includes(V)&&ee(V)}),[V]);const ue=(0,a.useMemo)((()=>!!U&&U.dataset.uid===String(de)),[U,de]),pe=(0,a.useMemo)((()=>!!Y&&Y.dataset.uid===String(de)),[Y,de]),fe=(0,a.useMemo)((()=>{let e={opacity:ue?.2:1};return pe&&V===p.inside&&(e={boxShadow:E,background:"rgba(255, 255, 255, 0.1)"}),Object.assign({},e)}),[pe,ue,V]),he=(0,a.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),oe(!0),ae((e=>!e))}),[]),me=(0,a.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),be=(0,a.useCallback)((e=>{var t;if(!x)return null==F||null===(t=F(c))||void 0===t?void 0:t();he(e)}),[F,he,x,c]);(0,a.useEffect)((()=>{te&&(null==_||_(null==K?void 0:K(c),ne))}),[te,ne,K,c,_]);const ge=D&&!g&&!X;return X&&A&&!c.matched?null:l().createElement(l().Fragment,null,pe&&(W||1!==f)&&Z===p.top&&l().createElement(S,{style:{marginLeft:Q}}),l().createElement("li",(0,n.A)({draggable:j,onDragStart:e=>H(e,c),"data-uid":de,"data-level":f,style:fe},x?{"data-container":x}:{}),l().createElement(k,(0,n.A)({className:"nodeLabelLink",tabIndex:0,onMouseEnter:le,onMouseLeave:re,onContextMenu:ie,onClick:be},O?{url:{pathname:(0,r.get)(c.link,"url","href"),state:{notify:!1}}}:{...(0,r.pick)(c.link,["url","href"])}),l().createElement("span",{className:s()("nodeLabelRow",{active:ce,hover:L&&c.key===L,matched:X&&c.matchedSelf&&!A,fixedActions:B&&[].concat(B).some((e=>(0,r.isMatch)(c.data,e))),collapsed:ge&&ne,collapsible:ge})},l().createElement("span",{className:s()("nodeLabel",{unreachable:c.unreachable}),style:{paddingLeft:Q,color:c.labelColor},ref:se},l().createElement("span",{className:"nodeIconWrapper"},ge&&l().createElement("span",{className:"collapseIcon",onClick:he,onMouseDown:me,title:ne?"Expand":"Collapse",role:"button"},l().createElement(y,{lib:"antd",theme:"outlined",icon:ne?"right":"down"})),l().createElement("span",{className:"nodeIcon"},l().createElement(y,(0,n.A)({},c.icon,{style:{fontSize:null!==(o=c.icon)&&void 0!==o&&o.imgSrc?14:null,color:null===(i=c.icon)||void 0===i?void 0:i.color}})))),l().createElement("span",{className:"nodeName"},c.labelPrefix&&l().createElement("span",{style:c.labelPrefix.style},c.labelPrefix.text),c.name)),l().createElement(v,{className:"nodeActionsBar",data:c.data,isFirst:m,isLast:b,actions:q,onActionClick:J,actionsHidden:G}),c.badge&&l().createElement("span",{className:"badge"},l().createElement(y,(0,n.A)({},c.badge,{style:{color:c.badge.color}}))))),g||l().createElement(N,{nodes:c.children,level:f+1})),pe&&(W||1!==f)&&Z===p.bottom&&l().createElement(S,{style:{marginLeft:Q}}))}},9406:(e,t,o)=>{o.d(t,{N:()=>a,o:()=>l});var n=o(8769);const a=(0,n.createContext)({});function l(){return(0,n.useContext)(a)}},675:(e,t,o)=>{function n(e,t){switch(typeof e){case"string":return e.toLowerCase().includes(t);case"boolean":case"number":return String(e).includes(t);case"object":return null===e?"null".includes(t):(Array.isArray(e)?e:Object.entries(e).flat()).some((e=>n(e,t)));default:return!1}}o.d(t,{U:()=>n})},6275:(e,t,o)=>{o.d(t,{A:()=>i});var n=o(6758),a=o.n(n),l=o(935),r=o.n(l)()(a());r.push([e.id,".actionsBar{display:flex;align-items:center;padding:0 3px}.action{display:flex;justify-content:center;align-items:center;width:20px;height:20px;border-radius:5px}.action:hover{color:#fff;background-color:rgba(90,93,94,0.31)}.action{color:#c5c5c5}.disabled,\n.disabled:hover{color:var(--color-disabled-text);cursor:not-allowed;background-color:initial}",""]);const i=r.toString()},7995:(e,t,o)=>{o.d(t,{A:()=>i});var n=o(6758),a=o.n(n),l=o(935),r=o.n(l)()(a());r.push([e.id,':host,\n:host-context(html[data-override-theme="light"]){--search-box-background:#fff;--node-color:#595959;--node-color-focus:#595959;--node-background-active:#e0eeff;--node-background-focus:#e0eeff;--node-icon-background-hover:#fff}:host-context(html[data-theme="dark-v2"]),\n:host-context(html[data-override-theme="dark-v2"]){--search-box-background:#181818;--node-color:#c5c5c5;--node-color-focus:#fff;--node-background-active:rgba(255,255,255,0.08);--node-background-focus:#1a7aff;--node-icon-background-hover:rgba(90,93,94,0.31)}.searchBox{position:sticky;top:0;background-color:var(--search-box-background);padding:5px 10px 10px;z-index:1}.searchBox .filter-input-wrapper{background-color:var(--search-box-background);border:1px solid rgba(255,255,255,0.2);position:relative;width:100%;min-width:0;padding:2px 7px;color:var(--antd-input-color);font-size:14px;line-height:1.5715;display:inline-flex;border-radius:3px;transition:all 0.3s;box-sizing:border-box}.searchBox .filter-input-wrapper.focus{background-color:var(--search-box-background);border:1px solid rgba(255,255,255,0.2);border-right-width:1px!important;outline:0;box-shadow:0 0 0 2px rgba(0,113,235,0.2)}.searchBox .filter-input-wrapper input{text-overflow:ellipsis;border:none;outline:none;border-radius:3px;background-color:var(--search-box-background);box-sizing:border-box;margin:0;padding:0;color:var(--antd-text-color);font-variant:tabular-nums;list-style:none;font-feature-settings:"tnum";position:relative;display:inline-block;width:100%;min-width:0;color:var(--antd-input-color);font-size:14px;line-height:1.5715;background-image:none;transition:all 0.3s}.prefix{margin-right:4px}.suffix{margin-left:4px}.searchBox .prefix,\n.searchBox .suffix{display:flex;flex:none;align-items:center}.clear-button{cursor:pointer}.tree{list-style:none;margin:0;padding:0}.placeholder{color:var(--antd-input-placeholder-color);padding:0 15px}.nodeLabelLink{display:block}.nodeLabelLink::part(link){display:flex}.nodeLabelRow{display:flex;cursor:pointer;height:22px;padding-right:10px;flex:1;min-width:0}.nodeLabelRow:hover,\n.nodeLabelRow.hover{background-color:rgba(255,255,255,0.12)}.nodeLabelLink:focus .nodeLabelRow.active{background-color:var(--node-background-focus)}.nodeLabel{display:flex;align-items:center;min-width:0;flex:1}.unreachable{opacity:0.3}.nodeAction,\n.nodeAction:hover,\n.nodeLabelRow .nodeLabel{color:var(--node-color)}.nodeLabelLink:focus .nodeLabel{color:var(--node-color-focus)}.nodeLabelRow.matched .nodeLabel{color:var(--palette-orange-6)}.nodeLabelRow.active{background-color:var(--node-background-active)}.nodeIconWrapper{display:flex;width:24px;flex-shrink:0}.nodeIcon,\n.collapseIcon{display:flex;justify-content:center;align-items:center;width:20px;height:20px;border-radius:5px;font-size:13px}.collapseIcon{display:none}.nodeLabelRow.collapsed .nodeIcon,\n.nodeLabelRow.collapsible .nodeIconWrapper:hover .nodeIcon{display:none}.nodeLabelRow.collapsed .collapseIcon,\n.nodeLabelRow.collapsible .nodeIconWrapper:hover .collapseIcon{display:flex}.nodeLabelRow.collapsible .nodeIcon:hover,\n.nodeLabelRow.collapsible .collapseIcon:hover{background-color:var(--node-icon-background-hover)}.nodeName{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.nodeLabelRow:not(:hover, .fixedActions) .nodeActionsBar{display:none}.badge{margin:0 3px}.collapsed + .tree{display:none}.hightlight{outline-width:1px;outline-style:solid;outline-offset:-1px;outline-color:#fcd93f}',""]);const i=r.toString()}}]);
//# sourceMappingURL=2980.c90cc3f1.js.map