/*! For license information please see 4231.41067a78.js.LICENSE.txt */
"use strict";(self.webpackChunk_next_bricks_visual_builder=self.webpackChunk_next_bricks_visual_builder||[]).push([[4231],{4231:(e,t,a)=>{a.r(t);var i,n,o,r,c,l,s,d,h,p,u,E,v,b,m,g,f,w,N,L=a(3395),k=a(1815),Z=a(381),O=a(687),I=a(2604),R=a(8657),y=a.n(R),T=a(5366),x=a(4511),M=a(8249),A=a(8453),_=a(2779),D=a.n(_),P=(0,x.wrapBrick)("icons.general-icon"),{defineElement:U,property:C,event:F}=(0,T.createDecorators)();n=U("visual-builder.workbench-pane",{styleTexts:[M.Z,A.Z]}),o=C(),c=C({type:Boolean}),s=C({type:Number}),h=F({type:"active.change"}),v=F({type:"active.firstActivated"});var W=new WeakMap,S=new WeakMap,B=new WeakMap,K=new WeakMap,j=new WeakMap,z=new WeakMap,G=new WeakMap,H=new WeakMap,V=new WeakMap;class Y extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,H,{get:X,set:q}),(0,L.Z)(this,j,{get:$,set:J}),(0,L.Z)(this,W,{writable:!0,value:(f(this),r(this))}),(0,L.Z)(this,S,{writable:!0,value:l(this)}),(0,L.Z)(this,B,{writable:!0,value:d(this)}),(0,L.Z)(this,K,{writable:!0,value:p(this)}),(0,L.Z)(this,z,{writable:!0,value:e=>{e!==this.active&&(this.active=e,(0,O.Z)(this,j).emit(e))}}),(0,L.Z)(this,G,{writable:!0,value:b(this)}),(0,L.Z)(this,V,{writable:!0,value:()=>{(0,O.Z)(this,H).emit()}})}get titleLabel(){return(0,O.Z)(this,W)}set titleLabel(e){(0,Z.Z)(this,W,e)}get active(){return(0,O.Z)(this,S)}set active(e){(0,Z.Z)(this,S,e)}get badge(){return(0,O.Z)(this,B)}set badge(e){(0,Z.Z)(this,B,e)}render(){return y().createElement(Q,{titleLabel:this.titleLabel,active:this.active,badge:this.badge,onActiveChange:(0,O.Z)(this,z),onFirstActivated:(0,O.Z)(this,V)})}}function J(e){E(this,e)}function $(){return u(this)}function q(e){g(this,e)}function X(){return m(this)}function Q(e){var{titleLabel:t,active:a,badge:i,onActiveChange:n,onFirstActivated:o}=e,[r,c]=(0,R.useState)(a),[l,s]=(0,R.useState)(!1);(0,R.useEffect)((()=>{c(a)}),[a]),(0,R.useEffect)((()=>{null==n||n(r)}),[r,n]);var d=(0,R.useCallback)((()=>{c((e=>!e)),l||r||(s(!0),null==o||o())}),[l,r,o]),h=(0,R.useRef)(),[p,u]=(0,R.useState)(!1),E=(0,R.useMemo)((()=>{return e=()=>{u(h.current.scrollTop>0)},i=function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];t&&a(),t=requestAnimationFrame((()=>{e(...n)}))},i.cancel=a=()=>cancelAnimationFrame(t),i;var e,t,a,i}),[]);return y().createElement("div",{className:D()("pane",{scrolled:p})},y().createElement("div",{className:"pane-header",tabIndex:0,onClick:d},y().createElement("div",{className:"pane-title"},y().createElement("span",{className:"title-icon"},r?y().createElement(P,{lib:"antd",theme:"outlined",icon:"down"}):y().createElement(P,{lib:"antd",theme:"outlined",icon:"right"})),y().createElement("div",{className:"title-label"},t),y().createElement("slot",{name:"title"})),y().createElement("slot",{name:"actions"}),i&&y().createElement("div",{className:"badge"},i),y().createElement("div",{className:"pane-scroll-shadow"})),y().createElement("div",{className:"pane-body custom-scrollbar-container",onScroll:E,ref:h},y().createElement("slot",null,y().createElement("div",{style:{padding:"10px 20px",color:"var(--text-color-secondary)"}},"No content"))))}w=Y,({e:[r,l,d,p,u,E,b,m,g,f],c:[N,i]}=(0,I.Z)(w,[[o,1,"titleLabel"],[c,1,"active"],[s,1,"badge"],[h,1,"activeChangeEvent",e=>(0,O.Z)(e,K),(e,t)=>(0,Z.Z)(e,K,t)],[v,1,"activeFirstActivatedEvent",e=>(0,O.Z)(e,G),(e,t)=>(0,Z.Z)(e,G,t)]],[n],0,(e=>V.has((0,k.Z)(e))),x.ReactNextElement)),i();var ee,te,ae,ie,ne,oe,re,ce=a(6666),le=a(3571),{defineElement:se,property:de}=(0,T.createDecorators)();te=se("visual-builder.workbench-sidebar",{styleTexts:[le.Z]}),ae=de();var he=new WeakMap,pe=new WeakMap,ue=new WeakMap,Ee=new WeakMap;class ve extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,he,{writable:!0,value:(ne(this),ie(this))}),(0,L.Z)(this,pe,{writable:!0,value:()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("slot:not([name])")}}),(0,L.Z)(this,ue,{writable:!0,value:()=>{var e=(0,O.Z)(this,pe).call(this).assignedNodes();for(var t of e){var a;t.active?t.style.flex=String(null!==(a=t.activeFlex)&&void 0!==a?a:"1"):t.style.flex="initial"}}}),(0,L.Z)(this,Ee,{writable:!0,value:e=>{var t=e.target.assignedNodes();for(var a of t)a.addEventListener("active.change",(0,O.Z)(this,ue))}}),(0,ce.Z)(this,"refCallback",(()=>{(0,O.Z)(this,ue).call(this);var e=(0,O.Z)(this,pe).call(this);null==e||e.addEventListener("slotchange",(e=>{(0,O.Z)(this,Ee).call(this,e)}))}))}get titleLabel(){return(0,O.Z)(this,he)}set titleLabel(e){(0,Z.Z)(this,he,e)}render(){return y().createElement(be,{titleLabel:this.titleLabel,refCallback:this.refCallback})}}function be(e){var{titleLabel:t,refCallback:a}=e;return y().createElement("div",{className:"sidebar",ref:a},y().createElement("div",{className:"title-container"},y().createElement("div",{className:"title-label"},t),y().createElement("slot",{name:"titleToolbar"})),y().createElement("div",{className:"pane-container"},y().createElement("slot",null)))}oe=ve,({e:[ie,ne],c:[re,ee]}=(0,I.Z)(oe,[[ae,1,"titleLabel"]],[te],0,void 0,x.ReactNextElement)),ee();var me,ge,fe,we,Ne,Le,ke,Ze,Oe,Ie,Re,ye,Te,xe,Me,Ae=a(7310),{defineElement:_e,property:De}=(0,T.createDecorators)(),Pe=(0,x.wrapBrick)("basic.general-link"),Ue=(0,x.wrapBrick)("icons.general-icon");ge=_e("visual-builder.workbench-action",{styleTexts:[Ae.Z]}),fe=De({attribute:!1}),Ne=De(),ke=De({type:Boolean}),Oe=De(),Re=De();var Ce=new WeakMap,Fe=new WeakMap,We=new WeakMap,Se=new WeakMap,Be=new WeakMap;class Ke extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,Ce,{writable:!0,value:(Te(this),we(this))}),(0,L.Z)(this,Fe,{writable:!0,value:Le(this)}),(0,L.Z)(this,We,{writable:!0,value:Ze(this)}),(0,L.Z)(this,Se,{writable:!0,value:Ie(this)}),(0,L.Z)(this,Be,{writable:!0,value:ye(this)})}get icon(){return(0,O.Z)(this,Ce)}set icon(e){(0,Z.Z)(this,Ce,e)}get to(){return(0,O.Z)(this,Fe)}set to(e){(0,Z.Z)(this,Fe,e)}get active(){return(0,O.Z)(this,We)}set active(e){(0,Z.Z)(this,We,e)}get href(){return(0,O.Z)(this,Se)}set href(e){(0,Z.Z)(this,Se,e)}get target(){return(0,O.Z)(this,Be)}set target(e){(0,Z.Z)(this,Be,e)}render(){return y().createElement(je,{to:this.to,icon:this.icon,active:this.active,href:this.href,target:this.target})}}function je(e){var{icon:t,to:a,active:i,href:n,target:o}=e;return y().createElement(Pe,{className:D()("action",{active:i}),url:a,href:n,target:o},y().createElement(Ue,t))}xe=Ke,({e:[we,Le,Ze,Ie,ye,Te],c:[Me,me]}=(0,I.Z)(xe,[[fe,1,"icon"],[Ne,1,"to"],[ke,1,"active"],[Oe,1,"href"],[Re,1,"target"]],[ge],0,void 0,x.ReactNextElement)),me();var ze=a(5062),Ge=a(8353);function He(e,t,a,i){var n=[],o=[],r=0;return e.forEach((e=>{if(e.key=""===i?"".concat(r):"".concat(i,".").concat(r),function(e){return"group"===e.type}(e)||function(e,t){return Boolean("subMenu"===e.type||void 0)}(e)){var c=He(e.items,t,a,e.key);n.push(...c.selectedKeys),(c.selectedKeys.length||e.defaultExpanded)&&o.push(e.key),o.push(...c.openedKeys)}else(function(e,t,a){if(!e.to)return!1;var i="object"==typeof e.to?e.to:(0,Ge.parsePath)(e.to),n=i.pathname.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),o=!!(0,ze.matchPath)(t,{path:n,exact:e.exact});if(!o&&Array.isArray(e.activeIncludes))for(var r of e.activeIncludes){var c,l=void 0,s=r.includes("?");if(s&&(l=(0,Ge.parsePath)(r)),(o=!!(0,ze.matchPath)(t,{path:s?l.pathname:r,exact:!0}))&&null!==(c=l)&&void 0!==c&&c.search&&(o=Ve(a,l.search)),o)break}if(o&&Array.isArray(e.activeExcludes))for(var d of e.activeExcludes)if(!(o=!(0,ze.matchPath)(t,{path:d,exact:!0})))break;return o&&e.activeMatchSearch&&(o=Ve(a,i.search)),o})(e,t,a)&&n.push(String(e.key));r+=1})),n.length&&""!==i&&o.push(i),{selectedKeys:n,openedKeys:o}}function Ve(e,t){var a=new URLSearchParams(e),i=new URLSearchParams(t);for(var[n,o]of i.entries())if(a.get(n)!==o)return!1;return!0}var Ye,Je,$e,qe,Xe,Qe,et,tt,at,it=a(8799),nt=(0,x.wrapBrick)("visual-builder.workbench-action"),{defineElement:ot,property:rt}=(0,T.createDecorators)();Je=ot("visual-builder.workbench-action-list",{styleTexts:[it.Z]}),$e=rt(),Xe=rt({attribute:!1});var ct,lt=new WeakMap,st=new WeakMap;class dt extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,lt,{writable:!0,value:(et(this),qe(this))}),(0,L.Z)(this,st,{writable:!0,value:Qe(this)})}get appId(){return(0,O.Z)(this,lt)}set appId(e){(0,Z.Z)(this,lt,e)}get menu(){return(0,O.Z)(this,st)}set menu(e){(0,Z.Z)(this,st,e)}render(){return y().createElement(pt,{appId:this.appId,menu:this.menu})}}tt=dt,({e:[qe,Qe,et],c:[at,Ye]}=(0,I.Z)(tt,[[$e,1,"appId"],[Xe,1,"menu"]],[Je],0,void 0,x.ReactNextElement)),Ye();var ht=new Map;function pt(e){var t,{appId:a,menu:i}=e,n=(0,ze.getHistory)(),[o,r]=(0,R.useState)(),[c,l]=(0,R.useState)(n.location);return(0,R.useEffect)((()=>{var e=n.listen((e=>{l(e)}));return e}),[n]),(0,R.useEffect)((()=>{ct||(ct=a),ct!==a&&(ht.clear(),ct=a)}),[a]),(0,R.useEffect)((()=>{var e,{pathname:t,search:a}=c,{selectedKeys:n}=He(null!==(e=null==i?void 0:i.menuItems)&&void 0!==e?e:[],t,a,"");r(Number(n[0]))}),[i,c]),y().createElement("div",{className:"workBenchActionList"},null==i||null===(t=i.menuItems)||void 0===t?void 0:t.map(((e,t)=>{if((e=>"default"===e.type||!e.type)(e)){var a=e.to;return o!==t&&ht.has(t)&&(a=ht.get(t)),y().createElement(nt,{key:t,icon:e.icon,to:a,href:e.href,target:e.target,active:o===t,onClick:()=>(e=>{e.href||ht.set(o,"".concat(c.pathname).concat(c.search))})(e)})}})).filter(Boolean))}var ut,Et,vt,bt,mt,gt,ft,wt,Nt,Lt,kt,Zt,Ot,It,Rt,yt,Tt,xt,Mt,At,_t,Dt,Pt,Ut,Ct,Ft,Wt,St,Bt,Kt,jt,zt,Gt,Ht,Vt,Yt,Jt,$t,qt,Xt,Qt,ea,ta,aa,ia,na,oa,ra,ca,la,sa,da,ha,pa,ua,Ea,va,ba,ma,ga,fa=a(5178),wa=a(8486),Na=a(1732),La=a(3321),ka=a(8401),Za=a(89),Oa=a(1674);function Ia(e){return e.key}a(8161);var Ra,{defineElement:ya,property:Ta,event:xa}=(0,T.createDecorators)();Et=ya("visual-builder.workbench-tree",{styleTexts:[Za.Z,Oa.Z]}),vt=Ta({attribute:!1}),mt=Ta({attribute:!1}),ft=Ta({type:Boolean}),Nt=Ta(),kt=Ta({type:Boolean}),Ot=Ta(),Rt=Ta({type:Boolean}),Tt=Ta({attribute:!1}),Mt=Ta({type:Boolean}),_t=Ta({attribute:!1}),Pt=Ta({attribute:!1}),Ct=Ta({type:Boolean}),Wt=Ta({attribute:!1}),Bt=Ta({type:Boolean}),jt=Ta({type:Boolean}),Gt=Ta({type:Boolean}),Vt=Ta({type:String}),Jt=Ta({type:Boolean}),qt=xa({type:"action.click"}),ta=xa({type:"node.click"}),oa=xa({type:"node.drop"}),sa=xa({type:"context.menu"}),ua=xa({type:"node.toggle"});var Ma=new WeakMap,Aa=new WeakMap,_a=new WeakMap,Da=new WeakMap,Pa=new WeakMap,Ua=new WeakMap,Ca=new WeakMap,Fa=new WeakMap,Wa=new WeakMap,Sa=new WeakMap,Ba=new WeakMap,Ka=new WeakMap,ja=new WeakMap,za=new WeakMap,Ga=new WeakMap,Ha=new WeakMap,Va=new WeakMap,Ya=new WeakMap,Ja=new WeakMap,$a=new WeakMap,qa=new WeakMap,Xa=new WeakMap,Qa=new WeakMap,ei=new WeakMap,ti=new WeakMap,ai=new WeakMap,ii=new WeakMap,ni=new WeakMap,oi=new WeakMap,ri=new WeakMap,ci=new WeakMap,li=new WeakMap,si=new WeakMap;class di extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,li,{get:wi,set:fi}),(0,L.Z)(this,oi,{get:gi,set:mi}),(0,L.Z)(this,ai,{get:bi,set:vi}),(0,L.Z)(this,Qa,{get:Ei,set:ui}),(0,L.Z)(this,$a,{get:pi,set:hi}),(0,L.Z)(this,Ma,{writable:!0,value:(ma(this),bt(this))}),(0,L.Z)(this,Aa,{writable:!0,value:gt(this)}),(0,L.Z)(this,_a,{writable:!0,value:wt(this)}),(0,L.Z)(this,Da,{writable:!0,value:Lt(this)}),(0,L.Z)(this,Pa,{writable:!0,value:Zt(this)}),(0,L.Z)(this,Ua,{writable:!0,value:It(this)}),(0,L.Z)(this,Ca,{writable:!0,value:yt(this)}),(0,L.Z)(this,Fa,{writable:!0,value:xt(this)}),(0,L.Z)(this,Wa,{writable:!0,value:At(this)}),(0,L.Z)(this,Sa,{writable:!0,value:Dt(this)}),(0,L.Z)(this,Ba,{writable:!0,value:Ut(this)}),(0,L.Z)(this,Ka,{writable:!0,value:Ft(this)}),(0,L.Z)(this,ja,{writable:!0,value:St(this)}),(0,L.Z)(this,za,{writable:!0,value:Kt(this)}),(0,L.Z)(this,Ga,{writable:!0,value:zt(this)}),(0,L.Z)(this,Ha,{writable:!0,value:Ht(this)}),(0,L.Z)(this,Va,{writable:!0,value:Yt(this)}),(0,L.Z)(this,Ya,{writable:!0,value:$t(this)}),(0,L.Z)(this,Ja,{writable:!0,value:Xt(this)}),(0,L.Z)(this,qa,{writable:!0,value:e=>{(0,O.Z)(this,$a).emit(e)}}),(0,L.Z)(this,Xa,{writable:!0,value:aa(this)}),(0,L.Z)(this,ei,{writable:!0,value:e=>()=>{(0,O.Z)(this,Qa).emit(e.data)}}),(0,L.Z)(this,ti,{writable:!0,value:ra(this)}),(0,L.Z)(this,ii,{writable:!0,value:e=>{(0,O.Z)(this,ai).emit(e)}}),(0,L.Z)(this,ni,{writable:!0,value:da(this)}),(0,L.Z)(this,ri,{writable:!0,value:e=>t=>{t.preventDefault(),(0,O.Z)(this,oi).emit({active:!0,node:null==e?void 0:e.data,x:t.clientX,y:t.clientY})}}),(0,L.Z)(this,ci,{writable:!0,value:Ea(this)}),(0,L.Z)(this,si,{writable:!0,value:(e,t)=>{(0,O.Z)(this,li).emit({nodeId:e,collapsed:t})}})}get nodes(){return(0,O.Z)(this,Ma)}set nodes(e){(0,Z.Z)(this,Ma,e)}get actions(){return(0,O.Z)(this,Aa)}set actions(e){(0,Z.Z)(this,Aa,e)}get actionsHidden(){return(0,O.Z)(this,_a)}set actionsHidden(e){(0,Z.Z)(this,_a,e)}get placeholder(){return(0,O.Z)(this,Da)}set placeholder(e){(0,Z.Z)(this,Da,e)}get isTransformName(){return(0,O.Z)(this,Pa)}set isTransformName(e){(0,Z.Z)(this,Pa,e)}get searchPlaceholder(){return(0,O.Z)(this,Ua)}set searchPlaceholder(e){(0,Z.Z)(this,Ua,e)}get noSearch(){return(0,O.Z)(this,Ca)}set noSearch(e){(0,Z.Z)(this,Ca,e)}get activeKey(){return(0,O.Z)(this,Fa)}set activeKey(e){(0,Z.Z)(this,Fa,e)}get showMatchedNodeOnly(){return(0,O.Z)(this,Wa)}set showMatchedNodeOnly(e){(0,Z.Z)(this,Wa,e)}get matchNodeDataFields(){return(0,O.Z)(this,Sa)}set matchNodeDataFields(e){(0,Z.Z)(this,Sa,e)}get fixedActionsFor(){return(0,O.Z)(this,Ba)}set fixedActionsFor(e){(0,Z.Z)(this,Ba,e)}get collapsible(){return(0,O.Z)(this,Ka)}set collapsible(e){(0,Z.Z)(this,Ka,e)}get collapsedNodes(){return(0,O.Z)(this,ja)}set collapsedNodes(e){(0,Z.Z)(this,ja,e)}get allowDrag(){return(0,O.Z)(this,za)}set allowDrag(e){(0,Z.Z)(this,za,e)}get allowDragToRoot(){return(0,O.Z)(this,Ga)}set allowDragToRoot(e){(0,Z.Z)(this,Ga,e)}get allowDragToInside(){return(0,O.Z)(this,Ha)}set allowDragToInside(e){(0,Z.Z)(this,Ha,e)}get nodeKey(){return(0,O.Z)(this,Va)}set nodeKey(e){(0,Z.Z)(this,Va,e)}get skipNotify(){return(0,O.Z)(this,Ya)}set skipNotify(e){(0,Z.Z)(this,Ya,e)}render(){return y().createElement(wa.L.Provider,{value:{actions:this.actions,actionsHidden:this.actionsHidden,onActionClick:(0,O.Z)(this,qa)}},y().createElement(La.f.Provider,{value:{activeKey:this.activeKey,basePaddingLeft:5,showMatchedNodeOnly:this.showMatchedNodeOnly,isTransformName:this.isTransformName,fixedActionsFor:this.fixedActionsFor,nodeKey:this.nodeKey,collapsible:this.collapsible,collapsedNodes:this.collapsedNodes,getCollapsedId:Ia,onNodeToggle:(0,O.Z)(this,si),skipNotify:this.skipNotify,clickFactory:(0,O.Z)(this,ei),contextMenuFactory:(0,O.Z)(this,ri),matchNode:(e,t)=>{var a;return(0,ka.$)(e.name,t)||!(null===(a=this.matchNodeDataFields)||void 0===a||!a.length)&&(0,ka.$)("*"===this.matchNodeDataFields?e.data:(0,fa.pick)(e.data,this.matchNodeDataFields),t)}}},y().createElement(Na.ME,{nodes:this.nodes,placeholder:this.placeholder,searchPlaceholder:this.searchPlaceholder,noSearch:this.noSearch,dropEmit:(0,O.Z)(this,ii),allowDrag:this.allowDrag,allowDragToInside:this.allowDragToInside,allowDragToRoot:this.allowDragToRoot})))}}function hi(e){ea(this,e)}function pi(){return Qt(this)}function ui(e){na(this,e)}function Ei(){return ia(this)}function vi(e){la(this,e)}function bi(){return ca(this)}function mi(e){pa(this,e)}function gi(){return ha(this)}function fi(e){ba(this,e)}function wi(){return va(this)}ga=di,({e:[bt,gt,wt,Lt,Zt,It,yt,xt,At,Dt,Ut,Ft,St,Kt,zt,Ht,Yt,$t,Xt,Qt,ea,aa,ia,na,ra,ca,la,da,ha,pa,Ea,va,ba,ma],c:[Ra,ut]}=(0,I.Z)(ga,[[vt,1,"nodes"],[mt,1,"actions"],[ft,1,"actionsHidden"],[Nt,1,"placeholder"],[kt,1,"isTransformName"],[Ot,1,"searchPlaceholder"],[Rt,1,"noSearch"],[Tt,1,"activeKey"],[Mt,1,"showMatchedNodeOnly"],[_t,1,"matchNodeDataFields"],[Pt,1,"fixedActionsFor"],[Ct,1,"collapsible"],[Wt,1,"collapsedNodes"],[Bt,1,"allowDrag"],[jt,1,"allowDragToRoot"],[Gt,1,"allowDragToInside"],[Vt,1,"nodeKey"],[Jt,1,"skipNotify"],[qt,1,"actionClickEvent",e=>(0,O.Z)(e,Ja),(e,t)=>(0,Z.Z)(e,Ja,t)],[ta,1,"nodeClickEvent",e=>(0,O.Z)(e,Xa),(e,t)=>(0,Z.Z)(e,Xa,t)],[oa,1,"nodeDropEvent",e=>(0,O.Z)(e,ti),(e,t)=>(0,Z.Z)(e,ti,t)],[sa,1,"nodeContextMenuEvent",e=>(0,O.Z)(e,ni),(e,t)=>(0,Z.Z)(e,ni,t)],[ua,1,"nodeToggleEvent",e=>(0,O.Z)(e,ci),(e,t)=>(0,Z.Z)(e,ci,t)]],[Et],0,(e=>si.has((0,k.Z)(e))),x.ReactNextElement)),ut();var Ni=a(6107),Li=a(206);a(894),customElements.define("visual-builder.inject-preview-agent",(0,Ni.createProviderClass)((function(e,t){return(0,Li.Z)(e,t)})));var ki,Zi,Oi,Ii,Ri,yi,Ti,xi,Mi,Ai,_i,Di,Pi,Ui,Ci,Fi,Wi=a(3028),Si=a(8874),Bi=a.n(Si),Ki=a(6094),ji=a(7088),zi=function(e){return e.LOAD_MORE="LOAD_MORE",e.LOADING="LOADING",e.NO_DATA="NO_DATA",e.NODE="NODE",e.ADD="ADD",e.EDIT="EDIT",e.DELETE="DELETE",e.IMPORT="IMPORT",e.CLONE="CLONE",e.APPEND_RELATION="APPEND_RELATION",e.UPDATE_RELATION="UPDATE_RELATION",e.REMOVE_RELATION="REMOVE_RELATION",e.ROLLBACK="ROLLBACK",e.ADD_FULL="ADD_FULL",e.EDIT_FULL="EDIT_FULL",e.DELETE_FULL="DELETE_FULL",e.IMPORT_FULL="IMPORT_FULL",e.CLONE_FULL="CLONE_FULL",e.APPEND_RELATION_FULL="APPEND_RELATION_FULL",e.UPDATE_RELATION_FULL="UPDATE_RELATION_FULL",e.REMOVE_RELATION_FULL="REMOVE_RELATION_FULL",e.ROLLBACK_FULL="ROLLBACK_FULL",e.PROJECT="PROJECT",e.USER="USER",e.PERMISSION="PERMISSION",e.BRICK="BRICK",e.ROUTE="ROUTE",e.TEMPLATE="TEMPLATE",e.SNIPPET="SNIPPET",e.I18N="I18N",e.IMAGE="IMAGE",e.FUNCTION="FUNCTION",e.MENU="MENU",e.MENU_ITEM="MENU_ITEM",e.WORKFLOW="WORKFLOW",e}({}),Gi="bricks/visual-builder/workbench-history-action",Hi=a(4795),Vi=a(5121),Yi=function(){var e=(0,Hi.Z)((function*(e,t,a){return(yield Vi.http.get("api/gateway/next_builder.workspace.GetChangeHistory/api/v1/next-builder/workspace/".concat(e,"/changes"),(0,Wi.Z)((0,Wi.Z)({},a),{},{params:t}))).data}));return function(t,a,i){return e.apply(this,arguments)}}(),Ji=a(860),$i={add:"".concat(Gi,":").concat(zi.ADD),edit:"".concat(Gi,":").concat(zi.EDIT),delete:"".concat(Gi,":").concat(zi.DELETE),batch_delete:"".concat(Gi,":").concat(zi.DELETE),import:"".concat(Gi,":").concat(zi.IMPORT),clone:"".concat(Gi,":").concat(zi.CLONE),append_relation:"".concat(Gi,":").concat(zi.APPEND_RELATION),update_relation:"".concat(Gi,":").concat(zi.UPDATE_RELATION),remove_relation:"".concat(Gi,":").concat(zi.REMOVE_RELATION),rollback:"".concat(Gi,":").concat(zi.ROLLBACK)},qi={add:"".concat(Gi,":").concat(zi.ADD_FULL),edit:"".concat(Gi,":").concat(zi.EDIT_FULL),delete:"".concat(Gi,":").concat(zi.DELETE_FULL),batch_delete:"".concat(Gi,":").concat(zi.DELETE_FULL),import:"".concat(Gi,":").concat(zi.IMPORT_FULL),clone:"".concat(Gi,":").concat(zi.CLONE_FULL),append_relation:"".concat(Gi,":").concat(zi.APPEND_RELATION_FULL),update_relation:"".concat(Gi,":").concat(zi.UPDATE_RELATION_FULL),remove_relation:"".concat(Gi,":").concat(zi.REMOVE_RELATION_FULL),rollback:"".concat(Gi,":").concat(zi.ROLLBACK_FULL)},Xi={project:"".concat(Gi,":").concat(zi.PROJECT),userGroup:"".concat(Gi,":").concat(zi.USER),permission:"".concat(Gi,":").concat(zi.PERMISSION),brick:"".concat(Gi,":").concat(zi.BRICK),route:"".concat(Gi,":").concat(zi.ROUTE),template:"".concat(Gi,":").concat(zi.TEMPLATE),snippet:"".concat(Gi,":").concat(zi.SNIPPET),i18n:"".concat(Gi,":").concat(zi.I18N),image:"".concat(Gi,":").concat(zi.IMAGE),function:"".concat(Gi,":").concat(zi.FUNCTION),menu:"".concat(Gi,":").concat(zi.MENU),menuItem:"".concat(Gi,":").concat(zi.MENU_ITEM),workflow:"".concat(Gi,":").concat(zi.WORKFLOW)},Qi={PROJECT_MICRO_APP:"".concat(Gi,":").concat(zi.PROJECT),"MICRO_APP_USER_GROUP@EASYOPS":"".concat(Gi,":").concat(zi.USER),MICRO_APP_RESOURCE_PERMISSION:"".concat(Gi,":").concat(zi.PERMISSION),STORYBOARD_BRICK:"".concat(Gi,":").concat(zi.BRICK),STORYBOARD_ROUTE:"".concat(Gi,":").concat(zi.ROUTE),STORYBOARD_TEMPLATE:"".concat(Gi,":").concat(zi.TEMPLATE),STORYBOARD_SNIPPET:"".concat(Gi,":").concat(zi.SNIPPET),STORYBOARD_I18N:"".concat(Gi,":").concat(zi.I18N),MICRO_APP_RESOURCE_IMAGE:"".concat(Gi,":").concat(zi.IMAGE),STORYBOARD_FUNCTION:"".concat(Gi,":").concat(zi.FUNCTION),MICRO_APP_RESOURCE_MENU:"".concat(Gi,":").concat(zi.MENU),MICRO_APP_RESOURCE_MENU_ITEM:"".concat(Gi,":").concat(zi.MENU_ITEM),"WORKFLOW_DEF@EASYOPS":"".concat(Gi,":").concat(zi.WORKFLOW)};function en(e){var t,a,i,n,o,r,c,l,s,d,h,p,u,E,v,b,m,g=Ji.i18n.t(null!==(t=Xi[e.category])&&void 0!==t?t:e.category),f=Ji.i18n.t(null!==(a=$i[e.action])&&void 0!==a?a:e.action),w=Ji.i18n.t(null!==(i=Qi[null===(n=e.abstract)||void 0===n?void 0:n.leftObjectId])&&void 0!==i?i:null===(o=e.abstract)||void 0===o?void 0:o.leftObjectId),N=Ji.i18n.t(null!==(r=Qi[null===(c=e.abstract)||void 0===c?void 0:c.rightObjectId])&&void 0!==r?r:null===(l=e.abstract)||void 0===l?void 0:l.rightObjectId),L=tn(null===(s=e.abstract)||void 0===s?void 0:s.nodes,null===(d=e.abstract)||void 0===d?void 0:d.nodesCount),k=tn(null===(h=e.abstract)||void 0===h?void 0:h.leftNodes,null===(p=e.abstract)||void 0===p?void 0:p.leftNodesCount),Z=tn(null===(u=e.abstract)||void 0===u?void 0:u.rightNodes,null===(E=e.abstract)||void 0===E?void 0:E.rightNodesCount),O="rollback"===e.action&&e.rollBackIdInfo?en(e.rollBackIdInfo).abstract:null;return{category:g,action:f,leftObjectId:w,rightObjectId:N,nodes:L,leftNodes:k,rightNodes:Z,abstract:Ji.i18n.t(null!==(v=qi[e.action])&&void 0!==v?v:e.action,{category:g,nodes:L,leftNodes:k,rightNodes:Z,nodeChanges:null===(b=e.abstract)||void 0===b||null===(b=b.nodeChanges)||void 0===b?void 0:b.join(", "),relationChanges:null===(m=e.abstract)||void 0===m||null===(m=m.relationChanges)||void 0===m?void 0:m.join(", "),leftObjectId:w,rightObjectId:N,rollbackAbstract:O}),rollbackAbstract:O}}function tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:", ";return Ji.i18n.t("".concat(Gi,":").concat(zi.NODE),{nodes:e.join(a),context:t>e.length?"ellipsis":void 0,count:t})}(0,ji.initializeReactI18n)(Gi,{en:{LOAD_MORE:"Load more",LOADING:"Loading",NO_DATA:"No data",NODE:"{{ nodes }}",NODE_ellipsis:"{{ nodes }} etc., a total of {{ count }} items",ADD:"Add node",EDIT:"Edit node",DELETE:"Delete node",IMPORT:"Batch import node",CLONE:"Clone node",APPEND_RELATION:"Append Relation",UPDATE_RELATION:"Update Relation",REMOVE_RELATION:"Remove Relation",ROLLBACK:"Rollback",ADD_FULL:"Add {{ category }} ({{ nodes }})",EDIT_FULL:"Edit {{ nodeChanges }} of {{ category }} ({{ nodes }})",DELETE_FULL:"Delete {{ category }} ({{ nodes }})",IMPORT_FULL:"Batch Import {{ category }} ({{ nodes }})",CLONE_FULL:"Clone {{ category }} ({{ nodes }})",APPEND_RELATION_FULL:"Append the relation between {{ leftObjectId }} ({{ leftNodes }}) and {{ rightObjectId }} ({{ rightNodes }})",UPDATE_RELATION_FULL:"Update the relation between {{ leftObjectId }} ({{ leftNodes }}) and {{ rightObjectId }} ({{ rightNodes }})",REMOVE_RELATION_FULL:"Remove the relation between {{ leftObjectId }} ({{ leftNodes }}) and {{ rightObjectId }} ({{ rightNodes }})",ROLLBACK_FULL:"Rollback to [{{ rollbackAbstract }}]",PROJECT:"Project",USER:"User Group",PERMISSION:"Permission",BRICK:"Brick",ROUTE:"Route",TEMPLATE:"Template",SNIPPET:"Snippet",I18N:"I18N",IMAGE:"Image",FUNCTION:"Function",MENU:"Menu",MENU_ITEM:"Menu item",WORKFLOW:"Workflow"},zh:{LOAD_MORE:"加载更多",LOADING:"加载中",NO_DATA:"没有数据",NODE:"{{ nodes }}",NODE_ellipsis:"{{ nodes }}等共{{ count }}项",ADD:"新增节点",EDIT:"编辑节点",DELETE:"删除节点",IMPORT:"批量导入节点",CLONE:"克隆节点",APPEND_RELATION:"添加关系",UPDATE_RELATION:"更新关系",REMOVE_RELATION:"移除关系",ROLLBACK:"回滚",ADD_FULL:"新增{{ category }}（{{ nodes }}）",EDIT_FULL:"编辑{{ category }}（{{ nodes }}）的 {{ nodeChanges }}",DELETE_FULL:"删除{{ category }}（{{ nodes }}）",IMPORT_FULL:"批量导入{{ category }}（{{ nodes }}）",CLONE_FULL:"克隆{{ category }}（{{ nodes }}）",APPEND_RELATION_FULL:"添加{{ leftObjectId }}（{{ leftNodes }}）和{{ rightObjectId }}（{{ rightNodes }}）的关系",UPDATE_RELATION_FULL:"更新{{ leftObjectId }}（{{ leftNodes }}）和{{ rightObjectId }}（{{ rightNodes }}）的关系",REMOVE_RELATION_FULL:"移除{{ leftObjectId }}（{{ leftNodes }}）和{{ rightObjectId }}（{{ rightNodes }}）的关系",ROLLBACK_FULL:"回滚到【{{ rollbackAbstract }}】",PROJECT:"项目",USER:"用户组",PERMISSION:"权限点",BRICK:"构件",ROUTE:"路由",TEMPLATE:"模版",SNIPPET:"片段",I18N:"国际化",IMAGE:"图片",FUNCTION:"函数",MENU:"菜单",MENU_ITEM:"菜单项",WORKFLOW:"工作流"}});var an,{defineElement:nn,property:on,event:rn}=(0,T.createDecorators)(),cn=(0,x.wrapBrick)("eo-button"),ln=(0,x.wrapBrick)("eo-link"),sn=(0,x.wrapBrick)("eo-icon"),dn=(0,x.wrapBrick)("eo-easyops-avatar"),hn=(0,x.wrapBrick)("eo-popover",{onVisibleChange:"visible.change",beforeVisibleChange:"before.visible.change"});Zi=nn("visual-builder.workbench-history-action",{styleTexts:[Ki.Z]}),Oi=on(),Ri=on(),Ti=rn({type:"history.item.click"}),_i=rn({type:"rollback"});var pn=new WeakMap,un=new WeakMap,En=new WeakMap,vn=new WeakMap,bn=new WeakMap,mn=new WeakMap,gn=new WeakMap,fn=new WeakMap;class wn extends x.ReactNextElement{constructor(){super(...arguments),(0,L.Z)(this,gn,{get:Zn,set:kn}),(0,L.Z)(this,vn,{get:Ln,set:Nn}),(0,L.Z)(this,pn,{writable:!0,value:(Ci(this),Ii(this))}),(0,L.Z)(this,un,{writable:!0,value:yi(this)}),(0,L.Z)(this,En,{writable:!0,value:xi(this)}),(0,L.Z)(this,bn,{writable:!0,value:e=>{(0,O.Z)(this,vn).emit(e)}}),(0,L.Z)(this,mn,{writable:!0,value:Di(this)}),(0,L.Z)(this,fn,{writable:!0,value:e=>{(0,O.Z)(this,gn).emit(e)}})}get appId(){return(0,O.Z)(this,pn)}set appId(e){(0,Z.Z)(this,pn,e)}get projectId(){return(0,O.Z)(this,un)}set projectId(e){(0,Z.Z)(this,un,e)}render(){return y().createElement(On,{appId:this.appId,projectId:this.projectId,onHistoryItemClick:(0,O.Z)(this,bn),onRollback:(0,O.Z)(this,fn)})}}function Nn(e){Ai(this,e)}function Ln(){return Mi(this)}function kn(e){Ui(this,e)}function Zn(){return Pi(this)}function On(e){var{appId:t,projectId:a,onHistoryItemClick:i,onRollback:n}=e,{t:o}=(0,ji.useTranslation)(Gi),[r,c]=(0,R.useState)(!1),[l,s]=(0,R.useState)(!0),[d,h]=(0,R.useState)([]),p=(0,R.useRef)(""),u=e=>{c(!0),Yi(t,{ts:p.current,limit:20}).then((t=>{h((a=>{var i=t.list.map((e=>(0,Wi.Z)((0,Wi.Z)({},e),{},{translation:en(e)})));return e?i:a.concat(i)})),p.current=t.ts,s(t.list.length<20)})).catch((e=>{(0,ze.handleHttpError)(e)})).finally((()=>{c(!1)}))};return y().createElement(hn,{placement:"bottom",trigger:"click",arrow:!0,arrowColor:"var(--color-fill-bg-container-4)",beforeVisibleChange:e=>{e.detail&&(s(!0),h([]),p.current="",u(!0))}},y().createElement(cn,{slot:"anchor",shape:"circle",className:"history-action",icon:{lib:"antd",icon:"history",theme:"outlined"}}),y().createElement("div",null,y().createElement("div",{className:"history-title"},"History"),y().createElement("div",{className:"history-list"},d.length?d.map(((e,t)=>y().createElement(In,{key:"".concat(e.uniqueKey,"-").concat(e.ts),data:e,enableRollback:0!==t&&"rollback"!==e.action,current:0===t,onHistoryItemClick:i,onRollback:n}))):y().createElement("div",{className:"empty"},o(r?zi.LOADING:zi.NO_DATA)),!l&&y().createElement("span",{className:"load-more-container"},y().createElement(ln,{className:"load-more",disabled:r,onClick:e=>u()},o(zi.LOAD_MORE)))),y().createElement("slot",null)))}function In(e){var{data:t,enableRollback:a,current:i,onHistoryItemClick:n,onRollback:o}=e,r=Bi()(Number(t.ts)/1e6),c=Bi().duration(r.diff(Bi()())),l=c.days()<=-1?r.format("YYYY-MM-DD HH:mm:ss"):c.humanize(!0,{ss:0,s:60,m:60,h:24});return y().createElement("div",{className:"item-container"},y().createElement("div",{className:"item-title"},y().createElement("div",{className:"title-left",onClick:e=>n((0,Wi.Z)((0,Wi.Z)({},t),{},{enableRollback:a}))},y().createElement("div",{className:"topic",title:t.translation.abstract},t.translation.abstract),i&&y().createElement("div",{className:"branch"},"(current)")),y().createElement("div",{className:"title-right"},a&&y().createElement(sn,{className:"rollback",lib:"antd",icon:"rollback",theme:"outlined",onClick:e=>o(t)}))),y().createElement("div",{className:"item-info"},y().createElement(dn,{className:"avatar",nameOrInstanceId:t.user,size:"xs"}),y().createElement("div",{className:"time"},l),y().createElement("div",{className:"operator"},t.user)))}Fi=wn,({e:[Ii,yi,xi,Mi,Ai,Di,Pi,Ui,Ci],c:[an,ki]}=(0,I.Z)(Fi,[[Oi,1,"appId"],[Ri,1,"projectId"],[Ti,1,"historyItemClickEvent",e=>(0,O.Z)(e,En),(e,t)=>(0,Z.Z)(e,En,t)],[_i,1,"rollbackEvent",e=>(0,O.Z)(e,mn),(e,t)=>(0,Z.Z)(e,mn,t)]],[Zi],0,(e=>fn.has((0,k.Z)(e))),x.ReactNextElement)),ki()},8453:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,".custom-scrollbar-container{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,0.15) rgba(255,255,255,0.03)}.custom-scrollbar-container::-webkit-scrollbar{width:8px;height:8px;background-color:transparent;position:absolute}.custom-scrollbar-container::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,0);border-radius:4px}.custom-scrollbar-container:hover::-webkit-scrollbar-track{background-color:rgba(255,255,255,0.03)}.custom-scrollbar-container:hover::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,0.15)}",""]);const c=r.toString()},8799:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,'.workBenchActionList{display:flex;flex-direction:column;width:-webkit-min-content;width:-moz-min-content;width:min-content;height:100%;background-color:#4297ff}:host-context(html[data-theme="dark-v2"]) .workBenchActionList,\n:host-context([data-override-theme="dark-v2"]) .workBenchActionList{background-color:#323237}',""]);const c=r.toString()},7310:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,'.action::part(link){display:flex;justify-content:center;align-items:center;width:48px;height:48px;font-size:24px;color:rgba(255,255,255,0.4);position:relative;transition:none}.action.active::part(link)::before{content:"";position:absolute;top:0;bottom:0;left:0;width:2px;background-color:white}.action.active::part(link),\n.action::part(link):hover{color:white}',""]);const c=r.toString()},6094:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,":host{display:inline-block}:host([hidden]){display:none}eo-popover::part(popup){width:400px;padding:10px;background:var(--color-fill-bg-container-4);border-radius:var(--medius-border-radius);box-shadow:var(--feedback-container-shadow);z-index:1000}.history-title{font-size:var(--title-font-size);font-weight:var(--font-weight-500);color:var(--color-strong-text);margin-bottom:5px}.history-list{max-height:500px;overflow-y:auto}.item-container{padding:10px 0;display:flex;flex-direction:column;gap:5px}.empty{padding:5px 0 10px 0;font-size:14px;color:var(--text-color-secondary);text-align:center}.item-container:not(:last-of-type){border-bottom:1px solid var(--color-border-divider-line)}.item-title{display:flex;align-items:center;justify-content:space-between;gap:5px}.title-left,\n.title-right{display:flex;align-items:center}.title-left{cursor:pointer;overflow:hidden;gap:5px}.topic{font-size:14px;color:var(--text-color-title);font-weight:var(--font-weight-500);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.branch{font-size:14px;color:var(--text-color-secondary)}.rollback{margin-right:5px;font-size:14px;color:var(--text-color-secondary);cursor:pointer}.rollback:hover{color:var(--color-brand)}.item-info{display:flex;align-items:center;gap:5px}.time,\n.operator{font-size:14px;color:var(--text-color-secondary)}.load-more-container{display:block;text-align:center}",""]);const c=r.toString()},8249:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,':host{display:block;--pane-color:#595959}:host-context(html[data-theme="dark-v2"]),\n:host-context([data-override-theme="dark-v2"]){--pane-color:#ccc}:host([hidden]){display:none}*,\n*::before,\n*::after{box-sizing:border-box}.pane{display:flex;flex-direction:column;color:var(--pane-color);height:100%}.pane-header{display:flex;align-items:center;cursor:pointer;border-top:1px solid transparent;position:relative}.pane-header:focus{outline-width:1px;outline-style:solid;outline-offset:-1px;outline-color:#007fd4}:host(:not(:first-child)) .pane-header{border-top-color:rgba(204,204,204,0.2)}.pane-scroll-shadow{display:none;position:absolute;bottom:-3px;left:0;right:0;height:3px;box-shadow:#000000 0 6px 6px -6px inset;z-index:1}.scrolled .pane-scroll-shadow{display:block}.pane-title{display:flex;align-items:center;font-size:13px;line-height:24px;height:25px;min-width:0;flex:1}.title-icon{display:flex;justify-content:center;align-items:center;width:24px;padding-right:2px;line-height:1;flex-shrink:0}.title-label{text-transform:uppercase;font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.pane-body{flex-grow:1;min-height:0;display:none;overflow:hidden;overflow-y:auto;overflow-y:overlay}:host([active]) .pane-body{display:initial}:host(:not(:hover)) ::slotted([slot="actions"]){display:none}.badge{background-color:rgb(77,77,77);color:rgb(255,255,255);border-radius:11px;height:18px;padding:3px 6px;line-height:13px;margin:0 3px;font-size:12px}',""]);const c=r.toString()},3571:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9601),n=a.n(i),o=a(2609),r=a.n(o)()(n());r.push([e.id,':host{--sidebar-background:#fff;--title-container-background:#fff;--title-container-color:#595959;display:block;outline-color:rgba(83,89,93,0.5);background-color:var(--sidebar-background);height:100%}:host-context(html[data-theme="dark-v2"]),\n:host-context([data-override-theme="dark-v2"]){--sidebar-background:#181818;--title-container-background:#181818;--title-container-color:rgb(187,187,187);background-color:var(--sidebar-background)}:host([hidden]){display:none}*,\n*::before,\n*::after{box-sizing:border-box}.sidebar{display:flex;flex-direction:column;height:100%}.title-container{display:flex;padding:0 8px 8px 8px;color:var(--title-container-color);background:var(--title-container-background)}.title-label{font-weight:300;line-height:44px;padding-left:12px;text-transform:uppercase;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.pane-container{flex-grow:1;min-height:0;display:flex;flex-direction:column}::slotted([slot="panes"]){transition:flex 0.2s;min-height:25px}',""]);const c=r.toString()}}]);
//# sourceMappingURL=4231.41067a78.js.map