"use strict";(globalThis.webpackChunk_next_bricks_visual_builder=globalThis.webpackChunk_next_bricks_visual_builder||[]).push([[1040],{9123:(e,t,n)=>{n.d(t,{F:()=>s,L:()=>c});var o=n(1030);let i=!1;const a="item:";let l=null;function s(e){if(i===e)return;i=e;const t=e?"addEventListener":"removeEventListener";window[t]("click",r,!0),window[t]("mousedown",d,!0),window[t]("mouseover",d,!0),window[t]("mouseup",d,!0),window[t]("pointerdown",d,!0),window[t]("pointerover",d,!0),window[t]("pointerup",d,!0),window[t]("pointerleave",w,!0),window[t]("pointermove",u,!0)}function c(e){const t=function(e,t){const n=[];return function t(o){const i=o.querySelectorAll(`[data-iid="${e}"]`);if(n.push(...i),!(o===document&&i.length>0))for(const e of o.querySelectorAll("*"))e.shadowRoot&&t(e.shadowRoot)}(document),n}(`${e.type}:${e.uuid}`);window.parent.postMessage({channel:"chat-preview",type:"inspect-active",payload:{outlines:t.map((t=>f({...e,element:t,label:g(t)})))}},location.origin)}function r(e){e.preventDefault(),e.stopPropagation(),function(e){const t=h(e.composedPath());window.parent.postMessage({channel:"chat-preview",type:"inspect-active",payload:{outlines:t.map(f)}},location.origin)}(e)}function d(e){e.preventDefault(),e.stopPropagation()}const p=(0,o.debounce)(((e,t,n)=>{let o=h(e);if(0===o.length)for(const i of e)if(i instanceof HTMLElement&&i.shadowRoot){o=h(i.shadowRoot.elementsFromPoint(t,n));break}const i=o.length>0?o[0].element:null;i!==l&&(l=i,window.parent.postMessage({channel:"chat-preview",type:"inspect-hover",payload:{outlines:o.map(f)}},location.origin))}),20,{leading:!0});function u(e){p(e.composedPath(),e.clientX,e.clientY)}function w(e){e.preventDefault(),e.stopPropagation(),l=null,window.parent.postMessage({channel:"chat-preview",type:"inspect-hover",payload:{outlines:[]}},location.origin)}function h(e){const t=[];return e.forEach((e=>{let n;if(e.nodeType===Node.ELEMENT_NODE&&e instanceof HTMLElement&&(n=e.dataset.iid)&&n.startsWith(a)){const o=n.substring(a.length);t.push({type:"item",uuid:o,label:g(e),element:e})}})),t}function f(e){const{element:t,type:n,uuid:o,label:i}=e,{width:a,height:l,left:s,top:c}=t.getBoundingClientRect();return{width:a,height:l,left:s+window.scrollX,top:c+window.scrollY,type:n,uuid:o,label:i}}function g(e){return e.tagName.toLowerCase().split(".").pop()}},4839:(e,t,n)=>{n.r(t),n.d(t,{injectChatPreviewAgent:()=>l});var o=n(3078),i=n(9123);let a=!1;async function l(){a||(a=!0,n.e(2201).then(n.bind(n,2201)),s({type:"initialized"}),window.addEventListener("message",(e=>{var t;if("chat-preview"===(null===(t=e.data)||void 0===t?void 0:t.channel))switch(e.data.type){case"toggle-inspecting":(0,i.F)(e.data.payload.inspecting);break;case"select":(0,i.L)(e.data.payload)}})),window.addEventListener("scroll",(()=>{s({type:"scroll",payload:{x:window.scrollX,y:window.scrollY}})})))}function s(e){window.parent.postMessage({channel:"chat-preview",...e},location.origin)}customElements.define("visual-builder.inject-chat-preview-agent",(0,o.createProviderClass)(l))}}]);
//# sourceMappingURL=inject-chat-preview-agent.b147f181.js.map