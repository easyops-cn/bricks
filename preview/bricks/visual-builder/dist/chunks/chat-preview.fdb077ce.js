/*! For license information please see chat-preview.fdb077ce.js.LICENSE.txt */
(globalThis.webpackChunk_next_bricks_visual_builder=globalThis.webpackChunk_next_bricks_visual_builder||[]).push([[5402,2052],{9047:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var r=n(8769),i=n.n(r);function o(e){let{variant:t,width:n,height:r,left:o,top:a,label:s}=e;return i().createElement("div",{className:"outline "+t,style:{width:n+8,height:r+8,left:o-4,top:a-4}},i().createElement("div",{className:"label"},s))}},44:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ChatPreview:()=>D,ChatPreviewComponent:()=>Y});var r,i=n(9575),o=n(4635),a=n(918),s=n(6902),c=n(5536),u=n(6121),l=n(829),p=n(2740),d=n(8769),h=n.n(d),f=n(300),v=n(4295),g=(n(6477),n(5223)),b=n(1732),y=n(3373),m=n.n(y),w=n(9047),A=n(1563);let k,x,E,S,_,j,T,O,P,C,M,W,z,V,B,N;const{defineElement:R,property:I,event:L,method:$}=(0,f.createDecorators)();let D;var q=new WeakMap,H=new WeakMap,J=new WeakMap,U=new WeakMap,F=new WeakMap,G=new WeakMap,K=new WeakSet,Q=new WeakMap;class X extends v.ReactNextElement{constructor(){super(...arguments),(0,o.A)(this,K),(0,a.A)(this,q,(k(this),E(this))),(0,a.A)(this,H,(S(this),_(this))),(0,a.A)(this,J,(j(this),T(this))),(0,a.A)(this,U,(O(this),P(this))),(0,a.A)(this,F,(C(this),M(this))),(0,a.A)(this,G,(W(this),z(this))),(0,a.A)(this,Q,(N(this),e=>{(0,c.A)(K,this,V).emit(e)}))}get storyboard(){return(0,l.A)(q,this)}set storyboard(e){(0,u.A)(q,this,e)}get theme(){return(0,l.A)(H,this)}set theme(e){(0,u.A)(H,this,e)}get uiVersion(){return(0,l.A)(J,this)}set uiVersion(e){(0,u.A)(J,this,e)}get app(){return(0,l.A)(U,this)}set app(e){(0,u.A)(U,this,e)}get inspecting(){return(0,l.A)(F,this)}set inspecting(e){(0,u.A)(F,this,e)}select(e){var t;const n=null===(t=this.shadowRoot)||void 0===t||null===(t=t.querySelector("iframe"))||void 0===t?void 0:t.contentWindow;null==n||n.postMessage({channel:"chat-preview",type:"select",payload:e},location.origin)}render(){return h().createElement(Y,{storyboard:this.storyboard,theme:this.theme,uiVersion:this.uiVersion,app:this.app,inspecting:this.inspecting,onActiveTargetChange:(0,l.A)(Q,this)})}}function Y(e){let{storyboard:t,theme:n,uiVersion:r,app:o,inspecting:a,onActiveTargetChange:s}=e;const c=(0,d.useRef)(),[u,l]=(0,d.useState)(!1),[p,f]=(0,d.useState)(!1),[v,y]=(0,d.useState)({x:0,y:0}),[A,k]=(0,d.useState)([]),[x,E]=(0,d.useState)([]),[S,_]=(0,d.useState)([]),[j,T]=(0,d.useState)([]),O=(0,d.useCallback)((()=>{const e=()=>{var t;const n=null===(t=c.current)||void 0===t?void 0:t.contentWindow;null!=n&&n._preview_only_render?l(!0):setTimeout(e,100)};e()}),[]);(0,d.useEffect)((()=>{var e;if(!u)return;const t=g.__secret_internals.getBrickPackagesById("bricks/visual-builder");if(!t)throw new Error("Cannot find preview agent package: bricks/visual-builder");(null===(e=c.current)||void 0===e||null===(e=e.contentWindow)||void 0===e?void 0:e._preview_only_inject)("visual-builder.inject-chat-preview-agent",{...t,filePath:`${location.origin}${(0,g.getBasePath)()}${window.PUBLIC_ROOT??""}${t.filePath}`})}),[u]),(0,d.useEffect)((()=>{var e;if(!u)return;const i=null===(e=c.current)||void 0===e||null===(e=e.contentWindow)||void 0===e?void 0:e._preview_only_render;i&&i("yaml",{yaml:(0,b.safeDump)(t,{schema:b.JSON_SCHEMA,skipInvalid:!0,noRefs:!0,noCompatMode:!0})},{app:o,theme:n,uiVersion:r})}),[o,u,t,n,r]);const P=(0,d.useMemo)((()=>{if(p)return()=>{setTimeout((()=>{window.postMessage({channel:"chat-preview",type:"inspect-hover",payload:{outlines:[]}})}),100)}}),[p]);(0,d.useEffect)((()=>{const e=e=>{var t;if("chat-preview"===(null===(t=e.data)||void 0===t?void 0:t.channel))switch(e.data.type){case"initialized":f(!0);break;case"inspect-hover":k(e.data.payload.outlines);break;case"scroll":y(e.data.payload);break;case"inspect-active":E(e.data.payload.outlines)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,d.useEffect)((()=>{var e;p&&(null===(e=c.current)||void 0===e||null===(e=e.contentWindow)||void 0===e||e.postMessage({channel:"chat-preview",type:"toggle-inspecting",payload:{inspecting:a}},location.origin))}),[p,a]);const C=(0,d.useCallback)((e=>e.map((e=>{var t,n;const r=(null==c||null===(t=c.current)||void 0===t?void 0:t.offsetLeft)??0,i=(null==c||null===(n=c.current)||void 0===n?void 0:n.offsetTop)??0,{width:o,height:a,left:s,top:u,...l}=e;return{width:1*o,height:1*a,left:1*(s-v.x)+r,top:1*(u-v.y)+i,...l}}))),[v.x,v.y]);return(0,d.useEffect)((()=>{s(x[0])}),[x,s]),(0,d.useEffect)((()=>{T(C(x))}),[x,C]),(0,d.useEffect)((()=>{_(C(A))}),[A,C]),h().createElement("div",{className:m()("container",{inspecting:a})},h().createElement("iframe",{ref:c,src:`${(0,g.getBasePath)()}_brick-preview-v3_/preview/`,loading:"lazy",onLoad:O,onMouseOut:P}),S.map(((e,t)=>h().createElement(w.e,(0,i.A)({key:t,variant:"hover"},e)))),j.map(((e,t)=>h().createElement(w.e,(0,i.A)({key:t,variant:"active"},e)))))}r=X,({e:[E,S,_,j,T,O,P,C,M,W,z,V,B,N,k],c:[D,x]}=(0,p.A)(r,[R("visual-builder.chat-preview",{styleTexts:[A.A]})],[[I({attribute:!1}),1,"storyboard"],[I(),1,"theme"],[I(),1,"uiVersion"],[I(),1,"app"],[I({type:Boolean}),1,"inspecting"],[L({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,l.A)(G,e),(e,t)=>(0,u.A)(G,e,t)],[$(),2,"select"]],0,(e=>Q.has((0,s.A)(e))),v.ReactNextElement)),x()},1563:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(6758),i=n.n(r),o=n(935),a=n.n(o)()(i());a.push([e.id,":host{display:block}:host([hidden]){display:none}*{box-sizing:border-box}.container,\niframe{width:100%;height:100%;border-radius:4px}.container{position:relative;box-shadow:rgba(204,204,204,0.2) 0px 0px 0px 1px}iframe{display:block;border:none;margin:0;padding:0;transform-origin:0% 0%;-webkit-user-select:none;user-select:none}.outline{position:absolute;border-style:solid;border-width:2px;border-radius:0 4px 4px;pointer-events:none}.label{position:absolute;left:-2px;top:-20px;height:18px;line-height:16px;padding:2px 5px 0;font-size:12px;border-radius:4px 4px 0 0;white-space:nowrap}.outline.hover{border-color:rgba(var(--palette-blue-6-channel),0.3)}.outline.hover .label{background:rgba(var(--palette-blue-6-channel),0.3)}.outline.active{border-color:var(--palette-blue-6)}.outline.active .label{background:var(--palette-blue-6)}.container:not(.inspecting) .outline{display:none}",""]);const s=a.toString()},935:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&a[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},6758:e=>{"use strict";e.exports=function(e){return e[1]}},3373:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=a(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=a(t,n));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},2740:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(7545),i=n(6902);function o(e,t,n){"symbol"==(0,r.A)(t)&&(t=(t=t.description)?"["+t+"]":"");try{Object.defineProperty(e,"name",{configurable:!0,value:n?n+" "+t:t})}catch(e){}return e}var a=n(1369);function s(e,t,n,s,c,u){var l,p,d,h,f,v,g,b=Symbol.metadata||Symbol.for("Symbol.metadata"),y=Object.defineProperty,m=Object.create,w=[m(null),m(null)],A=t.length;function k(t,n,r){return function(i,o){n&&(o=i,i=e);for(var a=0;a<t.length;a++)o=t[a].apply(i,r?[o]:[]);return r?o:i}}function x(e,t,n,r){if("function"!=typeof e&&(r||void 0!==e))throw new TypeError(t+" must "+(n||"be")+" a function"+(r?"":" or undefined"));return e}function E(e,t,n,i,a,s,c,u,d,h,f){function v(e){if(!f(e))throw new TypeError("Attempted to access private element on non-instance")}var g=[].concat(t[0]),b=t[3],m=!c,A=1===a,E=3===a,S=4===a,_=2===a;function j(t,n,r){return function(i,o){return n&&(o=i,i=e),r&&r(i),T[t].call(i,o)}}if(!m){var T={},O=[],P=E?"get":S||A?"set":"value";if(d?(h||A?T={get:o((function(){return b(this)}),i,"get"),set:function(e){t[4](this,e)}}:T[P]=b,h||o(T[P],i,_?"":P)):h||(T=Object.getOwnPropertyDescriptor(e,i)),!h&&!d){if((p=w[+u][i])&&7!=(p^a))throw Error("Decorating two elements with the same name ("+T[P].name+") is not supported yet");w[+u][i]=a<3?1:a}}for(var C=e,M=g.length-1;M>=0;M-=n?2:1){var W=x(g[M],"A decorator","be",!0),z=n?g[M-1]:void 0,V={},B={kind:["field","accessor","method","getter","setter","class"][a],name:i,metadata:l,addInitializer:function(e,t){if(e.v)throw Error("attempted to call addInitializer after decoration was finished");x(t,"An initializer","be",!0),s.push(t)}.bind(null,V)};if(m)p=W.call(z,C,B),V.v=1,x(p,"class decorators","return")&&(C=p);else if(B.static=u,B.private=d,p=B.access={has:d?f.bind():function(e){return i in e}},S||(p.get=d?_?function(e){return v(e),T.value}:j("get",0,v):function(e){return e[i]}),_||E||(p.set=d?j("set",0,v):function(e,t){e[i]=t}),C=W.call(z,A?{get:T.get,set:T.set}:T[P],B),V.v=1,A){if("object"==(0,r.A)(C)&&C)(p=x(C.get,"accessor.get"))&&(T.get=p),(p=x(C.set,"accessor.set"))&&(T.set=p),(p=x(C.init,"accessor.init"))&&O.unshift(p);else if(void 0!==C)throw new TypeError("accessor decorators must return an object with get, set, or init properties or undefined")}else x(C,(h?"field":"method")+" decorators","return")&&(h?O.unshift(C):T[P]=C)}return a<2&&c.push(k(O,u,1),k(s,u,0)),h||m||(d?A?c.splice(-1,0,j("get",u),j("set",u)):c.push(_?T[P]:x.call.bind(T[P])):y(e,i,T)),C}function S(e){return y(e,b,{configurable:!0,enumerable:!0,value:l})}return void 0!==u&&(l=u[b]),l=m(null==l?null:l),f=[],v=function(e){e&&f.push(k(e))},g=function(t,r){for(var o=0;o<n.length;o++){var s=n[o],u=s[1],l=7&u;if((8&u)==t&&!l==r){var p=s[2],v=!!s[3],g=16&u;E(t?e:e.prototype,s,g,v?"#"+p:(0,a.A)(p),l,l<2?[]:t?h=h||[]:d=d||[],f,!!t,v,r,t&&v?function(t){return(0,i.A)(t)===e}:c)}}},g(8,0),g(0,0),g(8,1),g(0,1),v(d),v(h),p=f,A||S(e),{e:p,get c(){var n=[];return A&&[S(e=E(e,[t],s,e.name,5,n)),k(n,1)]}}}},2559:(e,t,n)=>{"use strict";function r(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}n.d(t,{A:()=>r})},6902:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(7545);function i(e){if(Object(e)!==e)throw TypeError("right-hand side of 'in' should be an object, got "+(null!==e?(0,r.A)(e):"null"));return e}},2016:(e,t,n)=>{"use strict";function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}n.d(t,{A:()=>r})},829:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2559);function i(e,t){return e.get((0,r.A)(e,t))}},918:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2016);function i(e,t,n){(0,r.A)(e,t),t.set(e,n)}},6121:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2559);function i(e,t,n){return e.set((0,r.A)(e,t),n),n}},5536:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2559);function i(e,t,n){return n((0,r.A)(e,t))}},4635:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2016);function i(e,t){(0,r.A)(e,t),t.add(e)}},9575:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{A:()=>r})},1369:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(7545);function i(e){var t=function(e,t){if("object"!=(0,r.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=(0,r.A)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==(0,r.A)(t)?t:t+""}},7545:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})}}]);
//# sourceMappingURL=chat-preview.fdb077ce.js.map