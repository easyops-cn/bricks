{"version":3,"file":"chunks/eo-diagram.93f17e33.js","mappings":"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","sources":["webpack:///./src/diagram/index.tsx","webpack:///../../node_modules/@babel/runtime/helpers/esm/assertClassBrand.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/checkPrivateRedeclaration.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/typeof.js"],"sourcesContent":["import React, {\n  createRef,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { EventEmitter, createDecorators } from \"@next-core/element\";\nimport { ReactNextElement } from \"@next-core/react-element\";\nimport \"@next-core/theme\";\nimport { select } from \"d3-selection\";\nimport { ZoomTransform, zoom } from \"d3-zoom\";\nimport classNames from \"classnames\";\nimport { uniqueId } from \"lodash\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport type {\n  DiagramEdge,\n  DiagramNode,\n  LayoutOptions,\n  LineConf,\n  NodeBrickConf,\n  PositionTuple,\n  RefRepository,\n  RenderedLineLabel,\n  TransformLiteral,\n  LineTarget,\n  ConnectLineDetail,\n  ConnectNodesOptions,\n  ConnectLineState,\n  ActiveTarget,\n  RangeTuple,\n  LineLabel,\n  LineLabelConf,\n  TextOptions,\n  DragNodesOptions,\n  NodeMovement,\n  ManualLayoutStatus,\n  LineMaskRects,\n} from \"./interfaces\";\nimport { NodeComponentGroup } from \"./NodeComponent\";\nimport { handleKeyboard } from \"./processors/handleKeyboard\";\nimport { transformToCenter } from \"./processors/transformToCenter\";\nimport { getRenderedLines } from \"./processors/getRenderedLines\";\nimport { normalizeLinesAndMarkers } from \"./processors/normalizeLinesAndMarkers\";\nimport { LineLabelComponentGroup } from \"./LineLabelComponent\";\nimport { LineComponent } from \"./LineComponent\";\nimport { MarkerComponent } from \"./MarkerComponent\";\nimport { LineMaskComponent } from \"./LineMaskComponent\";\nimport { ConnectLineComponent } from \"./ConnectLineComponent\";\nimport { getRenderedLineLabels } from \"./processors/getRenderedLineLabels\";\nimport { handleNodesMouseDown } from \"./processors/handleNodesMouseDown\";\nimport { DEFAULT_SCALE_RANGE_MAX, DEFAULT_SCALE_RANGE_MIN } from \"./constants\";\nimport { useRenderedDiagram } from \"./hooks/useRenderedDiagram\";\nimport { adjustLineLabels } from \"./processors/adjustLineLabels\";\nimport styleText from \"./styles.shadow.css\";\nimport { useUserView } from \"./hooks/useUserView\";\nimport { sameTarget } from \"./processors/sameTarget\";\nimport { getLineMaskRects } from \"./processors/getLineMaskRects\";\n\nconst { defineElement, property, event, method } = createDecorators();\n\nexport interface EoDiagramProps {\n  layout?: \"dagre\" | \"force\";\n  nodes?: DiagramNode[];\n  edges?: DiagramEdge[];\n  nodeBricks?: NodeBrickConf[];\n  lines?: LineConf[];\n  layoutOptions?: LayoutOptions;\n  connectNodes?: ConnectNodesOptions;\n  dragNodes?: DragNodesOptions;\n  activeTarget?: ActiveTarget | null;\n  disableKeyboardAction?: boolean;\n  zoomable?: boolean;\n  scrollable?: boolean;\n  pannable?: boolean;\n  scaleRange?: RangeTuple;\n}\n\nexport interface DiagramRef {\n  callOnLineLabel(id: string, method: string, ...args: unknown[]): void;\n}\n\nexport const EoDiagramComponent = forwardRef(LegacyEoDiagramComponent);\n\n/**\n * 构件 `eo-diagram`\n */\nexport\n@defineElement(\"eo-diagram\", {\n  styleTexts: [styleText],\n})\nclass EoDiagram extends ReactNextElement implements EoDiagramProps {\n  /**\n   * @required\n   */\n  @property({ type: String })\n  accessor layout: \"dagre\" | \"force\" | undefined;\n\n  @property({ attribute: false })\n  accessor nodes: DiagramNode[] | undefined;\n\n  @property({ attribute: false })\n  accessor edges: DiagramEdge[] | undefined;\n\n  @property({ attribute: false })\n  accessor nodeBricks: NodeBrickConf[] | undefined;\n\n  @property({ attribute: false })\n  accessor lines: LineConf[] | undefined;\n\n  @property({ attribute: false })\n  accessor layoutOptions: LayoutOptions | undefined;\n\n  @property({ attribute: false })\n  accessor activeTarget: ActiveTarget | null | undefined;\n\n  @property({ type: Boolean })\n  accessor disableKeyboardAction: boolean | undefined;\n\n  @property({ attribute: false })\n  accessor connectNodes: ConnectNodesOptions | undefined;\n\n  @property({ attribute: false })\n  accessor dragNodes: DragNodesOptions | undefined;\n\n  @property({ type: Boolean })\n  accessor zoomable: boolean | undefined = true;\n\n  @property({ type: Boolean })\n  accessor scrollable: boolean | undefined = true;\n\n  @property({ type: Boolean })\n  accessor pannable: boolean | undefined = true;\n\n  @property({ attribute: false })\n  accessor scaleRange: RangeTuple | undefined;\n\n  @event({ type: \"activeTarget.change\" })\n  accessor #activeTargetChangeEvent!: EventEmitter<ActiveTarget | null>;\n\n  #handleActiveTargetChange = (target: ActiveTarget | null) => {\n    this.#activeTargetChangeEvent.emit(target);\n  };\n\n  @event({ type: \"node.delete\" })\n  accessor #nodeDelete!: EventEmitter<DiagramNode>;\n\n  #handleNodeDelete = (node: DiagramNode) => {\n    this.#nodeDelete.emit(node);\n  };\n\n  @event({ type: \"edge.delete\" })\n  accessor #edgeDelete!: EventEmitter<DiagramEdge>;\n\n  #handleEdgeDelete = (edge: DiagramEdge) => {\n    this.#edgeDelete.emit(edge);\n  };\n\n  @event({ type: \"line.click\" })\n  accessor #lineClick!: EventEmitter<LineTarget>;\n\n  #handleLineClick = (line: LineTarget) => {\n    this.#lineClick.emit(line);\n  };\n\n  @event({ type: \"line.dblclick\" })\n  accessor #lineDoubleClick!: EventEmitter<LineTarget>;\n\n  #handleLineDoubleClick = (line: LineTarget) => {\n    this.#lineDoubleClick.emit(line);\n  };\n\n  @event({ type: \"nodes.connect\" })\n  accessor #connectNodes!: EventEmitter<ConnectLineDetail>;\n\n  #handleNodesConnect = (detail: ConnectLineDetail) => {\n    this.#connectNodes.emit(detail);\n  };\n\n  #handleSwitchActiveTarget = (target: ActiveTarget | null) => {\n    if (!sameTarget(target, this.activeTarget)) {\n      this.activeTarget = target;\n    }\n  };\n\n  #diagramRef = createRef<DiagramRef>();\n\n  @method()\n  callOnLineLabel(id: string, method: string, ...args: unknown[]) {\n    this.#diagramRef.current?.callOnLineLabel(id, method, ...args);\n  }\n\n  render() {\n    return (\n      <EoDiagramComponent\n        ref={this.#diagramRef}\n        layout={this.layout}\n        nodes={this.nodes}\n        edges={this.edges}\n        nodeBricks={this.nodeBricks}\n        lines={this.lines}\n        layoutOptions={this.layoutOptions}\n        connectNodes={this.connectNodes}\n        dragNodes={this.dragNodes}\n        activeTarget={this.activeTarget}\n        disableKeyboardAction={this.disableKeyboardAction}\n        zoomable={this.zoomable}\n        scrollable={this.scrollable}\n        pannable={this.pannable}\n        scaleRange={this.scaleRange}\n        onActiveTargetChange={this.#handleActiveTargetChange}\n        onSwitchActiveTarget={this.#handleSwitchActiveTarget}\n        onNodeDelete={this.#handleNodeDelete}\n        onEdgeDelete={this.#handleEdgeDelete}\n        onLineClick={this.#handleLineClick}\n        onLineDoubleClick={this.#handleLineDoubleClick}\n        onNodesConnect={this.#handleNodesConnect}\n      />\n    );\n  }\n}\n\nexport interface EoDiagramComponentProps extends EoDiagramProps {\n  onActiveTargetChange?(target: ActiveTarget | null): void;\n  onSwitchActiveTarget?(target: ActiveTarget | null): void;\n  onNodeDelete?(node: DiagramNode): void;\n  onEdgeDelete?(edge: DiagramEdge): void;\n  onLineClick?(line: LineTarget): void;\n  onLineDoubleClick?(line: LineTarget): void;\n  onNodesConnect?(detail: ConnectLineDetail): void;\n}\n\nexport function LegacyEoDiagramComponent(\n  {\n    layout,\n    nodes,\n    edges,\n    nodeBricks,\n    lines,\n    layoutOptions,\n    connectNodes,\n    dragNodes,\n    activeTarget: _activeTarget,\n    disableKeyboardAction,\n    zoomable,\n    scrollable,\n    pannable,\n    scaleRange: _scaleRange,\n    onActiveTargetChange,\n    onSwitchActiveTarget,\n    onNodeDelete,\n    onEdgeDelete,\n    onLineClick,\n    onLineDoubleClick,\n    onNodesConnect,\n  }: EoDiagramComponentProps,\n  ref: React.Ref<DiagramRef>\n) {\n  const [nodesReady, setNodesReady] = useState(false);\n  const [nodesRenderId, setNodesRenderId] = useState(0);\n  const [nodesRefRepository, setNodesRefRepository] =\n    useState<RefRepository | null>(null);\n  const [lineLabelsReady, setLineLabelsReady] = useState(false);\n  const [lineLabelsRenderId, setLineLabelsRenderId] = useState(0);\n  const [lineLabelsRefRepository, setLineLabelsRefRepository] =\n    useState<RefRepository | null>(null);\n  const [renderedLineLabels, setRenderedLineLabels] = useState<\n    RenderedLineLabel[]\n  >([]);\n\n  const [grabbing, setGrabbing] = useState(false);\n  const [transform, setTransform] = useState<TransformLiteral>({\n    k: 1,\n    x: 0,\n    y: 0,\n  });\n\n  const linePathsRef = useRef(new Map<string, SVGPathElement | null>());\n\n  const rootRef = useRef<HTMLDivElement>(null);\n  const nodesRef = useRef<HTMLDivElement>(null);\n  const [centered, setCentered] = useState(false);\n\n  const { userViewReady, userViewNodesMap, saveUserView } = useUserView(\n    dragNodes?.save\n  );\n\n  const [connectLineTo, setConnectLineTo] = useState<PositionTuple>([0, 0]);\n  const [connectLineState, setConnectLineState] =\n    useState<ConnectLineState | null>(null);\n  const [manualLayoutStatus, setManualLayoutStatus] =\n    useState<ManualLayoutStatus>(\"initial\");\n  const [nodeMovement, setNodeMovement] = useState<NodeMovement | null>(null);\n\n  useImperativeHandle(ref, () => ({\n    callOnLineLabel(id, method, ...args) {\n      (\n        lineLabelsRefRepository?.get(id)\n          ?.firstElementChild as unknown as Record<string, Function>\n      )?.[method](...args);\n    },\n  }));\n\n  useEffect(() => {\n    const onNodesMouseDown = (event: MouseEvent) => {\n      handleNodesMouseDown(event, {\n        nodes,\n        nodesRefRepository,\n        connectNodes,\n        dragNodes,\n        scale: transform.k,\n        setConnectLineState,\n        setConnectLineTo,\n        setManualLayoutStatus,\n        setNodeMovement,\n        onSwitchActiveTarget,\n        onNodesConnect,\n      });\n    };\n    // Bind mousedown event manually, since the React event handler can't work with\n    // d3-zoom inside shadow DOM.\n    const nodesContainer = nodesRef.current;\n    nodesContainer?.addEventListener(\"mousedown\", onNodesMouseDown);\n    return () => {\n      nodesContainer?.removeEventListener(\"mousedown\", onNodesMouseDown);\n    };\n  }, [\n    nodes,\n    connectNodes,\n    dragNodes,\n    transform.k,\n    nodesRefRepository,\n    onNodesConnect,\n    onSwitchActiveTarget,\n  ]);\n\n  const { normalizedLines, normalizedLinesMap, markers } = useMemo(\n    () => normalizeLinesAndMarkers(edges, lines),\n    [edges, lines]\n  );\n\n  const lineLabels = useMemo(() => {\n    return normalizedLines.flatMap(({ line: { text, label, $id }, edge }) => {\n      if (!text && !label) {\n        return [] as LineLabel[];\n      }\n\n      let key: \"label\" | \"text\";\n      let list: LineLabelConf[] | TextOptions[];\n      if (label) {\n        key = \"label\";\n        list = ([] as LineLabelConf[]).concat(label);\n      } else {\n        key = \"text\";\n        list = ([] as TextOptions[]).concat(text!);\n      }\n\n      return list.map<LineLabel>((item) => ({\n        [key as \"label\"]: item as LineLabelConf,\n        id: `${$id}-${item.placement ?? \"center\"}`,\n        edge,\n      }));\n    });\n  }, [normalizedLines]);\n\n  const { nodes: renderedNodes, edges: renderedEdges } = useRenderedDiagram({\n    layout,\n    nodes,\n    edges,\n    manualLayoutStatus,\n    userViewReady,\n    userViewNodesMap,\n    nodeMovement,\n    nodesRefRepository,\n    lineLabelsRefRepository,\n    normalizedLinesMap,\n    layoutOptions,\n    nodesRenderId,\n    lineLabelsRenderId,\n  });\n\n  useEffect(\n    () => {\n      if (manualLayoutStatus === \"finished\") {\n        saveUserView(\n          renderedNodes.map((node) => ({\n            id: node.id,\n            x: node.x,\n            y: node.y,\n          }))\n        );\n      }\n    },\n    // Only save user view when manual layout is just finished.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [manualLayoutStatus]\n  );\n\n  const renderedLines = useMemo(\n    () => getRenderedLines(renderedEdges, renderedNodes, normalizedLines),\n    [normalizedLines, renderedNodes, renderedEdges]\n  );\n\n  const newActiveTarget = _activeTarget ?? null;\n  const [activeTarget, setActiveTarget] = useState<ActiveTarget | null>(\n    newActiveTarget\n  );\n\n  useEffect(() => {\n    setActiveTarget((previous) =>\n      sameTarget(previous, newActiveTarget) ? previous : newActiveTarget\n    );\n  }, [newActiveTarget]);\n\n  const activeTargetChangeInitialized = useRef(false);\n  useEffect(() => {\n    if (!activeTargetChangeInitialized.current) {\n      activeTargetChangeInitialized.current = true;\n      return;\n    }\n    onActiveTargetChange?.(activeTarget);\n  }, [activeTarget, onActiveTargetChange]);\n\n  useEffect(() => {\n    const root = rootRef.current;\n    if (!root || disableKeyboardAction) {\n      return;\n    }\n    const onKeydown = (event: KeyboardEvent) => {\n      const action = handleKeyboard(event, {\n        renderedNodes,\n        activeTarget,\n      });\n\n      if (action?.action === \"delete-node\") {\n        onNodeDelete?.(action.node);\n      } else if (action?.action === \"delete-edge\") {\n        onEdgeDelete?.(action.edge);\n      } else if (action?.action === \"switch-active-node\" && action.node) {\n        onSwitchActiveTarget?.({ type: \"node\", nodeId: action.node.id });\n      }\n    };\n    root.addEventListener(\"keydown\", onKeydown);\n    return () => {\n      root.removeEventListener(\"keydown\", onKeydown);\n    };\n  }, [\n    activeTarget,\n    renderedNodes,\n    disableKeyboardAction,\n    onSwitchActiveTarget,\n    onNodeDelete,\n    onEdgeDelete,\n  ]);\n\n  const handleNodesRendered = useCallback(\n    (refRepository: RefRepository | null) => {\n      if (refRepository) {\n        setNodesRenderId((previous) => previous + 1);\n        setNodesRefRepository(refRepository);\n      }\n      setNodesReady((previous) => previous || !!refRepository);\n    },\n    []\n  );\n\n  const handleLineLabelsRendered = useCallback(\n    (refRepository: RefRepository | null) => {\n      if (refRepository) {\n        setLineLabelsRenderId((previous) => previous + 1);\n        setLineLabelsRefRepository(refRepository);\n      }\n      setLineLabelsReady((previous) => previous || !!refRepository);\n    },\n    []\n  );\n\n  const scaleRange = useMemo(\n    () =>\n      _scaleRange ??\n      ([DEFAULT_SCALE_RANGE_MIN, DEFAULT_SCALE_RANGE_MAX] as RangeTuple),\n    [_scaleRange]\n  );\n\n  const zoomer = useMemo(() => zoom<HTMLDivElement, unknown>(), []);\n\n  useEffect(() => {\n    let moved = false;\n    zoomer\n      .scaleExtent(zoomable ? scaleRange : [1, 1])\n      .on(\"start\", () => {\n        moved = false;\n        setGrabbing(true);\n      })\n      .on(\"zoom\", (e: { transform: TransformLiteral }) => {\n        moved = true;\n        setTransform(e.transform);\n      })\n      .on(\"end\", () => {\n        setGrabbing(false);\n        if (!moved) {\n          onSwitchActiveTarget?.(null);\n        }\n      });\n  }, [onSwitchActiveTarget, scaleRange, zoomable, zoomer]);\n\n  useEffect(() => {\n    const root = rootRef.current;\n    if (!root) {\n      return;\n    }\n\n    const rootSelection = select(root);\n\n    const unsetZoom = () => {\n      rootSelection\n        .on(\".zoom\", null)\n        .on(\".zoom.custom\", null)\n        .on(\"wheel\", null);\n    };\n\n    if (!(zoomable || scrollable || pannable)) {\n      unsetZoom();\n      return;\n    }\n\n    if (zoomable || scrollable) {\n      // Do not override default d3 zoom handler.\n      // Only handles *panning*\n      rootSelection.on(\n        \"wheel.zoom.custom\",\n        (e: WheelEvent & { wheelDeltaX: number; wheelDeltaY: number }) => {\n          // Mac OS trackpad pinch event is emitted as a wheel.zoom and d3.event.ctrlKey set to true\n          if (!e.ctrlKey) {\n            // Stop immediate propagation for default d3 zoom handler\n            e.stopImmediatePropagation();\n            if (scrollable) {\n              e.preventDefault();\n              zoomer.translateBy(\n                rootSelection,\n                e.wheelDeltaX / 5,\n                e.wheelDeltaY / 5\n              );\n            }\n          }\n          // zoomer.scaleBy(rootSelection, Math.pow(2, defaultWheelDelta(e)))\n        }\n      );\n    }\n\n    rootSelection\n      .call(zoomer)\n      .on(\"wheel\", (e: WheelEvent) => e.preventDefault())\n      .on(\"dblclick.zoom\", null);\n\n    if (!pannable) {\n      rootSelection\n        .on(\"mousedown.zoom\", null)\n        .on(\"touchstart.zoom\", null)\n        .on(\"touchmove.zoom\", null)\n        .on(\"touchend.zoom\", null);\n    }\n\n    return unsetZoom;\n  }, [pannable, scrollable, zoomable, zoomer]);\n\n  useEffect(() => {\n    const root = rootRef.current;\n    if (renderedNodes.length === 0 || !root || centered) {\n      return;\n    }\n    const { k, x, y } = transformToCenter(renderedNodes, {\n      canvasWidth: root.clientWidth,\n      canvasHeight: root.clientHeight,\n      scaleRange: zoomable ? scaleRange : undefined,\n    });\n    zoomer.transform(select(root), new ZoomTransform(k, x, y));\n    setCentered(true);\n  }, [centered, renderedNodes, scaleRange, zoomable, zoomer]);\n\n  const defPrefix = useMemo(() => `${uniqueId(\"diagram-\")}-`, []);\n  const markerPrefix = `${defPrefix}line-arrow-`;\n  const maskPrefix = `${defPrefix}mask-`;\n  const activeLineMarkerPrefix = `${defPrefix}active-line-`;\n\n  useEffect(() => {\n    setRenderedLineLabels((previous) =>\n      getRenderedLineLabels(previous, renderedLines, linePathsRef.current)\n    );\n  }, [renderedLines]);\n\n  const [lineMaskRects, setLineMaskRects] = React.useState<LineMaskRects>(\n    new Map()\n  );\n\n  useEffect(() => {\n    if (!lineLabelsRefRepository) {\n      return;\n    }\n    const updateLineMaskRects = () => {\n      setLineMaskRects(\n        getLineMaskRects(renderedLineLabels, lineLabelsRefRepository)\n      );\n    };\n\n    adjustLineLabels(renderedLineLabels, lineLabelsRefRepository);\n\n    const observer = new ResizeObserver(updateLineMaskRects);\n    for (const lineLabel of lineLabelsRefRepository.values()) {\n      observer.observe(lineLabel);\n    }\n    return () => {\n      observer.disconnect();\n    };\n  }, [lineLabelsRenderId, lineLabelsRefRepository, renderedLineLabels]);\n\n  if (layout !== \"dagre\" && layout !== \"force\") {\n    return <div>{`Diagram layout not supported: \"${layout}\"`}</div>;\n  }\n\n  return (\n    <div\n      className={classNames(\"diagram\", {\n        ready: nodesReady && centered,\n        grabbing,\n        pannable,\n      })}\n      tabIndex={-1}\n      ref={rootRef}\n    >\n      <svg width=\"100%\" height=\"100%\" className=\"lines\">\n        <defs>\n          {markers.map(({ type, strokeColor }, index) => (\n            <MarkerComponent\n              key={index}\n              id={`${markerPrefix}${index}`}\n              type={type}\n              strokeColor={strokeColor}\n            />\n          ))}\n          {[...lineMaskRects].map(([lineId, rects]) => (\n            <LineMaskComponent\n              key={lineId}\n              lineId={lineId}\n              rects={rects}\n              maskPrefix={maskPrefix}\n              renderedLineLabels={renderedLineLabels}\n            />\n          ))}\n          <marker\n            id={`${activeLineMarkerPrefix}start`}\n            viewBox=\"0 0 8 8\"\n            refX={4}\n            refY={4}\n            markerWidth={8}\n            markerHeight={8}\n            orient=\"auto\"\n          >\n            <path\n              d=\"M 0.5 0.5 H 7.5 V 7.5 H 0.5 Z\"\n              stroke=\"var(--palette-gray-7)\"\n              strokeWidth={1}\n              fill=\"var(--palette-gray-1)\"\n            />\n          </marker>\n          <marker\n            id={`${activeLineMarkerPrefix}end`}\n            viewBox=\"0 0 14 8\"\n            refX={3}\n            refY={4}\n            markerWidth={14}\n            markerHeight={8}\n            orient=\"auto\"\n          >\n            <path\n              d=\"M 0.5 1.5 L 5.5 4 L 0.5 6.5 z\"\n              stroke=\"var(--palette-blue-3)\"\n              strokeWidth={1}\n              fill=\"var(--palette-blue-3)\"\n            />\n            <path\n              d=\"M 6.5 0.5 H 13.5 V 7.5 H 6.5 Z\"\n              stroke=\"var(--palette-gray-7)\"\n              strokeWidth={1}\n              fill=\"var(--palette-gray-1)\"\n            />\n          </marker>\n        </defs>\n        <g\n          transform={`translate(${transform.x} ${transform.y}) scale(${transform.k})`}\n        >\n          {renderedLines.map((line) => (\n            <LineComponent\n              key={line.line.$id}\n              line={line}\n              linePaths={linePathsRef.current}\n              lineMaskRects={lineMaskRects}\n              maskPrefix={maskPrefix}\n              markerPrefix={markerPrefix}\n              activeLineMarkerPrefix={activeLineMarkerPrefix}\n              active={\n                activeTarget?.type === \"edge\" &&\n                activeTarget.edge.source === line.edge.source &&\n                activeTarget.edge.target === line.edge.target\n              }\n              activeRelated={\n                activeTarget?.type === \"node\" &&\n                (line.edge.source === activeTarget.nodeId ||\n                  line.edge.target === activeTarget.nodeId)\n              }\n              onLineClick={onLineClick}\n              onLineDoubleClick={onLineDoubleClick}\n            />\n          ))}\n        </g>\n      </svg>\n      <div\n        className={classNames(\"line-labels\", { ready: lineLabelsReady })}\n        style={{\n          left: transform.x,\n          top: transform.y,\n          transform: `scale(${transform.k})`,\n        }}\n      >\n        <LineLabelComponentGroup\n          labels={lineLabels}\n          onRendered={handleLineLabelsRendered}\n        />\n      </div>\n      <div\n        className=\"nodes\"\n        ref={nodesRef}\n        style={{\n          left: transform.x,\n          top: transform.y,\n          transform: `scale(${transform.k})`,\n        }}\n      >\n        <NodeComponentGroup\n          nodes={nodes}\n          nodeBricks={nodeBricks}\n          // nodePositions={nodePositions}\n          onRendered={handleNodesRendered}\n        />\n      </div>\n      <ConnectLineComponent\n        connectLineState={connectLineState}\n        connectLineTo={connectLineTo}\n        markerPrefix={markerPrefix}\n      />\n    </div>\n  );\n}\n","export default function _assertClassBrand(e, t, n) {\n  if (\"function\" == typeof e ? e === t : e.has(t)) return arguments.length < 3 ? t : n;\n  throw new TypeError(\"Private element is not present on this object\");\n}","export default function _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}","import assertClassBrand from \"./assertClassBrand.js\";\nexport default function _classPrivateFieldGet2(s, a) {\n  return s.get(assertClassBrand(s, a));\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateFieldInitSpec(obj, privateMap, value) {\n  checkPrivateRedeclaration(obj, privateMap);\n  privateMap.set(obj, value);\n}","import assertClassBrand from \"./assertClassBrand.js\";\nexport default function _classPrivateFieldSet2(s, a, r) {\n  return s.set(assertClassBrand(s, a), r), r;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateMethodInitSpec(obj, privateSet) {\n  checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}"],"names":["defineElement","property","event","method","createDecorators","EoDiagramComponent","forwardRef","LegacyEoDiagramComponent","_EoDiagram","_A","WeakMap","_B","_C","_D","_E","_F","_G","_H","_I","_J","_K","_L","_M","_N","_O","_EoDiagram_brand","WeakSet","_handleActiveTargetChange","_P","_handleNodeDelete","_Q","_handleEdgeDelete","_R","_handleLineClick","_S","_handleLineDoubleClick","_T","_handleNodesConnect","_handleSwitchActiveTarget","_diagramRef","EoDiagram","ReactNextElement","constructor","arguments","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","_initProto","_init_layout","_init_extra_layout","_init_nodes","_init_extra_nodes","_init_edges","_init_extra_edges","_init_nodeBricks","_init_extra_nodeBricks","_init_lines","_init_extra_lines","_init_layoutOptions","_init_extra_layoutOptions","_init_activeTarget","_init_extra_activeTarget","_init_disableKeyboardAction","_init_extra_disableKeyboardAction","_init_connectNodes","_init_extra_connectNodes","_init_dragNodes","_init_extra_dragNodes","_init_zoomable","_init_extra_zoomable","_init_scrollable","_init_extra_scrollable","_init_pannable","_init_extra_pannable","_init_scaleRange","_init_extra_scaleRange","_init_activeTargetChangeEvent","_init_extra_activeTargetChangeEvent","target","_classPrivateGetter","this","_get_activeTargetChangeEvent","emit","_init_nodeDelete","_init_extra_nodeDelete","node","_get_nodeDelete","_init_edgeDelete","_init_extra_edgeDelete","edge","_get_edgeDelete","_init_lineClick","_init_extra_lineClick","line","_get_lineClick","_init_lineDoubleClick","_init_extra_lineDoubleClick","_get_lineDoubleClick","_init_connectNodes2","_init_extra_connectNodes2","detail","_get_connectNodes","sameTarget","activeTarget","createRef","layout","_classPrivateFieldGet","v","_classPrivateFieldSet","nodes","edges","nodeBricks","lines","layoutOptions","disableKeyboardAction","connectNodes","dragNodes","zoomable","scrollable","pannable","scaleRange","callOnLineLabel","id","_classPrivateFieldGet2","_len","length","args","Array","_key","current","render","React","ref","onActiveTargetChange","onSwitchActiveTarget","onNodeDelete","onEdgeDelete","onLineClick","onLineDoubleClick","onNodesConnect","_ref","_activeTarget","_scaleRange","nodesReady","setNodesReady","useState","nodesRenderId","setNodesRenderId","nodesRefRepository","setNodesRefRepository","lineLabelsReady","setLineLabelsReady","lineLabelsRenderId","setLineLabelsRenderId","lineLabelsRefRepository","setLineLabelsRefRepository","renderedLineLabels","setRenderedLineLabels","grabbing","setGrabbing","transform","setTransform","k","x","y","linePathsRef","useRef","Map","rootRef","nodesRef","centered","setCentered","userViewReady","userViewNodesMap","saveUserView","useUserView","save","connectLineTo","setConnectLineTo","connectLineState","setConnectLineState","manualLayoutStatus","setManualLayoutStatus","nodeMovement","setNodeMovement","useImperativeHandle","_lineLabelsRefReposit","_len2","_key2","get","firstElementChild","useEffect","onNodesMouseDown","handleNodesMouseDown","scale","nodesContainer","addEventListener","removeEventListener","normalizedLines","normalizedLinesMap","markers","useMemo","normalizeLinesAndMarkers","lineLabels","flatMap","_ref2","key","list","text","label","$id","concat","map","item","placement","renderedNodes","renderedEdges","useRenderedDiagram","renderedLines","getRenderedLines","newActiveTarget","setActiveTarget","previous","activeTargetChangeInitialized","root","onKeydown","action","handleKeyboard","type","nodeId","handleNodesRendered","useCallback","refRepository","handleLineLabelsRendered","DEFAULT_SCALE_RANGE_MIN","DEFAULT_SCALE_RANGE_MAX","zoomer","zoom","moved","scaleExtent","on","e","rootSelection","select","unsetZoom","ctrlKey","stopImmediatePropagation","preventDefault","translateBy","wheelDeltaX","wheelDeltaY","call","transformToCenter","canvasWidth","clientWidth","canvasHeight","clientHeight","undefined","ZoomTransform","defPrefix","uniqueId","markerPrefix","maskPrefix","activeLineMarkerPrefix","getRenderedLineLabels","lineMaskRects","setLineMaskRects","adjustLineLabels","observer","ResizeObserver","updateLineMaskRects","getLineMaskRects","lineLabel","values","observe","disconnect","className","classNames","ready","tabIndex","width","height","_ref3","index","strokeColor","MarkerComponent","_ref4","lineId","rects","LineMaskComponent","viewBox","refX","refY","markerWidth","markerHeight","orient","d","stroke","strokeWidth","fill","LineComponent","linePaths","active","source","activeRelated","style","left","top","LineLabelComponentGroup","labels","onRendered","NodeComponentGroup","ConnectLineComponent","_EoDiagram2","_set_activeTargetChangeEvent","_set_nodeDelete","_set_edgeDelete","_set_lineClick","_set_lineDoubleClick","_set_connectNodes","c","_initClass","_applyDecs","styleTexts","styleText","String","attribute","Boolean","o","_","has","_checkInRHS","_assertClassBrand","t","n","TypeError","_checkPrivateRedeclaration","obj","privateCollection","s","a","privateMap","value","set","_classPrivateFieldSet2","r","privateSet","add","toPropertyKey","i","Symbol","toPrimitive","_typeof","iterator","prototype"],"sourceRoot":""}