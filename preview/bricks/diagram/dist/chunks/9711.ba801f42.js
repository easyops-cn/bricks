"use strict";(globalThis.webpackChunk_next_bricks_diagram=globalThis.webpackChunk_next_bricks_diagram||[]).push([[9711,8939],{9711:(e,t,a)=>{var n,s=a(4635),l=a(918),i=a(6902),o=a(5536),r=a(6121),d=a(829),h=a(2740),c=a(8769),u=a.n(c),g=a(300),p=a(4295),A=(a(6477),a(7566)),m=a(9047),v=a(3373),y=a.n(v),f=a(1030),k=a(9126),b=a(8892),w=a(5157),C=a(8308),M=a(1518),E=a(9137),x=a(2547),W=a(1803),N=a(3739),S=a(9191),T=a(6671),R=a(8060),L=a(2448),z=a(8657),B=a(8069),D=a(1324),$=a(821),H=a(6753),P=a(2673),O=a(5987);let K,I,U,V,Y,X,Z,_,j,F,q,G,J,Q,ee,te,ae,ne,se,le,ie,oe,re,de,he,ce,ue,ge,pe,Ae,me,ve,ye,fe,ke,be,we,Ce,Me,Ee,xe,We,Ne,Se,Te,Re,Le,ze,Be,De,$e,He,Pe,Oe;const{defineElement:Ke,property:Ie,event:Ue,method:Ve}=(0,g.createDecorators)(),Ye=(0,c.forwardRef)(wt);let Xe;var Ze=new WeakMap,_e=new WeakMap,je=new WeakMap,Fe=new WeakMap,qe=new WeakMap,Ge=new WeakMap,Je=new WeakMap,Qe=new WeakMap,et=new WeakMap,tt=new WeakMap,at=new WeakMap,nt=new WeakMap,st=new WeakMap,lt=new WeakMap,it=new WeakMap,ot=new WeakSet,rt=new WeakMap,dt=new WeakMap,ht=new WeakMap,ct=new WeakMap,ut=new WeakMap,gt=new WeakMap,pt=new WeakMap,At=new WeakMap,mt=new WeakMap,vt=new WeakMap,yt=new WeakMap,ft=new WeakMap,kt=new WeakMap;class bt extends p.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,ot),(0,l.A)(this,Ze,(K(this),U(this))),(0,l.A)(this,_e,(V(this),Y(this))),(0,l.A)(this,je,(X(this),Z(this))),(0,l.A)(this,Fe,(_(this),j(this))),(0,l.A)(this,qe,(F(this),q(this))),(0,l.A)(this,Ge,(G(this),J(this))),(0,l.A)(this,Je,(Q(this),ee(this))),(0,l.A)(this,Qe,(te(this),ae(this))),(0,l.A)(this,et,(ne(this),se(this))),(0,l.A)(this,tt,(le(this),ie(this))),(0,l.A)(this,at,(oe(this),re(this,!0))),(0,l.A)(this,nt,(de(this),he(this,!0))),(0,l.A)(this,st,(ce(this),ue(this,!0))),(0,l.A)(this,lt,(ge(this),pe(this))),(0,l.A)(this,it,(Ae(this),me(this))),(0,l.A)(this,rt,(fe(this),e=>{(0,o.A)(ot,this,ve).emit(e)})),(0,l.A)(this,dt,ke(this)),(0,l.A)(this,ht,(Ce(this),e=>{(0,o.A)(ot,this,be).emit(e)})),(0,l.A)(this,ct,Me(this)),(0,l.A)(this,ut,(We(this),e=>{(0,o.A)(ot,this,Ee).emit(e)})),(0,l.A)(this,gt,Ne(this)),(0,l.A)(this,pt,(Re(this),e=>{(0,o.A)(ot,this,Se).emit(e)})),(0,l.A)(this,At,Le(this)),(0,l.A)(this,mt,(De(this),e=>{(0,o.A)(ot,this,ze).emit(e)})),(0,l.A)(this,vt,$e(this)),(0,l.A)(this,yt,(Oe(this),e=>{(0,o.A)(ot,this,He).emit(e)})),(0,l.A)(this,ft,(e=>{(0,P.c)(e,this.activeTarget)||(this.activeTarget=e)})),(0,l.A)(this,kt,(0,c.createRef)())}get layout(){return(0,d.A)(Ze,this)}set layout(e){(0,r.A)(Ze,this,e)}get nodes(){return(0,d.A)(_e,this)}set nodes(e){(0,r.A)(_e,this,e)}get edges(){return(0,d.A)(je,this)}set edges(e){(0,r.A)(je,this,e)}get nodeBricks(){return(0,d.A)(Fe,this)}set nodeBricks(e){(0,r.A)(Fe,this,e)}get lines(){return(0,d.A)(qe,this)}set lines(e){(0,r.A)(qe,this,e)}get layoutOptions(){return(0,d.A)(Ge,this)}set layoutOptions(e){(0,r.A)(Ge,this,e)}get activeTarget(){return(0,d.A)(Je,this)}set activeTarget(e){(0,r.A)(Je,this,e)}get disableKeyboardAction(){return(0,d.A)(Qe,this)}set disableKeyboardAction(e){(0,r.A)(Qe,this,e)}get connectNodes(){return(0,d.A)(et,this)}set connectNodes(e){(0,r.A)(et,this,e)}get dragNodes(){return(0,d.A)(tt,this)}set dragNodes(e){(0,r.A)(tt,this,e)}get zoomable(){return(0,d.A)(at,this)}set zoomable(e){(0,r.A)(at,this,e)}get scrollable(){return(0,d.A)(nt,this)}set scrollable(e){(0,r.A)(nt,this,e)}get pannable(){return(0,d.A)(st,this)}set pannable(e){(0,r.A)(st,this,e)}get scaleRange(){return(0,d.A)(lt,this)}set scaleRange(e){(0,r.A)(lt,this,e)}callOnLineLabel(e,t){for(var a,n=arguments.length,s=new Array(n>2?n-2:0),l=2;l<n;l++)s[l-2]=arguments[l];null===(a=(0,d.A)(kt,this).current)||void 0===a||a.callOnLineLabel(e,t,...s)}render(){return u().createElement(Ye,{ref:(0,d.A)(kt,this),layout:this.layout,nodes:this.nodes,edges:this.edges,nodeBricks:this.nodeBricks,lines:this.lines,layoutOptions:this.layoutOptions,connectNodes:this.connectNodes,dragNodes:this.dragNodes,activeTarget:this.activeTarget,disableKeyboardAction:this.disableKeyboardAction,zoomable:this.zoomable,scrollable:this.scrollable,pannable:this.pannable,scaleRange:this.scaleRange,onActiveTargetChange:(0,d.A)(rt,this),onSwitchActiveTarget:(0,d.A)(ft,this),onNodeDelete:(0,d.A)(ht,this),onEdgeDelete:(0,d.A)(ut,this),onLineClick:(0,d.A)(pt,this),onLineDoubleClick:(0,d.A)(mt,this),onNodesConnect:(0,d.A)(yt,this)})}}function wt(e,t){let{layout:a,nodes:n,edges:s,nodeBricks:l,lines:i,layoutOptions:o,connectNodes:r,dragNodes:d,activeTarget:h,disableKeyboardAction:g,zoomable:p,scrollable:v,pannable:$,scaleRange:K,onActiveTargetChange:I,onSwitchActiveTarget:U,onNodeDelete:V,onEdgeDelete:Y,onLineClick:X,onLineDoubleClick:Z,onNodesConnect:_}=e;const[j,F]=(0,c.useState)(!1),[q,G]=(0,c.useState)(0),[J,Q]=(0,c.useState)(null),[ee,te]=(0,c.useState)(!1),[ae,ne]=(0,c.useState)(0),[se,le]=(0,c.useState)(null),[ie,oe]=(0,c.useState)([]),[re,de]=(0,c.useState)(!1),[he,ce]=(0,c.useState)({k:1,x:0,y:0}),ue=(0,c.useRef)(new Map),ge=(0,c.useRef)(null),pe=(0,c.useRef)(null),[Ae,me]=(0,c.useState)(!1),{userViewReady:ve,userViewNodesMap:ye,saveUserView:fe}=(0,H._)(null==d?void 0:d.save),[ke,be]=(0,c.useState)([0,0]),[we,Ce]=(0,c.useState)(null),[Me,Ee]=(0,c.useState)("initial"),[xe,We]=(0,c.useState)(null);(0,c.useImperativeHandle)(t,(()=>({callOnLineLabel(e,t){for(var a,n=arguments.length,s=new Array(n>2?n-2:0),l=2;l<n;l++)s[l-2]=arguments[l];null==se||null===(a=se.get(e))||void 0===a||null===(a=a.firstElementChild)||void 0===a||a[t](...s)}}))),(0,c.useEffect)((()=>{const e=e=>{(0,L.P)(e,{nodes:n,nodesRefRepository:J,connectNodes:r,dragNodes:d,scale:he.k,setConnectLineState:Ce,setConnectLineTo:be,setManualLayoutStatus:Ee,setNodeMovement:We,onSwitchActiveTarget:U,onNodesConnect:_})},t=pe.current;return null==t||t.addEventListener("mousedown",e),()=>{null==t||t.removeEventListener("mousedown",e)}}),[n,r,d,he.k,J,_,U]);const{normalizedLines:Ne,normalizedLinesMap:Se,markers:Te}=(0,c.useMemo)((()=>(0,E.t)(s,i)),[s,i]),Re=(0,c.useMemo)((()=>Ne.flatMap((e=>{let t,a,{line:{text:n,label:s,$id:l},edge:i}=e;return n||s?(s?(t="label",a=[].concat(s)):(t="text",a=[].concat(n)),a.map((e=>({[t]:e,id:`${l}-${e.placement??"center"}`,edge:i})))):[]}))),[Ne]),{nodes:Le,edges:ze}=(0,B.o)({layout:a,nodes:n,edges:s,manualLayoutStatus:Me,userViewReady:ve,userViewNodesMap:ye,nodeMovement:xe,nodesRefRepository:J,lineLabelsRefRepository:se,normalizedLinesMap:Se,layoutOptions:o,nodesRenderId:q,lineLabelsRenderId:ae});(0,c.useEffect)((()=>{"finished"===Me&&fe(Le.map((e=>({id:e.id,x:e.x,y:e.y}))))}),[Me]);const Be=(0,c.useMemo)((()=>(0,M.R)(ze,Le,Ne)),[Ne,Le,ze]),De=h??null,[$e,He]=(0,c.useState)(De);(0,c.useEffect)((()=>{He((e=>(0,P.c)(e,De)?e:De))}),[De]);const Pe=(0,c.useRef)(!1);(0,c.useEffect)((()=>{Pe.current?null==I||I($e):Pe.current=!0}),[$e,I]),(0,c.useEffect)((()=>{const e=ge.current;if(!e||g)return;const t=e=>{const t=(0,w.a)(e,{renderedNodes:Le,activeTarget:$e});"delete-node"===(null==t?void 0:t.action)?null==V||V(t.node):"delete-edge"===(null==t?void 0:t.action)?null==Y||Y(t.edge):"switch-active-node"===(null==t?void 0:t.action)&&t.node&&(null==U||U({type:"node",nodeId:t.node.id}))};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}}),[$e,Le,g,U,V,Y]);const Oe=(0,c.useCallback)((e=>{e&&(G((e=>e+1)),Q(e)),F((t=>t||!!e))}),[]),Ke=(0,c.useCallback)((e=>{e&&(ne((e=>e+1)),le(e)),te((t=>t||!!e))}),[]),Ie=(0,c.useMemo)((()=>K??[z.sS,z.Yt]),[K]),Ue=(0,c.useMemo)((()=>(0,m.s_)()),[]);(0,c.useEffect)((()=>{let e=!1;Ue.scaleExtent(p?Ie:[1,1]).on("start",(()=>{e=!1,de(!0)})).on("zoom",(t=>{e=!0,ce(t.transform)})).on("end",(()=>{de(!1),e||null==U||U(null)}))}),[U,Ie,p,Ue]),(0,c.useEffect)((()=>{const e=ge.current;if(!e)return;const t=(0,A.A)(e),a=()=>{t.on(".zoom",null).on(".zoom.custom",null).on("wheel",null)};if(p||v||$)return(p||v)&&t.on("wheel.zoom.custom",(e=>{e.ctrlKey||(e.stopImmediatePropagation(),v&&(e.preventDefault(),Ue.translateBy(t,e.wheelDeltaX/5,e.wheelDeltaY/5)))})),t.call(Ue).on("wheel",(e=>e.preventDefault())).on("dblclick.zoom",null),$||t.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),a;a()}),[$,v,p,Ue]),(0,c.useEffect)((()=>{const e=ge.current;if(0===Le.length||!e||Ae)return;const{k:t,x:a,y:n}=(0,C.r)(Le,{canvasWidth:e.clientWidth,canvasHeight:e.clientHeight,scaleRange:p?Ie:void 0});Ue.transform((0,A.A)(e),new m.uV(t,a,n)),me(!0)}),[Ae,Le,Ie,p,Ue]);const Ve=(0,c.useMemo)((()=>`${(0,f.uniqueId)("diagram-")}-`),[]),Ye=`${Ve}line-arrow-`,Xe=`${Ve}mask-`,Ze=`${Ve}active-line-`;(0,c.useEffect)((()=>{oe((e=>(0,R.z)(e,Be,ue.current)))}),[Be]);const[_e,je]=u().useState(new Map);return(0,c.useEffect)((()=>{if(!se)return;(0,D.F)(ie,se);const e=new k.A((()=>{je((0,O.G)(ie,se))}));for(const t of se.values())e.observe(t);return()=>{e.disconnect()}}),[ae,se,ie]),"dagre"!==a&&"force"!==a?u().createElement("div",null,`Diagram layout not supported: "${a}"`):u().createElement("div",{className:y()("diagram",{ready:j&&Ae,grabbing:re,pannable:$}),tabIndex:-1,ref:ge},u().createElement("svg",{width:"100%",height:"100%",className:"lines"},u().createElement("defs",null,Te.map(((e,t)=>{let{type:a,strokeColor:n}=e;return u().createElement(N.c,{key:t,id:`${Ye}${t}`,type:a,strokeColor:n})})),[..._e].map((e=>{let[t,a]=e;return u().createElement(S.y,{key:t,lineId:t,rects:a,maskPrefix:Xe,renderedLineLabels:ie})})),u().createElement("marker",{id:`${Ze}start`,viewBox:"0 0 8 8",refX:4,refY:4,markerWidth:8,markerHeight:8,orient:"auto"},u().createElement("path",{d:"M 0.5 0.5 H 7.5 V 7.5 H 0.5 Z",stroke:"var(--palette-gray-7)",strokeWidth:1,fill:"var(--palette-gray-1)"})),u().createElement("marker",{id:`${Ze}end`,viewBox:"0 0 14 8",refX:3,refY:4,markerWidth:14,markerHeight:8,orient:"auto"},u().createElement("path",{d:"M 0.5 1.5 L 5.5 4 L 0.5 6.5 z",stroke:"var(--palette-blue-3)",strokeWidth:1,fill:"var(--palette-blue-3)"}),u().createElement("path",{d:"M 6.5 0.5 H 13.5 V 7.5 H 6.5 Z",stroke:"var(--palette-gray-7)",strokeWidth:1,fill:"var(--palette-gray-1)"}))),u().createElement("g",{transform:`translate(${he.x} ${he.y}) scale(${he.k})`},Be.map((e=>u().createElement(W.m,{key:e.line.$id,line:e,linePaths:ue.current,lineMaskRects:_e,maskPrefix:Xe,markerPrefix:Ye,activeLineMarkerPrefix:Ze,active:"edge"===(null==$e?void 0:$e.type)&&$e.edge.source===e.edge.source&&$e.edge.target===e.edge.target,activeRelated:"node"===(null==$e?void 0:$e.type)&&(e.edge.source===$e.nodeId||e.edge.target===$e.nodeId),onLineClick:X,onLineDoubleClick:Z}))))),u().createElement("div",{className:y()("line-labels",{ready:ee}),style:{left:he.x,top:he.y,transform:`scale(${he.k})`}},u().createElement(x.d2,{labels:Re,onRendered:Ke})),u().createElement("div",{className:"nodes",ref:pe,style:{left:he.x,top:he.y,transform:`scale(${he.k})`}},u().createElement(b.p,{nodes:n,nodeBricks:l,onRendered:Oe})),u().createElement(T.w,{connectLineState:we,connectLineTo:ke,markerPrefix:Ye}))}n=bt,({e:[U,V,Y,X,Z,_,j,F,q,G,J,Q,ee,te,ae,ne,se,le,ie,oe,re,de,he,ce,ue,ge,pe,Ae,me,ve,ye,fe,ke,be,we,Ce,Me,Ee,xe,We,Ne,Se,Te,Re,Le,ze,Be,De,$e,He,Pe,Oe,K],c:[Xe,I]}=(0,h.A)(n,[Ke("eo-diagram",{styleTexts:[$.A]})],[[Ie({type:String}),1,"layout"],[Ie({attribute:!1}),1,"nodes"],[Ie({attribute:!1}),1,"edges"],[Ie({attribute:!1}),1,"nodeBricks"],[Ie({attribute:!1}),1,"lines"],[Ie({attribute:!1}),1,"layoutOptions"],[Ie({attribute:!1}),1,"activeTarget"],[Ie({type:Boolean}),1,"disableKeyboardAction"],[Ie({attribute:!1}),1,"connectNodes"],[Ie({attribute:!1}),1,"dragNodes"],[Ie({type:Boolean}),1,"zoomable"],[Ie({type:Boolean}),1,"scrollable"],[Ie({type:Boolean}),1,"pannable"],[Ie({attribute:!1}),1,"scaleRange"],[Ue({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,d.A)(it,e),(e,t)=>(0,r.A)(it,e,t)],[Ue({type:"node.delete"}),1,"nodeDelete",e=>(0,d.A)(dt,e),(e,t)=>(0,r.A)(dt,e,t)],[Ue({type:"edge.delete"}),1,"edgeDelete",e=>(0,d.A)(ct,e),(e,t)=>(0,r.A)(ct,e,t)],[Ue({type:"line.click"}),1,"lineClick",e=>(0,d.A)(gt,e),(e,t)=>(0,r.A)(gt,e,t)],[Ue({type:"line.dblclick"}),1,"lineDoubleClick",e=>(0,d.A)(At,e),(e,t)=>(0,r.A)(At,e,t)],[Ue({type:"nodes.connect"}),1,"connectNodes",e=>(0,d.A)(vt,e),(e,t)=>(0,r.A)(vt,e,t)],[Ve(),2,"callOnLineLabel"]],0,(e=>kt.has((0,i.A)(e))),p.ReactNextElement)),I();var Ct,Mt=a(3971);let Et,xt,Wt,Nt,St,Tt,Rt,Lt,zt,Bt,Dt,$t,Ht,Pt;const{defineElement:Ot,property:Kt,event:It,method:Ut}=(0,g.createDecorators)(),Vt=(0,c.forwardRef)(ea);let Yt;var Xt=new WeakMap,Zt=new WeakMap,_t=new WeakMap,jt=new WeakSet,Ft=new WeakMap,qt=new WeakMap,Gt=new WeakMap,Jt=new WeakMap;class Qt extends p.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,jt),(0,l.A)(this,Xt,(Et(this),Wt(this))),(0,l.A)(this,Zt,(Nt(this),St(this))),(0,l.A)(this,_t,(Tt(this),Rt(this))),(0,l.A)(this,Ft,(Bt(this),e=>{(0,o.A)(jt,this,Lt).emit(e)})),(0,l.A)(this,qt,Dt(this)),(0,l.A)(this,Gt,(Pt(this),e=>{(0,o.A)(jt,this,$t).emit(e)})),(0,l.A)(this,Jt,(0,c.createRef)())}get label(){return(0,d.A)(Xt,this)}set label(e){(0,r.A)(Xt,this,e)}get type(){return(0,d.A)(Zt,this)}set type(e){(0,r.A)(Zt,this,e)}enableEditing(){var e;null===(e=(0,d.A)(Jt,this).current)||void 0===e||e.enableEditing()}render(){return u().createElement(Vt,{ref:(0,d.A)(Jt,this),label:this.label,onLabelEditingChange:(0,d.A)(Ft,this),onLabelChange:(0,d.A)(Gt,this)})}}function ea(e,t){let{label:a,onLabelChange:n,onLabelEditingChange:s}=e;const l=a??"",[i,o]=(0,c.useState)(l),[r,d]=(0,c.useState)(!1),h=(0,c.useRef)(!1),[g,p]=(0,c.useState)(!1),A=(0,c.useRef)(null);(0,c.useImperativeHandle)(t,(()=>({enableEditing(){d(!0)}}))),(0,c.useEffect)((()=>{o(l)}),[l]);const m=(0,c.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),d(!0)}),[]);(0,c.useEffect)((()=>{var e,t;r&&(null===(e=A.current)||void 0===e||e.focus({preventScroll:!0}),null===(t=A.current)||void 0===t||t.select())}),[r]),(0,c.useEffect)((()=>{h.current?null==s||s(r):h.current=!0}),[r,s]);const v=(0,c.useCallback)((e=>{o(e.target.value)}),[]),f=(0,c.useCallback)((e=>{const t=e.key||e.keyCode||e.which;var a;"Enter"!==t&&13!==t||null===(a=A.current)||void 0===a||a.blur()}),[]),k=(0,c.useCallback)((()=>{d(!1),p(!0)}),[]);(0,c.useEffect)((()=>{g&&(null==n||n(i),p(!1))}),[i,n,g]);const b=(0,c.useCallback)((e=>{e.stopPropagation()}),[]);return u().createElement("div",{className:y()("label",{editing:r,empty:!i}),onDoubleClick:b,onMouseDown:b},u().createElement("input",{className:"label-input",value:i,ref:A,onChange:v,onKeyDown:f,onBlur:k}),u().createElement("div",{className:"label-text",onDoubleClick:m},i))}Ct=Qt,({e:[Wt,Nt,St,Tt,Rt,Lt,zt,Bt,Dt,$t,Ht,Pt,Et],c:[Yt,xt]}=(0,h.A)(Ct,[Ot("diagram.editable-label",{styleTexts:[Mt.A]})],[[Kt(),1,"label"],[Kt({render:!1}),1,"type"],[It({type:"label.editing.change"}),1,"labelEditingChange",e=>(0,d.A)(_t,e),(e,t)=>(0,r.A)(_t,e,t)],[It({type:"label.change"}),1,"labelChange",e=>(0,d.A)(qt,e),(e,t)=>(0,r.A)(qt,e,t)],[Ut(),2,"enableEditing"]],0,(e=>Jt.has((0,i.A)(e))),p.ReactNextElement)),xt(),a(9068);var ta,aa=a(497);let na,sa,la,ia,oa,ra,da,ha,ca,ua,ga,pa,Aa,ma,va,ya,fa,ka,ba;const{defineElement:wa,property:Ca,event:Ma}=(0,g.createDecorators)();let Ea;var xa=new WeakMap,Wa=new WeakMap,Na=new WeakMap,Sa=new WeakMap,Ta=new WeakSet,Ra=new WeakMap,La=new WeakMap,za=new WeakMap,Ba=new WeakMap,Da=new WeakMap;class $a extends p.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,Ta),(0,l.A)(this,xa,sa(this)),(0,l.A)(this,Wa,(la(this),ia(this))),(0,l.A)(this,Na,(oa(this),ra(this))),(0,l.A)(this,Sa,(da(this),ha(this))),(0,l.A)(this,Ra,(ga(this),e=>{(0,o.A)(Ta,this,ca).emit(e)})),(0,l.A)(this,La,pa(this)),(0,l.A)(this,za,(va(this),e=>{(0,o.A)(Ta,this,Aa).emit(e)})),(0,l.A)(this,Ba,ya(this)),(0,l.A)(this,Da,(ba(this),e=>{(0,o.A)(Ta,this,fa).emit(e)}))}get usage(){return(0,d.A)(xa,this)}set usage(e){(0,r.A)(xa,this,e)}get status(){return(0,d.A)(Wa,this)}set status(e){(0,r.A)(Wa,this,e)}get decorator(){return(0,d.A)(Na,this)}set decorator(e){(0,r.A)(Na,this,e)}render(){return u().createElement(Ha,{usage:this.usage,onDragStart:(0,d.A)(Ra,this),onDragMove:(0,d.A)(za,this),onDragEnd:(0,d.A)(Da,this)})}}function Ha(e){let{usage:t,onDragStart:a,onDragMove:n,onDragEnd:s}=e;const l=(0,c.useCallback)((e=>{if("library"!==t)return;e.stopPropagation(),e.preventDefault();const l=[e.clientX,e.clientY];let i=!1;const o=e=>{i||(i=(e.clientX-l[0])**2+(e.clientY-l[1])**2>=9,i&&(null==a||a([e.clientX,e.clientY]))),i&&(null==n||n([e.clientX,e.clientY]))},r=e=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r),i&&(null==s||s([e.clientX,e.clientY]))};document.addEventListener("mousemove",o),document.addEventListener("mouseup",r)}),[s,n,a,t]);return u().createElement("div",{onMouseDown:l},u().createElement("slot",null))}ta=$a,({e:[sa,la,ia,oa,ra,da,ha,ca,ua,ga,pa,Aa,ma,va,ya,fa,ka,ba],c:[Ea,na]}=(0,h.A)(ta,[wa("diagram.experimental-node",{styleTexts:[aa.A]})],[[Ca(),1,"usage"],[Ca({type:String,render:!1}),1,"status"],[Ca({type:String}),1,"decorator"],[Ma({type:"drag.start"}),1,"dragStartEvent",e=>(0,d.A)(Sa,e),(e,t)=>(0,r.A)(Sa,e,t)],[Ma({type:"drag.move"}),1,"dragMoveEvent",e=>(0,d.A)(La,e),(e,t)=>(0,r.A)(La,e,t)],[Ma({type:"drag.end"}),1,"dragEndEvent",e=>(0,d.A)(Ba,e),(e,t)=>(0,r.A)(Ba,e,t)]],0,(e=>Da.has((0,i.A)(e))),p.ReactNextElement)),na();var Pa,Oa=a(8185),Ka=a(4932),Ia=a(3783),Ua=a(3033),Va=a(8091),Ya=a(1819),Xa=a(5748),Za=a(227),_a=a(531),ja=a(7099),Fa=a(1484),qa=a(8197),Ga=a(7531),Ja=a(2098),Qa=a(3012),en=a(6237);let tn,an,nn,sn,ln,on,rn,dn,hn,cn,un,gn,pn,An,mn,vn,yn,fn,kn,bn,wn,Cn,Mn,En,xn,Wn,Nn,Sn,Tn,Rn,Ln,zn,Bn,Dn,$n,Hn,Pn,On,Kn,In,Un,Vn,Yn,Xn,Zn;const{defineElement:_n,property:jn,event:Fn}=(0,g.createDecorators)();let qn;var Gn=new WeakMap,Jn=new WeakMap,Qn=new WeakMap,es=new WeakMap,ts=new WeakMap,as=new WeakMap,ns=new WeakMap,ss=new WeakMap,ls=new WeakMap,is=new WeakMap,os=new WeakMap,rs=new WeakMap,ds=new WeakMap,hs=new WeakMap,cs=new WeakMap,us=new WeakMap,gs=new WeakMap,ps=new WeakSet,As=new WeakMap,ms=new WeakMap,vs=new WeakMap,ys=new WeakMap,fs=new WeakMap,ks=new WeakMap;class bs extends p.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,ps),(0,l.A)(this,Gn,an(this)),(0,l.A)(this,Jn,(nn(this),sn(this))),(0,l.A)(this,Qn,(ln(this),on(this))),(0,l.A)(this,es,(rn(this),dn(this,[Ua.HP,Ua.HP]))),(0,l.A)(this,ts,(hn(this),cn(this))),(0,l.A)(this,as,(un(this),gn(this))),(0,l.A)(this,ns,(pn(this),An(this))),(0,l.A)(this,ss,(mn(this),vn(this))),(0,l.A)(this,ls,(yn(this),fn(this))),(0,l.A)(this,is,(kn(this),bn(this))),(0,l.A)(this,os,(wn(this),Cn(this,!0))),(0,l.A)(this,rs,(Mn(this),En(this,!0))),(0,l.A)(this,ds,(xn(this),Wn(this,!0))),(0,l.A)(this,hs,(Nn(this),Sn(this))),(0,l.A)(this,cs,(Tn(this),Rn(this))),(0,l.A)(this,us,(Ln(this),zn(this))),(0,l.A)(this,gs,(Bn(this),Dn(this))),(0,l.A)(this,As,(Pn(this),e=>{(0,o.A)(ps,this,$n).emit(e)})),(0,l.A)(this,ms,(e=>{(0,Oa.c)(e,this.activeTarget)||(this.activeTarget=e)})),(0,l.A)(this,vs,On(this)),(0,l.A)(this,ys,(Un(this),e=>{(0,o.A)(ps,this,Kn).emit(e)})),(0,l.A)(this,fs,Vn(this)),(0,l.A)(this,ks,(Zn(this),e=>{(0,o.A)(ps,this,Yn).emit(e)}))}get cells(){return(0,d.A)(Gn,this)}set cells(e){(0,r.A)(Gn,this,e)}get layout(){return(0,d.A)(Jn,this)}set layout(e){(0,r.A)(Jn,this,e)}get layoutOptions(){return(0,d.A)(Qn,this)}set layoutOptions(e){(0,r.A)(Qn,this,e)}get defaultNodeSize(){return(0,d.A)(es,this)}set defaultNodeSize(e){(0,r.A)(es,this,e)}get defaultNodeBricks(){return(0,d.A)(ts,this)}set defaultNodeBricks(e){(0,r.A)(ts,this,e)}get degradedThreshold(){return(0,d.A)(as,this)}set degradedThreshold(e){(0,r.A)(as,this,e)}get degradedNodeLabel(){return(0,d.A)(ns,this)}set degradedNodeLabel(e){(0,r.A)(ns,this,e)}get defaultEdgeLines(){return(0,d.A)(ss,this)}set defaultEdgeLines(e){(0,r.A)(ss,this,e)}get activeTarget(){return(0,d.A)(ls,this)}set activeTarget(e){(0,r.A)(ls,this,e)}get fadeUnrelatedCells(){return(0,d.A)(is,this)}set fadeUnrelatedCells(e){(0,r.A)(is,this,e)}get zoomable(){return(0,d.A)(os,this)}set zoomable(e){(0,r.A)(os,this,e)}get scrollable(){return(0,d.A)(rs,this)}set scrollable(e){(0,r.A)(rs,this,e)}get pannable(){return(0,d.A)(ds,this)}set pannable(e){(0,r.A)(ds,this,e)}get scaleRange(){return(0,d.A)(hs,this)}set scaleRange(e){(0,r.A)(hs,this,e)}get hideZoomBar(){return(0,d.A)(cs,this)}set hideZoomBar(e){(0,r.A)(cs,this,e)}get autoCenterWhenCellsChange(){return(0,d.A)(us,this)}set autoCenterWhenCellsChange(e){(0,r.A)(us,this,e)}render(){return u().createElement(ws,{shadowRoot:this.shadowRoot,cells:this.cells,layout:this.layout,layoutOptions:this.layoutOptions,defaultNodeSize:this.defaultNodeSize,defaultNodeBricks:this.defaultNodeBricks,defaultEdgeLines:this.defaultEdgeLines,degradedThreshold:this.degradedThreshold,degradedNodeLabel:this.degradedNodeLabel,activeTarget:this.activeTarget,fadeUnrelatedCells:this.fadeUnrelatedCells,zoomable:this.zoomable,scrollable:this.scrollable,pannable:this.pannable,scaleRange:this.scaleRange,hideZoomBar:this.hideZoomBar,autoCenterWhenCellsChange:this.autoCenterWhenCellsChange,onActiveTargetChange:(0,d.A)(As,this),onSwitchActiveTarget:(0,d.A)(ms,this),onCellContextMenu:(0,d.A)(ys,this),onCellClick:(0,d.A)(ks,this)})}}function ws(e){let{shadowRoot:t,cells:a,layout:n,layoutOptions:s,defaultNodeSize:l,defaultNodeBricks:i,defaultEdgeLines:o,degradedThreshold:r,degradedNodeLabel:d,activeTarget:h,fadeUnrelatedCells:g,zoomable:p,scrollable:m,pannable:v,scaleRange:k,hideZoomBar:b,autoCenterWhenCellsChange:w,onActiveTargetChange:C,onSwitchActiveTarget:M,onCellContextMenu:E,onCellClick:x}=e;const[{cells:W,layoutKey:S},T]=(0,c.useReducer)(Xa.d,a,(e=>({cells:(0,Ia.C)(e,{defaultNodeSize:l}),layoutKey:1}))),R=(0,c.useMemo)((()=>W.filter(_a.N).length>=(r??Ua.pC)),[W,r]),L=(0,c.useRef)(null),{grabbing:z,transform:B,zoomer:D,scaleRange:$}=(0,Va.f)({rootRef:L,zoomable:p,scrollable:m,pannable:v,draggable:!0,scaleRange:k,onSwitchActiveTarget:M}),{centered:H,setCentered:P,getNextLayoutKey:O}=(0,Fa.g)({layout:n,layoutOptions:s,rootRef:L,cells:W,zoomable:p,zoomer:D,scaleRange:$,layoutKey:S,autoCenterWhenCellsChange:w,dispatch:T}),K=(0,c.useCallback)((()=>{P(!1)}),[P]),I=(0,c.useRef)(a);(0,c.useEffect)((()=>{if(a!==I.current){I.current=a;const e=(0,Ja.L)({canvasWidth:t.host.clientWidth,canvasHeight:t.host.clientHeight,defaultNodeSize:l,layout:n,previousCells:W,cells:a,scaleRange:$,transform:B});T({type:"update-cells",payload:e.cells})}}),[W,l,a,n,$,t,B]);const U=(0,Ya.J)({rootRef:L,activeTarget:h,onActiveTargetChange:C}),V=`${(0,c.useMemo)((()=>`${(0,f.uniqueId)("diagram-")}-`),[])}line-arrow-`,Y=(0,c.useCallback)(((e,t)=>{T({type:"update-node-size",payload:{id:e,size:t},layoutKey:O()})}),[O]),[X,Z]=(0,c.useState)(null),_=(0,c.useCallback)((e=>{Z(e)}),[]),j=(0,c.useCallback)((e=>{Z((t=>t===e?null:t))}),[]),[F,q]=(0,c.useState)([]);(0,c.useEffect)((()=>{const e=g?(0,Za.Y)(W,null,X):[];q((t=>0===t.length&&0===e.length?t:e))}),[W,g,X]);const G=(0,c.useCallback)((e=>{D.scaleTo((0,A.A)(L.current),e/100)}),[D]),{lineConfMap:J,markers:Q}=(0,Ga.d)({cells:W,defaultEdgeLines:o,markerPrefix:V}),ee=(0,qa.H)({cells:W,layout:n,centered:H});return u().createElement(u().Fragment,null,u().createElement("svg",{width:"100%",height:"100%",ref:L,className:y()("root",{grabbing:z,pannable:v,ready:ee}),tabIndex:-1},u().createElement("defs",null,Q.map(((e,t)=>u().createElement(N.c,{key:t,id:`${V}${t}`,type:e.markerType,strokeColor:e.strokeColor})))),u().createElement("g",{transform:`translate(${B.x} ${B.y}) scale(${B.k})`},u().createElement("g",{className:"cells"},W.map((e=>u().createElement(Ka.m,{key:`${e.type}:${(0,_a.WW)(e)?`${e.source}~${e.target}`:e.id}`,layout:n,cell:e,cells:W,degraded:R,degradedNodeLabel:d,defaultNodeBricks:i,lineConfMap:J,transform:B,activeTarget:U,readOnly:!0,unrelatedCells:F,onSwitchActiveTarget:M,onCellContextMenu:E,onCellClick:x,onNodeBrickResize:Y,onCellMouseEnter:g&&(0,_a.N)(e)?_:void 0,onCellMouseLeave:g&&(0,_a.N)(e)?j:void 0})))))),!b&&u().createElement(ja.Y,{shadowRoot:t,scale:B.k,scaleRange:$,onZoomChange:G,onReCenter:K}))}Pa=bs,({e:[an,nn,sn,ln,on,rn,dn,hn,cn,un,gn,pn,An,mn,vn,yn,fn,kn,bn,wn,Cn,Mn,En,xn,Wn,Nn,Sn,Tn,Rn,Ln,zn,Bn,Dn,$n,Hn,Pn,On,Kn,In,Un,Vn,Yn,Xn,Zn],c:[qn,tn]}=(0,h.A)(Pa,[_n("eo-display-canvas",{styleTexts:[Qa.A,en.A]})],[[jn({attribute:!1}),1,"cells"],[jn({type:String}),1,"layout"],[jn({attribute:!1}),1,"layoutOptions"],[jn({attribute:!1}),1,"defaultNodeSize"],[jn({attribute:!1}),1,"defaultNodeBricks"],[jn({type:Number}),1,"degradedThreshold"],[jn({attribute:!1}),1,"degradedNodeLabel"],[jn({attribute:!1}),1,"defaultEdgeLines"],[jn({attribute:!1}),1,"activeTarget"],[jn({type:Boolean}),1,"fadeUnrelatedCells"],[jn({type:Boolean}),1,"zoomable"],[jn({type:Boolean}),1,"scrollable"],[jn({type:Boolean}),1,"pannable"],[jn({attribute:!1}),1,"scaleRange"],[jn({type:Boolean}),1,"hideZoomBar"],[jn({type:Boolean}),1,"autoCenterWhenCellsChange"],[Fn({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,d.A)(gs,e),(e,t)=>(0,r.A)(gs,e,t)],[Fn({type:"cell.contextmenu"}),1,"cellContextMenu",e=>(0,d.A)(vs,e),(e,t)=>(0,r.A)(vs,e,t)],[Fn({type:"cell.click"}),1,"cellClick",e=>(0,d.A)(fs,e),(e,t)=>(0,r.A)(fs,e,t)]],0,(e=>ks.has((0,i.A)(e))),p.ReactNextElement)),tn()},9068:(e,t,a)=>{a.d(t,{uuidV4:()=>Ia});var n,s=a(4635),l=a(918),i=a(6902),o=a(2559),r=a(5536),d=a(6121),h=a(829),c=a(2740),u=a(8769),g=a.n(u),p=a(300),A=a(4295),m=a(3078),v=(a(6477),a(1030)),y=a(3373),f=a.n(y),k=a(7566),b=a(5748),w=a(3739),C=a(531),M=a(8185),E=a(5114),x=a(4932),W=a(3639),N=a(3783),S=a(2098),T=a(227),R=a(3033),L=a(8091),z=a(1819),B=a(7099),D=a(1484),$=a(8197),H=a(7531),P=a(8875),O=a(2722),K=a(9978),I=a(2219),U=a(3012),V=a(6237),Y=a(1103),X=a(9386),Z=a(1991),_=a(2202),j=a(1825);let F,q,G,J,Q,ee,te,ae,ne,se,le,ie,oe,re,de,he,ce,ue,ge,pe,Ae,me,ve,ye,fe,ke,be,we,Ce,Me,Ee,xe,We,Ne,Se,Te,Re,Le,ze,Be,De,$e,He,Pe,Oe,Ke,Ie,Ue,Ve,Ye,Xe,Ze,_e,je,Fe,qe,Ge,Je,Qe,et,tt,at,nt,st,lt,it,ot,rt,dt,ht,ct,ut,gt,pt,At,mt,vt,yt,ft,kt,bt,wt,Ct,Mt,Et,xt,Wt,Nt,St,Tt,Rt,Lt,zt,Bt,Dt,$t;const Ht=(0,m.unwrapProvider)("basic.lock-body-scroll"),{defineElement:Pt,property:Ot,method:Kt,event:It}=(0,p.createDecorators)(),Ut=g().forwardRef(Ka);let Vt;var Yt=new WeakMap,Xt=new WeakMap,Zt=new WeakMap,_t=new WeakMap,jt=new WeakMap,Ft=new WeakMap,qt=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,Qt=new WeakMap,ea=new WeakMap,ta=new WeakMap,aa=new WeakMap,na=new WeakMap,sa=new WeakMap,la=new WeakMap,ia=new WeakMap,oa=new WeakMap,ra=new WeakMap,da=new WeakMap,ha=new WeakSet,ca=new WeakMap,ua=new WeakMap,ga=new WeakMap,pa=new WeakMap,Aa=new WeakMap,ma=new WeakMap,va=new WeakMap,ya=new WeakMap,fa=new WeakMap,ka=new WeakMap,ba=new WeakMap,wa=new WeakMap,Ca=new WeakMap,Ma=new WeakMap,Ea=new WeakMap,xa=new WeakMap,Wa=new WeakMap,Na=new WeakMap,Sa=new WeakMap,Ta=new WeakMap,Ra=new WeakMap,La=new WeakMap,za=new WeakMap,Ba=new WeakMap,Da=new WeakMap,$a=new WeakMap,Ha=new WeakMap;class Pa extends A.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,ha),(0,l.A)(this,Yt,(F(this),G(this))),(0,l.A)(this,Xt,(J(this),Q(this))),(0,l.A)(this,Zt,(ee(this),te(this))),(0,l.A)(this,_t,(ae(this),ne(this,[R.HP,R.HP]))),(0,l.A)(this,jt,(se(this),le(this))),(0,l.A)(this,Ft,(ie(this),oe(this))),(0,l.A)(this,qt,(re(this),de(this))),(0,l.A)(this,Gt,(he(this),ce(this))),(0,l.A)(this,Jt,(ue(this),ge(this))),(0,l.A)(this,Qt,(pe(this),Ae(this))),(0,l.A)(this,ea,(me(this),ve(this,!0))),(0,l.A)(this,ta,(ye(this),fe(this,!0))),(0,l.A)(this,aa,(ke(this),be(this,!0))),(0,l.A)(this,na,(we(this),Ce(this,!1))),(0,l.A)(this,sa,(Me(this),Ee(this))),(0,l.A)(this,la,(xe(this),We(this))),(0,l.A)(this,ia,(Ne(this),Se(this))),(0,l.A)(this,oa,(Te(this),Re(this))),(0,l.A)(this,ra,(Le(this),ze(this))),(0,l.A)(this,da,(Be(this),De(this))),(0,l.A)(this,ca,(Pe(this),e=>{(0,r.A)(ha,this,$e).emit(e)})),(0,l.A)(this,ua,(e=>{(0,M.c)(e,this.activeTarget)||(this.activeTarget=e)})),(0,l.A)(this,ga,Oe(this)),(0,l.A)(this,pa,(Ue(this),Ve(this))),(0,l.A)(this,Aa,(Ze(this),e=>{(0,r.A)(ha,this,Ye).emit(e),"node"===e.type&&(0,r.A)(ha,this,Ke).emit(e)})),(0,l.A)(this,ma,_e(this)),(0,l.A)(this,va,(qe(this),e=>{(0,r.A)(ha,this,je).emit(e)})),(0,l.A)(this,ya,Ge(this)),(0,l.A)(this,fa,(et(this),e=>{(0,r.A)(ha,this,Je).emit(e)})),(0,l.A)(this,ka,tt(this)),(0,l.A)(this,ba,(st(this),lt(this))),(0,l.A)(this,wa,(rt(this),e=>{(0,r.A)(ha,this,it).emit(e),"node"===e.type&&(0,r.A)(ha,this,at).emit(e)})),(0,l.A)(this,Ca,dt(this)),(0,l.A)(this,Ma,(ut(this),e=>{(0,r.A)(ha,this,ht).emit(e)})),(0,l.A)(this,Ea,gt(this)),(0,l.A)(this,xa,(mt(this),e=>{(0,r.A)(ha,this,pt).emit(e)})),(0,l.A)(this,Wa,vt(this)),(0,l.A)(this,Na,(kt(this),e=>{(0,r.A)(ha,this,yt).emit(e)})),(0,l.A)(this,Sa,bt(this)),(0,l.A)(this,Ta,(Mt(this),e=>{(0,r.A)(ha,this,wt).emit(e)})),(0,l.A)(this,Ra,Et(this)),(0,l.A)(this,La,(Nt(this),e=>{(0,r.A)(ha,this,xt).emit(e)})),(0,l.A)(this,za,St(this)),(0,l.A)(this,Ba,(Lt(this),e=>{(0,r.A)(ha,this,Tt).emit(e)})),(0,l.A)(this,Da,zt(this)),(0,l.A)(this,$a,($t(this),e=>{(0,r.A)(ha,this,Bt).emit(e)})),(0,l.A)(this,Ha,(0,u.createRef)())}get cells(){return(0,h.A)(Yt,this)}set cells(e){(0,d.A)(Yt,this,e)}get layout(){return(0,h.A)(Xt,this)}set layout(e){(0,d.A)(Xt,this,e)}get layoutOptions(){return(0,h.A)(Zt,this)}set layoutOptions(e){(0,d.A)(Zt,this,e)}get defaultNodeSize(){return(0,h.A)(_t,this)}set defaultNodeSize(e){(0,d.A)(_t,this,e)}get defaultNodeBricks(){return(0,h.A)(jt,this)}set defaultNodeBricks(e){(0,d.A)(jt,this,e)}get degradedThreshold(){return(0,h.A)(Ft,this)}set degradedThreshold(e){(0,d.A)(Ft,this,e)}get degradedNodeLabel(){return(0,h.A)(qt,this)}set degradedNodeLabel(e){(0,d.A)(qt,this,e)}get defaultEdgeLines(){return(0,h.A)(Gt,this)}set defaultEdgeLines(e){(0,d.A)(Gt,this,e)}get activeTarget(){return(0,h.A)(Jt,this)}set activeTarget(e){(0,d.A)(Jt,this,e)}get fadeUnrelatedCells(){return(0,h.A)(Qt,this)}set fadeUnrelatedCells(e){(0,d.A)(Qt,this,e)}get zoomable(){return(0,h.A)(ea,this)}set zoomable(e){(0,d.A)(ea,this,e)}get scrollable(){return(0,h.A)(ta,this)}set scrollable(e){(0,d.A)(ta,this,e)}get pannable(){return(0,h.A)(aa,this)}set pannable(e){(0,d.A)(aa,this,e)}get allowEdgeToArea(){return(0,h.A)(na,this)}set allowEdgeToArea(e){(0,d.A)(na,this,e)}get dragBehavior(){return(0,h.A)(sa,this)}set dragBehavior(e){(0,d.A)(sa,this,e)}get ctrlDragBehavior(){return(0,h.A)(la,this)}set ctrlDragBehavior(e){(0,d.A)(la,this,e)}get scaleRange(){return(0,h.A)(ia,this)}set scaleRange(e){(0,d.A)(ia,this,e)}get lineSettings(){return(0,h.A)(oa,this)}set lineSettings(e){(0,d.A)(oa,this,e)}get lineConnector(){return(0,h.A)(ra,this)}set lineConnector(e){(0,d.A)(ra,this,e)}async dropNode(e){var t,a;let{id:n,position:s,size:l,data:i,useBrick:o}=e;if(null===(t=(a=document).elementsFromPoint)||void 0===t||null===(t=t.call(a,s[0],s[1]))||void 0===t?void 0:t.includes(this)){var r;const e=this.getBoundingClientRect(),t=(0,h.A)(Ha,this).current.getTransform(),a={type:"node",id:n,view:{..."force"===this.layout||"dagre"===this.layout?null:{x:(s[0]-e.left-t.x)/t.k,y:(s[1]-e.top-t.y)/t.k},width:(null==l?void 0:l[0])??this.defaultNodeSize[0],height:(null==l?void 0:l[1])??this.defaultNodeSize[0]},data:i,useBrick:o};return null===(r=(0,h.A)(Ha,this).current)||void 0===r||r.dropNode(a),a}return null}async dropDecorator(e){var t,a;let{position:n,decorator:s,text:l,direction:i}=e;if(null===(t=(a=document).elementsFromPoint)||void 0===t||null===(t=t.call(a,n[0],n[1]))||void 0===t?void 0:t.includes(this)){var o;const e=this.getBoundingClientRect(),t=(0,h.A)(Ha,this).current.getTransform(),a={type:"decorator",decorator:s,id:Ia(),view:{x:(n[0]-e.left-t.x)/t.k,y:(n[1]-e.top-t.y)/t.k,width:R.N8,height:R.w1,text:l,direction:i}};return null===(o=(0,h.A)(Ha,this).current)||void 0===o||o.dropDecorator(a),a}return null}async addNodes(e){if(0===e.length)return[];const t=e.map((e=>{let{size:t,useBrick:a,id:n,data:s}=e;return{type:"node",id:n,data:s,view:{width:(null==t?void 0:t[0])??this.defaultNodeSize[0],height:(null==t?void 0:t[1])??this.defaultNodeSize[0]},useBrick:a}}));return(0,h.A)(Ha,this).current.addNodes(t,{defaultNodeSize:this.defaultNodeSize,canvasWidth:this.clientWidth,canvasHeight:this.clientHeight})}async addEdge(e){var t;let{source:a,target:n,data:s}=e;const l={type:"edge",source:a,target:n,data:s,view:this.lineSettings};return null===(t=(0,h.A)(Ha,this).current)||void 0===t||t.addEdge(l),l}manuallyConnectNodes(e){return(0,h.A)(Ha,this).current.manuallyConnectNodes(e)}async updateCells(e,t){await(0,o.A)(ha,this,Oa).call(this);const{updated:a}=(0,h.A)(Ha,this).current.updateCells(e,{...t,defaultNodeSize:this.defaultNodeSize,canvasWidth:this.clientWidth,canvasHeight:this.clientHeight});return{updated:a}}disconnectedCallback(){super.disconnectedCallback(),Ht(this,!1)}render(){return g().createElement(Ut,{host:this,ref:(0,h.A)(Ha,this),layout:this.layout,layoutOptions:this.layoutOptions,cells:this.cells,defaultNodeSize:this.defaultNodeSize,defaultNodeBricks:this.defaultNodeBricks,defaultEdgeLines:this.defaultEdgeLines,degradedThreshold:this.degradedThreshold,degradedNodeLabel:this.degradedNodeLabel,activeTarget:this.activeTarget,fadeUnrelatedCells:this.fadeUnrelatedCells,zoomable:this.zoomable,scrollable:this.scrollable,pannable:this.pannable,dragBehavior:this.dragBehavior,ctrlDragBehavior:this.ctrlDragBehavior,scaleRange:this.scaleRange,lineSettings:this.lineSettings,lineConnector:this.lineConnector,allowEdgeToArea:this.allowEdgeToArea,onActiveTargetChange:(0,h.A)(ca,this),onSwitchActiveTarget:(0,h.A)(ua,this),onCellMove:(0,h.A)(Aa,this),onCellsMove:(0,h.A)(va,this),onCellResize:(0,h.A)(fa,this),onCellDelete:(0,h.A)(wa,this),onCellsDelete:(0,h.A)(Ma,this),onEdgeAdd:(0,h.A)(Na,this),onCellContextMenu:(0,h.A)(xa,this),onDecoratorTextChange:(0,h.A)(La,this),onContainerContainerChange:(0,h.A)(Ba,this),onScaleChange:(0,h.A)($a,this),onEdgeViewChange:(0,h.A)(Ta,this)})}}function Oa(){return new Promise((e=>{const t=()=>{(0,h.A)(Ha,this).current?e():setTimeout(t,10)};t()}))}function Ka(e,t){let{host:a,layout:n,layoutOptions:s,cells:l,defaultNodeSize:i,defaultNodeBricks:o,defaultEdgeLines:r,degradedThreshold:d,degradedNodeLabel:h,activeTarget:c,fadeUnrelatedCells:p,zoomable:A,scrollable:m,pannable:y,dragBehavior:M,ctrlDragBehavior:U,scaleRange:V,lineSettings:F,lineConnector:q,allowEdgeToArea:G,onActiveTargetChange:J,onSwitchActiveTarget:Q,onCellMove:ee,onCellResize:te,onCellDelete:ae,onCellsMove:ne,onCellsDelete:se,onCellContextMenu:le,onEdgeAdd:ie,onDecoratorTextChange:oe,onScaleChange:re,onContainerContainerChange:de,onEdgeViewChange:he}=e;const[{cells:ce,layoutKey:ue},ge]=(0,u.useReducer)(b.d,l,(e=>({cells:(0,N.C)(e,{defaultNodeSize:i}),layoutKey:0}))),pe=(0,u.useMemo)((()=>ce.filter(C.N).length>=(d??R.pC)),[ce,d]),Ae=(0,u.useRef)(null),me=(0,u.useRef)(null),[ve,ye]=(0,u.useState)([]),[fe,ke]=(0,u.useState)([]),{grabbing:be,transform:we,zoomer:Ce,scaleRange:Me}=(0,L.f)({rootRef:Ae,zoomable:A,scrollable:m,pannable:y,draggable:"grab"===M,ctrlDraggable:"grab"===U,scaleRange:V,onSwitchActiveTarget:Q});(0,u.useEffect)((()=>{re(we.k)}),[re,we.k]);const[Ee,xe]=(0,u.useState)(null),[We,Ne]=(0,u.useState)(null),{centered:Se,setCentered:Te,getNextLayoutKey:Re}=(0,D.g)({layout:n,layoutOptions:s,rootRef:Ae,cells:ce,zoomable:A,zoomer:Ce,scaleRange:Me,layoutKey:ue,allowEdgeToArea:G,dispatch:ge});(0,u.useImperativeHandle)(t,(()=>({dropNode(e){"dagre"!==n&&"force"!==n&&Te(!0),ge({type:"drop-node",payload:e})},dropDecorator(e){"dagre"!==n&&"force"!==n&&Te(!0),ge({type:"drop-decorator",payload:e})},addNodes(e,t){let{defaultNodeSize:a,canvasWidth:s,canvasHeight:l}=t;const i=ce.findLastIndex((e=>!("decorator"===e.type&&"text"===e.decorator)))+1,o=[...ce.slice(0,i),...e,...ce.slice(i)],{cells:r,updated:d,shouldReCenter:h}=(0,S.L)({cells:o,layout:n,previousCells:ce,defaultNodeSize:a,canvasWidth:s,canvasHeight:l,scaleRange:Me,transform:we,allowEdgeToArea:G});return h&&Te(!1),ge({type:"update-cells",payload:r}),d.filter((t=>e.includes(t)))},addEdge(e){ge({type:"add-edge",payload:e})},updateCells(e,t){const{shouldReCenter:a,...s}=(0,S.L)({...t,layout:n,previousCells:ce,cells:e,scaleRange:Me,transform:we,allowEdgeToArea:G});return a&&Te(!1),ge({type:"update-cells",payload:s.cells}),s},getTransform:()=>we,manuallyConnectNodes(e){const t=ce.find((t=>(0,C.bo)(t,G)&&t.id===e));if(t){const e=Ae.current.getBoundingClientRect();return Ne({source:t,from:[t.view.x+t.view.width/2,t.view.y+t.view.height/2],offset:[e.left,e.top]}),new Promise(((e,t)=>{me.current={resolve:e,reject:t}}))}return Promise.reject(null)}})),[ce,n,Me,Te,we,G]);const Le=(0,u.useCallback)(((e,t)=>{var a;for(let a=ce.length-1;a>=0;a--){const s=ce[a];if((0,C.bo)(s,G)&&s.id!==e.source.id&&s.view.x<t[0]&&s.view.x+s.view.width>t[0]&&s.view.y<t[1]&&s.view.y+s.view.height>t[1]){var n;null===(n=me.current)||void 0===n||n.resolve({source:e.source,target:s});break}}null===(a=me.current)||void 0===a||a.reject(null),Ne(null)}),[G,ce]),[ze,Be]=(0,u.useState)(null);(0,u.useEffect)((()=>{Ht(a,!!(We||ze||Ee))}),[We,a,ze,Ee]);const De=(0,z.J)({rootRef:Ae,activeTarget:c,onActiveTargetChange:J}),[$e,He]=(0,u.useState)([]);(0,u.useEffect)((()=>{const e=p?(0,T.Y)(ce,We,De,G):[];He((t=>0===t.length&&0===e.length?t:e))}),[De,ce,We,p,G]),(0,u.useEffect)((()=>{const e=Ae.current;if(!e||ve.length>0)return;const t=e=>{const t=(0,E.a)(e,{cells:ce,activeTarget:De});"delete-cells"===(null==t?void 0:t.action)&&(se(t.cells),1===t.cells.length&&ae(t.cells[0]))};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}}),[De,ce,ve.length,ae,se]);const Pe=`${(0,u.useMemo)((()=>`${(0,v.uniqueId)("diagram-")}-`),[])}line-arrow-`,[Oe,Ke]=(0,u.useState)([]),Ie=(0,u.useCallback)((e=>{ge({type:"move-cells",payload:e});const t=[];(0,Z._)(e,ce).forEach((e=>{var a,n;null!==(a=e.containerCell)&&void 0!==a&&a.id&&t.push(null===(n=e.containerCell)||void 0===n?void 0:n.id)})),ke(t),Ke(e.flatMap((e=>e.guideLines??[])))}),[ce]),Ue=(0,u.useCallback)((e=>{ge({type:"move-cells",payload:e}),ne(e),1===e.length&&ee(e[0]),(0,Z._)(e,ce,de),ke([]),Ke([])}),[ee,ne,ce,de]),Ve=(0,u.useCallback)((e=>{ge({type:"resize-cell",payload:e})}),[]),Ye=(0,u.useCallback)((e=>{ge({type:"resize-cell",payload:e}),te(e)}),[te]),Xe=(0,u.useCallback)((e=>{let{id:t,editing:a}=e;ye(a?e=>e.includes(t)?e:[...e,t]:e=>e.filter((e=>e!==t)))}),[]),Ze=(0,u.useCallback)(((e,t)=>{const a=Re();ge({type:"update-node-size",payload:{id:e,size:t},layoutKey:a})}),[Re]),_e=(0,u.useCallback)((e=>{Ce.scaleTo((0,k.A)(Ae.current),e/100)}),[Ce]),je=(0,u.useCallback)((()=>{Te(!1)}),[Te]),{lineConfMap:Fe,lineConnectorConf:qe,markers:Ge}=(0,H.d)({cells:ce,defaultEdgeLines:r,lineConnector:q,markerPrefix:Pe}),Je=(0,$.H)({cells:ce,layout:n,centered:Se}),[Qe,et]=(0,u.useState)(null),tt=(0,u.useRef)(null),[at,nt]=(0,u.useState)(null),[st,lt]=(0,u.useState)(null),it=(0,u.useCallback)((e=>{if(qe&&(0,C.bo)(e,G)&&(!st||"control"!==st.type)){null!==tt.current&&(clearTimeout(tt.current),tt.current=null);const t=(0,P.G)();et({cell:e,relativePoints:t,points:Ua(t,e.view)})}}),[G,qe,st]),ot=(0,u.useCallback)((e=>{qe&&(0,C.N)(e)&&(tt.current=setTimeout((()=>{et(null)})))}),[qe]),rt=(0,u.useCallback)(((e,t,a,n)=>{const s={source:e.id,target:t.id,view:{...F,exitPosition:a,entryPosition:n,vertices:null}};if(ce.find((a=>"edge"===a.type&&a.source===e.id&&a.target===t.id)))ge({type:"change-edge-view",payload:s}),null==he||he(s);else{const a={type:"edge",...s};ge({type:"add-edge",payload:a}),ie({source:e,target:t,view:a.view})}}),[ce,F,ie,he]),dt=(0,u.useCallback)(((e,t,a)=>{const n={source:e.id,target:t.id,view:a};ge({type:"change-edge-view",payload:n}),null==he||he(n)}),[he]),ht=(0,u.useMemo)((()=>({rootRef:Ae,smartConnectLineState:ze,unsetHoverStateTimeoutRef:tt,hoverState:Qe,activeEditableLine:at,lineEditorState:st,setLineEditorState:lt,setActiveEditableLine:nt,setHoverState:et,setSmartConnectLineState:Be,onConnect:rt,onChangeEdgeView:dt})),[at,dt,rt,Qe,st,ze]);return(0,u.useEffect)((()=>{const e=Ae.current;if(!e||"lasso"!==M)return;const t=e.getBoundingClientRect(),a=e=>{(0,I.F)(e,{transform:we,offset:[t.left,t.top],onLassoing(e){xe(e)},onLassoed(e){xe(null);const t=[];for(const a of ce)if((0,C.t2)(a)||(0,C.o6)(a)||(0,C.Hs)(a)){const n=a.view.x,s=a.view.y;n>=e.x&&n+a.view.width<=e.x+e.width&&s>=e.y&&s+a.view.height<=e.y+e.height&&t.push(a)}null==Q||Q(t.length>1?{type:"multi",targets:t.map(X.P)}:1===t.length?(0,X.P)(t[0]):null)}})};return e.addEventListener("mousedown",a),()=>{e.removeEventListener("mousedown",a)}}),[we,ce,M,Q]),g().createElement(K.H.Provider,{value:ht},g().createElement("svg",{width:"100%",height:"100%",ref:Ae,className:f()("root",{grabbing:be,pannable:y,ready:Je}),tabIndex:-1},g().createElement("defs",null,Ge.map(((e,t)=>g().createElement(w.c,{key:t,id:`${Pe}${t}`,type:e.markerType,strokeColor:e.strokeColor})))),g().createElement("g",{transform:`translate(${we.x} ${we.y}) scale(${we.k})`},g().createElement("g",{className:f()("cells",{allowEdgeToArea:G})},ce.map((e=>g().createElement(x.m,{key:`${e.type}:${(0,C.WW)(e)?`${e.source}~${e.target}`:e.id}`,dragNodeToContainerActive:!(0,C.WW)(e)&&fe.includes(e.id),layout:n,layoutOptions:s,cell:e,cells:ce,degraded:pe,degradedNodeLabel:h,defaultNodeBricks:o,transform:we,lineConfMap:Fe,activeTarget:De,unrelatedCells:$e,allowEdgeToArea:G,onCellsMoving:Ie,onCellsMoved:Ue,onCellResizing:Ve,onCellResized:Ye,onSwitchActiveTarget:Q,onCellContextMenu:le,onDecoratorTextChange:oe,onDecoratorTextEditing:Xe,onNodeBrickResize:Ze,onCellMouseEnter:it,onCellMouseLeave:ot})))),g().createElement("g",null,g().createElement(W.w,{connectLineState:We,transform:we,markerEnd:`${Pe}0`,onConnect:Le})),Ee&&g().createElement("rect",{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,fill:"var(--palette-gray-5)",fillOpacity:.3,stroke:"var(--palette-gray-5)",strokeDasharray:2}),qe&&g().createElement("g",null,g().createElement(Y.X,{transform:we,lineSettings:F,options:qe}),g().createElement(j.W,{transform:we,options:qe})),g().createElement("g",null,Oe.map(((e,t)=>g().createElement("path",{key:t,d:`M${e[0].join(" ")} L${e[1].join(" ")}`,stroke:"var(--palette-orange-5)",fill:"none",strokeWidth:1/we.k})))),g().createElement("g",null,qe&&g().createElement(_.F,{scale:we.k})),qe&&g().createElement(O.T,{activeTarget:De,scale:we.k,disabled:!!We}))),g().createElement(B.Y,{shadowRoot:a.shadowRoot,scale:we.k,scaleRange:Me,onZoomChange:_e,onReCenter:je}))}function Ia(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function Ua(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=R.XK,s=n/2,l=t.x+a/2-s,i=t.y+a/2-s,o=t.width-a+n,r=t.height-a+n;return e.map((e=>({x:l+e.x*o,y:i+e.y*r})))}n=Pa,({e:[G,J,Q,ee,te,ae,ne,se,le,ie,oe,re,de,he,ce,ue,ge,pe,Ae,me,ve,ye,fe,ke,be,we,Ce,Me,Ee,xe,We,Ne,Se,Te,Re,Le,ze,Be,De,$e,He,Pe,Oe,Ke,Ie,Ue,Ve,Ye,Xe,Ze,_e,je,Fe,qe,Ge,Je,Qe,et,tt,at,nt,st,lt,it,ot,rt,dt,ht,ct,ut,gt,pt,At,mt,vt,yt,ft,kt,bt,wt,Ct,Mt,Et,xt,Wt,Nt,St,Tt,Rt,Lt,zt,Bt,Dt,$t,F],c:[Vt,q]}=(0,c.A)(n,[Pt("eo-draw-canvas",{styleTexts:[U.A,V.A]})],[[Ot({attribute:!1}),1,"cells"],[Ot({type:String}),1,"layout"],[Ot({attribute:!1}),1,"layoutOptions"],[Ot({attribute:!1}),1,"defaultNodeSize"],[Ot({attribute:!1}),1,"defaultNodeBricks"],[Ot({type:Number}),1,"degradedThreshold"],[Ot({attribute:!1}),1,"degradedNodeLabel"],[Ot({attribute:!1}),1,"defaultEdgeLines"],[Ot({attribute:!1}),1,"activeTarget"],[Ot({type:Boolean}),1,"fadeUnrelatedCells"],[Ot({type:Boolean}),1,"zoomable"],[Ot({type:Boolean}),1,"scrollable"],[Ot({type:Boolean}),1,"pannable"],[Ot({type:Boolean}),1,"allowEdgeToArea"],[Ot(),1,"dragBehavior"],[Ot(),1,"ctrlDragBehavior"],[Ot({attribute:!1}),1,"scaleRange"],[Ot({attribute:!1}),1,"lineSettings"],[Ot({attribute:!1}),1,"lineConnector"],[It({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,h.A)(da,e),(e,t)=>(0,d.A)(da,e,t)],[It({type:"node.move"}),1,"nodeMoveEvent",e=>(0,h.A)(ga,e),(e,t)=>(0,d.A)(ga,e,t)],[It({type:"cell.move"}),1,"cellMoveEvent",e=>(0,h.A)(pa,e),(e,t)=>(0,d.A)(pa,e,t)],[It({type:"cells.move"}),1,"cellsMoveEvent",e=>(0,h.A)(ma,e),(e,t)=>(0,d.A)(ma,e,t)],[It({type:"cell.resize"}),1,"cellResizeEvent",e=>(0,h.A)(ya,e),(e,t)=>(0,d.A)(ya,e,t)],[It({type:"node.delete"}),1,"nodeDelete",e=>(0,h.A)(ka,e),(e,t)=>(0,d.A)(ka,e,t)],[It({type:"cell.delete"}),1,"cellDelete",e=>(0,h.A)(ba,e),(e,t)=>(0,d.A)(ba,e,t)],[It({type:"cells.delete"}),1,"cellsDelete",e=>(0,h.A)(Ca,e),(e,t)=>(0,d.A)(Ca,e,t)],[It({type:"cell.contextmenu"}),1,"cellContextMenu",e=>(0,h.A)(Ea,e),(e,t)=>(0,d.A)(Ea,e,t)],[It({type:"edge.add"}),1,"edgeAdd",e=>(0,h.A)(Wa,e),(e,t)=>(0,d.A)(Wa,e,t)],[It({type:"edge.view.change"}),1,"edgeViewChange",e=>(0,h.A)(Sa,e),(e,t)=>(0,d.A)(Sa,e,t)],[It({type:"decorator.text.change"}),1,"decoratorTextChange",e=>(0,h.A)(Ra,e),(e,t)=>(0,d.A)(Ra,e,t)],[It({type:"node.container.change"}),1,"containerContainerChange",e=>(0,h.A)(za,e),(e,t)=>(0,d.A)(za,e,t)],[It({type:"scale.change"}),1,"scaleChange",e=>(0,h.A)(Da,e),(e,t)=>(0,d.A)(Da,e,t)],[Kt(),2,"dropNode"],[Kt(),2,"dropDecorator"],[Kt(),2,"addNodes"],[Kt(),2,"addEdge"],[Kt(),2,"manuallyConnectNodes"],[Kt(),2,"updateCells"]],0,(e=>Ha.has((0,i.A)(e))),A.ReactNextElement)),q()},3971:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(6758),s=a.n(n),l=a(935),i=a.n(l)()(s());i.push([e.id,':host{display:block;--local-label-line-height:inherit;--local-label-font-size:inherit;--local-label-color:inherit;--local-label-font-weight:inherit}:host([hidden]){display:none}:host([type="line"]){--local-label-line-height:18px;--local-label-font-size:11px;--local-label-color:var(--color-secondary-text);--local-label-font-weight:400}*{box-sizing:border-box}.label{max-width:168px;margin:-3px}.label-text,\n.label-input{width:100%;height:24px;padding:3px;border:none;line-height:var(--local-label-line-height);font-size:var(--local-label-font-size);color:var(--local-label-color);font-weight:var(--local-label-font-weight);text-align:center;font-family:inherit;cursor:text;-webkit-user-select:text;user-select:text}.label-text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.label.editing .label-text,\n.label.empty:not(.editing) .label-text,\n.label:not(.editing) .label-input{display:none}',""]);const o=i.toString()},497:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(6758),s=a.n(n),l=a(935),i=a.n(l)()(s());i.push([e.id,'*{box-sizing:border-box}:host{display:block;border:1px solid var(--palette-gray-5);cursor:default;-webkit-user-select:none;user-select:none}:host([hidden]){display:none}:host([usage="dragging"]){opacity:0.75;position:fixed}:host(:not([usage="library"])){background:rgba(0,0,0,0.2);width:60px;height:60px}:host([usage="library"]){width:180px;height:30px;margin-bottom:10px}div{width:100%;height:100%;display:flex;align-items:center;justify-content:center}:host(:not([usage="dragging"]):not([usage="library"]):hover),\n:host([status="highlighted"]){color:var(--palette-blue-5);background:var(--palette-blue-1);border-color:1px solid var(--palette-blue-4)}:host([status="faded"]){opacity:0.3}:host([decorator="area"]){width:100px;height:60px;background:rgba(119,141,195,0.1);border:none}:host([decorator="text"]){width:auto;height:auto;background:none;border:none}',""]);const o=i.toString()}}]);
//# sourceMappingURL=9711.ba801f42.js.map