"use strict";(globalThis.webpackChunk_next_bricks_diagram=globalThis.webpackChunk_next_bricks_diagram||[]).push([[9823,8939],{6094:(e,t,a)=>{a.r(t),a.d(t,{EoDisplayCanvas:()=>Se});var l,s=a(4635),i=a(918),n=a(6902),o=a(5536),r=a(6121),d=a(829),h=a(2740),c=a(8769),u=a.n(c),g=a(300),A=a(4295),p=(a(6477),a(1030)),y=a(3373),v=a.n(y),C=a(7566),f=a(3739),m=a(8185),k=a(4932),w=a(3783),b=a(3033),M=a(8091),E=a(1819),W=a(5748),x=a(227),N=a(531),T=a(7099),S=a(1484),R=a(8197),z=a(7531),B=a(2098),L=a(3012),D=a(6237);let $,H,P,O,U,K,Z,_,I,j,F,V,Y,q,J,X,G,Q,ee,te,ae,le,se,ie,ne,oe,re,de,he,ce,ue,ge,Ae,pe,ye,ve,Ce,fe,me,ke,we,be,Me,Ee,We;const{defineElement:xe,property:Ne,event:Te}=(0,g.createDecorators)();let Se;var Re=new WeakMap,ze=new WeakMap,Be=new WeakMap,Le=new WeakMap,De=new WeakMap,$e=new WeakMap,He=new WeakMap,Pe=new WeakMap,Oe=new WeakMap,Ue=new WeakMap,Ke=new WeakMap,Ze=new WeakMap,_e=new WeakMap,Ie=new WeakMap,je=new WeakMap,Fe=new WeakMap,Ve=new WeakMap,Ye=new WeakSet,qe=new WeakMap,Je=new WeakMap,Xe=new WeakMap,Ge=new WeakMap,Qe=new WeakMap,et=new WeakMap;class tt extends A.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,Ye),(0,i.A)(this,Re,H(this)),(0,i.A)(this,ze,(P(this),O(this))),(0,i.A)(this,Be,(U(this),K(this))),(0,i.A)(this,Le,(Z(this),_(this,[b.HP,b.HP]))),(0,i.A)(this,De,(I(this),j(this))),(0,i.A)(this,$e,(F(this),V(this))),(0,i.A)(this,He,(Y(this),q(this))),(0,i.A)(this,Pe,(J(this),X(this))),(0,i.A)(this,Oe,(G(this),Q(this))),(0,i.A)(this,Ue,(ee(this),te(this))),(0,i.A)(this,Ke,(ae(this),le(this,!0))),(0,i.A)(this,Ze,(se(this),ie(this,!0))),(0,i.A)(this,_e,(ne(this),oe(this,!0))),(0,i.A)(this,Ie,(re(this),de(this))),(0,i.A)(this,je,(he(this),ce(this))),(0,i.A)(this,Fe,(ue(this),ge(this))),(0,i.A)(this,Ve,(Ae(this),pe(this))),(0,i.A)(this,qe,(Ce(this),e=>{(0,o.A)(Ye,this,ye).emit(e)})),(0,i.A)(this,Je,(e=>{(0,m.c)(e,this.activeTarget)||(this.activeTarget=e)})),(0,i.A)(this,Xe,fe(this)),(0,i.A)(this,Ge,(we(this),e=>{(0,o.A)(Ye,this,me).emit(e)})),(0,i.A)(this,Qe,be(this)),(0,i.A)(this,et,(We(this),e=>{(0,o.A)(Ye,this,Me).emit(e)}))}get cells(){return(0,d.A)(Re,this)}set cells(e){(0,r.A)(Re,this,e)}get layout(){return(0,d.A)(ze,this)}set layout(e){(0,r.A)(ze,this,e)}get layoutOptions(){return(0,d.A)(Be,this)}set layoutOptions(e){(0,r.A)(Be,this,e)}get defaultNodeSize(){return(0,d.A)(Le,this)}set defaultNodeSize(e){(0,r.A)(Le,this,e)}get defaultNodeBricks(){return(0,d.A)(De,this)}set defaultNodeBricks(e){(0,r.A)(De,this,e)}get degradedThreshold(){return(0,d.A)($e,this)}set degradedThreshold(e){(0,r.A)($e,this,e)}get degradedNodeLabel(){return(0,d.A)(He,this)}set degradedNodeLabel(e){(0,r.A)(He,this,e)}get defaultEdgeLines(){return(0,d.A)(Pe,this)}set defaultEdgeLines(e){(0,r.A)(Pe,this,e)}get activeTarget(){return(0,d.A)(Oe,this)}set activeTarget(e){(0,r.A)(Oe,this,e)}get fadeUnrelatedCells(){return(0,d.A)(Ue,this)}set fadeUnrelatedCells(e){(0,r.A)(Ue,this,e)}get zoomable(){return(0,d.A)(Ke,this)}set zoomable(e){(0,r.A)(Ke,this,e)}get scrollable(){return(0,d.A)(Ze,this)}set scrollable(e){(0,r.A)(Ze,this,e)}get pannable(){return(0,d.A)(_e,this)}set pannable(e){(0,r.A)(_e,this,e)}get scaleRange(){return(0,d.A)(Ie,this)}set scaleRange(e){(0,r.A)(Ie,this,e)}get hideZoomBar(){return(0,d.A)(je,this)}set hideZoomBar(e){(0,r.A)(je,this,e)}get autoCenterWhenCellsChange(){return(0,d.A)(Fe,this)}set autoCenterWhenCellsChange(e){(0,r.A)(Fe,this,e)}render(){return u().createElement(at,{shadowRoot:this.shadowRoot,cells:this.cells,layout:this.layout,layoutOptions:this.layoutOptions,defaultNodeSize:this.defaultNodeSize,defaultNodeBricks:this.defaultNodeBricks,defaultEdgeLines:this.defaultEdgeLines,degradedThreshold:this.degradedThreshold,degradedNodeLabel:this.degradedNodeLabel,activeTarget:this.activeTarget,fadeUnrelatedCells:this.fadeUnrelatedCells,zoomable:this.zoomable,scrollable:this.scrollable,pannable:this.pannable,scaleRange:this.scaleRange,hideZoomBar:this.hideZoomBar,autoCenterWhenCellsChange:this.autoCenterWhenCellsChange,onActiveTargetChange:(0,d.A)(qe,this),onSwitchActiveTarget:(0,d.A)(Je,this),onCellContextMenu:(0,d.A)(Ge,this),onCellClick:(0,d.A)(et,this)})}}function at(e){let{shadowRoot:t,cells:a,layout:l,layoutOptions:s,defaultNodeSize:i,defaultNodeBricks:n,defaultEdgeLines:o,degradedThreshold:r,degradedNodeLabel:d,activeTarget:h,fadeUnrelatedCells:g,zoomable:A,scrollable:y,pannable:m,scaleRange:L,hideZoomBar:D,autoCenterWhenCellsChange:$,onActiveTargetChange:H,onSwitchActiveTarget:P,onCellContextMenu:O,onCellClick:U}=e;const[{cells:K,layoutKey:Z},_]=(0,c.useReducer)(W.d,a,(e=>({cells:(0,w.C)(e,{defaultNodeSize:i}),layoutKey:1}))),I=(0,c.useMemo)((()=>K.filter(N.N).length>=(r??b.pC)),[K,r]),j=(0,c.useRef)(null),{grabbing:F,transform:V,zoomer:Y,scaleRange:q}=(0,M.f)({rootRef:j,zoomable:A,scrollable:y,pannable:m,draggable:!0,scaleRange:L,onSwitchActiveTarget:P}),{centered:J,setCentered:X,getNextLayoutKey:G}=(0,S.g)({layout:l,layoutOptions:s,rootRef:j,cells:K,zoomable:A,zoomer:Y,scaleRange:q,layoutKey:Z,autoCenterWhenCellsChange:$,dispatch:_}),Q=(0,c.useCallback)((()=>{X(!1)}),[X]),ee=(0,c.useRef)(a);(0,c.useEffect)((()=>{if(a!==ee.current){ee.current=a;const e=(0,B.L)({canvasWidth:t.host.clientWidth,canvasHeight:t.host.clientHeight,defaultNodeSize:i,layout:l,previousCells:K,cells:a,scaleRange:q,transform:V});_({type:"update-cells",payload:e.cells})}}),[K,i,a,l,q,t,V]);const te=(0,E.J)({rootRef:j,activeTarget:h,onActiveTargetChange:H}),ae=`${(0,c.useMemo)((()=>`${(0,p.uniqueId)("diagram-")}-`),[])}line-arrow-`,le=(0,c.useCallback)(((e,t)=>{_({type:"update-node-size",payload:{id:e,size:t},layoutKey:G()})}),[G]),[se,ie]=(0,c.useState)(null),ne=(0,c.useCallback)((e=>{ie(e)}),[]),oe=(0,c.useCallback)((e=>{ie((t=>t===e?null:t))}),[]),[re,de]=(0,c.useState)([]);(0,c.useEffect)((()=>{const e=g?(0,x.Y)(K,null,se):[];de((t=>0===t.length&&0===e.length?t:e))}),[K,g,se]);const he=(0,c.useCallback)((e=>{Y.scaleTo((0,C.A)(j.current),e/100)}),[Y]),{lineConfMap:ce,markers:ue}=(0,z.d)({cells:K,defaultEdgeLines:o,markerPrefix:ae}),ge=(0,R.H)({cells:K,layout:l,centered:J});return u().createElement(u().Fragment,null,u().createElement("svg",{width:"100%",height:"100%",ref:j,className:v()("root",{grabbing:F,pannable:m,ready:ge}),tabIndex:-1},u().createElement("defs",null,ue.map(((e,t)=>u().createElement(f.c,{key:t,id:`${ae}${t}`,type:e.markerType,strokeColor:e.strokeColor})))),u().createElement("g",{transform:`translate(${V.x} ${V.y}) scale(${V.k})`},u().createElement("g",{className:"cells"},K.map((e=>u().createElement(k.m,{key:`${e.type}:${(0,N.WW)(e)?`${e.source}~${e.target}`:e.id}`,layout:l,cell:e,cells:K,degraded:I,degradedNodeLabel:d,defaultNodeBricks:n,lineConfMap:ce,transform:V,activeTarget:te,readOnly:!0,unrelatedCells:re,onSwitchActiveTarget:P,onCellContextMenu:O,onCellClick:U,onNodeBrickResize:le,onCellMouseEnter:g&&(0,N.N)(e)?ne:void 0,onCellMouseLeave:g&&(0,N.N)(e)?oe:void 0})))))),!D&&u().createElement(T.Y,{shadowRoot:t,scale:V.k,scaleRange:q,onZoomChange:he,onReCenter:Q}))}l=tt,({e:[H,P,O,U,K,Z,_,I,j,F,V,Y,q,J,X,G,Q,ee,te,ae,le,se,ie,ne,oe,re,de,he,ce,ue,ge,Ae,pe,ye,ve,Ce,fe,me,ke,we,be,Me,Ee,We],c:[Se,$]}=(0,h.A)(l,[xe("eo-display-canvas",{styleTexts:[L.A,D.A]})],[[Ne({attribute:!1}),1,"cells"],[Ne({type:String}),1,"layout"],[Ne({attribute:!1}),1,"layoutOptions"],[Ne({attribute:!1}),1,"defaultNodeSize"],[Ne({attribute:!1}),1,"defaultNodeBricks"],[Ne({type:Number}),1,"degradedThreshold"],[Ne({attribute:!1}),1,"degradedNodeLabel"],[Ne({attribute:!1}),1,"defaultEdgeLines"],[Ne({attribute:!1}),1,"activeTarget"],[Ne({type:Boolean}),1,"fadeUnrelatedCells"],[Ne({type:Boolean}),1,"zoomable"],[Ne({type:Boolean}),1,"scrollable"],[Ne({type:Boolean}),1,"pannable"],[Ne({attribute:!1}),1,"scaleRange"],[Ne({type:Boolean}),1,"hideZoomBar"],[Ne({type:Boolean}),1,"autoCenterWhenCellsChange"],[Te({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,d.A)(Ve,e),(e,t)=>(0,r.A)(Ve,e,t)],[Te({type:"cell.contextmenu"}),1,"cellContextMenu",e=>(0,d.A)(Xe,e),(e,t)=>(0,r.A)(Xe,e,t)],[Te({type:"cell.click"}),1,"cellClick",e=>(0,d.A)(Qe,e),(e,t)=>(0,r.A)(Qe,e,t)]],0,(e=>et.has((0,n.A)(e))),A.ReactNextElement)),$()},9068:(e,t,a)=>{a.r(t),a.d(t,{EoDrawCanvas:()=>_t,EoDrawCanvasComponent:()=>Zt,uuidV4:()=>Ka});var l,s=a(4635),i=a(918),n=a(6902),o=a(2559),r=a(5536),d=a(6121),h=a(829),c=a(2740),u=a(8769),g=a.n(u),A=a(300),p=a(4295),y=a(3078),v=(a(6477),a(1030)),C=a(3373),f=a.n(C),m=a(7566),k=a(5748),w=a(3739),b=a(531),M=a(8185),E=a(5114),W=a(4932),x=a(3639),N=a(3783),T=a(2098),S=a(227),R=a(3033),z=a(8091),B=a(1819),L=a(7099),D=a(1484),$=a(8197),H=a(7531),P=a(8875),O=a(2722),U=a(9978),K=a(2219),Z=a(3012),_=a(6237),I=a(1103),j=a(9386),F=a(1991),V=a(2202),Y=a(1825);let q,J,X,G,Q,ee,te,ae,le,se,ie,ne,oe,re,de,he,ce,ue,ge,Ae,pe,ye,ve,Ce,fe,me,ke,we,be,Me,Ee,We,xe,Ne,Te,Se,Re,ze,Be,Le,De,$e,He,Pe,Oe,Ue,Ke,Ze,_e,Ie,je,Fe,Ve,Ye,qe,Je,Xe,Ge,Qe,et,tt,at,lt,st,it,nt,ot,rt,dt,ht,ct,ut,gt,At,pt,yt,vt,Ct,ft,mt,kt,wt,bt,Mt,Et,Wt,xt,Nt,Tt,St,Rt,zt,Bt,Lt,Dt,$t;const Ht=(0,y.unwrapProvider)("basic.lock-body-scroll"),{defineElement:Pt,property:Ot,method:Ut,event:Kt}=(0,A.createDecorators)(),Zt=g().forwardRef(Ua);let _t;var It=new WeakMap,jt=new WeakMap,Ft=new WeakMap,Vt=new WeakMap,Yt=new WeakMap,qt=new WeakMap,Jt=new WeakMap,Xt=new WeakMap,Gt=new WeakMap,Qt=new WeakMap,ea=new WeakMap,ta=new WeakMap,aa=new WeakMap,la=new WeakMap,sa=new WeakMap,ia=new WeakMap,na=new WeakMap,oa=new WeakMap,ra=new WeakMap,da=new WeakMap,ha=new WeakSet,ca=new WeakMap,ua=new WeakMap,ga=new WeakMap,Aa=new WeakMap,pa=new WeakMap,ya=new WeakMap,va=new WeakMap,Ca=new WeakMap,fa=new WeakMap,ma=new WeakMap,ka=new WeakMap,wa=new WeakMap,ba=new WeakMap,Ma=new WeakMap,Ea=new WeakMap,Wa=new WeakMap,xa=new WeakMap,Na=new WeakMap,Ta=new WeakMap,Sa=new WeakMap,Ra=new WeakMap,za=new WeakMap,Ba=new WeakMap,La=new WeakMap,Da=new WeakMap,$a=new WeakMap,Ha=new WeakMap;class Pa extends p.ReactNextElement{constructor(){super(...arguments),(0,s.A)(this,ha),(0,i.A)(this,It,(q(this),X(this))),(0,i.A)(this,jt,(G(this),Q(this))),(0,i.A)(this,Ft,(ee(this),te(this))),(0,i.A)(this,Vt,(ae(this),le(this,[R.HP,R.HP]))),(0,i.A)(this,Yt,(se(this),ie(this))),(0,i.A)(this,qt,(ne(this),oe(this))),(0,i.A)(this,Jt,(re(this),de(this))),(0,i.A)(this,Xt,(he(this),ce(this))),(0,i.A)(this,Gt,(ue(this),ge(this))),(0,i.A)(this,Qt,(Ae(this),pe(this))),(0,i.A)(this,ea,(ye(this),ve(this,!0))),(0,i.A)(this,ta,(Ce(this),fe(this,!0))),(0,i.A)(this,aa,(me(this),ke(this,!0))),(0,i.A)(this,la,(we(this),be(this,!1))),(0,i.A)(this,sa,(Me(this),Ee(this))),(0,i.A)(this,ia,(We(this),xe(this))),(0,i.A)(this,na,(Ne(this),Te(this))),(0,i.A)(this,oa,(Se(this),Re(this))),(0,i.A)(this,ra,(ze(this),Be(this))),(0,i.A)(this,da,(Le(this),De(this))),(0,i.A)(this,ca,(Pe(this),e=>{(0,r.A)(ha,this,$e).emit(e)})),(0,i.A)(this,ua,(e=>{(0,M.c)(e,this.activeTarget)||(this.activeTarget=e)})),(0,i.A)(this,ga,Oe(this)),(0,i.A)(this,Aa,(Ze(this),_e(this))),(0,i.A)(this,pa,(Fe(this),e=>{(0,r.A)(ha,this,Ie).emit(e),"node"===e.type&&(0,r.A)(ha,this,Ue).emit(e)})),(0,i.A)(this,ya,Ve(this)),(0,i.A)(this,va,(Je(this),e=>{(0,r.A)(ha,this,Ye).emit(e)})),(0,i.A)(this,Ca,Xe(this)),(0,i.A)(this,fa,(et(this),e=>{(0,r.A)(ha,this,Ge).emit(e)})),(0,i.A)(this,ma,tt(this)),(0,i.A)(this,ka,(st(this),it(this))),(0,i.A)(this,wa,(rt(this),e=>{(0,r.A)(ha,this,nt).emit(e),"node"===e.type&&(0,r.A)(ha,this,at).emit(e)})),(0,i.A)(this,ba,dt(this)),(0,i.A)(this,Ma,(ut(this),e=>{(0,r.A)(ha,this,ht).emit(e)})),(0,i.A)(this,Ea,gt(this)),(0,i.A)(this,Wa,(yt(this),e=>{(0,r.A)(ha,this,At).emit(e)})),(0,i.A)(this,xa,vt(this)),(0,i.A)(this,Na,(mt(this),e=>{(0,r.A)(ha,this,Ct).emit(e)})),(0,i.A)(this,Ta,kt(this)),(0,i.A)(this,Sa,(Mt(this),e=>{(0,r.A)(ha,this,wt).emit(e)})),(0,i.A)(this,Ra,Et(this)),(0,i.A)(this,za,(Nt(this),e=>{(0,r.A)(ha,this,Wt).emit(e)})),(0,i.A)(this,Ba,Tt(this)),(0,i.A)(this,La,(zt(this),e=>{(0,r.A)(ha,this,St).emit(e)})),(0,i.A)(this,Da,Bt(this)),(0,i.A)(this,$a,($t(this),e=>{(0,r.A)(ha,this,Lt).emit(e)})),(0,i.A)(this,Ha,(0,u.createRef)())}get cells(){return(0,h.A)(It,this)}set cells(e){(0,d.A)(It,this,e)}get layout(){return(0,h.A)(jt,this)}set layout(e){(0,d.A)(jt,this,e)}get layoutOptions(){return(0,h.A)(Ft,this)}set layoutOptions(e){(0,d.A)(Ft,this,e)}get defaultNodeSize(){return(0,h.A)(Vt,this)}set defaultNodeSize(e){(0,d.A)(Vt,this,e)}get defaultNodeBricks(){return(0,h.A)(Yt,this)}set defaultNodeBricks(e){(0,d.A)(Yt,this,e)}get degradedThreshold(){return(0,h.A)(qt,this)}set degradedThreshold(e){(0,d.A)(qt,this,e)}get degradedNodeLabel(){return(0,h.A)(Jt,this)}set degradedNodeLabel(e){(0,d.A)(Jt,this,e)}get defaultEdgeLines(){return(0,h.A)(Xt,this)}set defaultEdgeLines(e){(0,d.A)(Xt,this,e)}get activeTarget(){return(0,h.A)(Gt,this)}set activeTarget(e){(0,d.A)(Gt,this,e)}get fadeUnrelatedCells(){return(0,h.A)(Qt,this)}set fadeUnrelatedCells(e){(0,d.A)(Qt,this,e)}get zoomable(){return(0,h.A)(ea,this)}set zoomable(e){(0,d.A)(ea,this,e)}get scrollable(){return(0,h.A)(ta,this)}set scrollable(e){(0,d.A)(ta,this,e)}get pannable(){return(0,h.A)(aa,this)}set pannable(e){(0,d.A)(aa,this,e)}get allowEdgeToArea(){return(0,h.A)(la,this)}set allowEdgeToArea(e){(0,d.A)(la,this,e)}get dragBehavior(){return(0,h.A)(sa,this)}set dragBehavior(e){(0,d.A)(sa,this,e)}get ctrlDragBehavior(){return(0,h.A)(ia,this)}set ctrlDragBehavior(e){(0,d.A)(ia,this,e)}get scaleRange(){return(0,h.A)(na,this)}set scaleRange(e){(0,d.A)(na,this,e)}get lineSettings(){return(0,h.A)(oa,this)}set lineSettings(e){(0,d.A)(oa,this,e)}get lineConnector(){return(0,h.A)(ra,this)}set lineConnector(e){(0,d.A)(ra,this,e)}async dropNode(e){var t,a;let{id:l,position:s,size:i,data:n,useBrick:o}=e;if(null===(t=(a=document).elementsFromPoint)||void 0===t||null===(t=t.call(a,s[0],s[1]))||void 0===t?void 0:t.includes(this)){var r;const e=this.getBoundingClientRect(),t=(0,h.A)(Ha,this).current.getTransform(),a={type:"node",id:l,view:{..."force"===this.layout||"dagre"===this.layout?null:{x:(s[0]-e.left-t.x)/t.k,y:(s[1]-e.top-t.y)/t.k},width:(null==i?void 0:i[0])??this.defaultNodeSize[0],height:(null==i?void 0:i[1])??this.defaultNodeSize[0]},data:n,useBrick:o};return null===(r=(0,h.A)(Ha,this).current)||void 0===r||r.dropNode(a),a}return null}async dropDecorator(e){var t,a;let{position:l,decorator:s,text:i,direction:n}=e;if(null===(t=(a=document).elementsFromPoint)||void 0===t||null===(t=t.call(a,l[0],l[1]))||void 0===t?void 0:t.includes(this)){var o;const e=this.getBoundingClientRect(),t=(0,h.A)(Ha,this).current.getTransform(),a={type:"decorator",decorator:s,id:Ka(),view:{x:(l[0]-e.left-t.x)/t.k,y:(l[1]-e.top-t.y)/t.k,width:R.N8,height:R.w1,text:i,direction:n}};return null===(o=(0,h.A)(Ha,this).current)||void 0===o||o.dropDecorator(a),a}return null}async addNodes(e){if(0===e.length)return[];const t=e.map((e=>{let{size:t,useBrick:a,id:l,data:s}=e;return{type:"node",id:l,data:s,view:{width:(null==t?void 0:t[0])??this.defaultNodeSize[0],height:(null==t?void 0:t[1])??this.defaultNodeSize[0]},useBrick:a}}));return(0,h.A)(Ha,this).current.addNodes(t,{defaultNodeSize:this.defaultNodeSize,canvasWidth:this.clientWidth,canvasHeight:this.clientHeight})}async addEdge(e){var t;let{source:a,target:l,data:s}=e;const i={type:"edge",source:a,target:l,data:s,view:this.lineSettings};return null===(t=(0,h.A)(Ha,this).current)||void 0===t||t.addEdge(i),i}manuallyConnectNodes(e){return(0,h.A)(Ha,this).current.manuallyConnectNodes(e)}async updateCells(e,t){await(0,o.A)(ha,this,Oa).call(this);const{updated:a}=(0,h.A)(Ha,this).current.updateCells(e,{...t,defaultNodeSize:this.defaultNodeSize,canvasWidth:this.clientWidth,canvasHeight:this.clientHeight});return{updated:a}}disconnectedCallback(){super.disconnectedCallback(),Ht(this,!1)}render(){return g().createElement(Zt,{host:this,ref:(0,h.A)(Ha,this),layout:this.layout,layoutOptions:this.layoutOptions,cells:this.cells,defaultNodeSize:this.defaultNodeSize,defaultNodeBricks:this.defaultNodeBricks,defaultEdgeLines:this.defaultEdgeLines,degradedThreshold:this.degradedThreshold,degradedNodeLabel:this.degradedNodeLabel,activeTarget:this.activeTarget,fadeUnrelatedCells:this.fadeUnrelatedCells,zoomable:this.zoomable,scrollable:this.scrollable,pannable:this.pannable,dragBehavior:this.dragBehavior,ctrlDragBehavior:this.ctrlDragBehavior,scaleRange:this.scaleRange,lineSettings:this.lineSettings,lineConnector:this.lineConnector,allowEdgeToArea:this.allowEdgeToArea,onActiveTargetChange:(0,h.A)(ca,this),onSwitchActiveTarget:(0,h.A)(ua,this),onCellMove:(0,h.A)(pa,this),onCellsMove:(0,h.A)(va,this),onCellResize:(0,h.A)(fa,this),onCellDelete:(0,h.A)(wa,this),onCellsDelete:(0,h.A)(Ma,this),onEdgeAdd:(0,h.A)(Na,this),onCellContextMenu:(0,h.A)(Wa,this),onDecoratorTextChange:(0,h.A)(za,this),onContainerContainerChange:(0,h.A)(La,this),onScaleChange:(0,h.A)($a,this),onEdgeViewChange:(0,h.A)(Sa,this)})}}function Oa(){return new Promise((e=>{const t=()=>{(0,h.A)(Ha,this).current?e():setTimeout(t,10)};t()}))}function Ua(e,t){let{host:a,layout:l,layoutOptions:s,cells:i,defaultNodeSize:n,defaultNodeBricks:o,defaultEdgeLines:r,degradedThreshold:d,degradedNodeLabel:h,activeTarget:c,fadeUnrelatedCells:A,zoomable:p,scrollable:y,pannable:C,dragBehavior:M,ctrlDragBehavior:Z,scaleRange:_,lineSettings:q,lineConnector:J,allowEdgeToArea:X,onActiveTargetChange:G,onSwitchActiveTarget:Q,onCellMove:ee,onCellResize:te,onCellDelete:ae,onCellsMove:le,onCellsDelete:se,onCellContextMenu:ie,onEdgeAdd:ne,onDecoratorTextChange:oe,onScaleChange:re,onContainerContainerChange:de,onEdgeViewChange:he}=e;const[{cells:ce,layoutKey:ue},ge]=(0,u.useReducer)(k.d,i,(e=>({cells:(0,N.C)(e,{defaultNodeSize:n}),layoutKey:0}))),Ae=(0,u.useMemo)((()=>ce.filter(b.N).length>=(d??R.pC)),[ce,d]),pe=(0,u.useRef)(null),ye=(0,u.useRef)(null),[ve,Ce]=(0,u.useState)([]),[fe,me]=(0,u.useState)([]),{grabbing:ke,transform:we,zoomer:be,scaleRange:Me}=(0,z.f)({rootRef:pe,zoomable:p,scrollable:y,pannable:C,draggable:"grab"===M,ctrlDraggable:"grab"===Z,scaleRange:_,onSwitchActiveTarget:Q});(0,u.useEffect)((()=>{re(we.k)}),[re,we.k]);const[Ee,We]=(0,u.useState)(null),[xe,Ne]=(0,u.useState)(null),{centered:Te,setCentered:Se,getNextLayoutKey:Re}=(0,D.g)({layout:l,layoutOptions:s,rootRef:pe,cells:ce,zoomable:p,zoomer:be,scaleRange:Me,layoutKey:ue,allowEdgeToArea:X,dispatch:ge});(0,u.useImperativeHandle)(t,(()=>({dropNode(e){"dagre"!==l&&"force"!==l&&Se(!0),ge({type:"drop-node",payload:e})},dropDecorator(e){"dagre"!==l&&"force"!==l&&Se(!0),ge({type:"drop-decorator",payload:e})},addNodes(e,t){let{defaultNodeSize:a,canvasWidth:s,canvasHeight:i}=t;const n=ce.findLastIndex((e=>!("decorator"===e.type&&"text"===e.decorator)))+1,o=[...ce.slice(0,n),...e,...ce.slice(n)],{cells:r,updated:d,shouldReCenter:h}=(0,T.L)({cells:o,layout:l,previousCells:ce,defaultNodeSize:a,canvasWidth:s,canvasHeight:i,scaleRange:Me,transform:we,allowEdgeToArea:X});return h&&Se(!1),ge({type:"update-cells",payload:r}),d.filter((t=>e.includes(t)))},addEdge(e){ge({type:"add-edge",payload:e})},updateCells(e,t){const{shouldReCenter:a,...s}=(0,T.L)({...t,layout:l,previousCells:ce,cells:e,scaleRange:Me,transform:we,allowEdgeToArea:X});return a&&Se(!1),ge({type:"update-cells",payload:s.cells}),s},getTransform:()=>we,manuallyConnectNodes(e){const t=ce.find((t=>(0,b.bo)(t,X)&&t.id===e));if(t){const e=pe.current.getBoundingClientRect();return Ne({source:t,from:[t.view.x+t.view.width/2,t.view.y+t.view.height/2],offset:[e.left,e.top]}),new Promise(((e,t)=>{ye.current={resolve:e,reject:t}}))}return Promise.reject(null)}})),[ce,l,Me,Se,we,X]);const ze=(0,u.useCallback)(((e,t)=>{var a;for(let a=ce.length-1;a>=0;a--){const s=ce[a];if((0,b.bo)(s,X)&&s.id!==e.source.id&&s.view.x<t[0]&&s.view.x+s.view.width>t[0]&&s.view.y<t[1]&&s.view.y+s.view.height>t[1]){var l;null===(l=ye.current)||void 0===l||l.resolve({source:e.source,target:s});break}}null===(a=ye.current)||void 0===a||a.reject(null),Ne(null)}),[X,ce]),[Be,Le]=(0,u.useState)(null);(0,u.useEffect)((()=>{Ht(a,!!(xe||Be||Ee))}),[xe,a,Be,Ee]);const De=(0,B.J)({rootRef:pe,activeTarget:c,onActiveTargetChange:G}),[$e,He]=(0,u.useState)([]);(0,u.useEffect)((()=>{const e=A?(0,S.Y)(ce,xe,De,X):[];He((t=>0===t.length&&0===e.length?t:e))}),[De,ce,xe,A,X]),(0,u.useEffect)((()=>{const e=pe.current;if(!e||ve.length>0)return;const t=e=>{const t=(0,E.a)(e,{cells:ce,activeTarget:De});"delete-cells"===(null==t?void 0:t.action)&&(se(t.cells),1===t.cells.length&&ae(t.cells[0]))};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}}),[De,ce,ve.length,ae,se]);const Pe=`${(0,u.useMemo)((()=>`${(0,v.uniqueId)("diagram-")}-`),[])}line-arrow-`,[Oe,Ue]=(0,u.useState)([]),Ke=(0,u.useCallback)((e=>{ge({type:"move-cells",payload:e});const t=[];(0,F._)(e,ce).forEach((e=>{var a,l;null!==(a=e.containerCell)&&void 0!==a&&a.id&&t.push(null===(l=e.containerCell)||void 0===l?void 0:l.id)})),me(t),Ue(e.flatMap((e=>e.guideLines??[])))}),[ce]),Ze=(0,u.useCallback)((e=>{ge({type:"move-cells",payload:e}),le(e),1===e.length&&ee(e[0]),(0,F._)(e,ce,de),me([]),Ue([])}),[ee,le,ce,de]),_e=(0,u.useCallback)((e=>{ge({type:"resize-cell",payload:e})}),[]),Ie=(0,u.useCallback)((e=>{ge({type:"resize-cell",payload:e}),te(e)}),[te]),je=(0,u.useCallback)((e=>{let{id:t,editing:a}=e;Ce(a?e=>e.includes(t)?e:[...e,t]:e=>e.filter((e=>e!==t)))}),[]),Fe=(0,u.useCallback)(((e,t)=>{const a=Re();ge({type:"update-node-size",payload:{id:e,size:t},layoutKey:a})}),[Re]),Ve=(0,u.useCallback)((e=>{be.scaleTo((0,m.A)(pe.current),e/100)}),[be]),Ye=(0,u.useCallback)((()=>{Se(!1)}),[Se]),{lineConfMap:qe,lineConnectorConf:Je,markers:Xe}=(0,H.d)({cells:ce,defaultEdgeLines:r,lineConnector:J,markerPrefix:Pe}),Ge=(0,$.H)({cells:ce,layout:l,centered:Te}),[Qe,et]=(0,u.useState)(null),tt=(0,u.useRef)(null),[at,lt]=(0,u.useState)(null),[st,it]=(0,u.useState)(null),nt=(0,u.useCallback)((e=>{if(Je&&(0,b.bo)(e,X)&&(!st||"control"!==st.type)){null!==tt.current&&(clearTimeout(tt.current),tt.current=null);const t=(0,P.G)();et({cell:e,relativePoints:t,points:Za(t,e.view)})}}),[X,Je,st]),ot=(0,u.useCallback)((e=>{Je&&(0,b.N)(e)&&(tt.current=setTimeout((()=>{et(null)})))}),[Je]),rt=(0,u.useCallback)(((e,t,a,l)=>{const s={source:e.id,target:t.id,view:{...q,exitPosition:a,entryPosition:l,vertices:null}};if(ce.find((a=>"edge"===a.type&&a.source===e.id&&a.target===t.id)))ge({type:"change-edge-view",payload:s}),null==he||he(s);else{const a={type:"edge",...s};ge({type:"add-edge",payload:a}),ne({source:e,target:t,view:a.view})}}),[ce,q,ne,he]),dt=(0,u.useCallback)(((e,t,a)=>{const l={source:e.id,target:t.id,view:a};ge({type:"change-edge-view",payload:l}),null==he||he(l)}),[he]),ht=(0,u.useMemo)((()=>({rootRef:pe,smartConnectLineState:Be,unsetHoverStateTimeoutRef:tt,hoverState:Qe,activeEditableLine:at,lineEditorState:st,setLineEditorState:it,setActiveEditableLine:lt,setHoverState:et,setSmartConnectLineState:Le,onConnect:rt,onChangeEdgeView:dt})),[at,dt,rt,Qe,st,Be]);return(0,u.useEffect)((()=>{const e=pe.current;if(!e||"lasso"!==M)return;const t=e.getBoundingClientRect(),a=e=>{(0,K.F)(e,{transform:we,offset:[t.left,t.top],onLassoing(e){We(e)},onLassoed(e){We(null);const t=[];for(const a of ce)if((0,b.t2)(a)||(0,b.o6)(a)||(0,b.Hs)(a)){const l=a.view.x,s=a.view.y;l>=e.x&&l+a.view.width<=e.x+e.width&&s>=e.y&&s+a.view.height<=e.y+e.height&&t.push(a)}null==Q||Q(t.length>1?{type:"multi",targets:t.map(j.P)}:1===t.length?(0,j.P)(t[0]):null)}})};return e.addEventListener("mousedown",a),()=>{e.removeEventListener("mousedown",a)}}),[we,ce,M,Q]),g().createElement(U.H.Provider,{value:ht},g().createElement("svg",{width:"100%",height:"100%",ref:pe,className:f()("root",{grabbing:ke,pannable:C,ready:Ge}),tabIndex:-1},g().createElement("defs",null,Xe.map(((e,t)=>g().createElement(w.c,{key:t,id:`${Pe}${t}`,type:e.markerType,strokeColor:e.strokeColor})))),g().createElement("g",{transform:`translate(${we.x} ${we.y}) scale(${we.k})`},g().createElement("g",{className:f()("cells",{allowEdgeToArea:X})},ce.map((e=>g().createElement(W.m,{key:`${e.type}:${(0,b.WW)(e)?`${e.source}~${e.target}`:e.id}`,dragNodeToContainerActive:!(0,b.WW)(e)&&fe.includes(e.id),layout:l,layoutOptions:s,cell:e,cells:ce,degraded:Ae,degradedNodeLabel:h,defaultNodeBricks:o,transform:we,lineConfMap:qe,activeTarget:De,unrelatedCells:$e,allowEdgeToArea:X,onCellsMoving:Ke,onCellsMoved:Ze,onCellResizing:_e,onCellResized:Ie,onSwitchActiveTarget:Q,onCellContextMenu:ie,onDecoratorTextChange:oe,onDecoratorTextEditing:je,onNodeBrickResize:Fe,onCellMouseEnter:nt,onCellMouseLeave:ot})))),g().createElement("g",null,g().createElement(x.w,{connectLineState:xe,transform:we,markerEnd:`${Pe}0`,onConnect:ze})),Ee&&g().createElement("rect",{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,fill:"var(--palette-gray-5)",fillOpacity:.3,stroke:"var(--palette-gray-5)",strokeDasharray:2}),Je&&g().createElement("g",null,g().createElement(I.X,{transform:we,lineSettings:q,options:Je}),g().createElement(Y.W,{transform:we,options:Je})),g().createElement("g",null,Oe.map(((e,t)=>g().createElement("path",{key:t,d:`M${e[0].join(" ")} L${e[1].join(" ")}`,stroke:"var(--palette-orange-5)",fill:"none",strokeWidth:1/we.k})))),g().createElement("g",null,Je&&g().createElement(V.F,{scale:we.k})),Je&&g().createElement(O.T,{activeTarget:De,scale:we.k,disabled:!!xe}))),g().createElement(L.Y,{shadowRoot:a.shadowRoot,scale:we.k,scaleRange:Me,onZoomChange:Ve,onReCenter:Ye}))}function Ka(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function Za(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const l=R.XK,s=l/2,i=t.x+a/2-s,n=t.y+a/2-s,o=t.width-a+l,r=t.height-a+l;return e.map((e=>({x:i+e.x*o,y:n+e.y*r})))}l=Pa,({e:[X,G,Q,ee,te,ae,le,se,ie,ne,oe,re,de,he,ce,ue,ge,Ae,pe,ye,ve,Ce,fe,me,ke,we,be,Me,Ee,We,xe,Ne,Te,Se,Re,ze,Be,Le,De,$e,He,Pe,Oe,Ue,Ke,Ze,_e,Ie,je,Fe,Ve,Ye,qe,Je,Xe,Ge,Qe,et,tt,at,lt,st,it,nt,ot,rt,dt,ht,ct,ut,gt,At,pt,yt,vt,Ct,ft,mt,kt,wt,bt,Mt,Et,Wt,xt,Nt,Tt,St,Rt,zt,Bt,Lt,Dt,$t,q],c:[_t,J]}=(0,c.A)(l,[Pt("eo-draw-canvas",{styleTexts:[Z.A,_.A]})],[[Ot({attribute:!1}),1,"cells"],[Ot({type:String}),1,"layout"],[Ot({attribute:!1}),1,"layoutOptions"],[Ot({attribute:!1}),1,"defaultNodeSize"],[Ot({attribute:!1}),1,"defaultNodeBricks"],[Ot({type:Number}),1,"degradedThreshold"],[Ot({attribute:!1}),1,"degradedNodeLabel"],[Ot({attribute:!1}),1,"defaultEdgeLines"],[Ot({attribute:!1}),1,"activeTarget"],[Ot({type:Boolean}),1,"fadeUnrelatedCells"],[Ot({type:Boolean}),1,"zoomable"],[Ot({type:Boolean}),1,"scrollable"],[Ot({type:Boolean}),1,"pannable"],[Ot({type:Boolean}),1,"allowEdgeToArea"],[Ot(),1,"dragBehavior"],[Ot(),1,"ctrlDragBehavior"],[Ot({attribute:!1}),1,"scaleRange"],[Ot({attribute:!1}),1,"lineSettings"],[Ot({attribute:!1}),1,"lineConnector"],[Kt({type:"activeTarget.change"}),1,"activeTargetChangeEvent",e=>(0,h.A)(da,e),(e,t)=>(0,d.A)(da,e,t)],[Kt({type:"node.move"}),1,"nodeMoveEvent",e=>(0,h.A)(ga,e),(e,t)=>(0,d.A)(ga,e,t)],[Kt({type:"cell.move"}),1,"cellMoveEvent",e=>(0,h.A)(Aa,e),(e,t)=>(0,d.A)(Aa,e,t)],[Kt({type:"cells.move"}),1,"cellsMoveEvent",e=>(0,h.A)(ya,e),(e,t)=>(0,d.A)(ya,e,t)],[Kt({type:"cell.resize"}),1,"cellResizeEvent",e=>(0,h.A)(Ca,e),(e,t)=>(0,d.A)(Ca,e,t)],[Kt({type:"node.delete"}),1,"nodeDelete",e=>(0,h.A)(ma,e),(e,t)=>(0,d.A)(ma,e,t)],[Kt({type:"cell.delete"}),1,"cellDelete",e=>(0,h.A)(ka,e),(e,t)=>(0,d.A)(ka,e,t)],[Kt({type:"cells.delete"}),1,"cellsDelete",e=>(0,h.A)(ba,e),(e,t)=>(0,d.A)(ba,e,t)],[Kt({type:"cell.contextmenu"}),1,"cellContextMenu",e=>(0,h.A)(Ea,e),(e,t)=>(0,d.A)(Ea,e,t)],[Kt({type:"edge.add"}),1,"edgeAdd",e=>(0,h.A)(xa,e),(e,t)=>(0,d.A)(xa,e,t)],[Kt({type:"edge.view.change"}),1,"edgeViewChange",e=>(0,h.A)(Ta,e),(e,t)=>(0,d.A)(Ta,e,t)],[Kt({type:"decorator.text.change"}),1,"decoratorTextChange",e=>(0,h.A)(Ra,e),(e,t)=>(0,d.A)(Ra,e,t)],[Kt({type:"node.container.change"}),1,"containerContainerChange",e=>(0,h.A)(Ba,e),(e,t)=>(0,d.A)(Ba,e,t)],[Kt({type:"scale.change"}),1,"scaleChange",e=>(0,h.A)(Da,e),(e,t)=>(0,d.A)(Da,e,t)],[Ut(),2,"dropNode"],[Ut(),2,"dropDecorator"],[Ut(),2,"addNodes"],[Ut(),2,"addEdge"],[Ut(),2,"manuallyConnectNodes"],[Ut(),2,"updateCells"]],0,(e=>Ha.has((0,n.A)(e))),p.ReactNextElement)),J()}}]);
//# sourceMappingURL=eo-display-canvas.2ecac4a8.js.map