{"version":3,"file":"chunks/7218.a6298ee8.js","mappings":"gYAIA,IAAIA,EAAgB,SAAuBC,GACzC,IAAI,SACFC,EAAQ,KACRC,EAAI,cACJC,EAAa,YACbC,EAAW,gBACXC,GACEL,EACJ,MAAOM,EAAcC,IAAmB,IAAAC,UAAS,MAC3CC,GAAc,IAAAC,WACbC,EAAWC,IAAgB,IAAAJ,YAC5BK,GAAe,IAAAH,QAAO,GACtBI,GAAkB,IAAAC,UAAQ,KAC9B,IAAIC,EACJ,OAAmE,QAA3DA,EAAuB,EAAAC,mBAAmBC,mBAAkD,IAAzBF,OAAkC,EAASA,EAAqBG,KAAK,EAAAF,mBAAmB,GAClK,KACH,IAAAG,YAAU,KACR,IAAIC,GAAS,EAkBb,OAjBAC,iBACE,IACE,MAAMC,QAAkB,EAAAN,mBAAmBO,eAAevB,EAAUC,EAAMC,GAC1E,GAAIkB,EACF,OAEFd,EAAgBgB,GAChBX,IAAyBC,EA6ClBY,QA5CT,CAAE,MAAOC,IACFL,GA6Cb,SAAyBP,GACvB,IAAIa,EACJ,MAAMC,EAA2E,QAA5DD,EAAwB,EAAAV,mBAAmBC,mBAAmD,IAA1BS,OAAmC,EAASA,EAAsBR,KAAK,EAAAF,oBAChK,OAAQH,IAAoBc,GAAed,IAAoBc,CACjE,CAjDuBC,CAAgBf,KAE7BgB,QAAQJ,MAAM,0BAA2BzB,EAAU,aAAcC,IACjE,IAAA6B,iBAAgBL,GAEpB,CACF,CACAM,GACO,KACLX,GAAS,CAAI,CACd,GACA,CAACnB,EAAMD,EAAUa,EAAiBX,IACrC,MAAM8B,GAAe,IAAAC,cAAYC,IAC3BA,EACF1B,EAAYgB,QAAU,EAAAR,mBAAmBmB,cAEzC9B,EAAc6B,IAGd,EAAAlB,mBAAmBoB,gBAAgB/B,EAAcG,EAAYgB,SAC7DhB,EAAYgB,aAAUa,GAExBlC,SAAkDA,EAAY+B,EAAQ,GACrE,CAAC/B,EAAaE,IACjB,IAAKA,EAEH,OAAO,KAGT,MAAM,QACJiC,GACEjC,EACJ,GAAgB,OAAZiC,EAEF,OADAlC,SAA0DA,IACnD,KAET,MAAMmC,EAAeD,EACrB,OAAoB,gBAAoBC,EAAc,CACpDC,IAAK9B,EACL+B,IAAKT,GAET,EASIU,EAAyB,SAAgCC,GAC3D,IAAI,SACF3C,EAAQ,KACRC,EAAI,cACJC,GACEyC,EACJ,OAAIC,MAAMC,QAAQ7C,GACI,gBAAoB,WAAgB,KAAMA,EAAS8C,KAAI,CAACC,EAAMC,IAAuB,gBAAoBlD,EAAe,CAC1I0C,IAAKQ,EACLhD,SAAU+C,EACV9C,KAAMA,EACNC,cAAeA,OAGC,gBAAoBJ,EAAe,CACrDE,SAAUA,EACVC,KAAMA,EACNC,cAAeA,GAEnB,EAIA,MAAM+C,GAAQ,IAAAC,uBAEd,GAAID,EAAO,CACT,MAAM,8BACJE,EAA6B,wBAC7BC,GACEH,EACAE,GAAiCC,IACnCtD,EAAgBqD,EAA8B,GAC9CT,EAAyBU,EAAwB,GAErD,CCjHO,SAASC,IACd,MAAOC,EAAcC,IAAmB,IAAAhD,UAAS,EAAAiD,iBAUjD,OATA,IAAArC,YAAU,KACR,MAAMsC,EAAsBC,IAC1BH,EAAgBG,EAAMC,OAAO,EAG/B,OADAC,OAAOC,iBAAiB,eAAgBJ,GACjC,KACLG,OAAOE,oBAAoB,eAAgBL,EAAoB,CAChE,GACA,IACIH,CACT,CCZO,SAASS,IACd,MAAOC,EAAYC,GAAiB,YAAe,KAAM,IAAAC,cAAaC,kBAQtE,OAPA,aAAgB,KACd,MAAMC,EAAWV,IACfO,EAAcP,EAAMC,OAAO,EAG7B,OADAC,OAAOC,iBAAiB,aAAcO,GAC/B,IAAMR,OAAOE,oBAAoB,aAAcM,EAAS,GAC9D,IACIJ,CACT,CCIO,SAASK,IACd,OAAON,IAAgBO,UACzB,CCjBO,SAASC,IACd,MAAOC,EAAaC,GAAkB,WAAe,MAQrD,OAPA,aAAgB,KACd,MAAML,EAAWV,IACfe,EAAef,EAAMC,OAAO,EAG9B,OADAC,OAAOC,iBAAiB,eAAgBO,GACjC,IAAMR,OAAOE,oBAAoB,eAAgBM,EAAS,GAChE,IACII,CACT,CCXO,MAAME,EAA0B,CACrCC,SAAU,GACVC,cAAe,CACbC,QAAS,OAGTC,UAAW,CAACC,EAASC,IAAYA,EACjC/E,UAAMoC,EACN4C,SAAS,EACTC,UAAU,EACVC,OAAO,GAETC,kBAAc/C,GAEhB,EAAegD,OAAOC,QAAQZ,GAAyBa,QAAO,CAACC,EAAKzF,KAClE,IAAKyC,EAAKiD,GAAS1F,EACnB,MAA8C,oBAA1CsF,OAAOK,UAAUC,SAASzE,KAAKuE,GAAqC,IACnED,KACAC,GAEE,IACFD,EACH,CAAChD,GAAMiD,EACR,GACA,CAAC,G,cCvBJ,MAAMG,EAAW,IAAIC,ICGd,SAASC,IACd,MAAM,SACJnB,EAAQ,cACRC,EAAa,aACbQ,EAAY,YACZW,GCNW,SAAyBC,EAAiCC,EAAqBC,GAC5F,MAAMvB,GAAW,IAAA7D,UAAQ,IACwB,iBAApCkF,EACFA,EAEFtB,EAAwBC,UAC9B,CAACqB,EAAiCC,IAC/BE,GAAU,IAAArF,UAAQ,KACtB,IAAIsF,EAAe,CAAC,EAMpB,OALI,IAAAC,UAASL,GACXI,EAAeJ,GACN,IAAAK,UAASJ,KAClBG,EAAeH,GAEV,IACF,KACAG,EACJ,GACA,CAACJ,EAAiCC,IAC/BF,GAAc,IAAAjF,UAAQ,KAC1B,MAAMwF,EAAmB,IAAIjB,OAAOkB,KAAK7B,MAA6BW,OAAOkB,KAAK7B,EAAwBE,iBACpG,KACJ4B,EAAO,QACJC,GACDpB,OAAOkB,KAAKJ,GAASZ,QAAO,CAACC,EAAKhD,KAC/B8D,EAAiBI,SAASlE,KAAMgD,EAAIhD,GAAO2D,EAAQ3D,IACjDgD,IACN,CAAC,GACJ,MAAO,CACLW,QAAS,IACJM,GAELD,OACD,GACA,CAACL,IACEf,GAAe,IAAAtE,UAAQ,IACvB8B,MAAMC,QAAQoD,GAA6BA,EAC3CrD,MAAMC,QAAQqD,GAAcA,EACzB,EAASd,cACf,CAACa,EAAqBC,IACnBjB,EAAUkB,EAAQlB,SAAWrC,MAAMC,QAAQuC,GAYjD,MAAO,CACLT,WACAC,eAboB,IAAA9D,UAAQ,KAMrB,IALkBuE,OAAOkB,KAAK7B,EAAwBE,eACtBW,QAAO,CAACoB,EAAMnE,KACnDmE,EAAKnE,GAAO2D,EAAQ3D,GACbmE,IACN,CAAC,GAGF1B,aAED,CAACkB,IAIFJ,cACAX,eAEJ,CDnDMwB,IAAmBC,YACjB,QACJhC,EAAO,UACPC,EAAS,SACTI,EAAQ,MACRC,KACG2B,GACDlC,GACGK,EAAS8B,IAAc,IAAAxG,UAASuG,EAAS7B,SAC1C+B,GAAiB,IAAAvG,QAAO,WACxBwG,GAAY,IAAAxG,UACZyG,GAAU,IAAAzG,SAAO,GACjBgB,GAAQ,IAAAhB,UACR0G,GAAW,IAAA1G,UACXR,GAAO,IAAAQ,QAAOqG,EAAS7G,MACvBmH,GAAc,IAAAC,aAAW,KAAM,CAAG,IAAG,IAAI,GACzCC,GAAU,IAAArF,cAAYZ,MAAOsD,EAAU4C,KAC3C,IACE9F,EAAMD,aAAUa,EACX6C,GAAU6B,GAAW,GAC1B,MAAMS,QDFGnG,eAAqBsD,EAAUQ,EAAOqB,GACnD,IAAIiB,EAGJ,MAAMC,EAxBR,SAA6B/C,GAC3B,MAAMgD,EAAUC,GAAOvC,OAAOkB,KAAKqB,GAAKC,OAAO/E,KAAIgF,IAAK,CACtD,CAACA,GAAIF,EAAIE,OAEX,IAAK,IAAIC,EAAOlB,UAAUmB,OAAQxB,EAAO,IAAI5D,MAAMmF,EAAO,EAAIA,EAAO,EAAI,GAAIE,EAAO,EAAGA,EAAOF,EAAME,IAClGzB,EAAKyB,EAAO,GAAKpB,UAAUoB,GAE7B,IACE,MAAMC,EAbY,iBADPC,EAcc3B,IAbW,OAAN2B,GAAevF,MAAMC,QAAQsF,GAaV3B,EAAK1D,KAAIsF,GAX9D,SAAkBD,GAChB,MAAoB,iBAANA,CAChB,CASqEE,CAASD,GAAOA,EAAMT,EAAQS,KAA9DT,EAAQnB,GACzC,OAAO8B,KAAKC,UAAU,CACpB5D,WACA6B,KAAM0B,GAEV,CAAE,MAAOM,GACP,OAAOF,KAAKC,UAAU,CACpB5D,WACA6B,QAEJ,CAxBF,IAAe2B,CAyBf,CAKmBM,CAAoB9D,KAAa6B,GAUlD,OATCrB,GAASS,EAAS8C,IAAIhB,IAAa9B,EAAS+C,OAAOjB,GAChD9B,EAAS8C,IAAIhB,GACfD,EAAU7B,EAASgD,IAAIlB,IAEvBD,GACS,IAAAoB,iBAAgBlE,EAAU6B,GAEnCrB,GAASS,EAASkD,IAAIpB,EAAUD,IAE3BA,CACT,CCb2BsB,CAAMpE,EAAUQ,EAAOoC,GAC5CJ,EAAS3F,QAAUgG,EACnBvH,EAAKuB,QAAUsD,EAAU7E,EAAKuB,QAASgG,EACzC,CAAE,MAAOgB,GACP/G,EAAMD,QAAUgH,EAChBvI,EAAKuB,aAAUa,CACjB,CAGA,OAFK6C,GAAU6B,GAAW,GACtBtF,EAAMD,SAASqD,EAAQpD,EAAMD,SAC1BvB,EAAKuB,OAAO,GAClB,CAACmD,EAAUC,EAAeQ,EAAcW,EAAab,EAAUJ,EAAWgC,EAAS7G,KAAM4E,EAASM,IAC/F6D,GAAY,IAAA/G,cAAYZ,MAAO4H,EAAgBzC,KACnD,IAAI0C,EAAcvE,EACd4C,EAAe,GASnB,OARI,IAAAc,UAASY,KACXC,EAAcD,IAEZ,IAAA5C,UAAS4C,GACX1B,EAAe0B,GACN,IAAA5C,UAASG,KAClBe,EAAef,GAEbtB,EACK,WACL+B,EAAUzF,QAAU8F,EAAQ4B,EAAa3B,GAAc4B,MAAKnE,IAC1DgC,EAAexF,QAAU,UAClBwD,KACNvD,IAEDuF,EAAexF,QAAU,QACzBC,EAAMD,QAAUC,EACTA,KAET2F,UACaH,EAAUzF,SAXlB,GAcF8F,EAAQ4B,EAAa3B,EAAa,GACxC,CAACD,IACE8B,GAAU,IAAAtI,UAAQ,IAAMuE,OAAOgE,iBAAiB,CACpDC,MAAON,GACN,CACD/D,QAAS,CACP2D,IAAG,IACM3D,GAGXhF,KAAM,CACJ2I,IAAG,IACM3I,EAAKuB,SAGhBC,MAAO,CACLmH,IAAG,IACMnH,EAAMD,YAGf,CAACwH,IAUL,IAPA,IAAA7H,YAAU,KACR+F,EAAQ1F,SAAU,EACdoB,MAAMC,QAAQuC,IAAiBT,GACjCyE,EAAQE,MAAM3E,EAAUoB,EAAYS,MAE/B,IAAMU,EAAQ1F,SAAU,IAC9B4D,GACCF,GAAY+B,EAAUzF,QACxB,OAAQwF,EAAexF,SACrB,IAAK,UACH,MAAMyF,EAAUzF,QAElB,IAAK,QACH,MAAMC,EAAMD,QAGlB,OAAO6D,OAAOkE,OAAO,CAACH,EAASjC,EAAS3F,QAASyD,EAASxD,EAAMD,SAAU,CACxE4H,aACGA,EACHjC,SAAUA,EAAS3F,QACnBvB,KAAMA,EAAKuB,QACXyD,UACAxD,MAAOA,EAAMD,SAEjB,C,cEjGOH,eAAemI,EAAeC,EAAWC,GAE9C,aADM,EAAA1I,mBAAmB2I,WAAW,CAACF,KAC9B,IAAAG,WAAUH,EAAWC,EAC9B,CClBO,SAASG,IACd,MAAOC,EAAWC,IAAgB,IAAAxJ,WAAS,KAAM,IAAA2D,cAAa8F,iBAQ9D,OAPA,IAAA7I,YAAU,KACR,MAAMiD,EAAWV,IACfqG,EAAarG,EAAMC,OAAO,EAG5B,OADAC,OAAOC,iBAAiB,mBAAoBO,GACrC,IAAMR,OAAOE,oBAAoB,mBAAoBM,EAAS,GACpE,IACI0F,CACT,CC2CO,SAASG,EAAiBR,EAAWC,GAC1C,OAAO,IAAA5I,UAAQ,IACI,MAAb2I,GACkB,IAAAS,OAAK7I,UAAY,CACnC8I,cAAeX,EAAeC,EAAWC,OAGtC,MACN,CAACD,EAAWC,GACjB,C","sources":["webpack:///../../node_modules/@next-core/react-runtime/dist/esm/ReactUseBrick.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useCurrentTheme.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useRecentApps.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useCurrentApp.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useRouteRender.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useProvider/useProviderArgsDefaults.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useProvider/fetch.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useProvider/useProvider.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useProvider/useProviderArgs.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/asyncWrapBrick.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useNavConfig.js","webpack:///../../node_modules/@next-core/react-runtime/dist/esm/useLazyWrapBrick.js"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { __secret_internals, handleHttpError, getV2RuntimeFromDll } from \"@next-core/runtime\";\n// Note: always synchronize code in LegacyUseBrick:\n// `bricks/v2-adapter/src/data-providers/legacy-brick-kit/getLegacyUseBrick.ts`\nlet ReactUseBrick = function ReactUseBrick(_ref) {\n  let {\n    useBrick,\n    data,\n    errorBoundary,\n    refCallback,\n    ignoredCallback\n  } = _ref;\n  const [renderResult, setRenderResult] = useState(null);\n  const mountResult = useRef();\n  const [renderKey, setRenderKey] = useState();\n  const IdCounterRef = useRef(0);\n  const initialRenderId = useMemo(() => {\n    var _secret_internals$ge;\n    return (_secret_internals$ge = __secret_internals.getRenderId) === null || _secret_internals$ge === void 0 ? void 0 : _secret_internals$ge.call(__secret_internals);\n  }, []);\n  useEffect(() => {\n    let ignore = false;\n    async function init() {\n      try {\n        const newRender = await __secret_internals.renderUseBrick(useBrick, data, errorBoundary);\n        if (ignore) {\n          return;\n        }\n        setRenderResult(newRender);\n        setRenderKey(getUniqueId(IdCounterRef));\n      } catch (error) {\n        if (!ignore && isTheSameRender(initialRenderId)) {\n          // eslint-disable-next-line no-console\n          console.error(\"Render useBrick failed:\", useBrick, \"with data:\", data);\n          handleHttpError(error);\n        }\n      }\n    }\n    init();\n    return () => {\n      ignore = true;\n    };\n  }, [data, useBrick, initialRenderId, errorBoundary]);\n  const _refCallback = useCallback(element => {\n    if (element) {\n      mountResult.current = __secret_internals.mountUseBrick(\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      renderResult, element);\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      __secret_internals.unmountUseBrick(renderResult, mountResult.current);\n      mountResult.current = undefined;\n    }\n    refCallback === null || refCallback === void 0 || refCallback(element);\n  }, [refCallback, renderResult]);\n  if (!renderResult) {\n    // Fallback when loading/\n    return null;\n    // return <span>🌀 Loading...</span>;\n  }\n  const {\n    tagName\n  } = renderResult;\n  if (tagName === null) {\n    ignoredCallback === null || ignoredCallback === void 0 || ignoredCallback();\n    return null;\n  }\n  const WebComponent = tagName;\n  return /*#__PURE__*/React.createElement(WebComponent, {\n    key: renderKey,\n    ref: _refCallback\n  });\n};\nfunction getUniqueId(ref) {\n  return ++ref.current;\n}\nfunction isTheSameRender(initialRenderId) {\n  var _secret_internals$ge2;\n  const newRenderId = (_secret_internals$ge2 = __secret_internals.getRenderId) === null || _secret_internals$ge2 === void 0 ? void 0 : _secret_internals$ge2.call(__secret_internals);\n  return !initialRenderId || !newRenderId || initialRenderId === newRenderId;\n}\nlet ReactUseMultipleBricks = function ReactUseMultipleBricks(_ref2) {\n  let {\n    useBrick,\n    data,\n    errorBoundary\n  } = _ref2;\n  if (Array.isArray(useBrick)) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, useBrick.map((item, index) => /*#__PURE__*/React.createElement(ReactUseBrick, {\n      key: index,\n      useBrick: item,\n      data: data,\n      errorBoundary: errorBoundary\n    })));\n  }\n  return /*#__PURE__*/React.createElement(ReactUseBrick, {\n    useBrick: useBrick,\n    data: data,\n    errorBoundary: errorBoundary\n  });\n};\n\n// Make v3 bricks compatible with Brick Next v2.\n// istanbul ignore next\nconst v2Kit = getV2RuntimeFromDll();\n// istanbul ignore next\nif (v2Kit) {\n  const {\n    SingleBrickAsComponentFactory,\n    BrickAsComponentFactory\n  } = v2Kit;\n  if (SingleBrickAsComponentFactory && BrickAsComponentFactory) {\n    ReactUseBrick = SingleBrickAsComponentFactory(React);\n    ReactUseMultipleBricks = BrickAsComponentFactory(React);\n  }\n}\nexport { ReactUseBrick, ReactUseMultipleBricks };\n//# sourceMappingURL=ReactUseBrick.js.map","import { useEffect, useState } from \"react\";\nimport { getCurrentTheme } from \"@next-core/runtime\";\nexport function useCurrentTheme() {\n  const [currentTheme, setCurrentTheme] = useState(getCurrentTheme);\n  useEffect(() => {\n    const listenToThemeChange = event => {\n      setCurrentTheme(event.detail);\n    };\n    window.addEventListener(\"theme.change\", listenToThemeChange);\n    return () => {\n      window.removeEventListener(\"theme.change\", listenToThemeChange);\n    };\n  }, []);\n  return currentTheme;\n}\n//# sourceMappingURL=useCurrentTheme.js.map","import React from \"react\";\nimport { getRuntime } from \"@next-core/runtime\";\nexport function useRecentApps() {\n  const [recentApps, setRecentApps] = React.useState(() => getRuntime().getRecentApps());\n  React.useEffect(() => {\n    const listener = event => {\n      setRecentApps(event.detail);\n    };\n    window.addEventListener(\"app.change\", listener);\n    return () => window.removeEventListener(\"app.change\", listener);\n  }, []);\n  return recentApps;\n}\n//# sourceMappingURL=useRecentApps.js.map","import { useRecentApps } from \"./useRecentApps.js\";\n\n/**\n * 获取当前所在微应用信息的 React hooks。\n *\n * @example\n *\n * ```tsx\n * function MyReactComponent() {\n *   const app = useCurrentApp();\n *   return <div>{app.id}</div>;\n * }\n * ```\n *\n * @returns 当前所在微应用的信息。\n */\nexport function useCurrentApp() {\n  return useRecentApps().currentApp;\n}\n//# sourceMappingURL=useCurrentApp.js.map","import React from \"react\";\nexport function useRouteRender() {\n  const [routeRender, setRouteRender] = React.useState(null);\n  React.useEffect(() => {\n    const listener = event => {\n      setRouteRender(event.detail);\n    };\n    window.addEventListener(\"route.render\", listener);\n    return () => window.removeEventListener(\"route.render\", listener);\n  }, []);\n  return routeRender;\n}\n//# sourceMappingURL=useRouteRender.js.map","export const useProviderArgsDefaults = {\n  provider: \"\",\n  customOptions: {\n    onError: () => {\n      /* Do nothing.. */\n    },\n    transform: (oldData, newData) => newData,\n    data: undefined,\n    loading: false,\n    suspense: false,\n    cache: true\n  },\n  dependencies: undefined\n};\nexport default Object.entries(useProviderArgsDefaults).reduce((acc, _ref) => {\n  let [key, value] = _ref;\n  if (Object.prototype.toString.call(value) === \"[object Object]\") return {\n    ...acc,\n    ...value\n  };\n  return {\n    ...acc,\n    [key]: value\n  };\n}, {});\n//# sourceMappingURL=useProviderArgsDefaults.js.map","import { fetchByProvider } from \"@next-core/runtime\";\nconst cacheMap = new Map();\nfunction isObj(v) {\n  return typeof v === \"object\" && v !== null && !Array.isArray(v);\n}\nfunction isString(v) {\n  return typeof v === \"string\";\n}\nfunction buildSortedCacheKey(provider) {\n  const sortObj = obj => Object.keys(obj).sort().map(k => ({\n    [k]: obj[k]\n  }));\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  try {\n    const sortedArgs = isObj(args) ? sortObj(args) : args.map(arg => isString(arg) ? arg : sortObj(arg));\n    return JSON.stringify({\n      provider,\n      args: sortedArgs\n    });\n  } catch (e) {\n    return JSON.stringify({\n      provider,\n      args\n    });\n  }\n}\nexport default async function fetch(provider, cache, args) {\n  let promise;\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  const cacheKey = buildSortedCacheKey(provider, ...args);\n  !cache && cacheMap.has(cacheKey) && cacheMap.delete(cacheKey);\n  if (cacheMap.has(cacheKey)) {\n    promise = cacheMap.get(cacheKey);\n  } else {\n    promise = (() => {\n      return fetchByProvider(provider, args);\n    })();\n    cache && cacheMap.set(cacheKey, promise);\n  }\n  return promise;\n}\n//# sourceMappingURL=fetch.js.map","import { useCallback, useEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport useProviderArgs from \"./useProviderArgs.js\";\nimport { isObject, isString } from \"lodash\";\nimport fetch from \"./fetch.js\";\nexport function useProvider() {\n  const {\n    provider,\n    customOptions,\n    dependencies,\n    requestInit\n  } = useProviderArgs(...arguments);\n  const {\n    onError,\n    transform,\n    suspense,\n    cache,\n    ...defaults\n  } = customOptions;\n  const [loading, setLoading] = useState(defaults.loading);\n  const suspenseStatus = useRef(\"pending\");\n  const suspender = useRef();\n  const mounted = useRef(false);\n  const error = useRef();\n  const response = useRef();\n  const data = useRef(defaults.data);\n  const forceUpdate = useReducer(() => ({}), [])[1];\n  const doFetch = useCallback(async (provider, providerArgs) => {\n    try {\n      error.current = undefined;\n      if (!suspense) setLoading(true);\n      const newRes = await fetch(provider, cache, providerArgs);\n      response.current = newRes;\n      data.current = transform(data.current, newRes);\n    } catch (e) {\n      error.current = e;\n      data.current = undefined;\n    }\n    if (!suspense) setLoading(false);\n    if (error.current) onError(error.current);\n    return data.current;\n  }, [provider, customOptions, dependencies, requestInit, suspense, transform, defaults.data, onError, cache]);\n  const makeFetch = useCallback(async (providerOrBody, args) => {\n    let providerStr = provider;\n    let providerArgs = [];\n    if (isString(providerOrBody)) {\n      providerStr = providerOrBody;\n    }\n    if (isObject(providerOrBody)) {\n      providerArgs = providerOrBody;\n    } else if (isObject(args)) {\n      providerArgs = args;\n    }\n    if (suspense) {\n      return (async () => {\n        suspender.current = doFetch(providerStr, providerArgs).then(newData => {\n          suspenseStatus.current = \"success\";\n          return newData;\n        }, error => {\n          /* istanbul ignore next */\n          suspenseStatus.current = \"error\";\n          error.current = error;\n          return error;\n        });\n        forceUpdate();\n        return await suspender.current;\n      })();\n    }\n    return doFetch(providerStr, providerArgs);\n  }, [doFetch]);\n  const request = useMemo(() => Object.defineProperties({\n    query: makeFetch\n  }, {\n    loading: {\n      get() {\n        return loading;\n      }\n    },\n    data: {\n      get() {\n        return data.current;\n      }\n    },\n    error: {\n      get() {\n        return error.current;\n      }\n    }\n  }), [makeFetch]);\n\n  // onMount/onUpdate\n  useEffect(() => {\n    mounted.current = true;\n    if (Array.isArray(dependencies) && provider) {\n      request.query(provider, requestInit.args);\n    }\n    return () => mounted.current = false;\n  }, dependencies);\n  if (suspense && suspender.current) {\n    switch (suspenseStatus.current) {\n      case \"pending\":\n        throw suspender.current;\n      /* istanbul ignore next */\n      case \"error\":\n        throw error.current;\n    }\n  }\n  return Object.assign([request, response.current, loading, error.current], {\n    request,\n    ...request,\n    response: response.current,\n    data: data.current,\n    loading,\n    error: error.current\n  });\n}\n//# sourceMappingURL=useProvider.js.map","import { useMemo } from \"react\";\nimport defaults, { useProviderArgsDefaults } from \"./useProviderArgsDefaults.js\";\nimport { isObject } from \"lodash\";\nexport default function useProviderArgs(providerOrParamsOrGlobalOptions, globalOptionsOrDeps, deps) {\n  const provider = useMemo(() => {\n    if (typeof providerOrParamsOrGlobalOptions === \"string\") {\n      return providerOrParamsOrGlobalOptions;\n    }\n    return useProviderArgsDefaults.provider;\n  }, [providerOrParamsOrGlobalOptions, globalOptionsOrDeps]);\n  const options = useMemo(() => {\n    let localOptions = {};\n    if (isObject(providerOrParamsOrGlobalOptions)) {\n      localOptions = providerOrParamsOrGlobalOptions;\n    } else if (isObject(globalOptionsOrDeps)) {\n      localOptions = globalOptionsOrDeps;\n    }\n    return {\n      ...defaults,\n      ...localOptions\n    };\n  }, [providerOrParamsOrGlobalOptions, globalOptionsOrDeps]);\n  const requestInit = useMemo(() => {\n    const customOptionKeys = [...Object.keys(useProviderArgsDefaults), ...Object.keys(useProviderArgsDefaults.customOptions)];\n    const {\n      args = null,\n      ...restOptions\n    } = Object.keys(options).reduce((acc, key) => {\n      if (!customOptionKeys.includes(key)) acc[key] = options[key];\n      return acc;\n    }, {});\n    return {\n      options: {\n        ...restOptions\n      },\n      args\n    };\n  }, [options]);\n  const dependencies = useMemo(() => {\n    if (Array.isArray(globalOptionsOrDeps)) return globalOptionsOrDeps;\n    if (Array.isArray(deps)) return deps;\n    return defaults.dependencies;\n  }, [globalOptionsOrDeps, deps]);\n  const loading = options.loading || Array.isArray(dependencies);\n  const customOptions = useMemo(() => {\n    const customOptionKeys = Object.keys(useProviderArgsDefaults.customOptions);\n    const customOptions = customOptionKeys.reduce((opts, key) => {\n      opts[key] = options[key];\n      return opts;\n    }, {});\n    return {\n      ...customOptions,\n      loading\n    };\n  }, [options]);\n  return {\n    provider,\n    customOptions,\n    requestInit,\n    dependencies\n  };\n}\n//# sourceMappingURL=useProviderArgs.js.map","import { __secret_internals } from \"@next-core/runtime\";\nimport { wrapBrick } from \"@next-core/react-element\";\n\n/**\n * 使用异步加载的方式包装一个构件，可用于按条件渲染的构件依赖。\n *\n * 例如提供复杂弹层内容的按钮构件，其内容需要使用到一些大型构件，那么这些依赖可以使用 asyncWrapBrick，\n * 这样只有在需要时才会加载这些依赖的构件。\n */\n\n/**\n * 使用异步加载的方式包装一个构件，可用于按条件渲染的构件依赖。\n *\n * 例如提供复杂弹层内容的按钮构件，其内容需要使用到一些大型构件，那么这些依赖可以使用 asyncWrapBrick，\n * 这样只有在需要时才会加载这些依赖的构件。\n */\n\nexport async function asyncWrapBrick(brickName, eventsMapping) {\n  await __secret_internals.loadBricks([brickName]);\n  return wrapBrick(brickName, eventsMapping);\n}\n//# sourceMappingURL=asyncWrapBrick.js.map","import { useEffect, useState } from \"react\";\nimport { getRuntime } from \"@next-core/runtime\";\nexport function useNavConfig() {\n  const [navConfig, setNavConfig] = useState(() => getRuntime().getNavConfig());\n  useEffect(() => {\n    const listener = event => {\n      setNavConfig(event.detail);\n    };\n    window.addEventListener(\"navConfig.change\", listener);\n    return () => window.removeEventListener(\"navConfig.change\", listener);\n  }, []);\n  return navConfig;\n}\n//# sourceMappingURL=useNavConfig.js.map","import { lazy, useMemo } from \"react\";\nimport { asyncWrapBrick } from \"./asyncWrapBrick.js\";\n\n/**\n * 使用 `React.lazy` 包装一个异步加载的构件。\n *\n * ```jsx\n * const DepComponent = useLazyWrapBrick(\"async-dep\");\n * return (\n *   <Suspense fallback=\"Loading...\">\n *    <DepComponent {...props} />\n *   </Suspense>\n * );\n * ```\n */\n\n/**\n * 使用 `React.lazy` 包装一个异步加载的构件。\n *\n * ```jsx\n * const DepComponent = useLazyWrapBrick(\"async-dep\");\n * return (\n *   <Suspense fallback=\"Loading...\">\n *    <DepComponent {...props} />\n *   </Suspense>\n * );\n * ```\n */\n\n/**\n * 使用 `React.lazy` 包装一个异步加载的构件。\n *\n * ```jsx\n * const DepComponent = useLazyWrapBrick(\"async-dep\");\n * return (\n *   <Suspense fallback=\"Loading...\">\n *    <DepComponent {...props} />\n *   </Suspense>\n * );\n * ```\n */\n\n/**\n * 使用 `React.lazy` 包装一个异步加载的构件。\n *\n * ```jsx\n * const DepComponent = useLazyWrapBrick(\"async-dep\");\n * return (\n *   <Suspense fallback=\"Loading...\">\n *    <DepComponent {...props} />\n *   </Suspense>\n * );\n * ```\n */\n\nexport function useLazyWrapBrick(brickName, eventsMapping) {\n  return useMemo(() => {\n    if (brickName != null) {\n      return /*#__PURE__*/lazy(async () => ({\n        default: await asyncWrapBrick(brickName, eventsMapping)\n      }));\n    }\n    return null;\n  }, [brickName, eventsMapping]);\n}\n//# sourceMappingURL=useLazyWrapBrick.js.map"],"names":["ReactUseBrick","_ref","useBrick","data","errorBoundary","refCallback","ignoredCallback","renderResult","setRenderResult","useState","mountResult","useRef","renderKey","setRenderKey","IdCounterRef","initialRenderId","useMemo","_secret_internals$ge","__secret_internals","getRenderId","call","useEffect","ignore","async","newRender","renderUseBrick","current","error","_secret_internals$ge2","newRenderId","isTheSameRender","console","handleHttpError","init","_refCallback","useCallback","element","mountUseBrick","unmountUseBrick","undefined","tagName","WebComponent","key","ref","ReactUseMultipleBricks","_ref2","Array","isArray","map","item","index","v2Kit","getV2RuntimeFromDll","SingleBrickAsComponentFactory","BrickAsComponentFactory","useCurrentTheme","currentTheme","setCurrentTheme","getCurrentTheme","listenToThemeChange","event","detail","window","addEventListener","removeEventListener","useRecentApps","recentApps","setRecentApps","getRuntime","getRecentApps","listener","useCurrentApp","currentApp","useRouteRender","routeRender","setRouteRender","useProviderArgsDefaults","provider","customOptions","onError","transform","oldData","newData","loading","suspense","cache","dependencies","Object","entries","reduce","acc","value","prototype","toString","cacheMap","Map","useProvider","requestInit","providerOrParamsOrGlobalOptions","globalOptionsOrDeps","deps","options","localOptions","isObject","customOptionKeys","keys","args","restOptions","includes","opts","useProviderArgs","arguments","defaults","setLoading","suspenseStatus","suspender","mounted","response","forceUpdate","useReducer","doFetch","providerArgs","newRes","promise","cacheKey","sortObj","obj","sort","k","_len","length","_key","sortedArgs","v","arg","isString","JSON","stringify","e","buildSortedCacheKey","has","delete","get","fetchByProvider","set","fetch","makeFetch","providerOrBody","providerStr","then","request","defineProperties","query","assign","asyncWrapBrick","brickName","eventsMapping","loadBricks","wrapBrick","useNavConfig","navConfig","setNavConfig","getNavConfig","useLazyWrapBrick","lazy","default"],"sourceRoot":""}