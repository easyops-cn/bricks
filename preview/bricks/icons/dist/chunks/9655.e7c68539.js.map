{"version":3,"file":"chunks/9655.e7c68539.js","mappings":"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","sources":["webpack:///./src/data-providers/get-icons.ts","webpack:///./src/data-providers/get-libs.ts","webpack:///./src/data-providers/search-icons.ts","webpack:///./src/editors/eo-icon/eoIcon.schema.tsx","webpack:///./src/editors/eo-icon/index.tsx"],"sourcesContent":["import { createProviderClass } from \"@next-core/utils/general\";\n\nexport async function getEasyopsIcons(): Promise<Record<string, string[]>> {\n  return (await import(\"../easyops-icon/generated/icons.json\")).default;\n}\n\nexport async function getFaIcons(): Promise<Record<string, string[]>> {\n  return (await import(\"../fa-icon/generated/icons.json\")).default;\n}\n\nexport async function getAntdIcons(): Promise<Record<string, string[]>> {\n  return (await import(\"../antd-icon/generated/icons.json\")).default;\n}\n\ncustomElements.define(\n  \"icons.get-easyops-icons\",\n  createProviderClass(getEasyopsIcons)\n);\n\ncustomElements.define(\"icons.get-fa-icons\", createProviderClass(getFaIcons));\n\ncustomElements.define(\n  \"icons.get-antd-icons\",\n  createProviderClass(getAntdIcons)\n);\n","import { createProviderClass } from \"@next-core/utils/general\";\nimport { uniqBy } from \"lodash\";\nimport type { LibIconProps } from \"../general-icon/index.jsx\";\nimport { getEasyopsIcons, getFaIcons, getAntdIcons } from \"./get-icons.js\";\n\nexport interface IconInfo {\n  title: string;\n  icon: LibIconProps;\n  $searchTextPool: string[];\n}\n\nexport interface LibInfo {\n  title: string;\n  lib: string;\n  icons: IconInfo[];\n}\n\nexport async function getLibs(): Promise<LibInfo[]> {\n  const easyopsIconLib = getEasyopsIcons().then((allIcons) => {\n    const iconInfoList: IconInfo[] = [];\n    Object.entries(allIcons).forEach(([category, icons]) => {\n      icons.forEach((iconName) => {\n        iconInfoList.push({\n          title: iconName,\n          icon: {\n            lib: \"easyops\",\n            category,\n            icon: iconName,\n          },\n          $searchTextPool: [iconName, category],\n        });\n      });\n    });\n    return { title: \"easyops\", lib: \"easyops\", icons: iconInfoList };\n  });\n\n  const faIconLib = Promise.all([\n    getFaIcons(),\n    import(\"../fa-icon/generated/alias.json\"),\n  ]).then(([allIcons, { default: aliasMapByCategory }]) => {\n    const iconAliasMapByPrefix: Record<string, Record<string, string[]>> = {};\n    Object.entries(\n      aliasMapByCategory as Record<string, Record<string, string>>\n    ).forEach(([prefix, aliasesMap]) => {\n      iconAliasMapByPrefix[prefix] = {};\n      Object.entries(aliasesMap).forEach(([alias, iconName]) => {\n        iconAliasMapByPrefix[prefix][iconName]\n          ? iconAliasMapByPrefix[prefix][iconName].push(alias)\n          : (iconAliasMapByPrefix[prefix][iconName] = [alias]);\n      });\n    });\n\n    const iconInfoList: IconInfo[] = [];\n    Object.entries(allIcons).forEach(([prefix, icons]) => {\n      icons.forEach((iconName) => {\n        if (\n          (aliasMapByCategory as Record<string, Record<string, string>>)[\n            prefix\n          ][iconName]\n        )\n          return;\n        const aliases = iconAliasMapByPrefix[prefix][iconName] || [];\n        iconInfoList.push({\n          title: iconName,\n          icon: {\n            lib: \"fa\",\n            prefix,\n            icon: iconName,\n          },\n          $searchTextPool: [iconName, prefix, ...aliases],\n        });\n      });\n    });\n    return {\n      title: \"font awesome\",\n      lib: \"fa\",\n      icons: uniqBy(iconInfoList, \"title\"),\n    };\n  });\n\n  const antdIconLib = getAntdIcons().then((allIcons) => {\n    const iconInfoList: IconInfo[] = [];\n    Object.entries(allIcons).forEach(([theme, icons]) => {\n      icons.forEach((iconName) => {\n        iconInfoList.push({\n          title: iconName,\n          icon: {\n            lib: \"antd\",\n            theme,\n            icon: iconName,\n          },\n          $searchTextPool: [iconName, theme],\n        });\n      });\n    });\n    return { title: \"ant design\", lib: \"antd\", icons: iconInfoList };\n  });\n\n  return Promise.all([easyopsIconLib, antdIconLib, faIconLib]);\n}\n\ncustomElements.define(\"icons.get-libs\", createProviderClass(getLibs));\n","// Merge bricks\nimport { createProviderClass } from \"@next-core/utils/general\";\nimport { getLibs, type IconInfo } from \"./get-libs.js\";\nimport \"./get-libs.js\";\nimport \"./get-icons.js\";\n\nexport interface SearchParams {\n  q?: string;\n  lib?: string;\n  page?: number;\n  pageSize?: number;\n}\n\nexport interface SearchResult {\n  list: IconInfo[];\n  page: number;\n  pageSize: number;\n  total: number;\n}\n\nexport async function searchIcons(\n  params?: SearchParams\n): Promise<SearchResult> {\n  const { q = \"\", lib, page = 1, pageSize = 20 } = params || {};\n  const lq = q.trim().toLowerCase();\n\n  const iconInfoList = (await getLibs()).flatMap((v) =>\n    !lib || v.lib === lib ? v.icons : []\n  );\n\n  const filteredList = iconInfoList\n    .filter((iconInfo) =>\n      iconInfo.$searchTextPool.some((searchText) =>\n        searchText.toLowerCase().includes(lq)\n      )\n    )\n    .slice((page - 1) * pageSize, page * pageSize);\n\n  return {\n    page,\n    pageSize,\n    list: filteredList,\n    total: filteredList.length,\n  };\n}\n\ncustomElements.define(\"icons.search-icons\", createProviderClass(searchIcons));\n","export const eoIconSchema = {\n  name: \"layout\",\n  type: \"void\",\n  component: {\n    name: \"FormLayout\",\n    props: {\n      layout: \"vertical\",\n    },\n  },\n  children: [\n    {\n      name: \"categoryTitle_basic\",\n      type: \"void\",\n      decorator: {\n        name: \"CategoryTitle\",\n        props: {\n          text: \"基础\",\n        },\n      },\n    },\n    {\n      name: \"icon\",\n      title: \"图标\",\n      type: \"string\",\n      component: \"IconSelect\",\n    },\n  ],\n};\n","import type _React from \"react\";\nimport { customEditors } from \"@next-core/runtime\";\nimport type { EditorComponentProps } from \"@next-shared/property-editor\";\nimport { eoIconSchema } from \"./eoIcon.schema\";\nimport { pick } from \"lodash\";\n\nfunction EoIconComponentFactory(React: typeof _React) {\n  return function EoIconComponent(\n    props: EditorComponentProps\n  ): React.ReactElement {\n    const {\n      SchemaFieldComponent,\n      formilySchemaFormatter,\n      scope,\n      form,\n      effects,\n    } = props;\n\n    React.useEffect(() => {\n      const { onSubmit, onAdvancedChange } = effects;\n\n      form.addEffects(\"submit\", () => {\n        onAdvancedChange((advancedMode: boolean, form: any) => {\n          const rawValue = form.getState()?.values ?? {};\n          if (advancedMode) {\n            return {\n              ...(rawValue?.icon ?? {}),\n            };\n          } else {\n            return {\n              icon: pick(rawValue[\"#advanced_form\"], [\n                \"lib\",\n                \"theme\",\n                \"icon\",\n                \"category\",\n                \"prefix\",\n                \"color\",\n              ]),\n            };\n          }\n        });\n        onSubmit((value: any) => {\n          return {\n            ...(value?.icon ?? {}),\n            ...value,\n          };\n        });\n      });\n    }, [form, effects]);\n\n    return React.createElement(SchemaFieldComponent, {\n      schema: formilySchemaFormatter(eoIconSchema as any),\n      scope,\n    });\n  };\n}\n\ncustomEditors.define(\"eo-icon\", EoIconComponentFactory);\n"],"names":["async","getEasyopsIcons","default","getFaIcons","getAntdIcons","getLibs","easyopsIconLib","then","allIcons","iconInfoList","Object","entries","forEach","_ref","category","icons","iconName","push","title","icon","lib","$searchTextPool","faIconLib","Promise","all","_ref2","aliasMapByCategory","iconAliasMapByPrefix","_ref3","prefix","aliasesMap","_ref4","alias","_ref5","aliases","uniqBy","antdIconLib","_ref6","theme","customElements","define","createProviderClass","params","q","page","pageSize","lq","trim","toLowerCase","filteredList","flatMap","v","filter","iconInfo","some","searchText","includes","slice","list","total","length","eoIconSchema","name","type","component","props","layout","children","decorator","text","customEditors","React","SchemaFieldComponent","formilySchemaFormatter","scope","form","effects","useEffect","onSubmit","onAdvancedChange","addEffects","advancedMode","_form$getState","rawValue","getState","values","pick","value","createElement","schema"],"sourceRoot":""}