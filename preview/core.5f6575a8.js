(globalThis.webpackChunk_next_core_preview=globalThis.webpackChunk_next_core_preview||[]).push([[114],{4701:()=>{void 0===Element.prototype.replaceChildren&&(Element.prototype.replaceChildren=function(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length>0&&this.append(...arguments)}),void 0===DocumentFragment.prototype.replaceChildren&&(DocumentFragment.prototype.replaceChildren=function(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length>0&&this.append(...arguments)})},2779:(e,t,n)=>{"use strict";var r=n(4596),o=n(8612),i=n(4197),s=n(5253),a=n(8679),c=(n(4829),n(2445)),l=n(6458);const u=/^\[\w+\]$/;function d(e){for(const t of e)p(t)}function p(e){let t=e.slots;const n=new Map;if(Array.isArray(e.children)&&!t){const t=[];for(const r of e.children){const e=r.slot??"";if(u.test(e)){delete r.slot;const o=n.get(e);o?o.push(r):n.set(e,[r]),t.push(r)}p(r)}(0,c.pull)(e.children,...t)}else{t??(t={});for(const[e,r]of Object.entries(t)){if(u.test(e)){const{bricks:o}=r;Array.isArray(o)&&o.length>0&&(n.set(e,o),d(o)),delete t[e]}Array.isArray(r.bricks)&&d(r.bricks)}}n.size>0&&f(e.properties,n)}function f(e,t){if(Array.isArray(e))for(const n of e)f(n,t);else if((0,l.isObject)(e))for(const[n,r]of Object.entries(e))if("useChildren"===n){const o=t.get(r);o&&(delete e[n],e.useBrick=1===o.length?o[0]:o)}else f(r,t)}function h(e,t){var n;null!==(n=t.options)&&void 0!==n&&null!==(n=n.interceptorParams)&&void 0!==n&&n.ignoreLoadingBar||window.dispatchEvent(new Event(e))}n(4701),o.http.interceptors.request.use((e=>(h("request.start",e),e))),o.http.interceptors.response.use((function(e,t){return h("request.end",t),e}),(function(e,t){return h("request.end",t),Promise.reject(e)}));const m=document.querySelector("#global-loading-bar");m.classList.add("rendered");let g=!1,v=0;function y(){const e=v>0;e!==g&&(g=e,m.classList[e?"add":"remove"]("loading"))}window.addEventListener("request.start",(()=>{v++,y()})),window.addEventListener("request.end",(()=>{v>0&&(v--,y())}));const w=(0,r.createRuntime)(),E=document.querySelector("#preview-root"),b=document.querySelector("#portal-mount-point"),S=(0,r.unstable_createRoot)(E,{portal:b,scope:"page",unknownBricks:"silent"}),A=o.http.get(window.BOOTSTRAP_FILE,{responseType:"json"}).then((e=>{w.initialize(window.BOOTSTRAP_FILE_FIELD?(0,c.get)(e,window.BOOTSTRAP_FILE_FIELD):e)}));let k,I=!1;async function P(e){I=!0;try{const{type:t,sources:n,options:o}=e;await async function(e,t){let{yaml:n,html:o}=t,{theme:i,uiVersion:c,language:l,context:u,functions:p,templates:f,i18n:h,url:m,app:g,styleText:v,templatesAreArrayOfYaml:y}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(O||(O=!0,document.body.classList.add("bootstrap-ready"),(0,r.applyTheme)("light"===i?i:"dark-v2")),document.body.classList.remove("bootstrap-error"),"html"===e){(0,r.applyTheme)("light"===i?i:"dark-v2"),(0,r.setUIVersion)(c),l&&await s.i18n.changeLanguage(l);const e=(new DOMParser).parseFromString(o,"text/html"),t=new Set;for(const n of e.body.querySelectorAll("*"))if(n.tagName.includes("-")){const e=n.tagName.toLowerCase();t.add(e)}else if("SCRIPT"===n.tagName){const e=n.text.matchAll(/\bdocument\.createElement\(\s*"([a-zA-Z0-9.]+-[-a-zA-Z0-9.]+)"\s*\)/g);for(const n of e)t.add(n[1])}await A,await w.loadBricks(t),E.replaceChildren(),b.replaceChildren();const n=[],a=e.querySelectorAll("script");for(const e of a){const t=document.createElement("script");t.text=e.text,t.type="module",n.push(t),e.remove()}E.append(...e.head.querySelectorAll("style"),...e.body.childNodes,...n)}else{const e=n?(0,a.safeLoad)(n,{schema:a.JSON_SCHEMA,json:!0}):null,t=[].concat(e??[]);d(t),v&&t.push({brick:"style",portal:!0,properties:{textContent:v}});const r=C(u),o=C(p),s=C(f,y),w=C(h);if(Array.isArray(s))for(const e of s)Array.isArray(e.bricks)&&d(e.bricks);await A,await S.render(t,{theme:"light"===i?i:"dark-v2",uiVersion:c,language:l,context:r,functions:o,templates:s,i18n:w,url:m,app:g})}}catch(e){console.error("Render failed:",e),document.body.classList.add("bootstrap-error"),b.textContent="",E.textContent=`Render failed: ${String(e)}`}}(t,n,o)}finally{if(I=!1,k){const e=k;k=void 0,P(e)}}}window._preview_only_render=(e,t,n)=>{I?k={type:e,sources:t,options:n}:P({type:e,sources:t,options:n})},window._preview_only_inject=async(e,t,n,r)=>{if(await(0,i.loadBricksImperatively)([e],[].concat(t)),r)return;const o=document.createElement(e);await o.resolve(n)};let O=!1;function C(e,t){return"string"==typeof e?(0,a.safeLoad)(e,{schema:a.JSON_SCHEMA,json:!0}):t?e.map((e=>"string"==typeof e.yaml?{...(0,a.safeLoad)(e.yaml,{schema:a.JSON_SCHEMA,json:!0}),name:e.name}:e)):e}},4712:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__dev_only_clearGlobalExecutionContextStack:()=>W,__dev_only_getGlobalExecutionContextStack:()=>K,clearExpressionASTCache:()=>se,clearFunctionASTCache:()=>ee,cook:()=>q,isEvaluable:()=>re,isTrackAll:()=>ie,precook:()=>X,precookFunction:()=>Z,preevaluate:()=>ne,shouldAllowRecursiveEvaluations:()=>oe});var r=n(4586);let o=function(e){return e[e.LEXICAL=0]="LEXICAL",e[e.STRICT=1]="STRICT",e}({});const i=Symbol.for("SourceNode"),s=Symbol.for("FormalParameters"),a=Symbol.for("ECMAScriptCode"),c=Symbol.for("Environment"),l=Symbol.for("IsConstructor"),u=Symbol.for("ThisMode"),d=Symbol.for("$DebuggerCall$"),p=Symbol.for("$DebuggerScope$"),f=Symbol.for("$DebuggerNode$"),h=Symbol.for("$DebuggerReturn$");class m{constructor(){(0,r.A)(this,"VariableEnvironment",void 0),(0,r.A)(this,"LexicalEnvironment",void 0),(0,r.A)(this,"Function",void 0)}}let g=function(e){return e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.LEXICAL=1]="LEXICAL",e[e.INITIALIZED=2]="INITIALIZED",e}({});class v{constructor(e){(0,r.A)(this,"OuterEnv",void 0),(0,r.A)(this,"bindingMap",new Map),(0,r.A)(this,"ThisValue",void 0),(0,r.A)(this,"ThisBindingStatus",void 0),this.OuterEnv=e}HasBinding(e){return this.bindingMap.has(e)}CreateMutableBinding(e,t){return this.bindingMap.set(e,{mutable:!0,deletable:t}),S(void 0)}CreateImmutableBinding(e,t){return this.bindingMap.set(e,{strict:t}),S(void 0)}InitializeBinding(e,t){const n=this.bindingMap.get(e);return Object.assign(n,{initialized:!0,value:t}),S(void 0)}SetMutableBinding(e,t,n){const r=this.bindingMap.get(e);if(!r.initialized)throw new ReferenceError(`${e} is not initialized`);if(!r.mutable)throw new TypeError("Assignment to constant variable");return r.value=t,S(void 0)}GetBindingValue(e,t){const n=this.bindingMap.get(e);if(!n.initialized)throw new ReferenceError(`${e} is not initialized`);return n.value}HasThisBinding(){return!1}}class y extends v{}class w extends v{constructor(e){super(e[c]),e[u]===o.LEXICAL?this.ThisBindingStatus=g.LEXICAL:this.ThisBindingStatus=g.UNINITIALIZED}HasThisBinding(){return this.ThisBindingStatus!==g.LEXICAL}BindThisValue(e){if(this.ThisBindingStatus===g.INITIALIZED)throw new Error("This binding has been initialized");this.ThisValue=e,this.ThisBindingStatus=g.INITIALIZED}GetThisBinding(){if(this.ThisBindingStatus===g.UNINITIALIZED)throw new Error("This binding is not initialized");return this.ThisValue}}class E{constructor(e,t,n){(0,r.A)(this,"Base",void 0),(0,r.A)(this,"ReferenceName",void 0),(0,r.A)(this,"Strict",void 0),this.Base=e,this.ReferenceName=t,this.Strict=n}}class b{constructor(e,t){(0,r.A)(this,"Type",void 0),(0,r.A)(this,"Value",void 0),this.Type=e,this.Value=t}}function S(e){return new b("normal",e)}const A=Symbol("empty completion");function k(e){const t=new Set,n=e=>{if(Array.isArray(e))for(const t of e)n(t);else if(e)switch(e.type){case"Identifier":return void t.add(e.name);case"VariableDeclaration":return n(e.declarations);case"VariableDeclarator":case"FunctionDeclaration":return n(e.id);case"ArrayPattern":return n(e.elements);case"AssignmentPattern":return n(e.left);case"ObjectPattern":return n(e.properties);case"Property":return n(e.value);case"RestElement":return n(e.argument)}};return n(e),Array.from(t)}function I(e){const t=e=>{if(Array.isArray(e))return e.some(t);if(e)switch(e.type){case"ArrayPattern":return t(e.elements);case"AssignmentPattern":return!0;case"ObjectPattern":return t(e.properties);case"Property":return e.computed||t(e.value);case"RestElement":return t(e.argument)}};return t(e)}function P(e,t){const n=[],r={var:t.var},o=(e,t)=>{if(Array.isArray(e))for(const n of e)o(n,t);else if(e){switch(e.type){case"FunctionDeclaration":return void(Number(!t.var)^Number(t.topLevel)&&n.push(e));case"VariableDeclaration":return void(Number(!t.var)^Number("var"===e.kind)&&n.push(e));case"SwitchCase":return void o(e.consequent,r);case"CatchClause":return void o(e.body,r)}if(t.var)switch(e.type){case"BlockStatement":case"DoWhileStatement":case"WhileStatement":return void o(e.body,r);case"IfStatement":return o(e.consequent,r),void o(e.alternate,r);case"ForStatement":return o(e.init,r),void o(e.body,r);case"ForInStatement":case"ForOfStatement":return o(e.left,r),void o(e.body,r);case"SwitchStatement":return void o(e.cases,r);case"TryStatement":return o(e.block,r),o(e.handler,r),void o(e.finalizer,r)}}};return o(e,t),n}function O(e){return"unresolvable"!==e.Base&&!(e.Base instanceof v)}function C(e,t){return e.Base.InitializeBinding(e.ReferenceName,t)}function x(e,t,n){if(null==t)return e;const r=Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t));for(const o of r)if(!n.has(o)){const n=Object.getOwnPropertyDescriptor(t,o);null!=n&&n.enumerable&&(e[o]=t[o])}return e}function T(e,t){const n="const"===e.kind;for(const r of k(e))n?t.CreateImmutableBinding(r,!0):t.CreateMutableBinding(r,!1)}function R(e){return"normal"===e.Type||"continue"==e.Type}function L(e,t){return e.Value!==A?e:new b(e.Type,t)}function _(e){if(e instanceof b&&(e=e.Value),!(e instanceof E))return e;if("unresolvable"===e.Base)throw new ReferenceError(`${e.ReferenceName} is not defined`);return e.Base instanceof v?e.Base.GetBindingValue(e.ReferenceName,e.Strict):e.Base[e.ReferenceName]}function B(e){return"symbol"==typeof e?e:String(e)}function M(e,t){return e[t]}function $(e,t){if("unresolvable"===e.Base)throw new ReferenceError(`${e.ReferenceName} is not defined`);return e.Base instanceof v?e.Base.SetMutableBinding(e.ReferenceName,t,e.Strict):(e.Base[e.ReferenceName]=t,S(void 0))}function N(e){if(t=e,!(Array.isArray(t)||null!=t&&"function"==typeof t[Symbol.iterator]))throw new TypeError(typeof e+" is not iterable");var t;return e[Symbol.iterator]()}function U(e){if(null==e)throw new TypeError("Cannot destructure properties of undefined or null")}function F(e,t,n){return e?e.HasBinding(t)?new E(e,t,n):F(e.OuterEnv,t,n):new E("unresolvable",t,n)}function j(e,t,n){switch(t){case"+":return e+n;case"-":return e-n;case"/":return e/n;case"%":return e%n;case"*":return e*n;case"**":return e**n;case"==":return e==n;case"===":return e===n;case"!=":return e!=n;case"!==":return e!==n;case">":return e>n;case"<":return e<n;case">=":return e>=n;case"<=":return e<=n;case"in":return e in n}throw new SyntaxError(`Unsupported binary operator \`${t}\``)}const V=new WeakSet([Function,Object,Function.prototype,Object.prototype,function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}()]),D=new WeakSet([Array,Map,Set,URL,URLSearchParams,WeakMap,WeakSet,RegExp]),H=[];function W(){H.length=0}function K(){return H}function q(e,t){var n;let{rules:r,debug:g,externalSourceForDebug:v,globalVariables:W={},ArrayConstructor:K=Array,hooks:q={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const G="FunctionDeclaration"!==e.type;function J(e){v||function(e){if(V.has(e))throw new TypeError("Cannot access reserved objects such as `Function`.")}(e)}const X=new y(null),Y=new m;Y.VariableEnvironment=X,Y.LexicalEnvironment=X;const Q=[Y];for(const[e,t]of Object.entries(W))X.CreateImmutableBinding(e,!0),X.InitializeBinding(e,t);const Z=new WeakMap;let ee;function*te(e,n,r){var o,i;switch(null===(o=q.beforeEvaluate)||void 0===o||o.call(q,e),ee=e,g&&(r||e.type.endsWith("Statement")&&("ExpressionStatement"!==e.type||"CallExpression"!==e.expression.type&&"TaggedTemplateExpression"!==e.expression.type)&&"TryStatement"!==e.type&&"BlockStatement"!==e.type&&"DoWhileStatement"!==e.type&&"WhileStatement"!==e.type&&"ForStatement"!==e.type&&"ForInStatement"!==e.type&&"ForOfStatement"!==e.type)&&(yield),e.type){case"ArrayExpression":{const t=new K;for(const n of e.elements)if(n)if("SpreadElement"===n.type){const e=_(yield*te(n.argument));t.push(...e)}else t.push(_(yield*te(n)));else t.length+=1;return S(t)}case"ArrowFunctionExpression":return Ce(e),S(Ee(e));case"BinaryExpression":{const n=_(yield*te(e.left)),r=yield*te(e.right),o=_(r);if(G&&"|>"===e.operator){if("function"!=typeof o){const n=t.substring(e.right.start,e.right.end);throw new TypeError(`${n} is not a function`)}let i;return r instanceof E&&O(r)&&(i=r.Base),S(o.call(i,n))}return S(j(n,e.operator,o))}case"CallExpression":{const t=(yield*te(e.callee,n)).Value,r=_(t);return null==r&&(e.optional||null!=n&&n.skipped)?(n.skipped=!0,S(void 0)):(J(r),g&&(yield),yield*pe(r,t,e.arguments,e.callee))}case"ChainExpression":return yield*te(e.expression,{});case"ConditionalExpression":return S(_(yield*te(_(yield*te(e.test))?e.consequent:e.alternate)));case"Identifier":return S(re(e.name));case"Literal":if(e.regex){if(null===e.value)throw new SyntaxError(`Invalid regular expression: ${e.raw}`);if(e.regex.flags.includes("u"))throw new SyntaxError(`Unsupported unicode flag in regular expression: ${e.raw}`);return S(new RegExp(e.regex.pattern,e.regex.flags))}return S(e.value);case"LogicalExpression":{const t=_(yield*te(e.left));switch(e.operator){case"&&":return S(t&&_(yield*te(e.right)));case"||":return S(t||_(yield*te(e.right)));case"??":return S(t??_(yield*te(e.right)));default:throw new SyntaxError(`Unsupported logical operator '${e.operator}'`)}}case"MemberExpression":{const t=_((yield*te(e.object,n)).Value);if(null==t&&(e.optional||null!=n&&n.skipped))return n.skipped=!0,S(void 0);J(t);const r=e.computed?yield*function*(e,t,n){const r=B(_(yield*te(t)));return new E(e,r,!0)}(t,e.property):function(e,t,n){ee=t;const r=t.name;return new E(e,r,!0)}(t,e.property);return J(r),S(r)}case"NewExpression":return yield*function*(e,n){const r=_(yield*te(e)),o=yield*fe(n);if("function"!=typeof r||!1===r[l]){const n=t.substring(e.start,e.end);throw new TypeError(`${n} is not a constructor`)}if(!v&&!function(e){return D.has(e)||e===Date}(r)&&r!==K){const n=t.substring(e.start,e.end);throw new TypeError(`${n} is not an allowed constructor`)}return S(new r(...o))}(e.callee,e.arguments);case"ObjectExpression":{const t={};for(const n of e.properties)if("SpreadElement"===n.type)x(t,_(yield*te(n.argument)),new Set);else{if("init"!==n.kind)throw new SyntaxError("Unsupported object getter/setter");const e=n.computed||"Identifier"!==n.key.type?yield*ke(n.key):n.key.name;if("__proto__"===e)throw new TypeError("Setting '__proto__' property is not allowed");const r=_(yield*te(n.value));n.method&&"function"==typeof r&&be(r,e),t[e]=r}return S(t)}case"SequenceExpression":{let t;for(const n of e.expressions)t=S(_(yield*te(n)));return t}case"TemplateLiteral":{const t=[e.quasis[0].value.cooked];let n=0;for(const r of e.expressions){const o=_(yield*te(r));t.push(String(o)),t.push(e.quasis[n+=1].value.cooked)}return S(t.join(""))}case"TaggedTemplateExpression":{const t=(yield*te(e.tag)).Value,n=_(t);return J(n),g&&(yield),yield*pe(n,t,e.quasi,e.tag)}case"UnaryExpression":{const t=(yield*te(e.argument)).Value;if(!G&&"delete"===e.operator){if(!(t instanceof E))return S(!0);if(O(t))return S(delete t.Base[t.ReferenceName])}return"typeof"===e.operator?t instanceof E&&"unresolvable"===t.Base?S("undefined"):S(typeof _(t)):S(function(e,t){switch(t){case"!":return!e;case"+":return+e;case"-":return-e;case"void":return}throw new SyntaxError(`Unsupported unary operator \`${t}\``)}(_(t),e.operator))}}if(!G)switch(e.type){case"AssignmentExpression":{if("="===e.operator){if("ArrayPattern"!==e.left.type&&"ObjectPattern"!==e.left.type){const t=(yield*te(e.left)).Value;let n;return n=ge(e.right)&&"Identifier"===e.left.type?ve(e.right,e.left.name):_(yield*te(e.right)),$(t,n),S(n)}const t=_(yield*te(e.right));return yield*ce(e.left,t),S(t)}const t=(yield*te(e.left)).Value,n=_(t),r=_(yield*te(e.right)),o=function(e,t,n){switch(t){case"+=":case"-=":case"*=":case"/=":case"%=":case"**=":return j(e,t.substr(0,t.length-1),n)}throw new SyntaxError(`Unsupported assignment operator \`${t}\``)}(n,e.operator,r);return $(t,o),S(o)}case"BlockStatement":{if(!e.body.length)return S(A);const t=ne().LexicalEnvironment,n=new y(t);de(e.body,n),ne().LexicalEnvironment=n;const r=yield*me(e.body);return ne().LexicalEnvironment=t,r}case"BreakStatement":return new b("break",A);case"ContinueStatement":return new b("continue",A);case"EmptyStatement":case"FunctionDeclaration":return S(A);case"DoWhileStatement":return oe(yield*function*(e){let t;for(;;){const n=yield*te(e.body);if(!R(n))return L(n,t);if(n.Value!==A&&(t=n.Value),!_(yield*te(e.test,void 0,!0)))return S(t)}}(e));case"ExpressionStatement":case"TSAsExpression":return yield*te(e.expression);case"ForInStatement":case"ForOfStatement":return oe(yield*function*(e){const t=e.left,n="VariableDeclaration"===t.type?"var"===t.kind?"varBinding":"lexicalBinding":"assignment",r="lexicalBinding"===n?k(t):[],o="ForInStatement"===e.type?"enumerate":"iterate",i=yield*function*(e,t,n){const r=ne(),o=r.LexicalEnvironment;if(e.length>0){const t=new y(o);for(const n of e)t.CreateMutableBinding(n,!1);r.LexicalEnvironment=t}const i=yield*te(t,void 0,!0);r.LexicalEnvironment=o;const s=_(i);return"enumerate"===n?null==s?new b("break",A):S(function*(e){for(const t in e)yield t}(s)):S(N(s))}(r,e.right,o);return"normal"!==i.Type?i:yield*function*(e,t,n,r,o){const i="assignment"===o?e:e.declarations[0].id,s=ne().LexicalEnvironment;let a;const c="ObjectPattern"===i.type||"ArrayPattern"===i.type;for(;;){ee=i;const{done:l,value:u}=n.next();if(l)return g&&(yield),S(a);let d,p;if("lexicalBinding"===o){if(p=new y(s),T(e,p),ne().LexicalEnvironment=p,g&&(yield),!c){const[e]=k(i);d=re(e)}}else g&&(yield),c||(d=(yield*te(i)).Value);c?"assignment"===o?yield*ce(i,u):"varBinding"===o?yield*Ae(i,u,void 0):yield*Ae(i,u,p):"lexicalBinding"===o?C(d,u):$(d,u);const f=yield*te(t);if(ne().LexicalEnvironment=s,!R(f)){const e=L(f,a);if("enumerate"!==r&&void 0!==n.return){const e=n.return();if(!e||!["object","function"].includes(typeof e))throw new TypeError("Iterator result is not an object")}return e}f.Value!==A&&(a=f.Value)}}(t,e.body,i.Value,o,n)}(e));case"ForStatement":return oe(yield*function*(e){var t;if("VariableDeclaration"===(null===(t=e.init)||void 0===t?void 0:t.type)){if("var"===e.init.kind)return yield*te(e.init),yield*se(e.test,e.update,e.body,[]);const t=ne().LexicalEnvironment,n=new y(t),r="const"===e.init.kind,o=k(e.init);for(const e of o)r?n.CreateImmutableBinding(e,!0):n.CreateMutableBinding(e,!1);ne().LexicalEnvironment=n,yield*te(e.init);const i=r?[]:Array.from(o),s=yield*se(e.test,e.update,e.body,i);return ne().LexicalEnvironment=t,s}return e.init&&_(yield*te(e.init)),yield*se(e.test,e.update,e.body,[])}(e));case"FunctionExpression":return Ce(e),S(we(e));case"IfStatement":var s;return _(yield*te(e.test))?(null===(s=q.beforeBranch)||void 0===s||s.call(q,e,"if"),L(yield*te(e.consequent),void 0)):(null===(i=q.beforeBranch)||void 0===i||i.call(q,e,"else"),e.alternate?L(yield*te(e.alternate),void 0):S(void 0));case"ReturnStatement":{let t;return e.argument&&(t=_(yield*te(e.argument))),new b("return",t)}case"ThisExpression":if(!v)break;return S(function(){let e=ne().LexicalEnvironment;for(;e;){if(e.HasThisBinding())return e;e=e.OuterEnv}throw new Error("Accessing global this is forbidden")}().GetThisBinding());case"ThrowStatement":throw _(yield*te(e.argument));case"UpdateExpression":{const t=(yield*te(e.argument)).Value,n=Number(_(t)),r="++"===e.operator?n+1:n-1;return $(t,r),S(e.prefix?r:n)}case"SwitchCase":return yield*me(e.consequent);case"SwitchStatement":{const t=_(yield*te(e.discriminant)),n=ne().LexicalEnvironment,r=new y(n);de(e.cases,r),ne().LexicalEnvironment=r;const o=yield*function*(e,t){let n;const r=e.findIndex((e=>!e.test)),o=r>=0,i=o?e.slice(0,r):e;let s=!1;for(const e of i)if(s||(s=yield*ie(e,t)),s){const t=yield*te(e);if(t.Value!==A&&(n=t.Value),"normal"!==t.Type)return L(t,n)}if(!o)return S(n);let a=!1;const c=e.slice(r+1);if(!s)for(const e of c)if(a||(a=yield*ie(e,t)),a){const t=yield*te(e);if(t.Value!==A&&(n=t.Value),"normal"!==t.Type)return L(t,n)}if(a)return S(n);const l=yield*te(e[r]);if(l.Value!==A&&(n=l.Value),"normal"!==l.Type)return L(l,n);for(const e of c){const t=yield*te(e);if(t.Value!==A&&(n=t.Value),"normal"!==t.Type)return L(t,n)}return S(n)}(e.cases,t);return ne().LexicalEnvironment=n,oe(o)}case"TryStatement":{let t;try{t=yield*te(e.block)}catch(n){if(!e.handler)throw n;var a;ee=e.handler,null===(a=q.beforeEvaluate)||void 0===a||a.call(q,e.handler),t=yield*function*(e,t){if(!e.param)return yield*te(e.body);const n=ne().LexicalEnvironment,r=new y(n);for(const t of k(e.param))r.CreateMutableBinding(t,!1);ne().LexicalEnvironment=r,yield*Ae(e.param,t,r);const o=yield*te(e.body);return ne().LexicalEnvironment=n,o}(e.handler,n)}finally{if(e.finalizer){const n=yield*te(e.finalizer);"normal"!==n.Type&&(t=n)}}return t}case"VariableDeclaration":{let t;for(const n of e.declarations)if(ee=n,n.init)if("Identifier"===n.id.type){ee=n.init,g&&"CallExpression"!==ee.type&&"TaggedTemplateExpression"!==ee.type&&(yield);const r=n.id.name,o=re(r);let i;i=ge(n.init)?ve(n.init,r):_(yield*te(n.init)),t="var"===e.kind?$(o,i):C(o,i)}else{ee=n.init,g&&"CallExpression"!==ee.type&&"TaggedTemplateExpression"!==ee.type&&(yield);const r=_(yield*te(n.init));t=yield*Ae(n.id,r,"var"===e.kind?void 0:ne().LexicalEnvironment)}else t="var"===e.kind?S(A):C(re(n.id.name),void 0);return t}case"WhileStatement":return oe(yield*function*(e){let t;for(;;){if(!_(yield*te(e.test,void 0,!0)))return S(t);const n=yield*te(e.body);if(!R(n))return L(n,t);n.Value!==A&&(t=n.Value)}}(e))}throw new SyntaxError(`Unsupported node type \`${e.type}\``)}function ne(){return Q[Q.length-1]}function re(e,t){return t||(t=ne().LexicalEnvironment),F(t,e,!0)}function oe(e){return"break"===e.Type?e.Value===A?S(void 0):S(e.Value):e}function*ie(e,t){return t===_(yield*te(e.test))}function*se(e,t,n,r){let o;for(ae(r);;){if(e&&!_(yield*te(e,void 0,!0)))return S(o);const i=yield*te(n);if(!R(i))return L(i,o);i.Value&&(o=i.Value),ae(r),t&&_(yield*te(t,void 0,!0))}}function ae(e){if(0===e.length)return;const t=ne().LexicalEnvironment,n=t.OuterEnv,r=new y(n);for(const n of e){r.CreateMutableBinding(n,!1);const e=t.GetBindingValue(n,!1);r.InitializeBinding(n,e)}ne().LexicalEnvironment=r}function*ce(e,t){if("ObjectPattern"===e.type)return U(t),e.properties.length>0&&(yield*function*(e,t){const n=new Set;for(const r of e)if("Property"===r.type){const e=r.computed||"Identifier"!==r.key.type?yield*ke(r.key):r.key.name,o="AssignmentPattern"===r.value.type?r.value.left:r.value;if("Identifier"===o.type){const i=re(o.name);let s=M(t,e);"AssignmentPattern"===r.value.type&&void 0===s&&(s=ge(r.value.right)?ve(r.value.right,o.name):_(yield*te(r.value.right))),$(i,s),n.add(e)}else yield*le(r.value,t,e),n.add(e)}else yield*ue(r,t,n)}(e.properties,t)),S(A);const n=N(t);return yield*function*(e,t){let n=S(A);for(const r of e){if(!r){t.next(),n=S(A);continue}const e="RestElement"===r.type?r.argument:"AssignmentPattern"===r.type?r.left:r,o="ArrayPattern"===e.type||"ObjectPattern"===e.type;let i,s;if(o||(i=(yield*te(e)).Value),"RestElement"!==r.type){const{done:n,value:o}=t.next(),i=n?void 0:o;s="AssignmentPattern"===r.type&&void 0===i?ge(r.right)&&"Identifier"===e.type?ve(r.right,e.name):_(yield*te(r.right)):i}else{s=new K;let e=0;for(;;){const{done:n,value:r}=t.next();if(n)break;s[e]=r,e++}}n=o?yield*ce(e,s):$(i,s)}return n}(e.elements,n)}function*le(e,t,n){const r="AssignmentPattern"===e.type?e.left:e,o="ArrayPattern"===r.type||"ObjectPattern"===r.type;let i;o||(i=(yield*te(r)).Value);const s=M(t,n);let a;return a="AssignmentPattern"===e.type&&void 0===s?_(yield*te(e.right)):s,o?yield*ce(r,a):$(i,a)}function*ue(e,t,n){return $((yield*te(e.argument)).Value,x({},t,n))}function de(e,t){const n=P(e,{var:!1,topLevel:!1});for(const e of n){const n="VariableDeclaration"===e.type&&"const"===e.kind;for(const r of k(e))n?t.CreateImmutableBinding(r,!0):t.CreateMutableBinding(r,!1);if("FunctionDeclaration"===e.type){const[n]=k(e),r=ye(e,t);t.InitializeBinding(n,r)}}}function*pe(e,n,r,o){let i;n instanceof E&&O(n)&&(i=n.Base);const s=yield*fe(r);if("function"!=typeof e){const e=t.substring(o.start,o.end);throw new TypeError(`${e} is not a function`)}if(g||v){const t=e[d];if(t){const e=yield*t.apply(i,s);return J(e),S(e)}}const a=e.apply(i,s);return J(a),S(a)}function*fe(e){const t=[];if(Array.isArray(e))for(const n of e)if("SpreadElement"===n.type){const e=_(yield*te(n.argument));t.push(...e)}else t.push(_(yield*te(n)));else{t.push(function(e){const t=Z.get(e);if(t)return t;const n=e.quasis.map((e=>e.value.raw)),r=e.quasis.map((e=>e.value.cooked));return Object.freeze(n),Object.defineProperty(r,"raw",{value:n,writable:!1,enumerable:!1,configurable:!1}),Object.freeze(r),Z.set(e,r),r}(e));for(const n of e.expressions)t.push(_(yield*te(n)))}return t}function*he(e,t,n){var c;null===(c=q.beforeCall)||void 0===c||c.call(q,e[i]),function(e,t,n){if(e[u]===o.LEXICAL)return;const r=t.LexicalEnvironment;null==r||r.BindThisValue(n)}(e,function(e){const t=new m;t.Function=e;const n=new w(e);return t.VariableEnvironment=n,t.LexicalEnvironment=n,Q.push(t),H.push(t),t}(e),t);const l=yield*function*(e,t){return yield*function*(e,t,n){return yield*function*(e,t){const n=ne(),i=e[a],c=e[s],l=k(c),d=I(c),p=P(i,{var:!0,topLevel:!0}),f=k(p),h=[],m=[];for(let e=p.length-1;e>=0;e--){const t=p[e];if("FunctionDeclaration"===t.type){Ce(t);const[e]=k(t);h.includes(e)||(h.unshift(e),m.unshift(t))}else if(null!=r&&r.noVar)throw new SyntaxError("Var declaration is not recommended, use `let` or `const` instead")}const g=!!v&&e[u]!==o.LEXICAL,w=n.LexicalEnvironment;for(const e of l)w.CreateMutableBinding(e,!1);let E=l;if(g){const e=function(e){const t=[...e],n={};Object.defineProperty(n,"length",{value:t.length,writable:!0,configurable:!0});for(let e=0;e<t.length;e++)n[String(e)]=t[e];Object.defineProperty(n,Symbol.iterator,{value:Array.prototype.values,writable:!0,configurable:!0});const r=()=>{throw new TypeError("'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them")};return Object.defineProperty(n,"callee",{get:r,set:r}),n}(t);w.CreateImmutableBinding("arguments",!1),w.InitializeBinding("arguments",e),E=l.concat("arguments")}const b=N(t);let S;if(yield*Pe(c,b,w),d){S=new y(w),n.VariableEnvironment=S;const e=[];for(const t of f)if(!e.includes(t)){let n;e.push(t),S.CreateMutableBinding(t,!1),E.includes(t)&&!h.includes(t)&&(n=w.GetBindingValue(t,!1)),S.InitializeBinding(t,n)}}else{const e=[...E];for(const t of f)e.includes(t)||(e.push(t),w.CreateMutableBinding(t,!1),w.InitializeBinding(t,void 0));S=w}const A=S;n.LexicalEnvironment=A;const O=P(i,{var:!1,topLevel:!0});for(const e of O)for(const t of k(e))"const"===e.kind?A.CreateImmutableBinding(t,!0):A.CreateMutableBinding(t,!1);for(const e of m){const[t]=k(e),n=ye(e,A);S.SetMutableBinding(t,n,!1)}}(t,n),Array.isArray(e)?yield*me(e):new b("return",_(yield*te(e)))}(e[a],e,t)}(e,n);if(g&&(ee={...e[i],[h]:!0},yield{type:"return",value:"return"===l.Type?l.Value:void 0}),Q.pop(),H.pop(),"return"===l.Type)return l.Value}function*me(e){let t=S(A);for(const n of e){const e=yield*te(n);if("normal"!==e.Type)return e;t=L(t,e.Value)}return t}function ge(e){return"FunctionExpression"===e.type&&!e.id||"ArrowFunctionExpression"===e.type}function ve(e,t){var n;switch(null===(n=q.beforeEvaluate)||void 0===n||n.call(q,e),e.type){case"FunctionExpression":return we(e,t);case"ArrowFunctionExpression":return Ee(e,t);default:throw new Error(`Unexpected node type for NamedEvaluation: ${e.type}`)}}function ye(e,t){const n=Se(e,t,!0,!1);return e.id&&be(n,e.id.name),n}function we(e,t){const n=ne().LexicalEnvironment;if(e.id){const t=e.id.name,r=new y(n);r.CreateImmutableBinding(t,!1);const o=Se(e,r,!0,!1);return be(o,t),r.InitializeBinding(t,o),o}{const r=Se(e,n,!0,!1);return be(r,t??""),r}}function Ee(e,t){const n=Se(e,ne().LexicalEnvironment,!1,!0);return be(n,t??""),n}function be(e,t){Object.defineProperty(e,"name",{value:t,configurable:!0})}function Se(e,t,n,r){const p=function(){return z(he(p,this,arguments))};Object.defineProperties(p,{[i]:{value:e},[s]:{value:e.params},[a]:{value:"BlockStatement"===e.body.type?e.body.body:e.body},[c]:{value:t},[l]:{value:n},[u]:{value:r?o.LEXICAL:o.STRICT}});const f=function(e){let t=0;for(const n of e)switch(n.type){case"AssignmentPattern":case"RestElement":return t;default:t++}return t}(e.params);return Object.defineProperty(p,"length",{configurable:!0,value:f}),(g||v)&&Object.defineProperty(p,d,{value:function(){return he(p,this,arguments)}}),p}function*Ae(e,t,n){switch(e.type){case"Identifier":return function(e,t,n){return n.InitializeBinding(e,t),S(A)}(e.name,t,n);case"ObjectPattern":return U(t),yield*function*(e,t,n){const r=new Set;for(const o of e){if("RestElement"===o.type)return Ie(o,t,n,r);if(o.computed||"Identifier"!==o.key.type){const e=yield*ke(o.key);yield*Oe(o.value,t,n,e),r.add(e)}else yield*Oe(o.value,t,n,o.key.name),r.add(o.key.name)}return S(A)}(e.properties,t,n);case"ArrayPattern":{const r=N(t);return yield*Pe(e.elements,r,n)}}}function*ke(e){return B(_(yield*te(e)))}function Ie(e,t,n,r){const o=re(e.argument.name,n),i=x({},t,r);return n?C(o,i):$(o,i)}function*Pe(e,t,n){if(0===e.length)return S(A);let r;for(const o of e)if(o)if("RestElement"===o.type)if("Identifier"===o.argument.type){const e=re(o.argument.name,n),i=new K;let s=0;for(;;){const{done:o,value:a}=t.next();if(o){r=n?C(e,i):$(e,i);break}i[s]=a,s++}}else{const e=new K;let i=0;for(;;){const{done:s,value:a}=t.next();if(s){r=yield*Ae(o.argument,e,n);break}e[i]=a,i++}}else{const e="AssignmentPattern"===o.type?o.left:o;switch(e.type){case"ObjectPattern":case"ArrayPattern":{let i;const{done:s,value:a}=t.next();s||(i=a),"AssignmentPattern"===o.type&&void 0===i&&(i=_(yield*te(o.right))),r=yield*Ae(e,i,n);break}case"Identifier":{const i=e.name,s=re(i,n);let a;const{done:c,value:l}=t.next();c||(a=l),"AssignmentPattern"===o.type&&void 0===a&&(a=ge(o.right)?ve(o.right,i):_(yield*te(o.right))),r=n?C(s,a):$(s,a);break}}}else t.next(),r=S(A);return r}function*Oe(e,t,n,r){if("Identifier"===e.type||"AssignmentPattern"===e.type&&"Identifier"===e.left.type){const o="Identifier"===e.type?e.name:e.left.name,i=re(o,n);let s=M(t,r);return"AssignmentPattern"===e.type&&void 0===s&&(s=ge(e.right)?ve(e.right,o):_(yield*te(e.right))),n?C(i,s):$(i,s)}let o=M(t,r);return"AssignmentPattern"===e.type&&void 0===o&&(o=_(yield*te(e.right))),yield*Ae("AssignmentPattern"===e.type?e.left:e,o,n)}function Ce(e){if(e.async||e.generator)throw new SyntaxError((e.async?"Async":"Generator")+" function is not allowed");if(G&&!e.expression)throw new SyntaxError("Only an `Expression` is allowed in `ArrowFunctionExpression`'s body")}if(G)return _(z(te(e)));null===(n=q.beforeEvaluate)||void 0===n||n.call(q,e),Ce(e);const[xe]=k(e);X.CreateImmutableBinding(xe,!0);const Te=ye(e,X);return X.InitializeBinding(xe,Te),g&&Object.defineProperties(Te,{[p]:{value:function(){return ne().LexicalEnvironment}},[f]:{value:function(){return ee}}}),Te}function z(e){for(;;){const{done:t,value:n}=e.next();if(t)return n}}class G{constructor(){(0,r.A)(this,"VariableEnvironment",void 0),(0,r.A)(this,"LexicalEnvironment",void 0)}}class J{constructor(e){(0,r.A)(this,"OuterEnv",void 0),(0,r.A)(this,"bindingSet",new Set),this.OuterEnv=e}HasBinding(e){return this.bindingSet.has(e)}CreateBinding(e){this.bindingSet.add(e)}}function X(e){let{expressionOnly:t,visitors:n,withParent:r,externalSourceForDebug:o,hooks:i={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new Set,a=[],c=new J(null),l=new G;function u(){return a[a.length-1]}function d(e,t,n){for(const r of t)p(e[r],null==n?void 0:n.concat({node:e,key:r}))}function p(e,r){if(Array.isArray(e))e.forEach(((e,t)=>{p(e,r?r.slice(0,-1).concat({...r[r.length-1],index:t}):r)}));else if(e){var a,c;switch(null===(a=i.beforeVisit)||void 0===a||a.call(i,e,r),function(e){var t,r;n&&(t=n,r=e.type,Object.prototype.hasOwnProperty.call(t,r))&&n[e.type](e)}(e),e.type){case"Identifier":var l;return w=e.name,void(h(u().LexicalEnvironment,w)||(null===(l=i.beforeVisitGlobal)||void 0===l||l.call(i,e,r),s.add(e.name)));case"ArrayExpression":case"ArrayPattern":return void d(e,["elements"],r);case"ArrowFunctionExpression":return void g(v(e,u().LexicalEnvironment,!0),r);case"AssignmentPattern":case"BinaryExpression":case"LogicalExpression":return void d(e,["left","right"],r);case"CallExpression":case"NewExpression":return void d(e,["callee","arguments"],r);case"ChainExpression":return void d(e,["expression"],r);case"ConditionalExpression":return void d(e,["test","consequent","alternate"],r);case"MemberExpression":return d(e,["object"],r),void(e.computed&&d(e,["property"],r));case"ObjectExpression":case"ObjectPattern":return void d(e,["properties"],r);case"Property":return e.computed&&d(e,["key"],r),void d(e,["value"],r);case"RestElement":case"SpreadElement":case"UnaryExpression":return void d(e,["argument"],r);case"SequenceExpression":case"TemplateLiteral":return void d(e,["expressions"],r);case"TaggedTemplateExpression":return void d(e,["tag","quasi"],r);case"Literal":return}if(!t)switch(e.type){case"AssignmentExpression":return void d(e,["right","left"],r);case"BlockStatement":{if(!e.body.length)return;const t=u(),n=t.LexicalEnvironment,o=new J(n);return m(e.body,o),t.LexicalEnvironment=o,d(e,["body"],r),void(t.LexicalEnvironment=n)}case"BreakStatement":case"ContinueStatement":case"EmptyStatement":return;case"CatchClause":{const t=u(),n=t.LexicalEnvironment,o=new J(n);return f(e.param,o),t.LexicalEnvironment=o,d(e,["param","body"],r),void(t.LexicalEnvironment=n)}case"DoWhileStatement":return void d(e,["body","test"],r);case"ExpressionStatement":case"TSAsExpression":return void d(e,["expression"],r);case"ForInStatement":case"ForOfStatement":{const t="VariableDeclaration"===e.left.type&&"var"!==e.left.kind,n=u(),o=n.LexicalEnvironment;if(t){const t=new J(o);f(e.left,t),n.LexicalEnvironment=t}if(d(e,["right"],r),n.LexicalEnvironment=o,t){const t=new J(o);f(e.left,t),n.LexicalEnvironment=t}return d(e,["left","body"],r),void(n.LexicalEnvironment=o)}case"ForStatement":{var y;const t="VariableDeclaration"===(null===(y=e.init)||void 0===y?void 0:y.type)&&"var"!==e.init.kind,n=u(),o=n.LexicalEnvironment;if(t){const t=new J(o);f(e.init,t),n.LexicalEnvironment=t}return d(e,["init","test","body","update"],r),void(n.LexicalEnvironment=o)}case"FunctionDeclaration":{const[t]=k(e),n=u().LexicalEnvironment,o=v(e,n);return n.CreateBinding(t),void g(o,r)}case"FunctionExpression":{const t=function(e){const t=u().LexicalEnvironment;if(!e.id)return v(e,t);const n=e.id.name,r=new J(t);return r.CreateBinding(n),v(e,r)}(e);return void g(t,r)}case"IfStatement":return void d(e,["test","consequent","alternate"],r);case"ReturnStatement":case"ThrowStatement":case"UpdateExpression":return void d(e,["argument"],r);case"SwitchCase":return void d(e,["test","consequent"],r);case"SwitchStatement":{d(e,["discriminant"],r);const t=u(),n=t.LexicalEnvironment,o=new J(n);return m(e.cases,o),t.LexicalEnvironment=o,d(e,["cases"],r),void(t.LexicalEnvironment=n)}case"ThisExpression":if(!o)break;return;case"TryStatement":return void d(e,["block","handler","finalizer"],r);case"VariableDeclaration":return void d(e,["declarations"],r);case"VariableDeclarator":return void d(e,["id","init"],r);case"WhileStatement":return void d(e,["test","body"],r)}(null===(c=i.beforeVisitUnknown)||void 0===c?void 0:c.call(i,e,r))||console.warn(`Unsupported node type \`${e.type}\``)}var w}function f(e,t){for(const n of k(e))t.CreateBinding(n)}function h(e,t){return!!e&&(e.HasBinding(t)||h(e.OuterEnv,t))}function m(e,t){f(P(e,{var:!1,topLevel:!1}),t)}function g(e,t){!function(e){const t=new G,n=new J(e.Environment);t.VariableEnvironment=n,t.LexicalEnvironment=n,a.push(t)}(e),function(e,t){const n=u(),r=e.ECMAScriptCode,i=e.FormalParameters,s=I(i),a=k(P(r,{var:!0,topLevel:!0})),c=!!o&&"LEXICAL"!==e.ThisMode,l=n.LexicalEnvironment;let d;if(f(i,l),c&&l.CreateBinding("arguments"),p(i,null==t?void 0:t.concat({node:e.Function,key:"params"})),s){d=new J(l),n.VariableEnvironment=d;for(const e of a)d.CreateBinding(e)}else{for(const e of a)l.CreateBinding(e);d=l}const h=d;n.LexicalEnvironment=h,f(P(r,{var:!1,topLevel:!0}),h)}(e,t),p(e.ECMAScriptCode,null==t?void 0:t.concat({node:e.Function,key:"body"}).concat("BlockStatement"===e.Function.body.type?{node:e.Function.body,key:"body"}:[])),a.pop()}function v(e,t,n){return{Function:e,FormalParameters:e.params,ECMAScriptCode:"BlockStatement"===e.body.type?e.body.body:e.body,Environment:t,ThisMode:n?"LEXICAL":"STRICT"}}return l.VariableEnvironment=c,l.LexicalEnvironment=c,a.push(l),p(e,r?[]:void 0),s}var Y=n(3340);let Q=new WeakMap;function Z(e){let{typescript:t,cacheKey:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n?Q.get(n):void 0;return o||(o=function(e){let{typescript:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,Y.parse)(e,{plugins:["estree",t&&"typescript"].filter(Boolean),strictMode:!0,attachComment:!1}).program.body,r=t?[]:n;if(t)for(const e of n)if(e.type.startsWith("TS")){if(/Enum|Import|Export/.test(e.type))throw new SyntaxError(`Unsupported TypeScript syntax: ${e.type}`)}else r.push(e);if(0===r.length)throw new SyntaxError("Function declaration not found");if(r.length>1||"FunctionDeclaration"!==r[0].type)throw new SyntaxError(`Expect a single function declaration at top level, but received: ${r.map((e=>`"${e.type}"`)).join(", ")}`);return r[0]}(e,{typescript:t}),n&&Q.set(n,o)),{function:o,attemptToVisitGlobals:X(o,r)}}function ee(){Q=new WeakMap}const te=new Map;function ne(e){let{cache:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[],o=e.replace(/^\s*<%[~=]?\s|\s%>\s*$/g,(e=>(r.push(e),"")));let i=t?te.get(o):void 0;return i||(i=function(e){return(0,Y.parseExpression)(e,{plugins:["estree",["pipelineOperator",{proposal:"minimal"}]],attachComment:!1})}(o),t&&te.set(o,i)),{expression:i,attemptToVisitGlobals:X(i,{...n,expressionOnly:!0}),source:o,prefix:r[0],suffix:r[1]}}function re(e){return/^\s*<%[~=]?\s/.test(e)&&/\s%>\s*$/.test(e)}function oe(e){return/^\s*<%~\s/.test(e)}function ie(e){return/^\s*<%=\s/.test(e)&&/\s%>\s*$/.test(e)}function se(){te.clear()}},2308:(e,t,n)=>{"use strict";n.r(t),n.d(t,{HttpAbortError:()=>U,HttpFetchError:()=>M,HttpParseError:()=>N,HttpResponseError:()=>$,createHttpInstance:()=>V,defaultAdapter:()=>D,fetch:()=>B,http:()=>F,isHttpAbortError:()=>j});var r={};n.r(r),n.d(r,{HttpAbortError:()=>h,HttpFetchError:()=>d,HttpParseError:()=>f,HttpResponseError:()=>p,createHttpInstance:()=>x,defaultAdapter:()=>A,fetch:()=>o,getUrlWithParams:()=>b,http:()=>C,isHttpAbortError:()=>w});const o=(e,t)=>{const n=new Request(e,Object.assign({credentials:"same-origin"},t));return self.fetch(n)};var i=n(4635),s=n(918),a=n(4586),c=n(829),l=n(2559),u=n(6121);class d extends Error{constructor(e){super(e),this.name="HttpFetchError",Error.captureStackTrace&&Error.captureStackTrace(this,d)}}class p extends Error{constructor(e,t){super(e.statusText),(0,a.A)(this,"response",void 0),(0,a.A)(this,"responseJson",void 0),this.name="HttpResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,p),this.response=e,this.responseJson=t}}class f extends Error{constructor(e){super(e.statusText),(0,a.A)(this,"response",void 0),this.name="HttpParseError",Error.captureStackTrace&&Error.captureStackTrace(this,f),this.response=e}}class h extends Error{constructor(e){super(e),this.name="HttpAbortError"}}class m{constructor(){(0,a.A)(this,"handlers",[])}use(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}forEach(e){this.handlers.forEach((t=>{null!==t&&e(t)}))}}function g(e){return null==e}const v=document.querySelector("base"),y=v?v.href:location.origin+"/",w=e=>e instanceof DOMException&&20===e.code,E=async(e,t,n)=>new Promise((async(r,i)=>{let s;n.url=e;let a,{responseType:c}=n.options||{};c||(c="json");try{s=await o(e,t)}catch(e){return void i(w(e)?new h(e.toString()):new d(e.toString()))}if(s.ok){try{a=await s[c]()}catch(e){return void i(w(e)?new h(e.toString()):new f(s))}r({status:s.status,statusText:s.statusText,headers:s.headers,data:a})}else{let e;try{e=await s.json()}catch{}i(new p(s,e))}})),b=(e,t)=>{if(t){const n=new URL(e,y);t instanceof URLSearchParams?t.forEach((function(e,t){n.searchParams.append(t,e)})):Object.entries(t).forEach((e=>{let[t,r]=e;Array.isArray(r)?r.forEach((e=>{n.searchParams.append(t,g(e)?"":e)})):n.searchParams.append(t,g(r)?"":r)}));const{href:r}=n;return r.startsWith(y)?r.substr(y.length):r}return e},S=(e,t)=>{if(void 0!==e){const n=new Headers(t||{}),r="Content-Type";let o=e;return n.has(r)||("string"==typeof e?n.set(r,"application/x-www-form-urlencoded"):e instanceof FormData||(n.set(r,"application/json"),o=JSON.stringify(e))),{body:o,headers:n}}return{headers:t}},A=e=>{const{url:t,method:n,data:r}=e;return["DELETE","GET","HEAD"].includes(e.method)?((e,t,n)=>{const{params:r,responseType:o,interceptorParams:i,observe:s,noAbortOnRouteChange:a,useCache:c,...l}=n.options||{};return E(b(t,r),{...l,method:e},n)})(n,t,e):((e,t,n,r)=>{const{params:o,headers:i,responseType:s,interceptorParams:a,observe:c,noAbortOnRouteChange:l,useCache:u,...d}=r.options||{};return E(b(t,o),{...d,method:e,...S(n,i)},r)})(n,t,r,e)};var k=new WeakMap,I=new WeakSet;class P{constructor(e){var t=this;(0,i.A)(this,I),(0,a.A)(this,"interceptors",void 0),(0,s.A)(this,k,A),(0,a.A)(this,"request",(async(e,t,n)=>{const{body:r,method:o,...i}=t||{};return(0,l.A)(I,this,O).call(this,{url:e,data:r,method:o||"GET",options:{...n||{},...i}})})),(0,a.A)(this,"simpleRequest",(function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,l.A)(I,t,O).call(t,{url:n,method:e,options:r})})),(0,a.A)(this,"requestWithBody",(function(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,l.A)(I,t,O).call(t,{url:n,method:e,data:r,options:o})})),this.interceptors={request:new m,response:new m},null!=e&&e.adapter&&(0,u.A)(k,this,e.adapter)}getUrlWithParams(e,t){return b(e,t)}getBodyAndHeaders(e,t){return S(e,t)}get(e,t){return(0,l.A)(I,this,O).call(this,{url:e,method:"GET",options:t})}delete(e,t){return(0,l.A)(I,this,O).call(this,{url:e,method:"DELETE",options:t})}head(e,t){return(0,l.A)(I,this,O).call(this,{url:e,method:"HEAD",options:t})}post(e,t,n){return(0,l.A)(I,this,O).call(this,{url:e,method:"POST",data:t,options:n})}put(e,t,n){return(0,l.A)(I,this,O).call(this,{url:e,method:"PUT",data:t,options:n})}patch(e,t,n){return(0,l.A)(I,this,O).call(this,{url:e,method:"PATCH",data:t,options:n})}}function O(e){const t=[];let n=Promise.resolve(e);for(this.interceptors.request.forEach((e=>{t.push(e.fulfilled,e.rejected)})),t.push((e=>(0,c.A)(k,this).call(this,e)),void 0),this.interceptors.response.forEach((n=>{t.push((t=>{var r;return null===(r=n.fulfilled)||void 0===r?void 0:r.call(n,t,e)}),(t=>{var r;return null===(r=n.rejected)||void 0===r?void 0:r.call(n,t,e)}))})),t.push((t=>{var n;return"response"===(null===(n=e.options)||void 0===n?void 0:n.observe)?t:t.data}),void 0);t.length;)n=n.then(t.shift(),t.shift());return n}let C=new P;function x(e){C=new P(e)}var T;let R,L;const{dll:_}=window;R=_&&null!==(T=window.BRICK_NEXT_VERSIONS)&&void 0!==T&&null!==(T=T["brick-container"])&&void 0!==T&&T.startsWith("2.")&&(L=_("JxWY"))?L:r;const{fetch:B,HttpFetchError:M,HttpResponseError:$,HttpParseError:N,HttpAbortError:U,http:F,isHttpAbortError:j,createHttpInstance:V,defaultAdapter:D}=R},7472:(e,t,n)=>{"use strict";n.r(t),n.d(t,{i18n:()=>d,i18nText:()=>u,initializeI18n:()=>c});var r=n(2350),o=n(5253),i=n(7072);let s=!1;const a=new Set;function c(e,t){if(s||(s=!0,o.i18n.use(i.default).init({fallbackLng:"zh",debug:!1,supportedLngs:["zh","en"],nonExplicitSupportedLngs:!0,interpolation:{escapeValue:!1},react:{useSuspense:!1},compatibilityJSON:"v3",resources:{}})),e&&t&&!a.has(e)){a.add(e);for(const[n,r]of Object.entries(t))o.i18n.addResourceBundle(n,e,r)}}var l=n(6458);function u(e){if(!e)return;const t=o.i18n.language??"zh-CN";if((0,l.hasOwnProperty)(e,t))return e[t];const n=t.split("-")[0];if(n!==t)return(0,l.hasOwnProperty)(e,n)?e[n]:void 0;const r=`${n}-`;for(const t of Object.keys(e))if(t.startsWith(r))return e[t]}const d=r.default},5774:(e,t,n)=>{"use strict";n.r(t),n.d(t,{inject:()=>A,transform:()=>S,transformAndInject:()=>k});var r=n(1030),o=n(1322);let i=function(e){return e[e.Initial=0]="Initial",e[e.ExpectField=1]="ExpectField",e[e.ExpectOptionalBeginDefault=2]="ExpectOptionalBeginDefault",e[e.ExpectDefaultValue=3]="ExpectDefaultValue",e[e.ExpectOptionalBeginPipe=4]="ExpectOptionalBeginPipe",e[e.ExpectPipeIdentifier=5]="ExpectPipeIdentifier",e[e.ExpectOptionalBeginPipeParameter=6]="ExpectOptionalBeginPipeParameter",e[e.ExpectPipeParameter=7]="ExpectPipeParameter",e[e.ExpectPlaceholderEnd=8]="ExpectPlaceholderEnd",e}({}),s=function(e){return e.Raw="Raw",e.BeginPlaceHolder="BeginPlaceHolder",e.Field="Field",e.BeginDefault="BeginDefault",e.LiteralString="LiteralString",e.BeginPipe="BeginPipe",e.PipeIdentifier="PipeIdentifier",e.BeginPipeParameter="BeginPipeParameter",e.EndPlaceHolder="EndPlaceHolder",e.JsonValue="JsonValue",e}({}),a=function(e){return e[e.Array=0]="Array",e[e.Object=1]="Object",e[e.String=2]="String",e[e.Others=3]="Others",e}({});function c(e){return new RegExp(`(${[].concat(e).map((e=>(0,r.escapeRegExp)(e))).join("|")})\\{`)}function l(e){var t;const n=b(e),r=null===(t=n.match(e.beginPlaceholder))||void 0===t?void 0:t[0],o=r?n.indexOf(r):-1;if(o>=0&&r&&"{"!==n.charAt(o+r.length)){const t=e.cursor+o;o>0&&e.tokens.push({type:s.Raw,value:n.substring(0,o)}),e.tokens.push({type:s.BeginPlaceHolder,loc:{start:t,end:t+r.length},value:r.substring(0,r.length-1)}),e.cursor+=o+r.length,e.status=i.ExpectField}else e.tokens.push({type:s.Raw,value:n}),e.cursor=e.raw.length}function u(e){e.cursor+=b(e).match(/^[ \r\n\t]*/)[0].length}function d(e){const[t]=b(e).match(/^[\w.*[\]\-\u{80}-\u{10FFFF}]*/u);e.tokens.push({type:s.Field,value:t}),e.cursor+=t.length,e.status=i.ExpectOptionalBeginDefault}function p(e){"="===b(e).charAt(0)?(e.tokens.push({type:s.BeginDefault}),e.cursor+=1,e.status=i.ExpectDefaultValue):e.status=i.ExpectOptionalBeginPipe}function f(e){E(e,i.ExpectOptionalBeginPipe)}function h(e){"|"===b(e).charAt(0)?(e.tokens.push({type:s.BeginPipe}),e.cursor+=1,e.status=i.ExpectPipeIdentifier):e.status=i.ExpectPlaceholderEnd}function m(e){const t=b(e).match(/^[a-zA-Z]\w*/);if(!t)throw new Error(`Expected a pipe identifier at index ${e.cursor} near: ${JSON.stringify(e.raw.substring(e.cursor))}`);const n=t[0];e.tokens.push({type:s.PipeIdentifier,value:n}),e.cursor+=n.length,e.status=i.ExpectOptionalBeginPipeParameter}function g(e){":"===b(e).charAt(0)?(e.tokens.push({type:s.BeginPipeParameter}),e.cursor+=1,e.status=i.ExpectPipeParameter):e.status=i.ExpectOptionalBeginPipe}function v(e){E(e,i.ExpectOptionalBeginPipeParameter)}function y(e){if("}"!==b(e).charAt(0))throw new Error(`Expected a placeholder end '}' at index ${e.cursor} near: ${JSON.stringify(e.raw.substring(e.cursor))}`);e.tokens.push({type:s.EndPlaceHolder,loc:{start:e.cursor,end:e.cursor+1}}),e.cursor+=1,e.status=i.Initial}const w=new Map([["false",!1],["null",null],["true",!0]]);function E(e,t){const n=b(e);if(/[0-9[{"]/.test(n.charAt(0))||/-[0-9]/.test(n.substring(0,2)))!function(e,t){const n=b(e),r=n.charAt(0),o="["===r?a.Array:"{"===r?a.Object:'"'===r?a.String:a.Others;let i=0,c=0,l=0,u=!1,d=!1,p=!1;for(;i<n.length;){const e=n.charAt(i);if(d)d=!1;else if(u)'"'===e?u=!1:"\\"===e&&(d=!0);else switch(e){case"[":l+=1;break;case"{":c+=1;break;case"]":l-=1;break;case"}":c-=1;break;case'"':u=!0}switch(i+=1,o){case a.Array:p=!l;break;case a.Object:p=!c;break;case a.String:p=!u;break;default:p=i<n.length&&/[^a-z0-9E.+-]/.test(n.charAt(i))}if(p)break}if(!p)throw new Error(`Failed to match a JSON value at index ${e.cursor} near: ${JSON.stringify(e.raw.substring(e.cursor))}`);e.tokens.push({type:s.JsonValue,value:JSON.parse(n.substring(0,i))}),e.cursor+=i,e.status=t}(e,t);else{const[n]=b(e).match(/^[\w\-\u{80}-\u{10FFFF}]*/u);w.has(n)?e.tokens.push({type:s.JsonValue,value:w.get(n)}):e.tokens.push({type:s.LiteralString,value:n}),e.cursor+=n.length,e.status=t}}function b(e){return e.raw.substring(e.cursor)}function S(e,t){return I(e,"@",t)}function A(e,t){return I(e,"$",t)}function k(e,t){return I(e,["@","$"],t)}function I(e,t,n){if(!function(e,t){return c(t).test(e)}(e,t))return e;const a=(w=n.data,function(e){let t=e.field?(0,r.get)(w,e.field):w;return void 0===t&&(t=e.defaultValue),(0,o.processPipes)(t,e.pipes)});var w;const E=function(e,t){return function(n){const i=n.field.match(/^(?:(QUERY(?:_ARRAY)?|EVENT|query|event|APP|HASH|ANCHOR|SYS|FLAGS|CTX)\.)?(.+)$/);if(!i)return t.substring(n.loc.start,n.loc.end);let s,[,a,c]=i;!a&&/^[A-Z_]+$/.test(c)&&(a=c,c="*");const l={SYS:"sys",FLAGS:"flags"};switch(a){case"QUERY":case"query":s="*"===c?e.query:e.query.has(c)?e.query.get(c):void 0;break;case"QUERY_ARRAY":s=e.query.has(c)?e.query.getAll(c):void 0;break;case"EVENT":case"event":if(void 0===e.event)return t.substring(n.loc.start,n.loc.end);s="*"===c?e.event:(0,r.get)(e.event,c);break;case"APP":s="*"===c?e.overrideApp??e.app:(0,r.get)(e.overrideApp??e.app,c);break;case"HASH":s=e.location.hash;break;case"SYS":case"FLAGS":s="*"===c?e[l[a]]:(0,r.get)(e[l[a]],c);break;case"ANCHOR":{const t=e.location.hash?e.location.hash.substr(1):null;s="*"===c?t:(0,r.get)(t,c);break}case"CTX":{const e=t.substring(n.loc.start,n.loc.end);return console.error(`CTX is not supported in placeholder any more: "${e}"`),e}default:if(!e.match)return t.substring(n.loc.start,n.loc.end);s=e.match.params[c]}return void 0===s&&(s=n.defaultValue),(0,o.processPipes)(s,n.pipes)}}(n,e);return b=function(e,t){return function(e){const t={type:"InjectableString",elements:[]};let n;function r(t){return t===e[0].type&&(n=e.shift(),!0)}function o(t){if(n=e.shift(),Array.isArray(t)?!t.includes(n.type):t!==n.type)throw new Error(`Expected token: ${t}, received token: ${n.type}`)}for(;e.length>0;)if(r(s.Raw))t.elements.push({type:"RawString",value:n.value});else{o(s.BeginPlaceHolder);const e=n.loc.start,i=n.value;o(s.Field);const a={type:"Placeholder",symbol:i,field:n.value,defaultValue:void 0,pipes:[],loc:{start:e,end:e}};for(t.elements.push(a),r(s.BeginDefault)&&(o([s.JsonValue,s.LiteralString]),a.defaultValue=n.value);r(s.BeginPipe);){o(s.PipeIdentifier);const e={type:"PipeCall",identifier:n.value,parameters:[]};for(a.pipes.push(e);r(s.BeginPipeParameter);)o([s.JsonValue,s.LiteralString]),e.parameters.push(n.value)}o(s.EndPlaceHolder),a.loc.end=n.loc.end}return t}(function(e,t){const n={beginPlaceholder:c(t),raw:e,cursor:0,status:i.Initial,tokens:[]};for(;n.cursor<e.length;)switch(n.status){case i.Initial:l(n);break;case i.ExpectField:u(n),d(n);break;case i.ExpectOptionalBeginDefault:u(n),p(n);break;case i.ExpectDefaultValue:u(n),f(n);break;case i.ExpectOptionalBeginPipe:u(n),h(n);break;case i.ExpectPipeIdentifier:u(n),m(n);break;case i.ExpectOptionalBeginPipeParameter:u(n),g(n);break;case i.ExpectPipeParameter:u(n),v(n);break;case i.ExpectPlaceholderEnd:u(n),y(n)}if(n.status!==i.Initial)throw new Error("Expected a placeholder end '}' at the end");return n.tokens}(e,t))}(e,t).elements.map((e=>"RawString"===e.type?e.value:"$"===e.symbol?E(e):a(e))),1===b.length?b[0]:b.join("");var b}},7457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BrickLoadError:()=>y,enqueueStableLoadBricks:()=>f,enqueueStableLoadProcessors:()=>h,flushStableLoadBricks:()=>p,loadBricksImperatively:()=>m,loadEditorsImperatively:()=>v,loadProcessorsImperatively:()=>g,loadScript:()=>i,loadSharedModule:()=>a,loadStyle:()=>s});const r=new Map;function o(e,t,n,i){if(Array.isArray(t))return Promise.all(t.map((t=>o(e,t,n))));const s=n&&!/^https?:/.test(t)?`${n}${t}`:t,a=r.get(s);if(a)return a;const c=new Promise(((t,n)=>{const r=()=>{window.dispatchEvent(new Event("request.end"))},o=document.createElement("style"===e?"link":"script");"script"===e?Object.assign(o,{type:"text/javascript",async:!0,...i,src:s}):Object.assign(o,{rel:"stylesheet",...i,href:s}),o.onload=()=>{t(s),r()},o.onerror=e=>{n(e),r()};const a=document.currentScript||document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a),window.dispatchEvent(new Event("request.start"))}));return r.set(s,c),c}function i(e,t,n){return o("script",e,t,n)}function s(e,t,n){return o("style",e,t,n)}async function a(e,t){await n.I("default");const r=window[e];return await r.init(n.S.default),(await r.get(t))()}let c,l,u=!1;const d=new Promise(((e,t)=>{c=e,l=t}));function p(){u||c()}function f(e,t){return I(k("bricks",e,t))}function h(e,t){return I(k("processors",e,t))}async function m(e,t){const n=k("bricks",e,t);return p(),I(n)}function g(e,t){const n=k("processors",e,t);return p(),I(n)}function v(e,t){const n=k("editors",e,t);return p(),I(n)}class y extends Error{constructor(e){super(e),this.name="BrickLoadError",Error.captureStackTrace&&Error.captureStackTrace(this,y)}}let w;const E="v2-adapter.load-bricks";function b(e,t,n){const r=new Map,o=new Set,i=t=>{var s;if(o.has(t))return;let a,c,l;if(o.add(t),"editors"===e){l=t;for(const e of n.values()){var u;null!==(u=e.propertyEditors??e.editors)&&void 0!==u&&u.some((e=>e===l))&&(a=e)}}else if("processors"===e||t.includes(".")){[c,l]=t.split(".");const r=`bricks/${"processors"===e?(f=c,f.replace(/[A-Z]/g,(e=>`-${e[0].toLocaleLowerCase()}`)).replace(/_[0-9]/g,(e=>`-${e[1]}`))):c}`;a=n.get(r)}else{let e;l=t;for(const r of n.values()){var d;if(null!==(d=r.elements)&&void 0!==d&&d.some((e=>e===l))){var p;if(null===(p=r.deprecatedElements)||void 0===p||!p.includes(t)){a=r;break}e=r}}!a&&e&&(a=e)}var f;if(!a)return void console.error(`Package for ${t} not found.`);let h=r.get(a);h||(h=[],r.set(a,h)),h.push({fullName:t,lastName:l});const m=null===(s=a.dependencies)||void 0===s?void 0:s[t];if(m)for(const e of m)i(e)};for(const e of t)i(e);return r}async function S(e,t,n){const r=`${"processors"===e||"editors"===e?`./${e}/`:"./"}${"editors"===e?n.fullName:n.lastName}`;try{await a(t,r)}catch(t){throw console.error(t),new y(`Load ${e} of "${n.fullName}" failed: ${null==t?void 0:t.message}`)}}function A(e,t,n){return t.map((async t=>(await i(t.filePath,window.PUBLIC_ROOT??""),await d,Promise.all(n.get(t).map((n=>S(e,t.id,n)))))))}async function k(e,t,n){const r=new Map;for(const e of n){const t=e.id||P(e.filePath);r.set(t,e)}const o=b(e,t,r);let s;const a=[],d=[];let p;for(const e of o.keys())if(e.id)"bricks/basic"===e.id?s=e:d.push(e);else if(a.push(e),p=r.get("bricks/v2-adapter"),!p)throw new Error("Using v2 bricks, but v2-adapter not found");const f=p;let h;const m=s;if(m){const t=i(m.filePath,window.PUBLIC_ROOT??"");u||(u=!0,t.then((()=>Promise.resolve())).then(c,l)),h=t.then((()=>Promise.all(o.get(m).map((t=>S(e,m.id,t))))))}const g=[h].concat(A(e,d,o));if(f&&a.length>0){if(!w){const e=b("bricks",[E],r),t=[...e.keys()];w=(async()=>(await Promise.all(A("bricks",t,e)),document.createElement(E)))()}g.push(w.then((t=>Promise.all(a.map((r=>{const i=P(r.filePath).split("/")[1];return t.resolve(f.filePath,"editors"===e?r.propertyEditorsJsFilePath??r.filePath:r.filePath,"bricks"===e?o.get(r).map((e=>`${i}.${e.lastName}`)):[],r.dll,n)}))))))}await Promise.all(g)}async function I(e){window.dispatchEvent(new Event("request.start"));try{await e}finally{window.dispatchEvent(new Event("request.end"))}}function P(e){return e.split("/").slice(0,2).join("/")}},6605:(e,t,n)=>{"use strict";n.r(t),n.d(t,{pipes:()=>r.pipes,processPipes:()=>i,utils:()=>r.utils});var r=n(3669);const o=new Map(Array.from(Object.entries(r.pipes)));function i(e,t){if(0===t.length)return e;let n=e;for(const e of t){const t=o.get(e.identifier);if(!t)return void console.warn(`Unknown pipe: ${e.identifier}`);n=t(n,...e.parameters)}return n}},9185:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Dialog:()=>Nt,Notification:()=>Kt,StoryboardFunctionRegistryFactory:()=>fe,__secret_internals:()=>r,__test_only:()=>{},applyTheme:()=>te,authenticate:()=>jo,batchSetAppsLocalTheme:()=>ne,checkIfByTransform:()=>pt,checkIfOfComputed:()=>dt,createHistory:()=>A,createRuntime:()=>xo,customEditors:()=>Ko,customProcessors:()=>_,customTemplates:()=>Te,fetchByProvider:()=>qo,getAuth:()=>Vo,getBasePath:()=>f,getCssPropertyValue:()=>ce,getCurrentMode:()=>se,getCurrentTheme:()=>ee,getHistory:()=>k,getPageInfo:()=>Qr,getRealValue:()=>Go,getRuntime:()=>To,getV2RuntimeFromDll:()=>S,handleHttpError:()=>Wt,httpErrorToString:()=>Ft,isLoggedIn:()=>Ho,isUnauthenticatedError:()=>jt,logout:()=>Do,matchPath:()=>At,registerWidgetFunctions:()=>Me,registerWidgetI18n:()=>N,setUIVersion:()=>eo,unstable_createRoot:()=>zo});var r={};n.r(r),n.d(r,{addRealTimeDataInspectHook:()=>yr,debugDataValue:()=>fr,getAddedContracts:()=>pr,getAllContextValues:()=>ar,getBrickPackagesById:()=>cr,getContextValue:()=>sr,getLegalRuntimeValue:()=>hr,getRenderId:()=>dr,legacyDoTransform:()=>Yn,loadBricks:()=>lr,loadEditors:()=>ur,mountUseBrick:()=>Jn,renderUseBrick:()=>Gn,setRealTimeDataInspectRoot:()=>vr,symbolForRootRuntimeContext:()=>zn,unmountUseBrick:()=>Xn,updateSnippetPreviewSettings:()=>or,updateStoryboard:()=>Qn,updateStoryboardByRoute:()=>Zn,updateStoryboardBySnippet:()=>rr,updateStoryboardByTemplate:()=>er,updateTemplatePreviewSettings:()=>tr});var o=n(4586),i=n(918),s=n(6121),a=n(829),c=n(5015),l=n(4197),u=n(6458),d=n(1302),p=(n(6036),n(2890));function f(){const e=document.querySelector("base");return e?e.getAttribute("href"):"/"}var h=n(1030);function m(e,t){const n=(0,h.orderBy)(e,(e=>{var t;return(null===(t=e.app.homepage)||void 0===t?void 0:t.length)??0}),"desc");for(const e of n){const n=e.app.homepage;if("string"==typeof n&&"/"===n[0]&&g(n,t))return e}}function g(e,t){return"/"===e?t===e:`${t.replace(/\/+$/,"")}/`.startsWith(`${e.replace(/\/+$/,"")}/`)}function v(e){var t;return!e||(null===(t=To().getCurrentApp())||void 0===t?void 0:t.id)!==e.app.id&&!window.STANDALONE_MICRO_APPS&&e.app.standaloneMode}let y,w=!1;function E(e,t){w=!confirm(e),t(!w)}function b(e){const{push:t,replace:n}=e;function r(r){return function(o,i,s){let a;const c="string"==typeof o;return a=c?(0,p.parsePath)(o).pathname:o.pathname,"string"==typeof a&&a.startsWith("/")&&v(function(e){var t;return m((null===(t=Io)||void 0===t?void 0:t.storyboards)??[],e)}(a))?location["push"===r?"assign":"replace"](c?f()+o.substring(1):e.createHref(o)):("push"===r?t:n)(o,i,s)}}return{push:r("push"),replace:r("replace")}}function S(){var e;const{dll:t}=window;if(t&&null!==(e=window.BRICK_NEXT_VERSIONS)&&void 0!==e&&null!==(e=e["brick-container"])&&void 0!==e&&e.startsWith("2."))return t("tYg3")}function A(){if(!y){const e=(0,p.createBrowserHistory)({basename:f().replace(/\/$/,""),getUserConfirmation:E});Object.assign(e,function(e){const{push:t,replace:n}=e;function r(e,n,r){w=!1,t(e,n),null==r||r(w)}function o(e,t,r){w=!1,n(e,t),null==r||r(w)}function i(t){return function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;const{extraQuery:a,clear:c,keepHash:l,...u}=i,d=new URLSearchParams(c?"":e.location.search),p={};Object.assign(p,n,a);for(const[e,t]of Object.entries(p))if(Array.isArray(t)){d.delete(e);for(const n of t)d.append(e,n)}else null==t||""===t?d.delete(e):d.set(e,t);("push"===t?r:o)(`?${d.toString()}${l?e.location.hash:""}`,u,s)}}let s;return{pushQuery:i("push"),replaceQuery:i("replace"),pushAnchor:function(t,n,o){r({...e.location,key:void 0,hash:t,state:{notify:!1,...n}},void 0,o)},reload:function(t){o({...e.location,state:{...e.location.state,notify:!0,noIncremental:!0}},void 0,t)},setBlockMessage:function(e){s=e},getBlockMessage:function(){return s},unblock:function(){s=void 0},...b({...e,push:r,replace:o})}}(e)),y=e}return y}const k=function(){const e=S();if(e)return e.getHistory}()||function(){return y};var I=n(4635),P=n(2559),O=n(8612),C=n(5238),x=n(2036),T=n(8439),R=n(9481),L=new WeakMap;const _=function(){const e=S();if(e)return Object.freeze({define:(t,n)=>e.getRuntime().registerCustomProcessor(t,n)})}()||new class{constructor(){(0,i.A)(this,L,new Map)}define(e,t){const[n,r]=e.split(".");let o=(0,a.A)(L,this).get(n);if(o||(o=new Map,(0,a.A)(L,this).set(n,o)),o.has(r))throw new Error(`Custom processor of "${e}" already registered`);o.set(r,t)}get(e){return(0,a.A)(L,this).get(e)}};function B(e){let{app:t,meta:n}=e;if(null!=n&&n.i18n){const e=M("app",t.id),r=[];return Object.entries(n.i18n).forEach((t=>{let[n,o]=t;c.i18n.addResourceBundle(n,e,o),r.push(n)})),()=>{for(const t of r)c.i18n.removeResourceBundle(t,e)}}}function M(e,t){return`${e}/${t}`}function $(e){return c.i18n.getFixedT(null,M("widget",e))}const N=function(){const e=S();if(e)return function(t,n){return e.getRuntime().registerWidgetI18n(t,n)}}()||function(e,t){const n=M("widget",e);Object.entries(t).forEach((e=>{let[t,r]=e;c.i18n.addResourceBundle(t,n,r)}))},U="brick-next-devtools-panel",F="devtools-frame-active-change",j="devtools-panel-change";let V,D=!0;function H(e,t){const n=W();if(!n||"evaluation"===e&&(!D||V&&"Evaluations"!==V))return;const r=()=>{var r;null===(r=n.emit)||void 0===r||r.call(n,{type:e,payload:t})};"function"==typeof window.requestIdleCallback?window.requestIdleCallback(r):setTimeout(r,0)}function W(){return window.__BRICK_NEXT_DEVTOOLS_HOOK__}const K=()=>{throw new Error("Can't modify read-only proxy object")},q={set:K,defineProperty:K,deleteProperty:K,setPrototypeOf:K};function z(e){return new Proxy(e,q)}function G(e){let{get:t,ownKeys:n}=e;return W()?z(Object.fromEntries(n(null).map((e=>[e,t(null,e,null)])))):new Proxy(Object.freeze({}),{get:t})}let J="light";const X=new u.JsonStorage(localStorage),Y="apps-theme";function Q(e){if("dark"!==e&&"light"!==e&&"dark-v2"!==e)throw new Error(`Unsupported theme: ${e}`);J=e}function Z(){return J}function ee(){return document.documentElement.dataset.theme}function te(e){e?Q(e):e=Z(),e!==ee()&&(document.documentElement.dataset.theme=e,window.dispatchEvent(new CustomEvent("theme.change",{detail:e})))}function ne(e){X.setItem(Y,{...re(),...e})}function re(){let e;try{e=X.getItem(Y)}catch{console.error("JSON parse error inside `getLocalAppsTheme()`")}return e??{}}let oe="default";function ie(e){if("dashboard"!==e&&"default"!==e)throw new Error(`Unsupported mode: ${e}`);oe=e}function se(){return document.documentElement.dataset.mode}function ae(e){e?ie(e):e=oe,e!==se()&&(document.documentElement.dataset.mode=e,window.dispatchEvent(new CustomEvent("mode.change",{detail:e})))}function ce(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;return n&&(null===(t=window.getComputedStyle(n))||void 0===t?void 0:t.getPropertyValue(e))||""}function le(e,t){const n={};for(const r of e){const e=ue(r,t);void 0!==e&&(n[r]=e)}return n}function ue(e,t){var n,r,o;let{collectCoverage:i,widgetId:s,widgetVersion:a,app:l,appendI18nNamespace:u,storyboardFunctions:d,isStoryboardFunction:p}=t;switch(e){case"BASE_URL":return i?"/next":f().replace(/\/$/,"");case"FN":return d;case"IMG":return i?{get:e=>`mock/images/${e}`}:s?null==Co||null===(n=Co.images)||void 0===n?void 0:n.widgetImagesFactory(s,a):null==Co||null===(r=Co.images)||void 0===r?void 0:r.imagesFactory(l.id,l.isBuildPush,l.currentVersion);case"I18N":return i?h.identity:s?$(s):c.i18n.getFixedT(null,[u,M("app",l.id)].filter(Boolean));case"I18N_TEXT":return i?de:c.i18nText;case"PERMISSIONS":return z({check:i?pe:null==Co||null===(o=Co.checkPermissions)||void 0===o?void 0:o.checkPermissions});case"THEME":return z({getTheme:i?()=>"light":Z,getCssPropertyValue:i?()=>"":ce});case"console":return p?z(console):void 0;case"location":return i?{href:"http://localhost:3000/functions/test",origin:"http://localhost:3000",host:"localhost:3000",hostname:"localhost"}:{href:location.href,origin:location.origin,host:location.host,hostname:location.hostname}}}function de(e){return null==e?void 0:e.en}function pe(){return!0}function fe(){let{widgetId:e,widgetVersion:t,collectCoverage:n,debuggerOverrides:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map,i=null==r?void 0:r({precookFunction:C.precookFunction,cook:C.cook,supply:R.supply}),s=new Proxy(Object.freeze({}),{get:(c,l)=>function(c){const l=o.get(c);if(!l)return;if(l.processed)return l.cooked;let u;n&&(u=n.createCollector(c));const d=(0,C.precookFunction)(l.source,{typescript:l.typescript,hooks:u&&{beforeVisit:u.beforeVisit},cacheKey:l}),p=(0,R.supply)(d.attemptToVisitGlobals,le(d.attemptToVisitGlobals,{collectCoverage:n,widgetId:e,widgetVersion:t,app:a,storyboardFunctions:s,isStoryboardFunction:!0}),!!n);return l.cooked=(0,C.cook)(d.function,l.source,{rules:{noVar:!0},globalVariables:i?{...p,...null!=i&&i.LodashWithStaticFields&&d.attemptToVisitGlobals.has("_")?{_:{...p._,...i.LodashWithStaticFields}}:null,...null!=i&&i.ArrayConstructor&&d.attemptToVisitGlobals.has("Array")?{Array:i.ArrayConstructor}:null,...null!=i&&i.ObjectWithStaticFields&&d.attemptToVisitGlobals.has("Object")?{Object:{...p.Object,...i.ObjectWithStaticFields}}:null}:p,ArrayConstructor:null==i?void 0:i.ArrayConstructor,hooks:u&&{beforeEvaluate:u.beforeEvaluate,beforeCall:u.beforeCall,beforeBranch:u.beforeBranch},debug:!!r}),l.processed=!0,l.cooked}(l)});let a;return{storyboardFunctions:s,registerStoryboardFunctions:function(e,t){if(t&&(a=t),o.clear(),Array.isArray(e))for(const t of e){let e=t.deps;null==e&&(e=(0,x.collectMemberUsageInFunction)(t,"FN",!!n),e.delete(t.name));const r=t.perm??(0,x.collectMemberUsageInFunction)(t,"PERMISSIONS",!!n).has("check");o.set(t.name,{source:t.source,typescript:t.typescript,deps:e,hasPermissionsCheck:r})}},updateStoryboardFunction(e,t){const n={...t,name:e},r=(0,x.collectMemberUsageInFunction)(n,"FN",!0),i=(0,x.collectMemberUsageInFunction)(n,"PERMISSIONS",!0).has("check");o.set(e,{source:t.source,typescript:t.typescript,deps:r,hasPermissionsCheck:i})},checkPermissionsUsage(e){const t=new Set,n=e=>{if(!t.has(e)){t.add(e);const r=o.get(e);return!!r&&(r.hasPermissionsCheck||[...r.deps].some(n))}return!1};return e.some(n)},clearGlobalExecutionContextStack(){(0,C.__dev_only_clearGlobalExecutionContextStack)()},getGlobalExecutionContextStack:()=>(0,C.__dev_only_getGlobalExecutionContextStack)()}}const{storyboardFunctions:he,registerStoryboardFunctions:me,checkPermissionsUsage:ge}=fe();var ve=n(3601);let ye=function(e){return e.xLarge="xLarge",e.large="large",e.medium="medium",e.small="small",e.xSmall="xSmall",e}({});const we=new Map([[ye.xLarge,"1920px"],[ye.large,"1600px"],[ye.medium,"1280px"],[ye.small,"1024px"],[ye.xSmall,0]]),Ee=new ve.A,be={},Se={};function Ae(e,t){let n=!1;be[t]=e.matches;for(const[e]of we)if(be[e]&&Se.breakpoint!==e){Se.breakpoint=e,n=!0;break}n&&Ee.dispatchEvent(new CustomEvent("change",{detail:Se}))}we.forEach(((e,t)=>{const n=window.matchMedia(`(min-width: ${e})`);Ae(n,t),n.addEventListener?n.addEventListener("change",(e=>{Ae(e,t)})):n.addListener((e=>{Ae(e,t)}))}));const ke=()=>Se;function Ie(e){return function(t){const n="local"===e?localStorage:sessionStorage;return JSON.parse(n.getItem(t)??"null")}}function Pe(e){var t,n;return!(null===(t=e?e.flags:null===(n=To())||void 0===n?void 0:n.getFeatureFlags())||void 0===t||!t["brick-next-v3-strict-mode"])}function Oe(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];const i=0===r.length?"":",";e?console.error(`${t} is dropped in v3 strict mode${i}`,...r):console.warn(`${t} is deprecated in v3 and will be dropped in strict mode${i}`,...r)}const Ce=new Set(["prefix"]);var xe=new WeakMap;const Te=function(){const e=S();if(e)return Object.freeze({define:(t,n)=>e.getRuntime().registerCustomTemplate(t,n)})}()||new class{constructor(){(0,i.A)(this,xe,new Map)}define(e,t){var n,r;let o=(0,a.A)(xe,this).has(e);o?console.warn(`Custom template of "${e}" already registered.`):(o=!!customElements.get(e),o&&console.warn(`Custom template of "${e}" already defined by customElements.`));const i=Pe(),s=(null===(n=t.proxy)||void 0===n?void 0:n.properties)??{},c=[],l=[];for(const[t,n]of Object.entries(s))n.asVariable?(Oe(i,"Template `asVariable`",e,t),i||l.push(t)):n.mergeProperty||n.refTransform?console.error("Template `mergeProperty` and `refTransform` are dropped in v3:",e,t):n.ref&&c.push([t,n]);const u={...t,proxy:{...t.proxy,properties:Object.fromEntries(c)},state:(t.state?i?t.state:t.state.map((e=>({expose:!0,...e}))):[]).concat(l.map((e=>({name:e,expose:!0}))))};(0,a.A)(xe,this).set(e,{...u,name:e});const d=(p=u.state,(0,h.uniq)((null==p?void 0:p.filter((e=>e.expose)).map((e=>e.name)))??[]));var p;const f=Object.entries((null===(r=u.proxy)||void 0===r?void 0:r.methods)??{}),m=d.concat(c.map((e=>e[0]))),g=f.map((e=>e[0])),v=m.concat(g).filter((e=>e in HTMLElement.prototype&&!Ce.has(e)));if(v.length>0&&(Oe(i,"Using native HTMLElement properties as template properties or methods",e,...v),i))throw new Error(`In custom template "${e}", ${v.map((e=>`"${e}"`)).join(", ")} are native HTMLElement properties, and should be avoid to be used as brick properties or methods.`);if(!o){class t extends HTMLElement{get $$typeof(){return"custom-template"}static get _dev_only_definedProperties(){return m}static get _dev_only_definedMethods(){return g}$$getElementByRef(e){var t;return null===(t=this.$$tplStateStore)||void 0===t||null===(t=t.hostBrick)||void 0===t||null===(t=t.tplHostMetadata)||void 0===t||null===(t=t.internalBricksByRef.get(e))||void 0===t?void 0:t.element}connectedCallback(){let e=this.shadowRoot;e||(e=this.attachShadow({mode:"open"}));const t=document.createDocumentFragment(),n=document.createElement("style");n.textContent=":host{display:block}:host([hidden]){display:none}";const r=document.createElement("slot");t.appendChild(n),t.appendChild(r),e.appendChild(t)}disconnectedCallback(){this.shadowRoot&&(this.shadowRoot.textContent="")}}for(const n of d)c.some((e=>e[0]===n))?console.error(`Cannot define an exposed state that is also a proxy property: "${n}" in ${e}`):Object.defineProperty(t.prototype,n,{get(){return this.$$tplStateStore.getValue(n)},set(e){var t;null===(t=this.$$tplStateStore)||void 0===t||t.updateValue(n,e,"replace")},enumerable:!0});for(const[e,n]of c)Object.defineProperty(t.prototype,e,{get(){return this.$$getElementByRef(n.ref)[n.refProperty??e]},set(t){var r;const o=null===(r=this.$$getElementByRef)||void 0===r?void 0:r.call(this,n.ref);o&&(o[n.refProperty??e]=t)},enumerable:!0});for(const[e,n]of f)Object.defineProperty(t.prototype,e,{value(){return this.$$getElementByRef(n.ref)[n.refMethod??e](...arguments)},enumerable:!0});customElements.define(e,t)}}get(e){return(0,a.A)(xe,this).get(e)}};function Re(e,t,n){let{tplStateStoreId:r,tplStateStoreMap:o}=e;if(!r)throw new Error(`Using "${t}" outside of a custom template${n??""}`);const i=o.get(r);if(!i)throw new Error(`Template state store is not found when using "${t}"${n??""}.\nThis is a bug of Brick Next, please report it.`);return i}function Le(e,t,n){const r=Re(e,t,n).hostBrick.element;if(!r)throw new Error(`Template host element is gone when using "${t}"${n??""}.\nThis is a bug of Brick Next, please report it.`);return r}const _e=new Map,Be=new Proxy(Object.freeze({}),{get:(e,t)=>_e.get(t)}),Me=function(){const e=S();if(e)return function(t,n,r){return e.getRuntime().registerWidgetFunctions(t,n,r)}}()||function(e,t,n){if(_e.has(e))throw new Error(`Widget functions of "${e}" already registered`);const{storyboardFunctions:r,registerStoryboardFunctions:o}=fe({widgetId:e,widgetVersion:n});_e.set(e,r),o(t)};var $e=n(5462);function Ne(e,t){let n=Fo(e);if(!n&&null!=Co&&Co.checkInstalledApps&&(n=Co.checkInstalledApps.getCheckedApp(e)),!n||"running"===n.installStatus)return!1;if(!t||!n.currentVersion)return!0;const r=t.match(/^([><]=?|=)(.*)$/);try{if(!r)throw new TypeError(`Invalid match version: ${t}`);return(0,$e.U)(n.currentVersion,r[2],r[1])}catch(e){console.error(e)}return!1}function Ue(e,t,n){let{formStateStoreId:r,formStateStoreMap:o}=e;if(!r)throw new Error(`Using "${t}" outside of form renderer${n??""}`);const i=o.get(r);if(!i)throw new Error(`Form state store is not found when using "${t}"${n??""}.\nThis is a bug of Brick Next, please report it.`);return i}const Fe=new Map;async function je(e){var t;const n=null==Co||null===(t=Co.flowApi)||void 0===t?void 0:t.isFlowApiProvider(e);n&&(e=Co.flowApi.FLOW_API_PROVIDER);let r=Fe.get(e);if(r)return r;if(e.includes("-")&&!customElements.get(e))if(n)Co.flowApi.registerFlowApiProvider();else if(await(0,l.loadBricksImperatively)([e],Bo()),!customElements.get(e))throw new Error(`Provider not defined: "${e}".`);return r=document.createElement(e),Fe.set(e,r),r}let Ve=new WeakSet;function De(e){if((0,u.isObject)(e)&&!He(e))if(Ve.add(e),Array.isArray(e))e.forEach(De);else{const t=Object.getPrototypeOf(e);t&&t.constructor!==Object||Object.values(e).forEach(De)}}function He(e){return Ve.has(e)}const We=new Map;async function Ke(e,t,n){const{useProvider:r,method:o="resolve",args:i=[],onReject:s}=e,{provider:a,field:c}=e;if(a&&!r)throw new Error(`You're using "provider: ${a}" which is dropped in v3, please use "useProvider" instead`);const l=null!=c;if(l){const e=Pe();if(Oe(e,"`resolve.field`"),e)throw new Error("Using deprecated `resolve.field`")}const[u,d]=await Promise.all([je(r),it(i,t)]),p=null==n?void 0:n.renderId,f=qe(u,r,o,d,n,i,!!p&&p!==$o());let m,{transform:g}=e;try{const e=await f;m=l?(0,h.get)(e,c):e,De(m)}catch(e){if(!function(e){return!(null==e||!e.transform)}(s))throw e;g=s.transform,m=e}return g?"string"==typeof g?{[g]:m}:it(g,{...t,data:m}):m}async function qe(e,t,n,r,o,i,s){let a,c;try{a=JSON.stringify({useProvider:t,method:n,args:r})}catch(e){if(!i)throw e;a=JSON.stringify({useProvider:t,method:n,originalArgs:i})}return"reload"!==(null==o?void 0:o.cache)&&(c=We.get(a)),c||(c=(async o=>{const i=null!=Co&&null!==(o=Co.flowApi)&&void 0!==o&&o.isFlowApiProvider(t)?await Co.flowApi.getArgsOfFlowApi(t,r,n):r;return e[n](...i)})(),s||We.set(a,c)),c}const ze=Symbol.for("pre.evaluated.raw"),Ge=Symbol.for("pre.evaluated.context");function Je(e){return!(null==e||!e[ze])}function Xe(e){return e[ze]}function Ye(e){return"string"==typeof e?(0,C.shouldAllowRecursiveEvaluations)(e):(0,C.shouldAllowRecursiveEvaluations)(e[ze])}const Qe=new WeakSet([SyntaxError,TypeError,ReferenceError]);function Ze(e){return Qe.has(e.constructor)?e.constructor:TypeError}function et(e,t,n){const{run:r}=tt(e,t,n,!1);return r()}function tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const o=[];if("string"!=typeof e){const n=(0,h.omit)(t,["pendingPermissionsPreCheck","tplStateStoreMap","tplStateStoreScope","formStateStoreMap","formStateStoreScope"]);t={...e[Ge],...n},e=e[ze]}const i={usedArgs:new Set},s={usedArgs:new Set};let a;try{a=(0,C.preevaluate)(e,{cache:!0,withParent:!0,hooks:{beforeVisitGlobal(e,t){(0,x.collectAppGetMenuUsage)(i,e,t),(0,x.collectInstalledAppsHasUsage)(s,e,t)}}})}catch(t){const n=`${t.message}, in "${e}"`;throw new(Ze(t))(n)}if(i.hasNonStaticUsage)throw new Error(`Non-static usage of "APP.getMenu" is prohibited in v3, check your expression: "${e}"`);if(s.hasNonStaticUsage)throw new Error(`Non-static usage of "INSTALLED_APPS.has" is prohibited in v3, check your expression: "${e}"`);const c={},{attemptToVisitGlobals:d}=a;if(n.lazy||d.has("EVENT")&&!(0,u.hasOwnProperty)(t,"event")||d.has("DATA")&&!(0,u.hasOwnProperty)(t,"data"))return{blockingList:o,run:()=>Object.keys(t).length>0?{[ze]:e,[Ge]:t}:e};let p,f,m,g;const v=Pe(t);let y,w;(d.has("STATE")||!v&&d.has("TPL"))&&(g=Re(t,"STATE",`: "${e}"`)),d.has("FORM_STATE")&&(w=Ue(t,"FORM_STATE",`: "${e}"`));const E=W();if(r||E){if(d.has("CTX")&&(p=(0,x.strictCollectMemberUsage)(e,"CTX"),r&&o.push(t.ctxStore.waitFor(p))),g){if(m=(0,x.strictCollectMemberUsage)(e,"STATE"),!v){const t=(0,x.strictCollectMemberUsage)(e,"TPL");for(const e of t)m.add(e)}r&&o.push(g.waitFor(m))}w&&(y=(0,x.strictCollectMemberUsage)(e,"FORM_STATE"),r&&o.push(w.waitFor(y))),d.has("PROCESSORS")&&(f=(0,x.strictCollectMemberUsage)(e,"PROCESSORS",2),r&&o.push((0,l.loadProcessorsImperatively)(f,Bo())))}if(r){let n=d.has("PERMISSIONS");if(!n&&d.has("FN")){const t=[...(0,x.strictCollectMemberUsage)(e,"FN")];n=ge(t)}if(n&&o.push(...t.pendingPermissionsPreCheck),i.usedArgs.size>0&&null!=Co&&Co.menu){const e=[...i.usedArgs];o.push(Promise.all(e.map((e=>Co.menu.fetchMenuById(e,t,{getStoryboardByAppId:Uo,resolveData:Ke,asyncComputeRealValue:it})))))}var b;s.usedArgs.size>0&&o.push(null==Co||null===(b=Co.checkInstalledApps)||void 0===b?void 0:b.waitForCheckingApps([...s.usedArgs]))}return{blockingList:o,run(){var n,r;const{app:o,location:i,query:s,match:l,flags:E,sys:b,ctxStore:S,data:A,event:k}=t,I=t.overrideApp??o;for(const o of d)switch(o){case"ANCHOR":c[o]=i.hash?i.hash.substring(1):null;break;case"APP":if(null==I)throw new ReferenceError(`APP is not defined, in "${e}"`);c[o]={...(0,h.cloneDeep)(I),getMenu:null==Co||null===(n=Co.menu)||void 0===n?void 0:n.getMenuById};break;case"CTX":c[o]=G({get:(e,t)=>S.getValue(t),ownKeys:()=>Array.from(p)});break;case"DATA":c[o]=A;break;case"EVENT":c[o]=k;break;case"FLAGS":c[o]=z(E);break;case"FORM_STATE":c[o]=G({get:(e,t)=>w.getValue(t),ownKeys:()=>Array.from(y)});break;case"HASH":c[o]=i.hash;break;case"INSTALLED_APPS":c[o]=z({has:Ne});break;case"ITEM":case"INDEX":case"SIZE":{const n="ITEM"===o?"forEachItem":"INDEX"===o?"forEachIndex":"forEachSize";(0,u.hasOwnProperty)(t,n)?c[o]=t[n]:console.error(`Using \`${o}\` but no \`:forEach\` is found, check your expression: "${e}"`);break}case"LOCAL_STORAGE":c[o]=z({getItem:Ie("local")});break;case"MEDIA":c[o]=z(ke());break;case"MISC":c[o]=To().getMiscSettings();break;case"PARAMS":if(null==s)throw new ReferenceError(`PARAMS is not defined, in "${e}"`);c[o]=new URLSearchParams(s);break;case"PATH":c[o]=z((null==l?void 0:l.params)??{});break;case"PATH_NAME":c[o]=i.pathname;break;case"PROCESSORS":c[o]=G({get(e,t){const n=_.get(t);if(!n)throw new Error(`'PROCESSORS.${t}' is not registered! Have you installed the relevant brick package?`);return G({get:(e,t)=>n.get(t),ownKeys:()=>Array.from(n.keys())})},ownKeys(){const e=new Set;for(const t of f){const n=t.split(".")[0];e.add(n)}return Array.from(e)}});break;case"QUERY":if(null==s)throw new ReferenceError(`QUERY is not defined, in "${e}"`);c[o]=Object.fromEntries(Array.from(s.keys()).map((e=>[e,s.get(e)])));break;case"QUERY_ARRAY":if(null==s)throw new ReferenceError(`QUERY_ARRAY is not defined, in "${e}"`);c[o]=Object.fromEntries(Array.from(s.keys()).map((e=>[e,s.getAll(e)])));break;case"SESSION_STORAGE":c[o]=z({getItem:Ie("session")});break;case"TPL":if(Oe(v,'Using "TPL" in expression',`check your expression: "${e}"`),v)break;case"STATE":c[o]=G({get:(e,t)=>g.getValue(t),ownKeys:()=>Array.from(m)});break;case"SYS":c[o]=z(b??{});break;case"__WIDGET_FN__":c[o]=Be;break;case"__WIDGET_IMG__":c[o]=null==Co||null===(r=Co.images)||void 0===r?void 0:r.widgetImagesFactory;break;case"__WIDGET_I18N__":c[o]=$}Object.assign(c,le(a.attemptToVisitGlobals,{storyboardFunctions:he,app:I,appendI18nNamespace:t.appendI18nNamespace}));try{const t=(0,C.cook)(a.expression,a.source,{globalVariables:(0,R.supply)(a.attemptToVisitGlobals,c)});return H("evaluation",{raw:e,context:c,result:t}),t}catch(t){const n=`${t.message}, in "${e}"`;throw new(Ze(t))(n)}}}}let nt=function(e){return e[e.INITIAL=0]="INITIAL",e[e.USE_BRICK=1]="USE_BRICK",e[e.USE_BRICK_ITEM=2]="USE_BRICK_ITEM",e[e.USE_BRICK_PROPERTIES=3]="USE_BRICK_PROPERTIES",e[e.USE_BRICK_TRANSFORM=4]="USE_BRICK_TRANSFORM",e[e.USE_BRICK_EVENTS=5]="USE_BRICK_EVENTS",e[e.USE_BRICK_IF=6]="USE_BRICK_IF",e[e.USE_BRICK_SLOTS=7]="USE_BRICK_SLOTS",e[e.USE_BRICK_SLOTS_ITEM=8]="USE_BRICK_SLOTS_ITEM",e[e.USE_BRICK_SLOTS_ITEM_BRICKS=9]="USE_BRICK_SLOTS_ITEM_BRICKS",e[e.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM=10]="USE_BRICK_SLOTS_ITEM_BRICKS_ITEM",e[e.USE_BRICK_LIFECYCLE=11]="USE_BRICK_LIFECYCLE",e[e.USE_BRICK_DATA_SOURCE=12]="USE_BRICK_DATA_SOURCE",e}({});function rt(e){switch(e){case nt.USE_BRICK_PROPERTIES:case nt.USE_BRICK_TRANSFORM:case nt.USE_BRICK_EVENTS:case nt.USE_BRICK_IF:case nt.USE_BRICK_LIFECYCLE:case nt.USE_BRICK_DATA_SOURCE:return!0}return!1}function ot(e,t,n){if(rt(e))return e;if(t)switch(e){case nt.USE_BRICK:return nt.USE_BRICK_ITEM;case nt.USE_BRICK_SLOTS_ITEM_BRICKS:return nt.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM}else switch(e){case nt.INITIAL:if("useBrick"===n)return nt.USE_BRICK;break;case nt.USE_BRICK:case nt.USE_BRICK_ITEM:case nt.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:switch(n){case"properties":return nt.USE_BRICK_PROPERTIES;case"transform":return nt.USE_BRICK_TRANSFORM;case"dataSource":return nt.USE_BRICK_DATA_SOURCE;case"events":return nt.USE_BRICK_EVENTS;case"slots":return nt.USE_BRICK_SLOTS;case"children":return nt.USE_BRICK_SLOTS_ITEM_BRICKS;case"if":return nt.USE_BRICK_IF;case"lifeCycle":return nt.USE_BRICK_LIFECYCLE}break;case nt.USE_BRICK_SLOTS:return nt.USE_BRICK_SLOTS_ITEM;case nt.USE_BRICK_SLOTS_ITEM:if("bricks"===n)return nt.USE_BRICK_SLOTS_ITEM_BRICKS}return nt.INITIAL}async function it(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Je(e);if(r||"string"==typeof e){const o=n.$$lazyForUseBrick&&rt(n.$$stateOfUseBrick);let i,s=o;return r||(0,C.isEvaluable)(e)?(i=await async function(e,t,n){const{blockingList:r,run:o}=tt(e,t,n,!0);return await Promise.all(r),o()}(e,t,{lazy:o}),s=Ye(e)):i=o?e:((0,u.hasOwnProperty)(t,"data")?n.noInject?T.transform:T.transformAndInject:n.noInject?ct:T.inject)(e,t),s||De(i),i}if(!(0,u.isObject)(e)||He(e)||"function"==typeof e)return e;if(Array.isArray(e)){const r=at(n,!0);return Promise.all(e.map((e=>it(e,t,r))))}return Object.fromEntries((await Promise.all(Object.entries(e).map((e=>{let[r,o]=e;return Promise.all([it(r,t),it(o,t,at(n,!1,r))])})))).concat(n.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))}function st(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Je(e);if(r||"string"==typeof e){const o=n.$$lazyForUseBrick&&rt(n.$$stateOfUseBrick);let i,s=o;return r||(0,C.isEvaluable)(e)?(i=et(e,t),s=Ye(e)):i=o?e:((0,u.hasOwnProperty)(t,"data")?n.noInject?T.transform:T.transformAndInject:n.noInject?ct:T.inject)(e,t),s||De(i),i}if(!(0,u.isObject)(e)||He(e)||"function"==typeof e)return e;if(Array.isArray(e)){const r=at(n,!0);return e.map((e=>st(e,t,r)))}return Object.fromEntries(Object.entries(e).map((e=>{let[r,o]=e;return[st(r,t),st(o,t,at(n,!1,r))]})).concat(n.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))}function at(e,t,n){return e.$$lazyForUseBrick?{...e,$$stateOfUseBrick:ot(e.$$stateOfUseBrick,t,n)}:e}function ct(e){return e}async function lt(e,t){return!(0,u.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||Je(e.if)?await it(e.if,t):e.if)}function ut(e,t){return!(0,u.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||Je(e.if)?st(e.if,t):e.if)}function dt(e){return!(0,u.hasOwnProperty)(e,"if")||!!e.if}const pt=function(){const e=S();if(e)return e.looseCheckIfByTransform}()||function(e,t){return ut(e,{data:t})};function ft(e){let t=!1,n=!1,r=!1;if("string"==typeof e?(0,C.isEvaluable)(e):Je(e)){const o="string"==typeof e?e:Xe(e);if((0,C.isTrackAll)(o)){const e=(0,x.trackAll)(o);e&&(t=e.context,n=e.state,r=e.formState)}else t=(0,x.track)(o,"track context","CTX"),n=(0,x.track)(o,"track state","STATE"),r=(0,x.track)(o,"track formstate","FORM_STATE")}return{contextNames:t,stateNames:n,formStateNames:r}}async function ht(e,t){for(const[n,r,o]of e)if(n===t){const e=await r;if(void 0!==e||!o)return e}}async function mt(e){const t={};for(const[n,r,o]of e){const e=await r;void 0===e&&o||!("style"!==n&&"dataset"!==n||(0,u.isObject)(e))||(t[n]=e)}return t}function gt(e,t){if(t)for(const[n,r]of Object.entries(t))switch(n){case"style":case"dataset":for(const[t,o]of Object.entries(r))e[n][t]=o;break;case"constructor":case"__proto__":case"innerHTML":throw new Error(`set \`${n}\` is prohibited`);default:e[n]=r}}function vt(e,t,n){const r=function(e,t){return(0,u.isObject)(e)?Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;const o=st(r,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===n?nt.USE_BRICK:nt.INITIAL});if("style"!==n&&"dataset"!==n||(0,u.isObject)(o))return[n,o]})).filter(Boolean)):{}}(t,n);Array.isArray(e)||(e=[e]),e.forEach((e=>{gt(e,r)}))}function yt(e,t,n){if(n)for(const{contextNames:r,stateNames:o,propValue:i}of t){if(r)for(const t of r)n.disposes.push(e.ctxStore.onChange(t,n.listener));if(o)for(const t of o){const r=Re(e,"STATE",`: "${i}"`);n.disposes.push(r.onChange(t,n.listener))}}}var wt=n(264);const Et=new Map,bt=1e4;let St=0;function At(e,t){const{path:n,exact:r=!1,strict:o=!1,sensitive:i=!0}=t;return(Array.isArray(n)?n:[n]).reduce(((t,n)=>{if(t)return t;const{regexp:s,keys:a}=function(e,t){const n=`${t.end}${t.strict}${t.sensitive}`;let r=Et.get(n);r||Et.set(n,r=new Map);const o=r.get(e);if(o)return o;const i=[],s={regexp:(0,wt.MM)(e,i,t),keys:i};return St<bt&&(r.set(e,s),St++),s}(n,{end:r,strict:o,sensitive:i}),c=s.exec(e);if(!c)return null;const[l,...u]=c,d=e===l;return r&&!d?null:{path:n,url:"/"===n&&""===l?"/":l,isExact:d,params:a.reduce(((e,t,n)=>(e[t.name]=u[n],e)),{})}}),null)}function kt(e,t,n){return At(n,{path:e.path.replace(/^\$\{APP.homepage\}/,t),exact:e.exact})}const It=Symbol.for("tpl.asyncComputedPropsFromHost"),Pt=Symbol.for("tpl.stateStoreId"),Ot=Symbol.for("tpl.externalForEachItem"),Ct=Symbol.for("tpl.externalForEachIndex"),xt=Symbol.for("tpl.externalForEachSize"),Tt=new Set;let Rt=function(e){return e.REQUEST_FAILED="REQUEST_FAILED",e.SOMETHING_WENT_WRONG="SOMETHING_WENT_WRONG",e.LOGIN_TIMEOUT_MESSAGE="LOGIN_TIMEOUT_MESSAGE",e.NETWORK_ERROR="NETWORK_ERROR",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.NO_PERMISSION="NO_PERMISSION",e.PAGE_NOT_FOUND="PAGE_NOT_FOUND",e.APP_NOT_FOUND="APP_NOT_FOUND",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.GO_BACK_TO_PREVIOUS_PAGE="GO_BACK_TO_PREVIOUS_PAGE",e.GO_BACK_HOME="GO_BACK_HOME",e.RELOAD="RELOAD",e}({});const Lt={[Rt.REQUEST_FAILED]:"Request Failed",[Rt.SOMETHING_WENT_WRONG]:"Something went wrong!",[Rt.LOGIN_TIMEOUT_MESSAGE]:"You haven't logged in or your login session has expired. Login right now?",[Rt.NETWORK_ERROR]:"Network error, please check your network.",[Rt.LICENSE_EXPIRED]:"The license authorization has expired, please contact the platform administrator",[Rt.NO_PERMISSION]:"Unauthorized access, unable to retrieve the required resources for this page",[Rt.PAGE_NOT_FOUND]:"Page not found, please check the URL",[Rt.APP_NOT_FOUND]:"App not found, maybe the URL is wrong or you don't have permission to access",[Rt.UNKNOWN_ERROR]:"Oops! Something went wrong",[Rt.GO_BACK_TO_PREVIOUS_PAGE]:"Go back to previous page",[Rt.GO_BACK_HOME]:"Go back to home page",[Rt.RELOAD]:"Reload"},_t={[Rt.REQUEST_FAILED]:"请求失败",[Rt.SOMETHING_WENT_WRONG]:"出现了一些问题！",[Rt.LOGIN_TIMEOUT_MESSAGE]:"您还未登录或登录信息已过期，现在重新登录？",[Rt.NETWORK_ERROR]:"网络错误，请检查您的网络连接。",[Rt.LICENSE_EXPIRED]:"License 授权失效，请联系平台管理员",[Rt.NO_PERMISSION]:"没有权限，无法获取页面所需要的资源",[Rt.PAGE_NOT_FOUND]:"请求的页面未找到，请确认 URL 是否正确",[Rt.APP_NOT_FOUND]:"请求的微应用无法找到, 可能是 URL 错误或者无权限访问",[Rt.UNKNOWN_ERROR]:"糟糕！页面出现了一些问题",[Rt.GO_BACK_TO_PREVIOUS_PAGE]:"回到上一页",[Rt.GO_BACK_HOME]:"回到首页",[Rt.RELOAD]:"刷新"},Bt="core/runtime",Mt={en:Lt,zh:_t};let $t;const Nt=Object.freeze({show:function(e){if($t)return $t.resolve(e);if("confirm"===e.type){const t=confirm(e.content);return new Promise(((e,n)=>setTimeout((()=>{(t?e:n)()}),1)))}return alert(e.content),new Promise((e=>setTimeout((()=>{e()}),1)))}});function Ut(e){const{search:t,pathname:n}=e,r=n?window.btoa(encodeURIComponent(n)):"",o=t?window.btoa(encodeURIComponent(t)):"";document.cookie=`SALOGINPATH=${r}; path=/`,document.cookie=`SALOGINQUERY=${o}; path=/`}function Ft(e){if(e instanceof Event&&e.target instanceof HTMLScriptElement)return e.target.src;if(e instanceof O.HttpFetchError)return c.i18n.t(`${Bt}:${Rt.NETWORK_ERROR}`);if(e instanceof O.HttpResponseError&&e.responseJson){if("string"==typeof e.responseJson.error)return e.responseJson.error;if("string"==typeof e.responseJson.msg)return e.responseJson.msg}return null==e?"Unknown error":e.toString()}function jt(e){return e instanceof O.HttpResponseError&&401===e.response.status&&!!e.responseJson&&100003===e.responseJson.code}let Vt,Dt,Ht=!1;function Wt(e){if(e instanceof O.HttpAbortError)return;if(jt(e)&&!window.NO_AUTH_GUARD){if(Ht)return;return Ht=!0,void Nt.show({type:"confirm",content:c.i18n.t(`${Bt}:${Rt.LOGIN_TIMEOUT_MESSAGE}`)}).then((()=>{!function(){const e=To().getFeatureFlags()["sso-enabled"],t=k();Ut(t.location),t.push(e?"/sso-auth/login":"/auth/login",{from:{...t.location,state:void 0}})}(),Ht=!1}),(()=>{Ht=!1}))}console.error(e);const t=Ft(e);t!==Vt&&(Vt=t,Nt.show({type:"error",title:c.i18n.t(`${Bt}:${Rt.REQUEST_FAILED}`),content:t,contentStyle:{whiteSpace:"pre-wrap",wordBreak:"break-word"}}).then((()=>{Vt=void 0})))}const Kt=Object.freeze({show:function(e){Dt?Dt.resolve(e):alert(e.message)}});function qt(e,t,n){t&&Object.entries(t).forEach((t=>{let[r,o]=t;const i=Yt(o,n,{element:e});e.addEventListener(r,i),e.$$listeners||(e.$$listeners=[]),e.$$listeners.push([r,i]),e.$$eventListeners||(e.$$eventListeners=[]);for(const t of[].concat(o))e.$$eventListeners.push([r,null,t])}))}function zt(e){return"string"==typeof e.action}function Gt(e){return"string"==typeof e.useProvider}function Jt(e){return!(!e.target&&!e.targetRef||!e.method&&!e.properties)}function Xt(e){return!!e.then}function Yt(e,t,n){return function(r){for(const o of[].concat(e))if(ut(o,{...t,event:r}))if(Xt(o))Yt(o.then,t,n)(r);else if(zt(o)){const[e,i]=o.action.split(".");switch(o.action){case"history.push":case"history.replace":case"history.pushQuery":case"history.replaceQuery":case"history.pushAnchor":case"history.block":case"history.goBack":case"history.goForward":case"history.reload":case"history.unblock":tn(r,i,o.args,o.callback,t);break;case"window.open":nn(r,o.args,t);break;case"window.postMessage":rn(r,o.args,t);break;case"parent.postMessage":on(r,o.args,t);break;case"location.reload":case"location.assign":un(r,i,o.args,t);break;case"localStorage.setItem":case"localStorage.removeItem":case"sessionStorage.setItem":case"sessionStorage.removeItem":dn(r,e,i,o.args,t);break;case"event.preventDefault":r.preventDefault();break;case"event.stopPropagation":r.stopPropagation();break;case"console.log":case"console.error":case"console.warn":case"console.info":pn(r,i,o.args,t);break;case"message.success":case"message.error":case"message.info":case"message.warn":fn(r,i,o.args,t);break;case"handleHttpError":Wt(r.detail);break;case"context.assign":case"context.replace":case"context.refresh":case"context.load":an(r,i,o.args,o.batch??!0,o.callback,t);break;case"state.update":case"state.refresh":case"state.load":cn(r,i,o.args,o.batch??!0,o.callback,t);break;case"tpl.dispatchEvent":{const[e,n]=gn(o.args,t,r);Le(t,o.action,`: ${e}`).dispatchEvent(new CustomEvent(e,n));break}case"formstate.update":ln(r,o.args,o.callback,t);break;case"message.subscribe":case"message.unsubscribe":hn(r,i,o.args,t,n,o.callback);break;case"theme.setDarkTheme":case"theme.setLightTheme":te("theme.setDarkTheme"===o.action?"dark":"light");break;case"theme.setTheme":{const[e]=gn(o.args,t,r);te(e);break}case"mode.setDashboardMode":case"mode.setDefaultMode":ae("mode.setDashboardMode"===o.action?"dashboard":"default");break;default:console.error("unknown event listener action:",o.action)}}else Gt(o)?Qt(r,o,t,n):Jt(o)?Zt(r,o,t,n):console.error("unknown event handler:",o);else o.else&&Yt(o.else,t,n)(r)}}function Qt(e,t,n,r){const o="saveAs"!==t.method?"resolve":"saveAs";en(e,t.useProvider,t,o,n,r)}function Zt(e,t,n,r){let o=[];const i=t.target,s=t.targetRef;let a=i;if(("string"==typeof i?(0,C.isEvaluable)(i):Je(i))&&(a=st(i,{...n,event:e})),"string"==typeof a)if("_self"===a)o.push(r.element);else if(t.multiple)o=Array.from(document.querySelectorAll(a));else{const e=document.querySelector(a);null!==e&&o.push(e)}else if(a)a instanceof HTMLElement?o.push(a):console.error("unexpected target:",a);else if(s){let t=s;("string"==typeof s?(0,C.isEvaluable)(s):Je(s))&&(t=st(s,{...n,event:e}));const r=[].concat(t),i=Le(n,"targetRef",`: ${r.join(", ")}`);o.push(...r.map((e=>{var t;return null===(t=i.$$getElementByRef)||void 0===t?void 0:t.call(i,e)})).filter(Boolean))}0!==o.length?function(e){return!!e.method}(t)?o.forEach((o=>{en(e,o,t,t.method,n,r,{useEventAsDefault:!0})})):function(e){return!!e.properties}(t)&&vt(o,t.properties,{...n,event:e}):console.error("target not found:",i||s)}async function en(e,t,n,r,o,i,s){const a=Gt(n),c=async()=>{var i;const c=a?await je(t):t;if("function"!=typeof c[r])throw new Error(`target <${c.tagName.toLowerCase()}> has no method: ${r}`);let l=gn(n.args,o,e,s);var u;return Gt(n)&&null!=Co&&null!==(i=Co.flowApi)&&void 0!==i&&i.isFlowApiProvider(n.useProvider)&&(l=await Co.flowApi.getArgsOfFlowApi(n.useProvider,l,r,null===(u=n.sse)||void 0===u?void 0:u.stream)),c[r](...l)};if(!n.callback)return void c();const l=mn(n.callback,o,i),u={progress:l("progress"),success:l("success"),error:l("error"),finally:l("finally")};if(a){var d,p;const t={...o,event:e};if(st(null===(d=n.sse)||void 0===d?void 0:d.stream,t))return void async function(e,t){let{progress:n,success:r,error:o,finally:i}=t;const s=$o();try{const t=await e();for await(const e of t){if(s!==$o())return;null==n||n(e)}if(s!==$o())return;null==r||r()}catch(e){if(s!==$o())return;null==o||o(e)}finally{null==i||i()}}(c,u);if(st(null===(p=n.poll)||void 0===p?void 0:p.enabled,t))return void function(e,t,n,r){let{progress:o,success:i,error:s,finally:a}=t;const{expectPollStopImmediately:c,expectPollEnd:l}=n,{interval:u,leadingRequestDelay:d,continueOnError:p,delegateLoadingBar:f}=st((0,h.pick)(n,["interval","leadingRequestDelay","continueOnError","delegateLoadingBar"]),r),m=$o();let g;async function v(){let t;Tt.delete(g);try{var n;if(t=null===(n=st(c,r))||void 0===n?void 0:n(),t)null==a||a();else{var d;const n=await e(),s=null===(d=st(c,r))||void 0===d?void 0:d();var h;t=s||m!==$o(),t?s&&(null==a||a()):(null==o||o(n),null!==(h=st(l,r))&&void 0!==h&&h(n)?(f&&window.dispatchEvent(new Event("request.end")),null==i||i(n),null==a||a()):y(u??3e3))}}catch(e){var v;const n=null===(v=st(c,r))||void 0===v?void 0:v();t=n||m!==$o(),t?n&&(null==a||a()):(null==s||s(e),p?y(u??3e3):null==a||a())}finally{f&&t&&window.dispatchEvent(new Event("request.end"))}}function y(e){g=setTimeout(v,e),Tt.add(g)}y(d??0),f&&window.dispatchEvent(new Event("request.start"))}(c,u,n.poll,t)}try{const e=await c();u.success(e)}catch(e){u.error(e)}finally{u.finally()}}function tn(e,t,n,r,o){let i=0,s=!1,a=t;switch(t){case"push":case"replace":case"pushQuery":case"replaceQuery":case"pushAnchor":i=2,s=!0;break;case"reload":s=!0;break;case"block":i=1,a="setBlockMessage"}let c=[];if(i>0&&(c=gn(n,o,e,{useEventDetailAsDefault:!0}),c.length=i),s&&r){const e=mn(r,o,void 0);c.push((t=>{e(t?"error":"success")({blocked:t}),e("finally")({blocked:t})}))}k()[a](...c)}function nn(e,t,n){const[r,o,i]=gn(t,n,e);window.open(r,o||"_self",i)}function rn(e,t,n){const r=gn(t,n,e);1===r.length&&r.push(location.origin),window.postMessage(...r)}function on(e,t,n){if(parent===window)throw new Error("parent is the window itself");const r=gn(t,n,e);parent.postMessage(...r)}function sn(e,t,n,r,o,i){t?r.updateValues(e,n,(e=>gn(e,o,i)[0])):e.forEach((e=>{const{name:t,value:s}=gn([e],o,i)[0];r.updateValue(t,s,n)}))}function an(e,t,n,r,o,i){if(!Array.isArray(n)||!n.every(u.isObject)||"assign"!==t&&"replace"!==t){const[r,s]=gn(n,i,e);i.ctxStore.updateValue(r,s,t,o,i)}else sn(n,r,t,i.ctxStore,i,e)}function cn(e,t,n,r,o,i){if(Array.isArray(n)&&n.every(u.isObject)&&"update"===t)sn(n,r,"replace",Re(i,`state.${t}`,`: ${JSON.stringify(n)}`),i,e);else{const[r,s]=gn(n,i,e);Re(i,`state.${t}`,`: ${r}`).updateValue(r,s,"update"===t?"replace":t,o,i)}}function ln(e,t,n,r){const[o,i]=gn(t,r,e);Ue(r,"formstate.update",`: ${o}`).updateValue(o,i,"replace",n,r)}function un(e,t,n,r){if("assign"===t){const[t]=gn(n,r,e);location.assign(t)}else location[t]()}function dn(e,t,n,r,o){const i="localStorage"===t?localStorage:sessionStorage,[s,a]=gn(r,o,e);"setItem"===n?void 0!==a&&i.setItem(s,JSON.stringify(a)):i.removeItem(s)}function pn(e,t,n,r){console[t](...gn(n,r,e,{useEventAsDefault:!0}))}function fn(e,t,n,r){const o=gn(n,r,e,{useEventAsDefault:!0});Kt.show({type:t,message:o[0]})}async function hn(e,t,n,r,o,i){const s=()=>{var o;const i=gn(n,r,e);return null==Co||null===(o=Co.messageDispatcher)||void 0===o?void 0:o[t](...i)};if(!i)return void s();const a=mn(i,r,o);try{const e=await s();a("success")(e)}catch(e){a("error")(e)}finally{a("finally")()}}function mn(e,t,n){return function(r){return function(o){const i=null==e?void 0:e[r];if(i)try{const e=new CustomEvent(`callback.${r}`,{detail:o});Yt(i,t,n)(e)}catch(e){console.error(e)}else"error"===r&&console.error("Unhandled callback error:",o)}}}function gn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Array.isArray(e)?st(e,{...t,event:n}):r.useEventAsDefault?[n]:r.useEventDetailAsDefault?[n.detail]:[]}function vn(e){var t;const{ref:n,runtimeContext:r,element:o}=e;if(!n||!r.tplStateStoreId)return;const{hostBrick:i}=Re(r,"bindTemplateProxy"),s=i.tplHostMetadata;s.internalBricksByRef.set(n,e);const a=null===(t=s.proxy)||void 0===t?void 0:t.events;if(a)for(const[e,t]of Object.entries(a))if(t.ref===n){var c;const n=t=>{t.bubbles&&t.stopPropagation(),i.element.dispatchEvent(new CustomEvent(e,{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}))},r=t.refEvent??e;o.addEventListener(r,n),(c=o).$$proxyListeners??(c.$$proxyListeners=[]),o.$$proxyListeners.push([r,n])}}function yn(e){const{ref:t,runtimeContext:n,element:r}=e;if(null==n||!n.tplStateStoreId||!t)return;const{hostBrick:o}=Re(n,"unbindTemplateProxy");o.tplHostMetadata.internalBricksByRef.delete(t);for(const[e,t]of r.$$proxyListeners??[])r.removeEventListener(e,t);delete r.$$proxyListeners}let wn=function(e){return e[e.ROOT=1]="ROOT",e[e.BRICK=2]="BRICK",e[e.PLACEHOLDER=3]="PLACEHOLDER",e}({});function En(e){e.replaceChildren()}function bn(e,t){window.DISABLE_REACT_FLUSH_SYNC=!1;let n=e.child;const r=[];for(;n;){if(n.tag===wn.BRICK){var o;const i=n.type;i.includes("-")&&!customElements.get(i)&&console.error(`Undefined custom element: ${i}`),"basic-bricks.script-brick"===i&&console.warn("`basic-bricks.script-brick` is deprecated, please take caution when using it");const s=t&&n===e.child?t:document.createElement(i);n.element=s,n.slotId&&s.setAttribute("slot",n.slotId),n.iid&&(s.dataset.iid=n.iid),null!==(o=n.tplHostMetadata)&&void 0!==o&&o.tplStateStoreId&&(s.dataset.tplStateStoreId=n.tplHostMetadata.tplStateStoreId),gt(s,n.properties),qt(s,n.events,n.runtimeContext),n.tplHostMetadata&&(s.$$tplStateStore=Re({tplStateStoreId:n.tplHostMetadata.tplStateStoreId,tplStateStoreMap:n.runtimeContext.tplStateStoreMap},"mount")),vn(n),n.portal?r.push(s):n.return&&(n.return.childElements||(n.return.childElements=[]),n.return.childElements.push(s))}if(n.child)n=n.child;else if(n.sibling)n=n.sibling;else{var i;let e=n.return;for(;e;){var s;if(e.childElements)e.tag===wn.ROOT?null===(s=e.container)||void 0===s||s.append(...e.childElements):e.element.append(...e.childElements),e.childElements=void 0;if(e.tag===wn.ROOT&&r.length>0&&("function"==typeof e.createPortal?e.createPortal():e.createPortal).append(...r),e.sibling)break;e=e.return}n=null===(i=e)||void 0===i?void 0:i.sibling}}setTimeout((()=>{window.DISABLE_REACT_FLUSH_SYNC=!0}))}const Sn=["onMount","onUnmount","onMediaChange","onScrollIntoView","onMessage","onMessageClose"],An=["onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload"];var kn=new WeakMap,In=new WeakMap,Pn=new WeakMap,On=new WeakMap,Cn=new WeakMap,xn=new WeakMap,Tn=new WeakMap,Rn=new WeakMap,Ln=new WeakMap,_n=new WeakSet;class Bn{constructor(e,t){(0,I.A)(this,_n),(0,o.A)(this,"scope",void 0),(0,o.A)(this,"unknownBricks",void 0),(0,o.A)(this,"renderId",void 0),(0,i.A)(this,kn,void 0),(0,i.A)(this,In,{onBeforePageLoad:[],onPageLoad:[],onPageLeave:[],onBeforePageLeave:[],onAnchorLoad:[],onAnchorUnload:[],onMediaChange:[],onScrollIntoView:[],onMount:[],onUnmount:[],onMessage:[],onMessageClose:[]}),(0,i.A)(this,Pn,new Map),(0,i.A)(this,On,void 0),(0,i.A)(this,Cn,new Map),(0,i.A)(this,xn,void 0),(0,i.A)(this,Tn,void 0),(0,i.A)(this,Rn,new WeakMap),(0,i.A)(this,Ln,new Map),this.scope=e,this.unknownBricks=(null==t?void 0:t.unknownBricks)??"throw",(0,s.A)(kn,this,null==t?void 0:t.routeHelper),this.renderId=null==t?void 0:t.renderId}setInitialMenuRequestNode(e){(0,s.A)(Tn,this,e)}memoizeMenuRequestNode(e,t){(0,a.A)(Rn,this).set(e,t)}getMenuRequests(){const e=[];let t=(0,a.A)(Tn,this);for(;t;)if(t.request&&e.push(t.request),t.child)t=t.child;else{for(var n;t&&!t.sibling;)t=t.return;t=null===(n=t)||void 0===n?void 0:n.sibling}return e}async reMergeMenuRequestNodes(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(0,a.A)(Rn,this).get(t);(0,a.A)(Rn,this).set(t,n);let o,i=e.child;for(;i&&i!==r;)o=i,i=i.sibling;o?(o.sibling=n,n.sibling=null==r?void 0:r.sibling):e.child=n,await(0,a.A)(kn,this).mergeMenus(this.getMenuRequests())}reBailout(e){return(0,a.A)(kn,this).bailout(e)}reCatch(e,t){return(0,a.A)(kn,this).catch(e,t,!1,!0)}async didPerformIncrementalRender(e,t){let n=!1;const r=[];for(const{parentRoutes:o,callback:i}of[...(0,a.A)(Ln,this).values()].reverse()){const s=o[o.length-1];if(r.includes(s))continue;const a=await i(e,t);a&&r.push(...o.slice(0,-1)),!1!==a&&(n=!0)}return n}performIncrementalRender(e,t,n){(0,a.A)(Ln,this).set(e,{parentRoutes:t,callback:n})}registerBrickLifeCycle(e,t){if(!t)return;const n=[...Sn,..."page"===this.scope?An:[]];for(const r of n){const n=t[r];n&&(0,a.A)(In,this)[r].push({brick:e,handlers:n})}(0,h.isEmpty)(t.useResolves)||console.error("`lifeCycle.useResolves` is dropped in v3:",t)}registerArbitraryLifeCycle(e,t){const n=(0,a.A)(Cn,this).get(e);n?n.add(t):(0,a.A)(Cn,this).set(e,new Set([t]))}memoize(e,t,n,r){(0,a.A)(xn,this)||(0,s.A)(xn,this,new WeakMap);const o=[e??"",...t].join(".");let i=(0,a.A)(xn,this).get(r);i||(i=new Map,(0,a.A)(xn,this).set(r,i)),i.set(o,{node:n,last:Fn(n),lastNormal:jn(n),lastPortal:Dn(n)})}reRender(e,t,n,r){const o=[e??"",...t].join("."),i=(0,a.A)(xn,this).get(r).get(o),{node:s,last:c,lastNormal:l,lastPortal:u}=i;let d;const p=[];if((null==s?void 0:s.tag)===wn.PLACEHOLDER){var f,h;d=(null===(f=function(e){return Vn(e,!0)}(s))||void 0===f?void 0:f.element)??null;const e=null===(h=function(e){return Hn(e,!0)}(s))||void 0===h?void 0:h.element;e&&p.push(e)}else{var m,g;d=(null==l||null===(m=l.element)||void 0===m?void 0:m.nextSibling)??null;let e=null==u||null===(g=u.element)||void 0===g?void 0:g.nextSibling;for(;e&&(p.push(e),e instanceof HTMLElement&&"DIV"===e.tagName);)e=e.nextSibling}const v=Fn(n);let y;i.node=n,i.last=v,i.lastNormal=jn(n),i.lastPortal=Dn(n);let w=r.child;for(;w&&w!==c;){if(w.sibling===s){y=w;break}w=w.sibling}const E=document.createDocumentFragment(),b=document.createDocumentFragment(),S={tag:wn.ROOT,container:E,createPortal:b,child:n};for(w=n;w;)w.return=S,w=w.sibling;const A=Wn(s,c);for((0,P.A)(_n,this,Mn).call(this,A),bn(S),y?y.sibling=n:r.child=n,v&&(v.sibling=null==c?void 0:c.sibling),w=n;w;)w.return=r,w=w.sibling;var k,I;if(E.hasChildNodes()&&(r.tag===wn.ROOT?null===(k=r.container)||void 0===k||k.insertBefore(E,d):null===(I=r.element)||void 0===I||I.insertBefore(E,d)),b.hasChildNodes()){var O;let e=n;for(;e&&e.return;)e=e.return;if((null===(O=e)||void 0===O?void 0:O.tag)!==wn.ROOT)throw new Error("Cannot find render root node. This is a bug of Brick Next, please report it.");const t="function"==typeof e.createPortal?e.createPortal():e.createPortal;let r=null;for(const e of p)if(t.contains(e)){r=e;break}t.insertBefore(b,r)}const C=Wn(n,v);(0,P.A)(_n,this,$n).call(this,C)}dispose(){for(const e of Object.values((0,a.A)(In,this)))e.length=0;for(const e of(0,a.A)(Pn,this).values()){for(const t of e)t.disconnect();e.length=0}(0,a.A)(Pn,this).clear(),(0,a.A)(On,this)&&(Ee.removeEventListener("change",(0,a.A)(On,this)),(0,s.A)(On,this,void 0)),(0,s.A)(xn,this,void 0),(0,a.A)(Cn,this).clear(),(0,a.A)(Ln,this).clear(),(0,s.A)(Rn,this,void 0)}dispatchBeforePageLoad(){(0,P.A)(_n,this,Nn).call(this,"onBeforePageLoad",new CustomEvent("page.beforeLoad"))}dispatchPageLoad(){const e=new CustomEvent("page.load");(0,P.A)(_n,this,Nn).call(this,"onPageLoad",e),window.dispatchEvent(e)}dispatchBeforePageLeave(e){(0,P.A)(_n,this,Nn).call(this,"onBeforePageLeave",new CustomEvent("page.beforeLeave",{detail:e}))}dispatchPageLeave(){(0,P.A)(_n,this,Nn).call(this,"onPageLeave",new CustomEvent("page.leave"))}dispatchAnchorLoad(){const{hash:e}=k().location;e&&"#"!==e?(0,P.A)(_n,this,Nn).call(this,"onAnchorLoad",new CustomEvent("anchor.load",{detail:{hash:e,anchor:e.substring(1)}})):(0,P.A)(_n,this,Nn).call(this,"onAnchorUnload",new CustomEvent("anchor.unload"))}initializeScrollIntoView(){for(const{brick:e,handlers:t}of(0,a.A)(In,this).onScrollIntoView)(0,P.A)(_n,this,Un).call(this,e,t)}initializeMediaChange(){(0,s.A)(On,this,(e=>{(0,P.A)(_n,this,Nn).call(this,"onMediaChange",new CustomEvent("media.change",{detail:z(e.detail)}))})),Ee.addEventListener("change",(0,a.A)(On,this))}initializeMessageDispatcher(){var e;for(const{brick:e,handlers:n}of(0,a.A)(In,this).onMessage)for(const r of[].concat(n)){var t;null==Co||null===(t=Co.messageDispatcher)||void 0===t||t.onMessage(r.channel,(t=>{Yt(r.handlers,e.runtimeContext,e)(new CustomEvent("message.push",{detail:t}))}))}null==Co||null===(e=Co.messageDispatcher)||void 0===e||e.onClose((()=>{(0,P.A)(_n,this,Nn).call(this,"onMessageClose",new CustomEvent("message.close"))}))}dispatchOnMount(){(0,P.A)(_n,this,Nn).call(this,"onMount",new CustomEvent("mount"))}dispatchOnUnmount(){(0,P.A)(_n,this,Nn).call(this,"onUnmount",new CustomEvent("unmount"))}}function Mn(e){const t=[...Sn,..."page"===this.scope?An:[]],n=[];for(const r of t){const t=(0,h.remove)((0,a.A)(In,this)[r],(t=>e.has(t.brick)));"onUnmount"===r&&n.push(...t)}for(const t of e){var r,o,i;const e=(0,a.A)(Pn,this).get(t);if(null!=e&&e.length){for(const t of e)t.disconnect();e.length=0,(0,a.A)(Pn,this).delete(t)}yn(t),null===(r=t.element)||void 0===r||delete r.$$tplStateStore,null===(o=t.element)||void 0===o||o.remove(),null===(i=t.disposes)||void 0===i||i.forEach((e=>e())),delete t.disposes}const s=new CustomEvent("unmount");for(const{brick:e,handlers:t}of n)Yt(t,e.runtimeContext,e)(s)}function $n(e){const t=new CustomEvent("mount");for(const{brick:n,handlers:r}of(0,a.A)(In,this).onMount)e.has(n)&&Yt(r,n.runtimeContext,n)(t);for(const{brick:t,handlers:n}of(0,a.A)(In,this).onScrollIntoView)e.has(t)&&(0,P.A)(_n,this,Un).call(this,t,n)}function Nn(e,t){for(const{brick:n,handlers:r}of(0,a.A)(In,this)[e])Yt(r,n.runtimeContext,n)(t);const n=(0,a.A)(Cn,this).get(e);if(n)for(const e of n)e()}function Un(e,t){const n=t.threshold??.1,r=new IntersectionObserver(((r,o)=>{r.forEach((r=>{r.isIntersecting&&r.intersectionRatio>=n&&(Yt(t.handlers,e.runtimeContext,e)(new CustomEvent("scroll.into.view")),o.disconnect())}))}),{threshold:n});r.observe(e.element);let o=(0,a.A)(Pn,this).get(e);o||(o=[],(0,a.A)(Pn,this).set(e,o)),o.push(r)}function Fn(e){let t=e;for(;null!==(n=t)&&void 0!==n&&n.sibling;){var n;t=t.sibling}return t}function jn(e){return Vn(e,!1)}function Vn(e,t){let n,r=e;for(;r;){if(r.tag===wn.BRICK&&!r.portal){if(t)return r;n=r}r=r.sibling}return n}function Dn(e){return Hn(e,!1)}function Hn(e,t){let n,r=e;for(;r;){if(r.tag===wn.BRICK&&r.portal){if(t)return r;n=r}if(r.child)r=r.child;else if(r.sibling)r=r.sibling;else{var o;let e=r.return;for(;e&&!e.sibling;)e=e.return;r=null===(o=e)||void 0===o?void 0:o.sibling}}return n}function Wn(e,t){const n=new Set;let r=e;for(;r;)if(r.tag===wn.BRICK&&n.add(r),r.child)r=r.child;else{if(r===t)break;if(r.sibling)r=r.sibling;else{var o;let e=r.return;for(;e&&e!==t&&!e.sibling;)e=e.return;if(e===t)break;r=null===(o=e)||void 0===o?void 0:o.sibling}}return n}const Kn=new Map;function qn(e){return Kn.get(e)}const zn=Symbol.for("root.runtimeContext");async function Gn(e,t,n){var r,o;const[i,s,a]=Wr({...e[zn]??No(),data:t,pendingPermissionsPreCheck:[]});i.tplStateStoreMap??(i.tplStateStoreMap=new Map),i.formStateStoreMap??(i.formStateStoreMap=new Map);const c=new Bn("fragment"),l={tag:wn.ROOT,createPortal:null},u=e.transform,d=Pe();u&&Oe(d,"`useBrick.transform`",'please use "properties" instead, check your useBrick:',e);const p=await Vr(l,d&&!n?e:{errorBoundary:n,...e,properties:{...e.properties,...u}},i,c,[],{}),f=[...s,...a];if(await Hr(p,i,f),(null===(r=p.node)||void 0===r?void 0:r.tag)===wn.PLACEHOLDER)throw new Error("The root brick of useBrick cannot be an ignored control node");if(null!==(o=p.node)&&void 0!==o&&o.portal)throw new Error("The root brick of useBrick cannot be a portal brick");return l.child=p.node,{tagName:p.node?p.node.type:null,renderRoot:l,rendererContext:c,scopedStores:f}}function Jn(e,t){let n,{renderRoot:r,rendererContext:o,scopedStores:i}=e;r.createPortal=()=>{const e=document.querySelector("#portal-mount-point");return n=document.createElement("div"),e.appendChild(n),n},bn(r,t),o.dispatchOnMount(),o.initializeScrollIntoView(),o.initializeMediaChange(),o.initializeMessageDispatcher();for(const e of i)e.mountAsyncData();return{portal:n}}function Xn(e,t){let{rendererContext:n}=e;t.portal&&(En(t.portal),t.portal.remove()),n.dispatchOnUnmount(),n.dispose()}function Yn(e,t,n){if(n)throw new Error("Legacy doTransform does not support options in v3");return st(t,{...No(),data:e},{noInject:!0})}function Qn(e,t){const n=Uo(e);Object.assign(n,{...t,meta:{...n.meta,...t.meta},$$fulfilling:null,$$fulfilled:!0,$$registerCustomTemplateProcessed:!1}),B(n)}function Zn(e,t){const n=Uo(e);let r=!1;function o(e){e.forEach(((n,s)=>{"routes"===n.type?o(n.routes):function(e){return e.path===t.path&&!e.exact==!t.exact}(n)?(r=!0,e[s]=t):Array.isArray(n.bricks)&&i(n.bricks)}))}function i(e){e.forEach((e=>{if(e.slots)for(const t of Object.values(e.slots))"routes"===t.type?o(t.routes):i(t.bricks)}))}o(n.routes),r||n.routes.unshift(t)}function er(e,t,n){const r=`${e}.${t.name}`;Te.define(r,{bricks:t.bricks,proxy:t.proxy,state:t.state}),tr(e,t.name,n)}function tr(e,t,n){ir(e,`\${APP.homepage}/_dev_only_/template-preview/${t}`,[{brick:t,...(0,h.pick)(n,"properties","events","lifeCycle","context","slots","children")}])}function nr(e){return`\${APP.homepage}/_dev_only_/snippet-preview/${e}`}function rr(e,t){var n;ir(e,nr(t.snippetId),null!==(n=t.bricks)&&void 0!==n&&n.length?t.bricks:[{brick:"span"}],t.context)}const or=rr;function ir(e,t,n,r){const{routes:o}=Uo(e),i=o.findIndex((e=>e.path===t)),s={path:t,bricks:n,context:r,menu:!1,exact:!0};-1===i?o.unshift(s):o.splice(i,1,s)}function sr(e,t){let{tplStateStoreId:n}=t;const r=No();return n?Re({...r,tplStateStoreId:n},"STATE").getValue(e):r.ctxStore.getValue(e)}function ar(e){let{tplStateStoreId:t}=e;const n=No();return t?Re({...n,tplStateStoreId:t},"STATE").getAllValues():n.ctxStore.getAllValues()}function cr(e){return Bo().find((t=>t.id?t.id===e:t.filePath.startsWith(`${e}/`)))}function lr(e){return(0,l.loadBricksImperatively)(e,Bo())}function ur(e,t){return(0,l.loadEditorsImperatively)(e,t??Bo())}function dr(){return $o()}async function pr(e,t){let{appId:n,updateStoryboardType:r,collectUsedContracts:o}=t;const i=Uo(n);let s;if("route"===r)s={routes:[e]};else if("template"===r)s={meta:{customTemplates:[e]}};else if("snippet"===r){var a;const t=nr(e.snippetId);s={routes:[null==i||null===(a=i.routes)||void 0===a?void 0:a.find((e=>e.path===t))]}}const c=[];return s&&o&&(await o(s)).forEach((e=>{var t;const[n,r,o]=e.match(/(.*)@(.*):\d\.\d\.\d/);null!=i&&null!==(t=i.meta)&&void 0!==t&&null!==(t=t.contracts)&&void 0!==t&&t.some((e=>e.namespaceId===r&&e.name===o))||c.push(e)})),c}async function fr(e,t){let{tplStateStoreId:n,routeId:r}=t;const o={...No(),tplStateStoreId:n,match:qn(r)};return e.resolve?Ke(e.resolve,o,{cache:"reload"}):it(e.value,o)}function hr(e){const t=No();return{app:(null==t?void 0:t.overrideApp)??(null==t?void 0:t.app),location:(0,h.pick)(location,["href","origin","hostname","host"]),...(0,h.pick)(t,["query","sys"]),match:qn(null==e?void 0:e.routeId)}}let mr;const gr=[];function vr(e){mr=e;const t=ar({tplStateStoreId:e.tplStateStoreId});wr({changeType:"initialize",tplStateStoreId:e.tplStateStoreId,detail:{data:t}})}function yr(e){gr.push(e)}function wr(e){setTimeout((()=>{for(const t of gr)try{t(e)}catch(t){console.error(`RealTimeDataInspectHook failed (${e.changeType}):`,t)}}))}const Er=["onBeforePageLoad","onPageLoad","onBeforePageLeave","onPageLeave","onAnchorLoad","onAnchorUnload"];class br{constructor(e,t,n,r){(0,o.A)(this,"type",void 0),(0,o.A)(this,"data",new Map),(0,o.A)(this,"changeEventType",void 0),(0,o.A)(this,"pendingStack",[]),(0,o.A)(this,"hostBrick",void 0),(0,o.A)(this,"stateStoreId",void 0),(0,o.A)(this,"batchUpdate",!1),(0,o.A)(this,"batchUpdateContextsNames",[]),(0,o.A)(this,"rendererContext",void 0),(0,o.A)(this,"routeMap",new WeakMap),this.type=e,this.changeEventType="FORM_STATE"===this.type?"formstate.change":"STATE"===this.type?"state.change":"context.change",this.hostBrick=t,this.rendererContext=n,this.stateStoreId=r}getAllValues(){return Object.fromEntries([...this.data.entries()].map((e=>{let[t,{value:n}]=e;return[t,n]})))}getValue(e){var t;return null===(t=this.data.get(e))||void 0===t?void 0:t.value}notifyRealTimeDataChange(e,t){if(mr){const{tplStateStoreId:n}=mr;(n?"STATE"===this.type&&this.stateStoreId===n:"CTX"===this.type)&&wr({changeType:"update",tplStateStoreId:n,detail:{name:e,value:t}})}}getAffectListByContext(e){const t=[e];return this.data.forEach(((e,n)=>{e.deps&&e.deps.some((e=>t.includes(e)))&&t.push(n)&&t.push(...this.getAffectListByContext(n))})),t.shift(),[...new Set(t)]}updateValues(e,t,n){if(this.batchUpdate=!0,this.batchUpdateContextsNames=e.map((e=>e.name)),[...new Set(this.batchUpdateContextsNames)].length!==this.batchUpdateContextsNames.length)throw new Error("Batch update not allow to update same item");const r={},o={},i=[];e.forEach((e=>{const{name:o,value:s}=n([e]),a=this.data.get(o);i.push(...this.getAffectListByContext(o)),a&&(r[o]=a),this.updateValue(o,s,t)})),i.filter((e=>!r[e])).forEach((e=>{const t=this.data.get(e);t&&(o[e]=t)}));const s=e=>{for(const n in e){var t;const r=e[n];null===(t=r.eventTarget)||void 0===t||t.dispatchEvent(new CustomEvent(this.changeEventType,{detail:r.value}))}};s(r),s(o),this.batchUpdate=!1}updateValue(e,t,n,r,o){const i=this.data.get(e);if(!i)throw new Error(`${this.type} '${e}' is not defined`);if("refresh"!==n&&"load"!==n)"replace"===n?i.value=t:(0,u.isObject)(i.value)?Object.assign(i.value,t):(console.warn(`Non-object current value of "${this.type}.${e}" for "context.assign", try "context.replace" instead.`),i.value=t),this.batchUpdate||i.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:i.value}));else{if(!i.useResolve)throw new Error(`You can not ${n} "${this.type}.${e}" which is not using resolve`);let s;"load"===n&&(i.loaded?s=Promise.resolve(i.value):i.loading&&(s=i.loading));const a=e=>{var t;let n;return"FlowApiNotFoundError"===(null==e?void 0:e.name)&&!!(n=null===(t=this.rendererContext)||void 0===t?void 0:t.renderId)&&n!==$o()};if(s||(s=i.loading=i.load({cache:"load"===n?"default":"reload",...t}),s.then((e=>{this.finishLoad(i,e)}),(e=>{!i.useResolve||a(e)||null!=r&&r.error||Wt(e)}))),r){const e=mn(r,o);s.then((t=>{e("success")({value:t}),e("finally")()}),(t=>{!a(t)&&r.error&&e("error")(t),e("finally")()}))}}}finishLoad(e,t){e.useResolve&&(e.loaded=!0,e.value=t,e.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:t})))}define(e,t,n,r){if(Array.isArray(e)&&e.length>0){const o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CTX";const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CTX",n=arguments.length>2?arguments[2]:void 0;const r=new Map;for(const o of e){const e=[o.if,o.value,o.resolve],i=(0,x.collectMemberUsage)(e,t);if(!n&&"STATE"===t){const t=(0,x.collectMemberUsage)(e,"TPL");for(const e of t.usedProperties)i.usedProperties.add(e);t.hasNonStaticUsage&&(i.hasNonStaticUsage=!0)}r.set(o,i)}return r}(e,n,arguments.length>3?arguments[3]:void 0),o=new Map;for(const e of Array.from(r.keys()).map((e=>e.name)))o.set(e,(o.get(e)??0)+1);const i=Array.from(r.values()).some((e=>e.hasNonStaticUsage)),s=new WeakSet,a=new Map,c=new Map([...new Set(e.map((e=>e.name)))].map((e=>[e,new Promise(((t,n)=>{a.set(e,{resolve:t,reject:n})}))]))),l=async e=>{s.add(e);const n=await t(e);r.delete(e);const i=o.get(e.name)??0;if(n){if(a.get(e.name).resolve(),o.delete(e.name),0===i)throw new Error(`Duplicated context defined: ${e.name}`)}else 1===i?(a.get(e.name).resolve(),o.delete(e.name)):o.set(e.name,i-1);await d()};let u=i;async function d(){const e=Array.from(r.entries()).filter(function(e,t){return(n,r)=>t?0===r:![...n[1].usedProperties].some((t=>e.has(t)))}(o,u)).map((e=>e[0])).filter((e=>!s.has(e)));await Promise.all(e.map(l))}return{pendingResult:d().then((async()=>{r.size>0&&(function(e,t){const n=new Map(e),r=new Set(Array.from(n.keys()).map((e=>e.name))),o=()=>{let e=!1;for(const[t,o]of n.entries())[...o.usedProperties].some((e=>r.has(e)))||(n.delete(t),r.delete(t.name),e=!0);e&&o()};if(o(),n.size>0)throw new ReferenceError(`Circular ${t} detected: ${Array.from(n.keys()).map((e=>e.name)).join(", ")}`)}(r,n),u=!0,await d());for(const e of a.values())e.resolve()})).catch((e=>{for(const t of a.values())t.reject(e);throw e})),pendingContexts:c}}(e,(e=>this.resolve(e,t,n,r)),this.type,Pe(t));this.pendingStack.push(o)}}onChange(e,t){var n;const r=null===(n=this.data.get(e))||void 0===n?void 0:n.eventTarget;return null==r||r.addEventListener(this.changeEventType,t),()=>{null==r||r.removeEventListener(this.changeEventType,t)}}async waitFor(e){for(const{pendingContexts:t}of this.pendingStack)await Promise.all([...e].map((e=>t.get(e))))}async waitForAll(){for(const{pendingContexts:e}of this.pendingStack)for(const t of e.values())t.catch((()=>{}));for(const{pendingResult:e}of this.pendingStack)await e}mountAsyncData(e){this.data.forEach((t=>{var n;if(t.async&&(!e||null!==(n=this.routeMap.get(e))&&void 0!==n&&n.has(t.name))){if(t.asyncMounted)return void console.error(`Async data "${t.name}" already mounted. This is a bug of Brick Next, please report it.`);t.asyncMounted=!0,t.loading.then((e=>{this.finishLoad(t,e)}))}}))}async resolve(e,t,n,r){if(!await lt(e,t))return!1;let o,i,s,a,c,l;if(n&&("STATE"===this.type?e.expose:"FORM_STATE"===this.type)&&(o=await ht(n,e.name)),void 0===o){if(e.resolve){const n=(0,u.hasOwnProperty)(e,"value");c=e.track&&n&&(0,u.hasOwnProperty)(e.resolve,"if")&&(0,x.strictCollectMemberUsage)(e.resolve.if,this.type).size>0;const r={transform:"value",...e.resolve};if(a=await lt(e.resolve,t),(a||c)&&(i=async e=>{var n;return(await Ke(r,t,{...e,renderId:null===(n=this.rendererContext)||void 0===n?void 0:n.renderId})).value}),a)l=e.resolve.async?"async":e.resolve.lazy?"lazy":"eager","eager"===l?o=await i():"async"===l&&(s=i());else if(!n)return!1}a&&"eager"===l||void 0===e.value||(o=await it(e.value,t))}if(this.data.has(e.name))throw new Error(`${this.type} '${e.name}' has already been declared`);const d={name:e.name,value:o,eventTarget:new ve.A,useResolve:a,load:i,loaded:"eager"===l,loading:s,async:"async"===l,deps:[]};if("lazy"===l){const{trigger:t}=e.resolve;var p;t&&Er.includes(t)&&(null===(p=this.rendererContext)||void 0===p||p.registerArbitraryLifeCycle(t,(()=>{this.updateValue(e.name,void 0,"load")})))}if(e.onChange&&d.eventTarget.addEventListener(this.changeEventType,Yt(e.onChange,t)),e.track){const n=(0,x.strictCollectMemberUsage)(c?[e.resolve,e.value]:i?e.resolve:e.value,this.type);!i&&(d.deps=[...n]);for(const r of n)this.onChange(r,this.batchAddListener((()=>{d.useResolve=c?ut(e.resolve,t):!!i,d.useResolve?this.updateValue(e.name,{cache:"default"},"refresh"):this.updateValue(e.name,st(e.value,t),"replace")}),e))}if(d.eventTarget.addEventListener(this.changeEventType,(t=>{this.notifyRealTimeDataChange(e.name,t.detail)})),this.data.set(e.name,d),Array.isArray(r))for(const t of r){const n=this.routeMap.get(t);n?n.add(e.name):this.routeMap.set(t,new Set([e.name]))}return!0}disposeDataInRoutes(e){for(const t of e){const e=this.routeMap.get(t);if(void 0!==e)for(const t of e)this.data.delete(t)}}batchAddListener(e,t){return n=>{this.batchUpdate&&this.batchUpdateContextsNames.includes(t.name)||e(n)}}}function Sr(e,t,n){const{reversedProxies:r,asyncHostPropertyEntries:o,externalSlots:i,tplStateStoreId:s,hostBrick:a}=e;let c;if(t&&r){const e=r.properties.get(t);e&&(d=o,c=e.map((e=>{let{from:t,to:n}=e;const r=d.filter((e=>e[0]===t));if(r.length>0&&n.refProperty)return[n.refProperty,ht(r,t),!0]})).filter(Boolean));const s=r.slots.get(t);if(s&&i){const e=new Map;for(const{from:t,to:r}of s){var l;const o=(null===(l=i[t])||void 0===l?void 0:l.bricks)??[];if(!o.length)continue;const s=r.refSlot??t;let c=e.get(s);if(!c){c=[];const t=(0,u.hasOwnProperty)(n,s)?n[s].bricks.length+1:1;for(let e=0;e<t;e+=1)c.push([]);e.set(s,c)}const d=r.refPosition??-1,p=(0,u.hasOwnProperty)(a.runtimeContext,"forEachItem");c[(0,h.clamp)(d<0?c.length+d:d,0,c.length-1)].push(...p?Ar(o,a.runtimeContext.forEachItem,a.runtimeContext.forEachIndex,a.runtimeContext.forEachSize):o)}for(const[t,r]of e.entries()){(0,u.hasOwnProperty)(n,t)||(n[t]={type:"bricks",bricks:[]});const e=n[t];e.bricks=r.flatMap(((t,n)=>n<e.bricks.length?t.concat(e.bricks[n]):t)),0===e.bricks.length&&delete n[t]}}}var d;return{[It]:c,[Pt]:s}}function Ar(e,t,n,r){return e.map((e=>{let{children:o,slots:i,...s}=e;return{...s,[Ot]:t,[Ct]:n,[xt]:r,slots:":forEach"===s.brick?zr(o,i):Object.fromEntries(Object.entries(zr(o,i)??{}).map((e=>{let[o,i]=e;return[o,"routes"===i.type?{type:"routes",routes:kr(i.routes,t,n,r)}:{type:"bricks",bricks:Ar(i.bricks,t,n,r)}]})))}}))}function kr(e,t,n,r){return e.map((e=>"routes"===e.type?{...e,routes:kr(e.routes,t,n,r)}:"redirect"===e.type?e:{...e,bricks:Ar(e.bricks,t,n,r)}))}function Ir(e,t){function n(e){return(0,u.isObject)(e)&&"function"!=typeof e?Array.isArray(e)?e.map(n):Object.fromEntries(Object.entries(e).map((e=>{let[t,o]=e;return(0,u.isObject)(o)&&"useBrick"===t?Array.isArray(o)?[t,o.map(r)]:[t,r(o)]:[t,n(o)]})).concat(Object.getOwnPropertySymbols(e).map((t=>[t,e[t]])))):e}function r(e){const{properties:o,slots:i,children:s,...a}=e,c=zr(s,i),l=Object.fromEntries(Object.entries(c??{}).map((e=>{let[t,n]=e;return[t,{type:"bricks",bricks:(n.bricks??[]).map(r)}]})));return{...a,properties:n(o),slots:l,...Sr(t,a.ref,l)}}return n(e)}function Pr(e,t,n,r,o){var i;const s=(0,h.uniqueId)("tpl-state-"),a={...n.runtimeContext,tplStateStoreId:s};delete a.forEachItem,delete a.forEachIndex,delete a.forEachSize,delete a.formStateStoreId;const c=new br("STATE",n,o,s);a.tplStateStoreMap.set(s,c),a.tplStateStoreScope&&a.tplStateStoreScope.push(c);const{bricks:l,proxy:u,state:d,contracts:p}=Te.get(e);null==Co||null===(i=Co.flowApi)||void 0===i||i.collectWidgetContract(p),c.define(d,a,r);const{slots:f,children:m,...g}=t,v={...g,brick:e};n.tplHostMetadata={internalBricksByRef:new Map,tplStateStoreId:s,proxy:u};const y={properties:new Map,slots:new Map};if(null!=u&&u.properties)for(const[e,t]of Object.entries(u.properties)){let n=y.properties.get(t.ref);n||(n=[],y.properties.set(t.ref,n)),n.push({from:e,to:t})}if(null!=u&&u.slots)for(const[e,t]of Object.entries(u.slots)){let n=y.slots.get(t.ref);n||(n=[],y.slots.set(t.ref,n)),n.push({from:e,to:t})}const w={reversedProxies:y,asyncHostPropertyEntries:r,externalSlots:zr(m,f),tplStateStoreId:s,hostBrick:n};return v.slots={"":{type:"bricks",bricks:l.map((e=>Or(e,w)))}},v}function Or(e,t){null===e.if&&delete e.if;const{properties:n,slots:r,children:o,...i}=e,s=zr(o,r),a=Object.fromEntries(Object.entries(s??{}).map((e=>{let[n,r]=e;return[n,{type:"bricks",bricks:(r.bricks??[]).map((e=>Or(e,t)))}]})));return{...i,properties:Ir(n,t),slots:a,...Sr(t,i.ref,a)}}const Cr="form-renderer.form-renderer",xr=Symbol.for("form.stateStoreId"),Tr=["forms.general-form","form.general-form","eo-form"];function Rr(e,t,n){const{id:r,bricks:o,events:i,context:s,mountPoint:a,instanceId:c}=e;let{brick:l,properties:d}=e;const p=t.find((e=>e.fieldId===r));if(p){const e=function(e){let t;const n={id:e.fieldId,name:e.fieldId,label:e.name,dataset:{testid:e.fieldId}},r=()=>{var t,n;return{readOnly:null===(t=e.limit)||void 0===t?void 0:t.includes("READONLY"),required:null===(n=e.limit)||void 0===n?void 0:n.includes("REQUIRED")}};switch(e.fieldType){case"INT":t={brick:"forms.general-input-number",properties:{...n,...r(),placeholder:e.description,precision:0,inputBoxStyle:{width:"100%"}}};break;case"BOOLEAN":t={brick:"forms.general-switch",properties:{...n,...r()}};break;case"FLOAT":t={brick:"forms.general-input-number",properties:{...n,...r(),placeholder:e.description,inputBoxStyle:{width:"100%"}}};break;case"ENUM":t={brick:"forms.general-select",properties:{...n,...r(),options:[{label:"选项一",value:1},{label:"选项二",value:2}],placeholder:e.description,inputBoxStyle:{width:"100%"}}};break;case"ENUMS":t={brick:"forms.general-select",properties:{...n,...r(),mode:"multiple",options:[{label:"选项一",value:1},{label:"选项二",value:2}],placeholder:e.description,inputBoxStyle:{width:"100%"}}};break;case"DATE":case"TIME":t={brick:"forms.general-date-picker",properties:{...n,...r(),placeholder:e.description}};break;case"IP":t={brick:"forms.general-input",properties:{...n,...r(),placeholder:e.description,pattern:"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))",message:{pattern:"输入字符不匹配IP格式"}}};break;case"JSON":t={brick:"forms.general-textarea",properties:{...n}};break;case"ARRAY":t={brick:"forms.general-select",properties:{...n}};break;case"STRUCTURE":case"STRUCTURE_ARRAY":t={brick:"forms.cmdb-instance-select-panel",properties:{...n,...r()}};break;default:t={brick:"forms.general-input",properties:{...n,...r(),placeholder:e.description}}}return t}(p);l||(l=e.brick),d={...e.properties,...d}}const f={brick:l,properties:d,iid:c,slot:a,events:i,context:s,children:Lr(o,t,n),[xr]:n};return(0,u.hasOwnProperty)(e,"if")&&(f.if=e.if),f}function Lr(e,t,n){if(Array.isArray(e))return e.map((e=>Rr(e,t,n)))}var _r=new WeakSet;class Br extends HTMLElement{constructor(){super(...arguments),(0,I.A)(this,_r),(0,o.A)(this,"renderRoot",void 0)}get $$typeof(){return"formRenderer"}validate(){(0,P.A)(_r,this,Mr).call(this,"validate")}setInitValue(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,P.A)(_r,this,Mr).call(this,"setInitValue",t)}resetFields(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,P.A)(_r,this,Mr).call(this,"resetFields",t)}}function Mr(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=!1!==this.renderRoot?null===(t=this.firstElementChild)||void 0===t?void 0:t.firstElementChild:this.firstElementChild,i=null==o||null===(n=o.tagName)||void 0===n?void 0:n.toLowerCase();Tr.includes(i)?o[e](...r):console.error(`no ${e} method in the container element`,{container:i})}class $r extends Error{constructor(e){super(e),this.name="PageNotFoundError",Error.captureStackTrace&&Error.captureStackTrace(this,l.BrickLoadError)}}async function Nr(e,t,n){const{title:r,variant:o,showLink:i,showDescription:s}=function(e){var t,n;return e instanceof $r?"app not found"===e.message?{showLink:"home",title:c.i18n.t(`${Bt}:${Rt.APP_NOT_FOUND}`),variant:"no-permission"}:{showLink:"home",variant:"not-found",title:c.i18n.t(`${Bt}:${Rt.PAGE_NOT_FOUND}`)}:e instanceof l.BrickLoadError||e instanceof Error&&"ChunkLoadError"===e.name||e instanceof Event&&"error"===e.type&&e.target instanceof HTMLScriptElement?{showDescription:!0,title:c.i18n.t(`${Bt}:${Rt.NETWORK_ERROR}`),variant:"internet-disconnected",showLink:"reload"}:e instanceof O.HttpResponseError&&403===(null===(t=e.response)||void 0===t?void 0:t.status)?{showLink:"previous",showDescription:!0,title:c.i18n.t(`${Bt}:${Rt.NO_PERMISSION}`),variant:"no-permission"}:e instanceof O.HttpResponseError&&"200000"===(null===(n=e.responseJson)||void 0===n?void 0:n.code)?{showDescription:!0,title:c.i18n.t(`${Bt}:${Rt.LICENSE_EXPIRED}`),variant:"license-expired"}:{showLink:"previous",showDescription:!0,title:c.i18n.t(`${Bt}:${Rt.UNKNOWN_ERROR}`),variant:"unknown-error"}}(e);if(n){const n=Mo().error??"illustrations.error-message";if(!1!==n){const a="eo-link",c=(i?[n,a]:[n]).filter((e=>!customElements.get(e)));try{await Promise.race([(0,l.loadBricksImperatively)(c,Bo()),new Promise(((e,t)=>setTimeout((()=>{t(new Error("timeout"))}),3e3)))]);const u={tag:wn.BRICK,type:n,properties:{errorTitle:r,description:s?Ft(e):void 0,variant:o,dataset:{errorBoundary:""}},runtimeContext:null,return:t};return i&&(u.child=Ur(i,a,u,"")),u}catch(e){console.error("Failed to load brick:",c.join(", "),e)}}}const a=n&&!!customElements.get("easyops-default-error"),u={tag:wn.BRICK,type:a?"easyops-default-error":"div",properties:{errorTitle:r,dataset:{errorBoundary:""},style:{color:"var(--color-error)"}},runtimeContext:null,return:t},d={tag:wn.BRICK,type:"div",properties:{textContent:a?s?Ft(e):"":s?`${r}: ${Ft(e)}`:r},runtimeContext:null,return:u};return u.child=d,n&&i&&(d.sibling=Ur(i,"a",u,a?"link":"")),u}function Ur(e,t,n,r){return{tag:wn.BRICK,type:t,slotId:r,properties:{textContent:"home"===e?c.i18n.t(`${Bt}:${Rt.GO_BACK_HOME}`):"reload"===e?c.i18n.t(`${Bt}:${Rt.RELOAD}`):c.i18n.t(`${Bt}:${Rt.GO_BACK_TO_PREVIOUS_PAGE}`),href:"home"===e?f():"reload"===e?location.href:void 0},events:"previous"===e?{click:{action:"history.goBack"}}:void 0,runtimeContext:null,return:n}}async function Fr(e,t,n,r,o,i,s,a,c){const u=await async function(e,t){for(const n of e){if("string"!=typeof n.path)throw console.error("Invalid route with invalid path:",n),new Error("Invalid route with invalid type of path: "+typeof n.path);const e=kt(n,t.app.homepage,t.location.pathname);if(e&&await lt(n,t))return t.app.noAuthGuard||n.public||null==Co||!Co.auth||Co.auth.isLoggedIn()?{match:e,route:n}:"unauthenticated"}return"missed"}(t,n),d={blockingList:[]},p=d.menuRequestNode={return:i};switch(u){case"missed":break;case"unauthenticated":d.unauthenticated=!0;break;default:{var f;const i=d.route=u.route;d.path=u.match.path;const g={...n,match:u.match};i.iid&&(h=i.iid,m=u.match,Kn.set(h,m)),a&&g.ctxStore.disposeDataInRoutes(t);const v=o.concat(i);g.ctxStore.define(i.context,g,void 0,v),g.pendingPermissionsPreCheck.push(null==Co||null===(f=Co.checkPermissions)||void 0===f?void 0:f.preCheckPermissionsForBrickOrRoute(i,(e=>it(e,g))));const{preLoadBricks:y}=i;if(Array.isArray(y)&&d.blockingList.push((0,l.loadBricksImperatively)(y,Bo())),"redirect"===i.type){let e;if(e="string"==typeof i.redirect?await it(i.redirect,g):(await Ke({transform:"redirect",...i.redirect},g)).redirect,"string"!=typeof e)throw console.error("Unexpected redirect result:",e),new Error("Unexpected type of redirect result: "+typeof e);d.redirect={path:e}}else{const n=function(e,t){if(e){if("brick"===e.type)throw console.error("Set menu with brick is dropped in v3:",e),new Error("Set menu with brick is dropped in v3");if("resolve"!==e.type)return it(e,t);console.warn("Set menu with resolve is not supported in v3 yet:",e)}}(i.menu,g);let o;n&&(p.request=n),a||r.memoizeMenuRequestNode(t,p),o="routes"===i.type?await Fr(e,i.routes,g,r,v,p,s,void 0,c):await jr(e,i.bricks,g,r,v,p,s,void 0,void 0,c),Kr(d,o),qr(p,o.menuRequestNode)}}}var h,m;return d}async function jr(e,t,n,r,o,i,s,a,c,l){!function(e,t,n){function r(e){if((0,u.isObject)(e)&&"function"!=typeof e)if(Array.isArray(e))e.map(r);else for(const[t,n]of Object.entries(e))(0,u.isObject)(n)&&"useBrick"===t?Array.isArray(n)?n.forEach((e=>o(e,!0))):o(n,!0,!0):r(n)}function o(e,i,s){if(i&&(e[zn]=t),r(e.properties),n&&!s)return;const a=zr(e.children,e.slots);for(const e of Object.values(a??{}))for(const t of e.bricks??[])o(t,i)}for(const t of e)o(t)}(t,n,!0);const d={blockingList:[]},p=c??[];return(await Promise.all(t.map(((t,c)=>Vr(e,t,n,r,o,i,s,p.concat(c),a&&new Map(a),l))))).forEach(((t,n)=>{t.hasTrackingControls&&r.memoize(s,p.concat(n),t.node,e),Kr(d,t)})),d}async function Vr(e,t,n,r,o,i,s){let a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Map,d=arguments.length>9?arguments[9]:void 0;try{return await async function(e,t,n,r,o,i,s,a,c,d){var p,f;const m={blockingList:[]};if(!t.brick)return t.template?console.error("Legacy templates are dropped in v3:",t):console.error("Invalid brick:",t),m;const{if:v,permissionsPreCheck:y,...w}=t;if(function(e){return"string"==typeof e?(0,C.isTrackAll)(e):Je(e)&&(0,C.isTrackAll)(Xe(e))}(v))return Vr(e,{brick:":if",dataSource:v,permissionsPreCheck:y,slots:{"":{type:"bricks",bricks:[w]}},...Object.getOwnPropertySymbols(t).reduce(((e,n)=>({...e,[n]:t[n]})),{})},n,r,o,i,s,a,c,d);const E=t[Pt],b=t[xr],S={...n,tplStateStoreId:E,formStateStoreId:b};(0,u.hasOwnProperty)(t,Ot)&&(S.forEachItem=t[Ot],S.forEachIndex=t[Ct],S.forEachSize=t[xt]);const{context:A}=t;if(Array.isArray(A)&&A.length>0){const e=Pe(S);Oe(e,"Defining context on bricks","check your brick:",t),e||S.ctxStore.define(A,S)}if(S.pendingPermissionsPreCheck.push(null==Co||null===(p=Co.checkPermissions)||void 0===p?void 0:p.preCheckPermissionsForBrickOrRoute(t,(e=>it(e,S)))),!await async function(e,t){return(0,u.isObject)(e.if)&&!Je(e.if)?dt(await Ke(e.if,t)):lt(e,t)}(t,S))return m;const k=t.brick;if(k.startsWith(":")){!function(e){if(":forEach"!==e&&":if"!==e&&":switch"!==e)throw new Error(`Unknown storyboard control node: "${e}"`)}(k);const{dataSource:n}=t,{contextNames:l,stateNames:d}=ft(n),p=async(p,f,h)=>{var m;const g=await it(n,p);h&&yt(p,[{contextNames:l,stateNames:d,propValue:n}],f);const v=":forEach"===k?"":":switch"===k?String(g):g?"":"else",y=zr(t.children,t.slots),w=y&&(0,u.hasOwnProperty)(y,v)&&(null===(m=y[v])||void 0===m?void 0:m.bricks);if(!Array.isArray(w))return{blockingList:[]};switch(k){case":forEach":return Array.isArray(g)?async function(e,t,n,r,o,i,s,a,c,l,u){const d={blockingList:[]},p=t.length,f=await Promise.all(t.map(((t,d)=>Promise.all(n.map(((n,f)=>Vr(e,n,{...r,forEachItem:t,forEachIndex:d,forEachSize:p},o,i,s,a,l.concat(d*p+f),c&&new Map(c),u)))))));return f.flat().forEach(((t,n)=>{t.hasTrackingControls&&o.memoize(a,l.concat(n),t.node,e),Kr(d,t)})),d}(e,g,w,p,r,o,i,s,c,a,f):{blockingList:[]};case":if":case":switch":return jr(e,w,p,r,o,i,s,c,a,f)}},f=async(n,r)=>{var o;let i=!1;const s={disposes:[],listener:()=>{i=!0}};let a,c=0,l=!0;for(;l||i;)if(i=!1,a=await p(n,s,l&&"initial"===r),s.disposes.forEach((e=>e())),s.disposes.length=0,l=!1,++c>10)throw new Error(`Maximum rerender stack overflowed (iid: ${t.iid})`);return(o=a).node??(o.node={tag:wn.PLACEHOLDER,return:e}),a},m=await f(S,"initial"),{onMount:g,onUnmount:v}=t.lifeCycle??{};if(l||d){m.hasTrackingControls=!0;let t=0;const o=async()=>{const n=++t,[o,i,c]=Wr(S),l=await f(o,"rerender"),u=[...i,...c];if(await Hr(l,o,u),t===n){v&&Yt(v,S)(new CustomEvent("unmount",{detail:{rerender:!0}})),r.reRender(s,a,l.node,e),g&&Yt(g,o)(new CustomEvent("mount",{detail:{rerender:!0}}));for(const e of u)e.mountAsyncData()}},i=(0,h.debounce)(o,0,{leading:!0,trailing:!0}),c=e.tag===wn.BRICK?e:null,u=c?c.disposes??(c.disposes=[]):[];if(l)for(const e of l)u.push(S.ctxStore.onChange(e,i));if(d)for(const e of d){const t=Re(S,"STATE",`: "${n}"`);u.push(t.onChange(e,i))}}return g&&r.registerArbitraryLifeCycle("onMount",(()=>{Yt(g,S)(new CustomEvent("mount",{detail:{rerender:!1}}))})),v&&r.registerArbitraryLifeCycle("onUnmount",(()=>{Yt(v,S)(new CustomEvent("unmount",{detail:{rerender:!1}}))})),m}/\.tpl-/.test(k)&&!Te.get(k)&&await Gr((0,l.loadBricksImperatively)([k],Bo()),"brick",k,r.unknownBricks);const I=function(e,t){if(!e.includes(".")&&e.startsWith("tpl-")&&t){const n=`${t}.${e}`;if(Te.get(n))return n}return!!Te.get(e)&&e}(k,null===(f=S.app)||void 0===f?void 0:f.id);if(I){const e=c.get(I)??0;if(e>=10)throw new Error(`Maximum custom template stack overflowed: "${I}"`);c.set(I,e+1)}else k.includes("-")&&!customElements.get(k)&&(k===Cr?customElements.get(Cr)||customElements.define(Cr,Br):m.blockingList.push(Gr((0,l.enqueueStableLoadBricks)([k],Bo()),"brick",k,r.unknownBricks)));let P,O;var T;k===Cr?(({formData:P,...O}=t.properties??{}),null!==(T=t.properties)&&void 0!==T&&T.compute&&(P=await it(P,S))):O=t.properties;const R=[],L=function(e,t,n){return(0,u.isObject)(e)?Object.entries(e).map((e=>{let[r,o]=e;const{contextNames:i,stateNames:s,formStateNames:a}=ft(o);return(i||s||a)&&n.push({contextNames:i,stateNames:s,formStateNames:a,propName:r,propValue:o}),[r,it(o,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===r?nt.USE_BRICK:nt.INITIAL})]})):[]}(O,S,R),_=t[It];_&&L.push(..._);const B="script"===k;if(B||"link"===k){const e=await mt(L);if(B?e.src:"stylesheet"===e.rel&&e.href){const t=window.PUBLIC_ROOT??"";if(B){const{src:n,...r}=e;await Gr((0,l.loadScript)(n,t,r),"script",n,"silent")}else{const{href:n,...r}=e;await Gr((0,l.loadStyle)(n,t,r),"stylesheet",n,"silent")}return m}}const M={tag:wn.BRICK,type:I||k,return:e,slotId:s,events:t.events,runtimeContext:S,portal:t.portal,iid:t.iid,ref:t.ref};m.node=M;const $=(0,x.strictCollectMemberUsage)([t.events,t.lifeCycle],"PROCESSORS",2);$.size>0&&m.blockingList.push(Gr((0,l.loadProcessorsImperatively)($,Bo()),"processors",[...$].join(", "),r.unknownBricks));const N=[];yt(S,R,d);N.push((async()=>{M.properties=await mt(L),function(e,t){for(const n of t){const t=()=>{e.element&&vt(e.element,{[n.propName]:n.propValue},e.runtimeContext)};if(e.disposes??(e.disposes=[]),n.contextNames)for(const r of n.contextNames)e.disposes.push(e.runtimeContext.ctxStore.onChange(r,t));if(n.stateNames){const r=Re(e.runtimeContext,"STATE",`: "${n.propValue}"`);for(const o of n.stateNames)e.disposes.push(r.onChange(o,t))}if(n.formStateNames){const r=Ue(e.runtimeContext,"FORM_STATE",`: "${n.propValue}"`);for(const o of n.formStateNames)e.disposes.push(r.onChange(o,t))}}}(M,R)})()),r.registerBrickLifeCycle(M,t.lifeCycle);let U,F=t;I?F=Pr(I,t,M,L,r):k===Cr&&(F=function(e,t,n,r,o){var i;const s="string"==typeof e?JSON.parse(e):e,a=(0,h.uniqueId)("form-state-"),c={...n.runtimeContext,formStateStoreId:a};delete c.forEachItem,delete c.forEachIndex,delete c.forEachSize,delete c.tplStateStoreId;const l=new br("FORM_STATE",void 0,o,a);c.formStateStoreMap.set(a,l),c.formStateStoreScope&&c.formStateStoreScope.push(l);const d=s.context??[];d.some((e=>"params"===e.name))||d.push({name:"params"}),l.define(d,c,r);const p=Rr(s.formSchema,s.fields,a);return Tr.includes(p.brick)&&t.events&&(p.events=function(e,t){const n=e??{};for(const[e,r]of Object.entries(t))n[e]=(0,u.hasOwnProperty)(n,e)?[n[e],r].flat():r;return n}(p.events,t.events)),"boolean"!=typeof(null===(i=t.properties)||void 0===i?void 0:i.renderRoot)||t.properties.renderRoot?{...t,slots:void 0,children:[{brick:"eo-micro-view",properties:{style:{padding:"12px"}},children:[p]}]}:{...t,slots:void 0,children:[p]}}(P,t,M,L,r)),F.portal&&(M.slotId=void 0),I?(U={...S},delete U.forEachItem,delete U.forEachIndex,delete U.forEachSize):U=S;return N.push((async()=>{const e=zr(F.children,F.slots);if(!e)return;const t=new Map,n=await Promise.all(Object.entries(e).map(((e,n)=>{let[s,a]=e;if("routes"!==a.type)return jr(M,a.bricks,U,r,o,i,s,c,void 0,d);const l=o[o.length-1];return null!=l&&l.incrementalSubRoutes&&(t.set(n,s),r.performIncrementalRender(a,o,(async(e,t)=>{const{homepage:n}=U.app,{pathname:c}=e;if(!g(n,c)||!o.every((e=>{let r,o;return(r=kt(e,n,t.pathname))&&(o=kt(e,n,c))&&(e!==l||(0,h.isEqual)(r.params,o.params))})))return!1;const[u,d,p]=Wr({...U,location:e,query:new URLSearchParams(e.search)});let f,m=!1,v=[];try{if(f=await Fr(M,a.routes,u,r,o,i,s,!0),f.route){if(r.reBailout(f))return!0;v=[...d,...p],await Hr(f,u,[u.ctxStore,...v])}await r.reMergeMenuRequestNodes(i,a.routes,f.menuRequestNode)}catch(e){console.error("Incremental sub-router failed:",e);const t=await r.reCatch(e,M);if(!t)return!0;({failed:m,output:f}=t),await r.reMergeMenuRequestNodes(i,a.routes,f.menuRequestNode)}if(r.reRender(s,[],f.node,M),!m){u.ctxStore.mountAsyncData(f.route);for(const e of v)e.mountAsyncData()}return!!f.route||null}))),Fr(M,a.routes,U,r,o,i,s,void 0,d)}))),s={...m,node:void 0,blockingList:[],menuRequestNode:void 0};n.forEach(((e,n)=>{t.has(n)&&r.memoize(t.get(n),[],e.node,M),Kr(s,e),function(e,t){const n=t.menuRequestNode;if(n)if(e.menuRequestNode){let t=e.menuRequestNode;for(;t.sibling;)t=t.sibling;t.sibling=n}else e.menuRequestNode=n}(s,e)})),s.node&&(M.child=s.node),Kr(m,{...s,node:void 0}),qr(i,m.menuRequestNode=s.menuRequestNode)})()),await Promise.all(N),m}(e,t,n,r,o,i,s,a,c,d)}catch(n){if(t.errorBoundary)return console.error("Error caught by error boundary:",n),{node:await Nr(n,e),blockingList:[]};throw n}}function Dr(e){return[e.ctxStore,...e.tplStateStoreMap.values(),...e.formStateStoreMap.values()]}function Hr(e,t,n){return(0,l.flushStableLoadBricks)(),Promise.all([...e.blockingList,...n.map((e=>e.waitForAll())),...t.pendingPermissionsPreCheck])}function Wr(e){const t=[],n=[];return[{...e,tplStateStoreScope:t,formStateStoreScope:n},t,n]}function Kr(e,t){const{blockingList:n,node:r,menuRequestNode:o,hasTrackingControls:i,...s}=t;if(e.blockingList.push(...n),r)if(e.node){let t=e.node;for(;t.sibling;)t=t.sibling;t.sibling=r}else e.node=r;Object.assign(e,s)}function qr(e,t){if(t)if(e.child){let n=e.child;for(;n.sibling;)n=n.sibling;n.sibling=t}else e.child=t}function zr(e,t){let n=t;if(Array.isArray(e)&&!n){n={};for(const t of e){const e=t.slot??"";(0,u.hasOwnProperty)(n,e)||(n[e]={type:"bricks",bricks:[]}),n[e].bricks.push(t)}}return n}function Gr(e,t,n,r){return"silent"===r?e.catch((e=>{console.error('Load %s "%s" failed:',t,n,e)})):e}let Jr,Xr,Yr;function Qr(){if(!Jr){if(Jr={isInIframe:!1,isInIframeOfSameSite:!1,isInIframeOfNext:!1,isInIframeOfVisualBuilder:!1,isInIframeOfLegacyConsole:!1},window!==window.parent){Jr.isInIframe=!0;try{if(window.origin===window.parent.origin){Jr.isInIframeOfSameSite=!0;const e="/next/"===f(),t=window.parent.location.pathname,n=t.startsWith("/next/");Jr.isInIframeOfNext=0==(Number(e)^Number(n));const r=n?"/next":"";Jr.isInIframeOfVisualBuilder=t.startsWith(`${r}/visual-builder/`)||t.startsWith(`${r}/visual-builder-`),Jr.isInIframeOfLegacyConsole=e&&!n}}catch{}}Object.freeze(Jr)}return Jr}function Zr(e){var t;if(e.$$registerCustomTemplateProcessed)return;e.$$registerCustomTemplateProcessed=!0;const n=null===(t=e.meta)||void 0===t?void 0:t.customTemplates;if(Array.isArray(n))for(const t of n){const n=t.name.includes(".")?t.name:`${e.app.id}.${t.name}`;Te.define(n,t)}}function eo(e){let t;t="8.2"===e?"v8-2":"v8",document.documentElement.dataset.ui=t}const to="basic.show-watermark";var no=new WeakMap,ro=new WeakMap,oo=new WeakMap,io=new WeakMap,so=new WeakMap,ao=new WeakMap,co=new WeakMap,lo=new WeakMap,uo=new WeakMap,po=new WeakMap,fo=new WeakMap,ho=new WeakSet;class mo{constructor(e){(0,I.A)(this,ho),(0,i.A)(this,no,void 0),(0,i.A)(this,ro,!1),(0,i.A)(this,oo,void 0),(0,i.A)(this,io,void 0),(0,i.A)(this,so,void 0),(0,i.A)(this,ao,new Set),(0,i.A)(this,co,0),(0,i.A)(this,lo,void 0),(0,i.A)(this,uo,void 0),(0,i.A)(this,po,void 0),(0,i.A)(this,fo,void 0),(0,s.A)(no,this,e);const t=k();window.addEventListener("beforeunload",(e=>{(0,P.A)(ho,this,go).call(this,{})?(e.preventDefault(),e.returnValue=""):delete e.returnValue})),t.block(((e,t)=>(0,P.A)(ho,this,go).call(this,{location:e,action:t})))}getRenderId(){return(0,a.A)(lo,this)}getRuntimeContext(){return(0,a.A)(io,this)}getRecentApps(){return{currentApp:(0,a.A)(uo,this),previousApp:(0,a.A)(po,this)}}getNavConfig(){return(0,a.A)(fo,this)}bootstrap(){window.AbortController&&(Xr=new AbortController,O.http.interceptors.request.use((e=>{var t;return{...e,options:{...e.options,signal:null!==(t=e.options)&&void 0!==t&&t.noAbortOnRouteChange?null:Xr.signal}}})));const e=k();let t=e.location;return e.listen(((e,n)=>{const r=t;t=e,(0,a.A)(ro,this)?(0,s.A)(oo,this,{location:e,prevLocation:r,action:n}):(0,P.A)(ho,this,yo).call(this,{location:e,prevLocation:r,action:n}).catch(Wt)})),(0,P.A)(ho,this,yo).call(this,{location:e.location})}}function go(e){var t;const n=k(),r=n.getBlockMessage();null===(t=(0,a.A)(so,this))||void 0===t||t.dispatchBeforePageLeave(e);const o=n.getBlockMessage();return!r&&o&&n.unblock(),o}function vo(e,t,n){var r,o;if((0,s.A)(co,this,(r=(0,a.A)(co,this),o=r++,r)),o>10){const t=`Infinite redirect detected: from "${n.pathname}${n.search}${n.hash}" to "${e}"`;throw new Error(t)}k().replace(e,t)}async function yo(e){(0,s.A)(ro,this,!0);try{await(0,P.A)(ho,this,wo).call(this,e)}finally{if((0,s.A)(ro,this,!1),(0,a.A)(oo,this)){const e=(0,a.A)(oo,this);(0,s.A)(oo,this,void 0),await(0,P.A)(ho,this,yo).call(this,e)}}}async function wo(e){let{location:t,prevLocation:n,action:r}=e;if(n){var o,i,s,c;let e;const u={hash:void 0,state:void 0};var l;if(void 0!==t.key&&("POP"!==r||void 0!==n.key&&!1!==(null===(o=n.state)||void 0===o?void 0:o.notify))||(u.key=void 0),((0,p.locationsAreEqual)({...n,...u},{...t,...u})||"POP"!==r&&!1===(null===(i=t.state)||void 0===i?void 0:i.notify))&&(e=!0),e||null!==(s=t.state)&&void 0!==s&&s.noIncremental||(e=await(null===(l=(0,a.A)(so,this))||void 0===l?void 0:l.didPerformIncrementalRender(t,n))),e)return;if(Xr&&(Xr.abort(),Xr=new AbortController),null===(c=(0,a.A)(so,this))||void 0===c||c.dispatchPageLeave(),"POP"===r&&v(m((0,a.A)(no,this),t.pathname)))return void window.location.reload();H("locationChange")}return(0,P.A)(ho,this,Eo).call(this,t,!n)}async function Eo(e,t){var n,r,o,i;const c=(0,s.A)(lo,this,(0,h.uniqueId)("render-id-"));Ve=new WeakSet,We.clear(),null==Co||null===(n=Co.flowApi)||void 0===n||n.clearCollectWidgetContract(),k().unblock();const u=null==Co||null===(r=Co.pageView)||void 0===r?void 0:r.create(),d=m((0,a.A)(no,this),e.pathname),p=null===(o=(0,a.A)(io,this))||void 0===o?void 0:o.app,f=null==d||null===(i=d.app)||void 0===i?void 0:i.id;window.BOOTSTRAP_UNION_FILE&&f&&f!==(null==p?void 0:p.id)&&function(e){const{appId:t,version:n}=e;window.APP_ROOT_TPL&&(window.APP_ID=t,window.APP_ROOT=window.APP_ROOT_TPL.replace("{id}",t).replace("{version}",n))}({appId:f,version:d.app.currentVersion}),null!=d&&d.app&&await async function(e){if(!e.$$fulfilled)return e.$$fulfilling||(e.$$fulfilling=async function(e){var t;await(null==Co||null===(t=Co.fulfilStoryboard)||void 0===t?void 0:t.call(Co,e)),B(e),Object.assign(e,{$$fulfilled:!0,$$fulfilling:null})}(e)),e.$$fulfilling}(d);const g=(0,s.A)(uo,this,null==d?void 0:d.app);!function(){var e,t,n,r,o;const i=To().getFeatureFlags(),s=To().getMiscSettings();if(!i["show-watermark"])return;const a="0.0.0"===(null===(e=window.APP_ROOT)||void 0===e||null===(e=e.match(/versions\/([^/]+)\//))||void 0===e?void 0:e[1])||"0.0.0"===(null===(t=window.APP_ROOT)||void 0===t||null===(t=t.match(/micro-apps\/(?:v2|v3)\/[^/]+\/([^/]+)/))||void 0===t?void 0:t[1]),c=(null==Co||null===(n=Co.auth)||void 0===n||null===(n=n.getAuth())||void 0===n?void 0:n.username)??"",u=s.watermarkConfig??{flags:{}},d=[..."string"==typeof u.content?[u.content]:u.content??[],null!==(r=u.flags)&&void 0!==r&&r["show-development"]&&a?"Development":"",null!==(o=u.flags)&&void 0!==o&&o["show-user"]?c:""].filter(Boolean);if(0===d.length)return;const p={content:d,zIndex:1001,width:200,font:{fontSize:28},gap:[190,190],...(0,h.omit)(u,["content","flags"])};Yr?Yr.resolve(p):(0,l.loadBricksImperatively)([to],Bo()).then((()=>{Yr=document.createElement(to),Yr.resolve(p)}),(e=>{console.error("Load watermark service failed:",e)}))}();const v=p&&g?p.id!==g.id:p!==g;(0,C.clearExpressionASTCache)(),v&&(0,C.clearFunctionASTCache)();const y=To().getFeatureFlags(),w=(0,a.A)(so,this),E=(t,n)=>{null==u||u({status:"redirected"}),(0,a.A)(ao,this).add(w),(0,P.A)(ho,this,vo).call(this,t,n,e)},b=()=>{const t=y["sso-enabled"]?"/sso-auth/login":"/auth/login";Ut(e),E(t,{from:e})},S=document.querySelector("#main-mount-point"),A=document.querySelector("#portal-mount-point"),I={tag:wn.ROOT,container:S,createPortal:A},x=()=>{var e;En(S),En(A),(0,a.A)(ao,this).add(w);for(const e of(0,a.A)(ao,this))e&&(e.dispatchOnUnmount(),e.dispose());(0,a.A)(ao,this).clear(),null==Co||null===(e=Co.messageDispatcher)||void 0===e||e.reset(),v&&((0,s.A)(po,this,p),window.dispatchEvent(new CustomEvent("app.change",{detail:{previousApp:p,currentApp:g}})))};if(Q(g&&(re()[g.id]||g.theme)||"light"),ie("default"),g){var T,R,L,_,M,$;null==Co||null===(T=Co.checkInstalledApps)||void 0===T||T.preCheckInstalledApps(d,(e=>!!Fo(e)));const n={bailout:e=>e.unauthenticated?(b(),!0):e.redirect?(E(e.redirect.path,e.redirect.state),!0):void(0,s.A)(co,this,0),mergeMenus:async e=>{const t=await Promise.all(e);(0,s.A)(fo,this,function(e){const t={breadcrumb:[]};for(const n of e){const{breadcrumb:e}=n;e&&(e.overwrite?t.breadcrumb=e.items:t.breadcrumb.push(...e.items))}return t}(t)),window.dispatchEvent(new CustomEvent("navConfig.change",{detail:(0,a.A)(fo,this)}))},catch:async(t,n,r,o)=>{if(!jt(t)||window.NO_AUTH_GUARD){if(!(t instanceof O.HttpAbortError)){const i=To().getMiscSettings().noAuthGuardLoginPath;if(jt(t)&&i)return void E(i,{from:e});if(r)throw t;return{failed:!0,output:{node:await Nr(t,n,!o),blockingList:[]}}}(0,a.A)(ao,this).add(w)}else b()}},r=(0,s.A)(so,this,new Bn("page",{routeHelper:n,renderId:c})),o=(0,s.A)(io,this,{app:g,location:e,query:new URLSearchParams(e.search),flags:y,sys:{...null==Co||null===(R=Co.auth)||void 0===R?void 0:R.getAuth(),...Qr(),settings:{brand:To().getBrandSettings()}},ctxStore:new br("CTX",void 0,r),pendingPermissionsPreCheck:[null==Co||null===(L=Co.checkPermissions)||void 0===L?void 0:L.preCheckPermissions(d)],tplStateStoreMap:new Map,formStateStoreMap:new Map});(0,s.A)(fo,this,void 0),Zr(d),me(null===(_=d.meta)||void 0===_?void 0:_.functions,g),null==Co||null===(M=Co.flowApi)||void 0===M||M.collectContract(null===($=d.meta)||void 0===$?void 0:$.contracts);let i,l=!1,p=[];try{Kn.clear();const e={};if(i=await Fr(I,function(e){if(window.parent===window)return e;let t=e;const n=(0,h.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/template-preview/")));t=[...t.slice(0,n+1),{path:"${APP.homepage}/_dev_only_/template-preview/:templateId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(n+1)];const r=(0,h.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/snippet-preview/")));return t=[...t.slice(0,r+1),{path:"${APP.homepage}/_dev_only_/snippet-preview/:snippetId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(r+1)],t}(d.routes),o,r,[],e),n.bailout(i))return;p=Dr(o),await Hr(i,o,p),e.child=i.menuRequestNode,r.setInitialMenuRequestNode(e),await n.mergeMenus(r.getMenuRequests())}catch(e){console.error("Router failed:",e);const r=await n.catch(e,I,t);if(!r)return;({failed:l,output:i}=r)}if(I.child=i.node,x(),i.route&&"routes"!==i.route.type||l){if(l||r.dispatchBeforePageLoad(),te(),ae(),eo(null==g?void 0:g.uiVersion),bn(I),window.scrollTo(0,0),l)null==u||u({status:"failed"});else{r.dispatchPageLoad(),r.dispatchAnchorLoad(),r.dispatchOnMount(),r.initializeScrollIntoView(),r.initializeMediaChange(),r.initializeMessageDispatcher();for(const e of p)e.mountAsyncData();null==u||u({status:"ok",path:i.path,pageTitle:document.title})}return void H("rendered")}}else{if(!window.NO_AUTH_GUARD&&null!=Co&&Co.auth&&!Co.auth.isLoggedIn())return void b();x()}te(),ae();const N=await Nr(new $r(g?"page not found":"app not found"),I,!0);I.child=N,bn(I),window.scrollTo(0,0),null==u||u({status:"not-found"}),H("rendered")}const bo="undefined"!=typeof BRICK_PACKAGES?BRICK_PACKAGES:null;var So=n(3999);function Ao(e){const t=[];if(["light","dark"].forEach((n=>{if(e[n])switch(e.type){case"brandColor":t.push((0,So.LP)(n,e[n]));break;case"baseColors":t.push((0,So.eC)(n,e[n],e.backgroundColor));break;case"variables":t.push((0,So.Gb)(n,e[n]))}})),t.length>0){const e=document.createElement("style");return e.textContent=t.join("\n\n"),document.head.appendChild(e),()=>{e.remove()}}}let ko,Io,Po,Oo,Co;function xo(e){if(ko)throw new Error("Cannot create multiple runtimes");return window.addEventListener("message",(e=>{let{data:t}=e;if((null==t?void 0:t.source)!==U)return;const n=t.payload;switch(null==n?void 0:n.type){case F:D=n.active;break;case j:V=n.panel}})),Co=null==e?void 0:e.hooks,(0,c.initializeI18n)(Bt,Mt),d.locale(c.i18n.language),c.i18n.on("languageChanged",(()=>{d.locale(c.i18n.language)})),A(),ko=new _o,ko}const To=function(){const e=S();if(e)return function(){return new Proxy(e.getRuntime(),{get(){switch(arguments.length<=1?void 0:arguments[1]){case"getCurrentApp":case"getRecentApps":case"hasInstalledApp":case"getDesktops":case"getLaunchpadSettings":case"getLaunchpadSiteMap":case"toggleLaunchpadEffect":case"applyPageTitle":case"getNavConfig":case"getFeatureFlags":case"getMiscSettings":case"getBrandSettings":return Reflect.get(...arguments)}}})}}()||function(){return ko};var Ro=new WeakMap,Lo=new WeakMap;class _o{constructor(){(0,i.A)(this,Ro,!1),(0,i.A)(this,Lo,!1),(0,o.A)(this,"version",3)}initialize(e){var t;if((0,a.A)(Ro,this))throw new Error("The runtime cannot be initialized more than once");(0,s.A)(Ro,this,!0),function(e){(0,u.isObject)(e.settings)&&(0,u.deepFreeze)(e.settings),e.brickPackages&&(0,u.deepFreeze)(e.brickPackages)}(e),Io=e;const{notification:n,dialog:r}=Mo();var o;!1!==n&&(o=n??"basic.show-notification",(0,this.loadBricks)([o]).then((()=>{Dt=document.createElement(o)}),(e=>{console.error("Load notification service failed:",e)}))),!1!==r&&function(e,t){t([e]).then((()=>{$t=document.createElement(e)}),(e=>{console.error("Load dialog service failed:",e)}))}(r??"basic.show-dialog",this.loadBricks),function(e){e&&(e.brandColor?Ao({type:"brandColor",...e.brandColor}):e.baseColors?Ao({type:"baseColors",...e.baseColors}):e.variables&&Ao({type:"variables",...e.variables}))}(null===(t=e.settings)||void 0===t||null===(t=t.misc)||void 0===t?void 0:t.theme)}async bootstrap(e){if(e&&this.initialize(e),(0,a.A)(Lo,this))throw new Error("The runtime cannot be bootstrapped more than once");(0,s.A)(Lo,this,!0),Po=new mo(Io.storyboards),await Po.bootstrap()}getRecentApps(){var e;return(null===(e=Po)||void 0===e?void 0:e.getRecentApps())??{}}getCurrentApp(){var e;return null===(e=Po)||void 0===e?void 0:e.getRecentApps().currentApp}hasInstalledApp(e,t){return Ne(e,t)}getFeatureFlags(){var e,t;return{...null===(e=Io)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.featureFlags,...null===(t=Po)||void 0===t||null===(t=t.getRecentApps().currentApp)||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.featureFlags,"migrate-to-brick-next-v3":!0}}getMiscSettings(){var e,t;return{...null===(e=Io)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.misc,...null===(t=Po)||void 0===t||null===(t=t.getRecentApps().currentApp)||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.misc}}getBrandSettings(){var e;return{base_title:"DevOps 管理专家",...null===(e=Io)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.brand}}getLaunchpadSettings(){var e;return{columns:7,rows:4,...null===(e=Io)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.launchpad}}getDesktops(){var e;return(null===(e=Io)||void 0===e?void 0:e.desktops)??[]}getLaunchpadSiteMap(){var e;return(null===(e=Io)||void 0===e?void 0:e.siteSort)??[]}toggleLaunchpadEffect(e){document.body.classList.toggle("launchpad-open",e)}applyPageTitle(e){var t;const n=this.getBrandSettings().base_title;document.title=(null===(t=Po)||void 0===t||null===(t=t.getRecentApps().currentApp)||void 0===t?void 0:t.localeTitle)||(e?`${e} - ${n}`:n)}getNavConfig(){var e;return null===(e=Po)||void 0===e?void 0:e.getNavConfig()}loadBricks(e){return(0,l.loadBricksImperatively)(e,Bo())}}function Bo(){var e;return Oo??(Oo=function(e,t){if(null==t||!t.length)return e;const n=new Map;return[...t,...e].forEach((e=>{const t=e.filePath.split("/")[1];n.has(t)||n.set(t,e)})),Array.from(n.values())}((null===(e=Io)||void 0===e?void 0:e.brickPackages)??bo??window.STANDALONE_BRICK_PACKAGES??[],window.PUBLIC_DEPS))}function Mo(){var e;return(null===(e=Io)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.presetBricks)??{}}function $o(){var e;return null===(e=Po)||void 0===e?void 0:e.getRenderId()}function No(){var e;return null===(e=Po)||void 0===e?void 0:e.getRuntimeContext()}function Uo(e){var t;return null===(t=Io)||void 0===t||null===(t=t.storyboards)||void 0===t?void 0:t.find((t=>t.app.id===e))}function Fo(e){var t;return null===(t=Uo(e))||void 0===t?void 0:t.app}function jo(){for(var e,t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];null==Co||null===(e=Co.auth)||void 0===e||null===(t=e.authenticate)||void 0===t||t.call(e,...r)}function Vo(){var e;return null==Co||null===(e=Co.auth)||void 0===e?void 0:e.getAuth()}function Do(){var e,t;return null==Co||null===(e=Co.auth)||void 0===e||null===(t=e.logout)||void 0===t?void 0:t.call(e)}function Ho(){var e;return null==Co||null===(e=Co.auth)||void 0===e?void 0:e.isLoggedIn()}var Wo=new WeakMap;const Ko=new class{constructor(){(0,i.A)(this,Wo,new Map)}define(e,t){(0,a.A)(Wo,this).has(e)?console.error(`Custom editor of "${e}" already registered`):(0,a.A)(Wo,this).set(e,t)}get(e){return(0,a.A)(Wo,this).get(e)}};async function qo(e,t,n){return qe(await je(e),e,"resolve",t,n)}function zo(e){let t,{portal:n,scope:r="fragment",unknownBricks:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n;t=n||(()=>(i=document.createElement("div"),i.style.position="absolute",i.style.width=i.style.height="0",document.body.append(i),i));let s,a,l=!1;return{async render(n){let{theme:u,uiVersion:d,language:p,context:f,functions:m,templates:g,i18n:v,url:y,app:w}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l)throw new Error("The root is unmounted and cannot be rendered any more");const E=[].concat(n),b=s,S=(0,h.uniqueId)("render-id-");s=new Bn(r,{unknownBricks:o,renderId:S});const A={ctxStore:new br("CTX",void 0,s),pendingPermissionsPreCheck:[],tplStateStoreMap:new Map,formStateStoreMap:new Map};if(y){const e=new URL(y);A.query=e.searchParams,A.location={pathname:e.pathname,search:e.search,hash:e.hash,state:void 0}}const k={tag:wn.ROOT,container:e,createPortal:t};if("page"===r){var I;Q(u??"light"),ie("default"),eo(d),p&&await c.i18n.changeLanguage(p),w??(w={id:"demo",homepage:"/demo"}),A.app=w;const e={app:w,meta:{i18n:v,customTemplates:g}};null===(I=a)||void 0===I||I(),a=B(e),Zr(e),me(m,w)}A.ctxStore.define(f,A);let P,O=!1,C=[];try{P=await jr(k,E,A,s,[],{}),C=Dr(A),await Hr(P,A,C)}catch(e){O=!0,P={node:await Nr(e,k,"page"===r),blockingList:[]}}if(k.child=P.node,null==b||b.dispatchOnUnmount(),null==b||b.dispose(),En(e),i&&En(i),"page"===r&&(O||s.dispatchBeforePageLoad(),te(),ae()),bn(k),"page"===r&&window.scrollTo(0,0),!O){for(const e of C)e.mountAsyncData();"page"===r&&s.dispatchPageLoad(),s.dispatchOnMount(),s.initializeScrollIntoView(),s.initializeMediaChange(),s.initializeMessageDispatcher()}},unmount(){l||(l=!0,En(e),i&&(En(i),n||i.remove()))}}}function Go(e){let{useRealTimeQuery:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={...No()};t&&(n.query=new URLSearchParams(k().location.search));const r=t=>{if("string"==typeof t){if((0,C.isEvaluable)(t)){const e=et(t,n);return De(e),e}return(0,T.inject)(t,n)}return!(0,u.isObject)(t)||He(e)?t:Array.isArray(t)?t.map((e=>r(e))):Object.fromEntries(Object.entries(t).map((e=>{let[t,n]=e;return[r(t),r(n)]})))};return r(e)}},2561:(e,t,n)=>{"use strict";n.r(t),n.d(t,{supply:()=>s});var r=n(1030),o=n(1302),i=n(1322);function s(e,t,n){const r={undefined:void 0};for(const o of e)if(!Object.prototype.hasOwnProperty.call(r,o))if(t&&Object.prototype.hasOwnProperty.call(t,o))r[o]=t[o];else{const e=u(o,n);void 0!==e&&(r[o]=e)}return r}const a=new Set(["fill","pull","pullAll","pullAllBy","pullAllWith","pullAt","remove","reverse","assign","assignIn","assignInWith","assignWith","defaults","defaultsDeep","merge","mergeWith","set","setWith","unset","update","updateWith","after","ary","before","bind","bindKey","curry","curryRight","debounce","defer","delay","flip","memoize","negate","once","overArgs","partial","partialRight","rearg","rest","spread","throttle","unary","wrap"]),c=new Set(["lang","langData","locale","localeData","defineLocale","updateLocale","updateOffset"]),l=new Set(["Array","Boolean","Date","Infinity","JSON","Math","NaN","Number","String","RegExp","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","isFinite","isNaN","parseFloat","parseInt","Map","Set","URL","URLSearchParams","WeakMap","WeakSet","atob","btoa"]);function u(e,t){switch(e){case"Object":return n=Object,s=["entries","fromEntries","keys","values"],Object.fromEntries(s.map((e=>[e,function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n[e].apply(n,r)}])));case"_":return Object.fromEntries(Object.entries(r).filter((e=>!a.has(e[0]))).concat(t?[["uniqueId",e=>`${e??""}42`]]:[]));case"moment":return Object.assign((function(){return o(...arguments)}),Object.fromEntries(Object.entries(o).filter((e=>!c.has(e[0])))));case"PIPES":return i.pipes;case"TAG_URL":return d(!0);case"SAFE_TAG_URL":return d();default:if(l.has(e))return window[e]}var n,s}function d(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=[];return t.forEach(((t,n)=>{i.push(t),n<r.length&&i.push(e?String(r[n]).replace(/[^/]+/g,(e=>encodeURIComponent(e))):encodeURIComponent(String(r[n])))})),i.join("")}}},916:(e,t,n)=>{"use strict";n.r(t),n.d(t,{JsonStorage:()=>d,createProviderClass:()=>o,createSSEStream:()=>s,deepFreeze:()=>c,hasOwnProperty:()=>l,isObject:()=>u,unwrapProvider:()=>f});var r=n(5060);function o(e){return class extends HTMLElement{get $$typeof(){return"provider"}resolve(){return e(...arguments)}async saveAs(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];const s=await e(...o);(0,r.saveAs)(s,t)}}}var i=n(2110);async function s(e,t){const n=[],r=[];let o=!1,s=!1;const{converter:c,...l}=t??{};function u(){r.forEach((e=>{let[t]=e;return t({value:void 0,done:!0})}))}function d(){o=!0,r.length=0,n.length=0}return await new Promise(((t,o)=>{(0,i.y)(e,{...l,openWhenHidden:!0,async onopen(e){if(!e.ok)throw console.error("open error",e.statusText),new Error(e.statusText);t(null)},onmessage(e){let t,o,i=!0;try{t=(c??a)(e.data,e.event)}catch(e){i=!1,o=e}if(r.length>0){const[e,n]=r.shift();i?e(t):n(o)}else n.push(i?{ok:!0,data:t}:{ok:!1,reason:o})},onclose(){s=!0,u()},onerror(e){throw e}}).catch((e=>{o(e),function(e){r.forEach((t=>{let[n,r]=t;return r(e)})),d()}(e)}))})),{next(){return o?this.return():new Promise(((e,t)=>{if(n.length>0){const r=n.shift();r.ok?e(r.data):t(r.reason)}else s?(d(),e({value:void 0,done:!0})):r.push([e,t])}))},return:()=>(u(),d(),Promise.resolve({value:void 0,done:!0})),throw:e=>(u(),d(),Promise.reject(e)),[Symbol.asyncIterator](){return this}}}function a(e,t){if("error"===t){var n;let t;console.error("Received error event:",e);try{t=JSON.parse(e)}catch{}throw new Error("string"==typeof(null===(n=t)||void 0===n?void 0:n.error)?t.error:e)}if("[DONE]"===e)return{value:void 0,done:!0};if(e.startsWith("[ERROR]"))throw console.error("Received error message:",e),new Error(e);try{return{value:JSON.parse(e),done:!1}}catch(t){throw console.error("Failed to parse message:",e),t}}function c(e){const t=Object.getOwnPropertyNames(e);for(const n of t){const t=e[n];t&&"object"==typeof t&&c(t)}return Object.freeze(e)}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e){const t=typeof e;return null!=e&&("object"==t||"function"==t)}class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"brick-next-";this.storage=e,this.prefix=t}setItem(e,t){this.storage.setItem(this.prefix+e,JSON.stringify(t))}getItem(e){return JSON.parse(this.storage.getItem(this.prefix+e)??"null")}removeItem(e){return this.storage.removeItem(this.prefix+e)}clear(){return this.storage.clear()}}const p=new Map;function f(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o=function(e){let t=p.get(e);return t||(t=document.createElement(e),p.set(e,t),t)}(e);return o.resolve(...n)}}},5177:(e,t,n)=>{"use strict";function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(o,i){if("string"==typeof t?o.name===t:t.includes(o.name)){const t=[];for(let s=1;s<=n;s++){const n=i[i.length-s];if("MemberExpression"===(null==n?void 0:n.node.type)&&"object"===n.key){const i=n.node;i.computed||"Identifier"!==i.property.type?i.computed&&"Literal"===i.property.type&&"string"==typeof i.property.value?t.push(r?`${o.name}.${i.property.value}`:i.property.value):e.hasNonStaticUsage=!0:t.push(r?`${o.name}.${i.property.name}`:i.property.name)}else e.hasNonStaticUsage=!0}t.length===n&&e.usedProperties.add(t.join("."))}}}function o(e,t){return function(n,r,o){if(r.name===e){const e=o[o.length-1],r=o[o.length-2];if("CallExpression"===(null==r?void 0:r.node.type)&&"callee"===(null==r?void 0:r.key)&&"MemberExpression"===(null==e?void 0:e.node.type)&&"object"===e.key&&(e.node.computed?"Literal"===e.node.property.type&&e.node.property.value===t:"Identifier"===e.node.property.type&&e.node.property.name===t)){const e=r.node.arguments;if(e.length>0){const t=e[0];"Literal"===t.type&&"string"==typeof t.value?n.usedArgs.add(t.value):n.hasNonStaticUsage=!0}}}}}n.r(t),n.d(t,{beforeVisitGlobalMember:()=>r,collectAppGetMenuUsage:()=>i,collectInstalledAppsHasUsage:()=>s,collectMemberUsage:()=>d,collectMemberUsageInFunction:()=>v,createProviderClass:()=>c.createProviderClass,scanPermissionActionsInAny:()=>b,scanPermissionActionsInStoryboard:()=>E,strictCollectMemberUsage:()=>u,track:()=>f,trackAll:()=>h,traverseStoryboardExpressions:()=>l,traverseStoryboardFunction:()=>g,traverseStoryboardFunctions:()=>m,unwrapProvider:()=>c.unwrapProvider});const i=o("APP","getMenu"),s=o("INSTALLED_APPS","has");var a=n(5238),c=n(6458);function l(e,t,n){const r=new WeakSet,{matchExpressionString:o,visitNotMatchedExpressionString:i,visitNonExpressionString:s,visitObject:l}="string"==typeof n?{matchExpressionString:e=>e.includes(n)}:n;!function e(n){if("string"==typeof n)if((0,a.isEvaluable)(n))if(o(n))try{(0,a.preevaluate)(n,{cache:!0,withParent:!0,hooks:{beforeVisitGlobal(e,r){t(e,r,n)}}})}catch(e){console.error("Parse storyboard expression failed:",e)}else null==i||i(n);else null==s||s(n);else if((0,c.isObject)(n)){if(r.has(n))return;r.add(n),null==l||l(n);for(const t of Array.isArray(n)?n:Object.values(n))e(t)}}(e)}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const{hasNonStaticUsage:r,nonStaticUsage:o,usedProperties:i}=d(e,t,n);if(r)throw new Error(`Non-static usage of ${t} is prohibited, check your expression: "${o}"`);return i}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o={usedProperties:new Set,hasNonStaticUsage:!1},i=r(o,t,n);return l(e,((e,t,n)=>{i(e,t),o.hasNonStaticUsage&&(o.nonStaticUsage=n)}),t),o}const p=["CTX","STATE","FORM_STATE"];function f(e,t,n){if(e.includes(t)){const o={usedProperties:new Set,hasNonStaticUsage:!1},{expression:i}=(0,a.preevaluate)(e,{cache:!0,withParent:!0,hooks:{beforeVisitGlobal:r(o,n)}});let s;if("SequenceExpression"===i.type&&(s=i.expressions[0])&&"Literal"===s.type&&s.value===t){if(o.usedProperties.size>0)return o.usedProperties;console.warn(`You are using "${t}" but no \`${n}\` usage found in your expression: ${JSON.stringify(e)}`)}}return!1}function h(e){if(p.some((t=>e.includes(t)))){const t={usedProperties:new Set,hasNonStaticUsage:!1};if((0,a.preevaluate)(e,{cache:!0,withParent:!0,hooks:{beforeVisitGlobal:r(t,p,1,!0)}}),t.usedProperties.size>0){const e=[...t.usedProperties],n={context:!1,state:!1,formState:!1},r={CTX:"context",STATE:"state",FORM_STATE:"formState"};return e.forEach((e=>{const[t,o]=e.split(".");n[r[t]]||(n[r[t]]=[]),n[r[t]].push(o)})),n}console.warn(`You are using track all but no "CTX" or "STATE" or "FORM_STATE" usage found in your expression: ${JSON.stringify(e)}`)}return!1}function m(e,t,n){if(Array.isArray(e))for(const r of e)null!=n&&n.matchSource&&!n.matchSource(r.source)||g(r,t)}function g(e,t,n){try{(0,a.precookFunction)(e.source,{typescript:e.typescript,withParent:!0,hooks:{beforeVisitGlobal:t},cacheKey:e})}catch(t){n||console.error(`Parse storyboard function "${e.name}" failed:`,t)}}function v(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i={usedProperties:new Set,hasNonStaticUsage:!1};if(e.source.includes(t)&&g(e,r(i,t,o),n),i.hasNonStaticUsage&&!n)throw new Error(`Non-static usage of ${t} is prohibited, check your function: "${e.name}"`);return i.usedProperties.delete(e.name),i.usedProperties}const y="PERMISSIONS",w="check";function E(e){const t=new Set,n=S(t),{customTemplates:r,functions:o}=e.meta??{};return l([e.routes,r],n,y),m(o,n,{matchSource:e=>e.includes(y)}),Array.from(t)}function b(e){const t=new Set;return l(e,S(t),y),Array.from(t)}function S(e){return function(t,n){if(t.name===y){const t=n[n.length-1],r=n[n.length-2];if("CallExpression"===(null==r?void 0:r.node.type)&&"callee"===(null==r?void 0:r.key)&&"MemberExpression"===(null==t?void 0:t.node.type)&&"object"===t.key&&(t.node.computed?"Literal"===t.node.property.type&&t.node.property.value===w:"Identifier"===t.node.property.type&&t.node.property.name===w))for(const t of r.node.arguments)"Literal"===t.type&&"string"==typeof t.value&&e.add(t.value)}}}}}]);
//# sourceMappingURL=core.5f6575a8.js.map